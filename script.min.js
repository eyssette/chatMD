!function(){"use strict";let e={secureMode:!1,authorizedChatbots:["https://codimd.apps.education.fr/d3yEseF3RtWzeW3vcgn4MQ"],defaultMessage:["Désolé, je ne comprends pas votre question.","Pardonnez-moi, mais je ne saisis pas votre demande.","Excusez-moi, je ne parviens pas à comprendre ce que vous demandez.","Je suis navré, mais je ne parviens pas à saisir votre question.","Malheureusement, je ne suis pas en mesure de comprendre votre question.","Je suis désolé, mais je ne saisis pas votre question.","Pardonnez-moi, mais je ne saisis pas le sens de votre question.","Je m'excuse, mais je ne parviens pas à saisir votre demande. Pouvez-vous reformuler votre question, s'il vous plaît ?","Je ne suis pas sûr de comprendre ce que vous demandez. Pouvez-vous expliquer davantage ?","Je ne peux pas répondre à votre question telle qu'elle est formulée. Pouvez-vous la poser différemment ?","Votre question ne semble pas correspondre à mes capacités actuelles. Pourriez-vous la reformuler autrement ?","Je n'ai malheureusement pas compris votre requête.","Je suis désolé, je ne suis pas capable de répondre.","Malheureusement, je ne peux pas répondre à votre question.","Malheureusement je n'arrive pas à comprendre votre requête.","Excusez-moi, je ne comprends pas votre requête.","Excusez-moi, je n'arrive pas à répondre à votre question.","Je ne parviens pas à répondre à votre requête. Veuillez m'excuser."],badWordsMessage:["Même si je ne suis qu'un chatbot, merci de vous adresser à moi avec un langage approprié","Je préférerais que nous restions courtois dans notre communication.","Les insultes ne sont pas nécessaires. Comment puis-je vous aider autrement ?","Essayons de garder une conversation respectueuse.","Je préfère une conversation respectueuse et productive.","Je vous encourage à reformuler votre question ou commentaire de manière respectueuse.","Les mots offensants ne sont pas nécessaires ici. Comment puis-je vous aider de manière constructive ?","Restons courtois dans nos échanges, s'il vous plaît.","Injures et grossièretés ne mènent nulle part. Comment puis-je vous assister ?","Je suis ouvert à la discussion, mais veuillez garder un langage respectueux.","Essayons de communiquer de manière civilisée !"],shortcuts:[["dissertation-philo","https://raw.githubusercontent.com/eyssette/chatbot/main/dissertation-philosophie.md"],["multiple-urls",["https://codimd.apps.education.fr/t7yi1Ak7Q--r2r4oB-3Uhg/download","https://codimd.apps.education.fr/fqjqvdIkQvWD-PVGONrq2g/download"]]],corsProxy:"https://corsproxy.io/?",responsesTitles:["## "],allowedAddOns:{pako:{js:"js/externals/pako.min.js"},kroki:{js:"js/externals/kroki.js"},textFit:{js:"js/externals/textFit.min.js",css:"<style>.katex-display{max-width:80%} .katex-display .textFitted{white-space:nowrap}</style>"}},addOnsDependencies:{kroki:["pako"]}};e.yaml={addOns:"",avatar:"",bots:{},detectBadWords:!1,defaultMessage:e.defaultMessage,dynamicContent:!1,favicon:"",footer:!0,maths:!1,obfuscate:!1,responsesTitles:e.responsesTitles,searchInContent:!1,style:"",theme:"",typeWriter:!0,userInput:!0,variables:""};e.yaml.useLLM={url:"",askAPIkey:!1,apiKey:"",model:"",always:!1,systemPrompt:"Tu es un assistant efficace qui réponds en français et pas dans une autre langue. Les phrases de réponse doivent être courtes et claires.",maxTokens:100,preprompt:"",postprompt:"\nN'oublie pas de répondre en français."};const t={RAGinformations:"",RAGseparator:"\n",RAGmaxTopElements:3,RAGprompt:"\nVoici ci-dessous le contexte à partir duquel tu dois prioritairement partir pour construire ta réponse, tu dois sélectionner dans ce contexte l'information qui est en lien avec la question et ne pas parler du reste. Si l'information n'est pas dans le contexte, indique-le et essaie de répondre malgré tout.\nCONTEXTE : "};function n(e){return e[Math.floor(Math.random()*e.length)]}function r(e,t){for(const n of t)if(e.startsWith(n))return n}function a(e){return e.sort((function(){return Math.random()-.5}))}function s(t){if(""!==t){let n=!0;const r=e.shortcuts.find((e=>e[0]==t));if(r)return t=r[1];if(e.secureMode){const n=e.authorizedChatbots.find((e=>e==t));if(!n)return"";t=n}t.includes(".forge")&&(n=!1),t.startsWith("https://github.com")&&(n=!1,t=(t=t.replace("https://github.com","https://raw.githubusercontent.com")).replace("/blob/","/")),(t.startsWith("https://codimd")||t.includes("hedgedoc")||t.includes("digipage"))&&(n=!1,t=-1===(t=t.replace("?edit","").replace("?both","").replace("?view","").replace(/#$/,"").replace(/\/$/,"")).indexOf("download")?t+"/download":t),!t.includes("framapad")&&!t.includes("digidoc")||t.endsWith("/export/txt")||(n=!1,t=t.replace(/\?.*/,"")+"/export/txt"),t=n?e.corsProxy+t:t}return t}function i(e){return new Promise(((t,n)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=n,document.head.appendChild(r)}))}function o(e){return new Promise(((t,n)=>{let r;e.startsWith("<style>")?(r=document.createElement("style"),r.textContent=e.replace("<style>","").replace("</style>","")):(r=document.createElement("link"),r.href=e,r.rel="stylesheet",r.onload=t,r.onerror=n),document.head.appendChild(r)}))}function l(){setTimeout((()=>{window.scrollTo(0,document.body.scrollHeight)}),100)}e.yaml.useLLM={...e.yaml.useLLM,...t};const u=document.getElementById("footer");function c(e){const t=parseFloat(e);return isNaN(t)||t.toString()!==e.toString().trim()?e:t}function p(e,t){for(const r in t)(n=t[r])&&"object"==typeof n?(e[r]||Object.assign(e,{[r]:{}}),p(e[r],t[r])):Object.assign(e,{[r]:t[r]});var n;return e}
/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function d(e){return null==e}var m={isNothing:d,isObject:function(e){return"object"==typeof e&&null!==e},toArray:function(e){return Array.isArray(e)?e:d(e)?[]:[e]},repeat:function(e,t){var n,r="";for(n=0;n<t;n+=1)r+=e;return r},isNegativeZero:function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e},extend:function(e,t){var n,r,a,s;if(t)for(n=0,r=(s=Object.keys(t)).length;n<r;n+=1)e[a=s[n]]=t[a];return e}};function h(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),r+" "+n):r}function f(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=h(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}f.prototype=Object.create(Error.prototype),f.prototype.constructor=f,f.prototype.toString=function(e){return this.name+": "+h(this,e)};var g=f;function b(e,t,n,r,a){var s="",i="",o=Math.floor(a/2)-1;return r-t>o&&(t=r-o+(s=" ... ").length),n-r>o&&(n=r+o-(i=" ...").length),{str:s+e.slice(t,n).replace(/\t/g,"→")+i,pos:r-t+s.length}}function v(e,t){return m.repeat(" ",t-e.length)+e}var _=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,r=/\r?\n|\r|\0/g,a=[0],s=[],i=-1;n=r.exec(e.buffer);)s.push(n.index),a.push(n.index+n[0].length),e.position<=n.index&&i<0&&(i=a.length-2);i<0&&(i=a.length-1);var o,l,u="",c=Math.min(e.line+t.linesAfter,s.length).toString().length,p=t.maxLength-(t.indent+c+3);for(o=1;o<=t.linesBefore&&!(i-o<0);o++)l=b(e.buffer,a[i-o],s[i-o],e.position-(a[i]-a[i-o]),p),u=m.repeat(" ",t.indent)+v((e.line-o+1).toString(),c)+" | "+l.str+"\n"+u;for(l=b(e.buffer,a[i],s[i],e.position,p),u+=m.repeat(" ",t.indent)+v((e.line+1).toString(),c)+" | "+l.str+"\n",u+=m.repeat("-",t.indent+c+3+l.pos)+"^\n",o=1;o<=t.linesAfter&&!(i+o>=s.length);o++)l=b(e.buffer,a[i+o],s[i+o],e.position-(a[i]-a[i+o]),p),u+=m.repeat(" ",t.indent)+v((e.line+o+1).toString(),c)+" | "+l.str+"\n";return u.replace(/\n$/,"")},w=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],k=["scalar","sequence","mapping"];var y=function(e,t){if(t=t||{},Object.keys(t).forEach((function(t){if(-1===w.indexOf(t))throw new g('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')})),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=function(e){var t={};return null!==e&&Object.keys(e).forEach((function(n){e[n].forEach((function(e){t[String(e)]=n}))})),t}(t.styleAliases||null),-1===k.indexOf(this.kind))throw new g('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function x(e,t){var n=[];return e[t].forEach((function(e){var t=n.length;n.forEach((function(n,r){n.tag===e.tag&&n.kind===e.kind&&n.multi===e.multi&&(t=r)})),n[t]=e})),n}function M(e){return this.extend(e)}M.prototype.extend=function(e){var t=[],n=[];if(e instanceof y)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new g("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach((function(e){if(!(e instanceof y))throw new g("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new g("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new g("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")})),n.forEach((function(e){if(!(e instanceof y))throw new g("Specified list of YAML types (or a single Type object) contains a non-Type object.")}));var r=Object.create(M.prototype);return r.implicit=(this.implicit||[]).concat(t),r.explicit=(this.explicit||[]).concat(n),r.compiledImplicit=x(r,"implicit"),r.compiledExplicit=x(r,"explicit"),r.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function r(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}(r.compiledImplicit,r.compiledExplicit),r};var A=M,C=new y("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),L=new y("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),S=new y("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}}),T=new A({explicit:[C,L,S]});var j=new y("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});var q=new y("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function P(e){return 48<=e&&e<=55}function E(e){return 48<=e&&e<=57}var O=new y("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=e.length,a=0,s=!1;if(!r)return!1;if("-"!==(t=e[a])&&"+"!==t||(t=e[++a]),"0"===t){if(a+1===r)return!0;if("b"===(t=e[++a])){for(a++;a<r;a++)if("_"!==(t=e[a])){if("0"!==t&&"1"!==t)return!1;s=!0}return s&&"_"!==t}if("x"===t){for(a++;a<r;a++)if("_"!==(t=e[a])){if(!(48<=(n=e.charCodeAt(a))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;s=!0}return s&&"_"!==t}if("o"===t){for(a++;a<r;a++)if("_"!==(t=e[a])){if(!P(e.charCodeAt(a)))return!1;s=!0}return s&&"_"!==t}}if("_"===t)return!1;for(;a<r;a++)if("_"!==(t=e[a])){if(!E(e.charCodeAt(a)))return!1;s=!0}return!(!s||"_"===t)},construct:function(e){var t,n=e,r=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(r=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return r*parseInt(n.slice(2),2);if("x"===n[1])return r*parseInt(n.slice(2),16);if("o"===n[1])return r*parseInt(n.slice(2),8)}return r*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!m.isNegativeZero(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),I=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");var z=/^[-+]?[0-9]+e/;var D=new y("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!I.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||m.isNegativeZero(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(m.isNegativeZero(e))return"-0.0";return n=e.toString(10),z.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),B=T.extend({implicit:[j,q,O,D]}),R=B,N=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),H=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");var F=new y("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==N.exec(e)||null!==H.exec(e))},construct:function(e){var t,n,r,a,s,i,o,l,u=0,c=null;if(null===(t=N.exec(e))&&(t=H.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,a=+t[3],!t[4])return new Date(Date.UTC(n,r,a));if(s=+t[4],i=+t[5],o=+t[6],t[7]){for(u=t[7].slice(0,3);u.length<3;)u+="0";u=+u}return t[9]&&(c=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(c=-c)),l=new Date(Date.UTC(n,r,a,s,i,o,u)),c&&l.setTime(l.getTime()-c),l},instanceOf:Date,represent:function(e){return e.toISOString()}});var U=new y("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),G="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r";var V=new y("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,r=0,a=e.length,s=G;for(n=0;n<a;n++)if(!((t=s.indexOf(e.charAt(n)))>64)){if(t<0)return!1;r+=6}return r%8==0},construct:function(e){var t,n,r=e.replace(/[\r\n=]/g,""),a=r.length,s=G,i=0,o=[];for(t=0;t<a;t++)t%4==0&&t&&(o.push(i>>16&255),o.push(i>>8&255),o.push(255&i)),i=i<<6|s.indexOf(r.charAt(t));return 0===(n=a%4*6)?(o.push(i>>16&255),o.push(i>>8&255),o.push(255&i)):18===n?(o.push(i>>10&255),o.push(i>>2&255)):12===n&&o.push(i>>4&255),new Uint8Array(o)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,r="",a=0,s=e.length,i=G;for(t=0;t<s;t++)t%3==0&&t&&(r+=i[a>>18&63],r+=i[a>>12&63],r+=i[a>>6&63],r+=i[63&a]),a=(a<<8)+e[t];return 0===(n=s%3)?(r+=i[a>>18&63],r+=i[a>>12&63],r+=i[a>>6&63],r+=i[63&a]):2===n?(r+=i[a>>10&63],r+=i[a>>4&63],r+=i[a<<2&63],r+=i[64]):1===n&&(r+=i[a>>2&63],r+=i[a<<4&63],r+=i[64],r+=i[64]),r}}),$=Object.prototype.hasOwnProperty,W=Object.prototype.toString;var Q=new y("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,a,s,i=[],o=e;for(t=0,n=o.length;t<n;t+=1){if(r=o[t],s=!1,"[object Object]"!==W.call(r))return!1;for(a in r)if($.call(r,a)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==i.indexOf(a))return!1;i.push(a)}return!0},construct:function(e){return null!==e?e:[]}}),Y=Object.prototype.toString;var J=new y("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,r,a,s,i=e;for(s=new Array(i.length),t=0,n=i.length;t<n;t+=1){if(r=i[t],"[object Object]"!==Y.call(r))return!1;if(1!==(a=Object.keys(r)).length)return!1;s[t]=[a[0],r[a[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,r,a,s,i=e;for(s=new Array(i.length),t=0,n=i.length;t<n;t+=1)r=i[t],a=Object.keys(r),s[t]=[a[0],r[a[0]]];return s}}),K=Object.prototype.hasOwnProperty;var Z=new y("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(K.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),X=R.extend({implicit:[F,U],explicit:[V,Q,J,Z]}),ee=Object.prototype.hasOwnProperty,te=1,ne=2,re=3,ae=4,se=1,ie=2,oe=3,le=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,ue=/[\x85\u2028\u2029]/,ce=/[,\[\]\{\}]/,pe=/^(?:!|!!|![a-z\-]+!)$/i,de=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function me(e){return Object.prototype.toString.call(e)}function he(e){return 10===e||13===e}function fe(e){return 9===e||32===e}function ge(e){return 9===e||32===e||10===e||13===e}function be(e){return 44===e||91===e||93===e||123===e||125===e}function ve(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function _e(e){return 48===e?"\0":97===e?"":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"":95===e?" ":76===e?"\u2028":80===e?"\u2029":""}function we(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var ke=new Array(256),ye=new Array(256),xe=0;xe<256;xe++)ke[xe]=_e(xe)?1:0,ye[xe]=_e(xe);function Me(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||X,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function Ae(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=_(n),new g(t,n)}function Ce(e,t){throw Ae(e,t)}function Le(e,t){e.onWarning&&e.onWarning.call(null,Ae(e,t))}var Se={YAML:function(e,t,n){var r,a,s;null!==e.version&&Ce(e,"duplication of %YAML directive"),1!==n.length&&Ce(e,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&Ce(e,"ill-formed argument of the YAML directive"),a=parseInt(r[1],10),s=parseInt(r[2],10),1!==a&&Ce(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=s<2,1!==s&&2!==s&&Le(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var r,a;2!==n.length&&Ce(e,"TAG directive accepts exactly two arguments"),r=n[0],a=n[1],pe.test(r)||Ce(e,"ill-formed tag handle (first argument) of the TAG directive"),ee.call(e.tagMap,r)&&Ce(e,'there is a previously declared suffix for "'+r+'" tag handle'),de.test(a)||Ce(e,"ill-formed tag prefix (second argument) of the TAG directive");try{a=decodeURIComponent(a)}catch(t){Ce(e,"tag prefix is malformed: "+a)}e.tagMap[r]=a}};function Te(e,t,n,r){var a,s,i,o;if(t<n){if(o=e.input.slice(t,n),r)for(a=0,s=o.length;a<s;a+=1)9===(i=o.charCodeAt(a))||32<=i&&i<=1114111||Ce(e,"expected valid JSON character");else le.test(o)&&Ce(e,"the stream contains non-printable characters");e.result+=o}}function je(e,t,n,r){var a,s,i,o;for(m.isObject(n)||Ce(e,"cannot merge mappings; the provided source object is unacceptable"),i=0,o=(a=Object.keys(n)).length;i<o;i+=1)s=a[i],ee.call(t,s)||(t[s]=n[s],r[s]=!0)}function qe(e,t,n,r,a,s,i,o,l){var u,c;if(Array.isArray(a))for(u=0,c=(a=Array.prototype.slice.call(a)).length;u<c;u+=1)Array.isArray(a[u])&&Ce(e,"nested arrays are not supported inside keys"),"object"==typeof a&&"[object Object]"===me(a[u])&&(a[u]="[object Object]");if("object"==typeof a&&"[object Object]"===me(a)&&(a="[object Object]"),a=String(a),null===t&&(t={}),"tag:yaml.org,2002:merge"===r)if(Array.isArray(s))for(u=0,c=s.length;u<c;u+=1)je(e,t,s[u],n);else je(e,t,s,n);else e.json||ee.call(n,a)||!ee.call(t,a)||(e.line=i||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Ce(e,"duplicated mapping key")),"__proto__"===a?Object.defineProperty(t,a,{configurable:!0,enumerable:!0,writable:!0,value:s}):t[a]=s,delete n[a];return t}function Pe(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):Ce(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function Ee(e,t,n){for(var r=0,a=e.input.charCodeAt(e.position);0!==a;){for(;fe(a);)9===a&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),a=e.input.charCodeAt(++e.position);if(t&&35===a)do{a=e.input.charCodeAt(++e.position)}while(10!==a&&13!==a&&0!==a);if(!he(a))break;for(Pe(e),a=e.input.charCodeAt(e.position),r++,e.lineIndent=0;32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position)}return-1!==n&&0!==r&&e.lineIndent<n&&Le(e,"deficient indentation"),r}function Oe(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||(n+=3,0!==(t=e.input.charCodeAt(n))&&!ge(t)))}function Ie(e,t){1===t?e.result+=" ":t>1&&(e.result+=m.repeat("\n",t-1))}function ze(e,t){var n,r,a=e.tag,s=e.anchor,i=[],o=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=i),r=e.input.charCodeAt(e.position);0!==r&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,Ce(e,"tab characters must not be used in indentation")),45===r)&&ge(e.input.charCodeAt(e.position+1));)if(o=!0,e.position++,Ee(e,!0,-1)&&e.lineIndent<=t)i.push(null),r=e.input.charCodeAt(e.position);else if(n=e.line,Re(e,t,re,!1,!0),i.push(e.result),Ee(e,!0,-1),r=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==r)Ce(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!o&&(e.tag=a,e.anchor=s,e.kind="sequence",e.result=i,!0)}function De(e){var t,n,r,a,s=!1,i=!1;if(33!==(a=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&Ce(e,"duplication of a tag property"),60===(a=e.input.charCodeAt(++e.position))?(s=!0,a=e.input.charCodeAt(++e.position)):33===a?(i=!0,n="!!",a=e.input.charCodeAt(++e.position)):n="!",t=e.position,s){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&62!==a);e.position<e.length?(r=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Ce(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==a&&!ge(a);)33===a&&(i?Ce(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),pe.test(n)||Ce(e,"named tag handle cannot contain such characters"),i=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);r=e.input.slice(t,e.position),ce.test(r)&&Ce(e,"tag suffix cannot contain flow indicator characters")}r&&!de.test(r)&&Ce(e,"tag name cannot contain such characters: "+r);try{r=decodeURIComponent(r)}catch(t){Ce(e,"tag name is malformed: "+r)}return s?e.tag=r:ee.call(e.tagMap,n)?e.tag=e.tagMap[n]+r:"!"===n?e.tag="!"+r:"!!"===n?e.tag="tag:yaml.org,2002:"+r:Ce(e,'undeclared tag handle "'+n+'"'),!0}function Be(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&Ce(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!ge(n)&&!be(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Ce(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function Re(e,t,n,r,a){var s,i,o,l,u,c,p,d,h,f=1,g=!1,b=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,s=i=o=ae===n||re===n,r&&Ee(e,!0,-1)&&(g=!0,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)),1===f)for(;De(e)||Be(e);)Ee(e,!0,-1)?(g=!0,o=s,e.lineIndent>t?f=1:e.lineIndent===t?f=0:e.lineIndent<t&&(f=-1)):o=!1;if(o&&(o=g||a),1!==f&&ae!==n||(d=te===n||ne===n?t:t+1,h=e.position-e.lineStart,1===f?o&&(ze(e,h)||function(e,t,n){var r,a,s,i,o,l,u,c=e.tag,p=e.anchor,d={},m=Object.create(null),h=null,f=null,g=null,b=!1,v=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),u=e.input.charCodeAt(e.position);0!==u;){if(b||-1===e.firstTabInLine||(e.position=e.firstTabInLine,Ce(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),s=e.line,63!==u&&58!==u||!ge(r)){if(i=e.line,o=e.lineStart,l=e.position,!Re(e,n,ne,!1,!0))break;if(e.line===s){for(u=e.input.charCodeAt(e.position);fe(u);)u=e.input.charCodeAt(++e.position);if(58===u)ge(u=e.input.charCodeAt(++e.position))||Ce(e,"a whitespace character is expected after the key-value separator within a block mapping"),b&&(qe(e,d,m,h,f,null,i,o,l),h=f=g=null),v=!0,b=!1,a=!1,h=e.tag,f=e.result;else{if(!v)return e.tag=c,e.anchor=p,!0;Ce(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!v)return e.tag=c,e.anchor=p,!0;Ce(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===u?(b&&(qe(e,d,m,h,f,null,i,o,l),h=f=g=null),v=!0,b=!0,a=!0):b?(b=!1,a=!0):Ce(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,u=r;if((e.line===s||e.lineIndent>t)&&(b&&(i=e.line,o=e.lineStart,l=e.position),Re(e,t,ae,!0,a)&&(b?f=e.result:g=e.result),b||(qe(e,d,m,h,f,g,i,o,l),h=f=g=null),Ee(e,!0,-1),u=e.input.charCodeAt(e.position)),(e.line===s||e.lineIndent>t)&&0!==u)Ce(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return b&&qe(e,d,m,h,f,null,i,o,l),v&&(e.tag=c,e.anchor=p,e.kind="mapping",e.result=d),v}(e,h,d))||function(e,t){var n,r,a,s,i,o,l,u,c,p,d,m,h=!0,f=e.tag,g=e.anchor,b=Object.create(null);if(91===(m=e.input.charCodeAt(e.position)))i=93,u=!1,s=[];else{if(123!==m)return!1;i=125,u=!0,s={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=s),m=e.input.charCodeAt(++e.position);0!==m;){if(Ee(e,!0,t),(m=e.input.charCodeAt(e.position))===i)return e.position++,e.tag=f,e.anchor=g,e.kind=u?"mapping":"sequence",e.result=s,!0;h?44===m&&Ce(e,"expected the node content, but found ','"):Ce(e,"missed comma between flow collection entries"),d=null,o=l=!1,63===m&&ge(e.input.charCodeAt(e.position+1))&&(o=l=!0,e.position++,Ee(e,!0,t)),n=e.line,r=e.lineStart,a=e.position,Re(e,t,te,!1,!0),p=e.tag,c=e.result,Ee(e,!0,t),m=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==m||(o=!0,m=e.input.charCodeAt(++e.position),Ee(e,!0,t),Re(e,t,te,!1,!0),d=e.result),u?qe(e,s,b,p,c,d,n,r,a):o?s.push(qe(e,null,b,p,c,d,n,r,a)):s.push(c),Ee(e,!0,t),44===(m=e.input.charCodeAt(e.position))?(h=!0,m=e.input.charCodeAt(++e.position)):h=!1}Ce(e,"unexpected end of the stream within a flow collection")}(e,d)?b=!0:(i&&function(e,t){var n,r,a,s,i,o=se,l=!1,u=!1,c=t,p=0,d=!1;if(124===(s=e.input.charCodeAt(e.position)))r=!1;else{if(62!==s)return!1;r=!0}for(e.kind="scalar",e.result="";0!==s;)if(43===(s=e.input.charCodeAt(++e.position))||45===s)se===o?o=43===s?oe:ie:Ce(e,"repeat of a chomping mode identifier");else{if(!((a=48<=(i=s)&&i<=57?i-48:-1)>=0))break;0===a?Ce(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):u?Ce(e,"repeat of an indentation width identifier"):(c=t+a-1,u=!0)}if(fe(s)){do{s=e.input.charCodeAt(++e.position)}while(fe(s));if(35===s)do{s=e.input.charCodeAt(++e.position)}while(!he(s)&&0!==s)}for(;0!==s;){for(Pe(e),e.lineIndent=0,s=e.input.charCodeAt(e.position);(!u||e.lineIndent<c)&&32===s;)e.lineIndent++,s=e.input.charCodeAt(++e.position);if(!u&&e.lineIndent>c&&(c=e.lineIndent),he(s))p++;else{if(e.lineIndent<c){o===oe?e.result+=m.repeat("\n",l?1+p:p):o===se&&l&&(e.result+="\n");break}for(r?fe(s)?(d=!0,e.result+=m.repeat("\n",l?1+p:p)):d?(d=!1,e.result+=m.repeat("\n",p+1)):0===p?l&&(e.result+=" "):e.result+=m.repeat("\n",p):e.result+=m.repeat("\n",l?1+p:p),l=!0,u=!0,p=0,n=e.position;!he(s)&&0!==s;)s=e.input.charCodeAt(++e.position);Te(e,n,e.position,!1)}}return!0}(e,d)||function(e,t){var n,r,a;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,r=a=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(Te(e,r,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;r=e.position,e.position++,a=e.position}else he(n)?(Te(e,r,a,!0),Ie(e,Ee(e,!1,t)),r=a=e.position):e.position===e.lineStart&&Oe(e)?Ce(e,"unexpected end of the document within a single quoted scalar"):(e.position++,a=e.position);Ce(e,"unexpected end of the stream within a single quoted scalar")}(e,d)||function(e,t){var n,r,a,s,i,o,l;if(34!==(o=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;0!==(o=e.input.charCodeAt(e.position));){if(34===o)return Te(e,n,e.position,!0),e.position++,!0;if(92===o){if(Te(e,n,e.position,!0),he(o=e.input.charCodeAt(++e.position)))Ee(e,!1,t);else if(o<256&&ke[o])e.result+=ye[o],e.position++;else if((i=120===(l=o)?2:117===l?4:85===l?8:0)>0){for(a=i,s=0;a>0;a--)(i=ve(o=e.input.charCodeAt(++e.position)))>=0?s=(s<<4)+i:Ce(e,"expected hexadecimal character");e.result+=we(s),e.position++}else Ce(e,"unknown escape sequence");n=r=e.position}else he(o)?(Te(e,n,r,!0),Ie(e,Ee(e,!1,t)),n=r=e.position):e.position===e.lineStart&&Oe(e)?Ce(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Ce(e,"unexpected end of the stream within a double quoted scalar")}(e,d)?b=!0:!function(e){var t,n,r;if(42!==(r=e.input.charCodeAt(e.position)))return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!ge(r)&&!be(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Ce(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),ee.call(e.anchorMap,n)||Ce(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],Ee(e,!0,-1),!0}(e)?function(e,t,n){var r,a,s,i,o,l,u,c,p=e.kind,d=e.result;if(ge(c=e.input.charCodeAt(e.position))||be(c)||35===c||38===c||42===c||33===c||124===c||62===c||39===c||34===c||37===c||64===c||96===c)return!1;if((63===c||45===c)&&(ge(r=e.input.charCodeAt(e.position+1))||n&&be(r)))return!1;for(e.kind="scalar",e.result="",a=s=e.position,i=!1;0!==c;){if(58===c){if(ge(r=e.input.charCodeAt(e.position+1))||n&&be(r))break}else if(35===c){if(ge(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&Oe(e)||n&&be(c))break;if(he(c)){if(o=e.line,l=e.lineStart,u=e.lineIndent,Ee(e,!1,-1),e.lineIndent>=t){i=!0,c=e.input.charCodeAt(e.position);continue}e.position=s,e.line=o,e.lineStart=l,e.lineIndent=u;break}}i&&(Te(e,a,s,!1),Ie(e,e.line-o),a=s=e.position,i=!1),fe(c)||(s=e.position+1),c=e.input.charCodeAt(++e.position)}return Te(e,a,s,!1),!!e.result||(e.kind=p,e.result=d,!1)}(e,d,te===n)&&(b=!0,null===e.tag&&(e.tag="?")):(b=!0,null===e.tag&&null===e.anchor||Ce(e,"alias node should not have any properties")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===f&&(b=o&&ze(e,h))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&Ce(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,u=e.implicitTypes.length;l<u;l+=1)if((p=e.implicitTypes[l]).resolve(e.result)){e.result=p.construct(e.result),e.tag=p.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(ee.call(e.typeMap[e.kind||"fallback"],e.tag))p=e.typeMap[e.kind||"fallback"][e.tag];else for(p=null,l=0,u=(c=e.typeMap.multi[e.kind||"fallback"]).length;l<u;l+=1)if(e.tag.slice(0,c[l].tag.length)===c[l].tag){p=c[l];break}p||Ce(e,"unknown tag !<"+e.tag+">"),null!==e.result&&p.kind!==e.kind&&Ce(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+p.kind+'", not "'+e.kind+'"'),p.resolve(e.result,e.tag)?(e.result=p.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):Ce(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||b}function Ne(e){var t,n,r,a,s=e.position,i=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(a=e.input.charCodeAt(e.position))&&(Ee(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==a));){for(i=!0,a=e.input.charCodeAt(++e.position),t=e.position;0!==a&&!ge(a);)a=e.input.charCodeAt(++e.position);for(r=[],(n=e.input.slice(t,e.position)).length<1&&Ce(e,"directive name must not be less than one character in length");0!==a;){for(;fe(a);)a=e.input.charCodeAt(++e.position);if(35===a){do{a=e.input.charCodeAt(++e.position)}while(0!==a&&!he(a));break}if(he(a))break;for(t=e.position;0!==a&&!ge(a);)a=e.input.charCodeAt(++e.position);r.push(e.input.slice(t,e.position))}0!==a&&Pe(e),ee.call(Se,n)?Se[n](e,n,r):Le(e,'unknown document directive "'+n+'"')}Ee(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,Ee(e,!0,-1)):i&&Ce(e,"directives end mark is expected"),Re(e,e.lineIndent-1,ae,!1,!0),Ee(e,!0,-1),e.checkLineBreaks&&ue.test(e.input.slice(s,e.position))&&Le(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&Oe(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,Ee(e,!0,-1)):e.position<e.length-1&&Ce(e,"end of the stream or a document separator is expected")}function He(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new Me(e,t),r=e.indexOf("\0");for(-1!==r&&(n.position=r,Ce(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)Ne(n);return n.documents}var Fe={loadAll:function(e,t,n){null!==t&&"object"==typeof t&&void 0===n&&(n=t,t=null);var r=He(e,n);if("function"!=typeof t)return r;for(var a=0,s=r.length;a<s;a+=1)t(r[a])},load:function(e,t){var n=He(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new g("expected a single document in the stream, but found more")}}},Ue=Object.prototype.toString,Ge=Object.prototype.hasOwnProperty,Ve=65279,$e=9,We=10,Qe=13,Ye=32,Je=33,Ke=34,Ze=35,Xe=37,et=38,tt=39,nt=42,rt=44,at=45,st=58,it=61,ot=62,lt=63,ut=64,ct=91,pt=93,dt=96,mt=123,ht=124,ft=125,gt={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},bt=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],vt=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function _t(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else{if(!(e<=4294967295))throw new g("code point within a string may not be greater than 0xFFFFFFFF");n="U",r=8}return"\\"+n+m.repeat("0",r-t.length)+t}var wt=1,kt=2;function yt(e){this.schema=e.schema||X,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=m.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=function(e,t){var n,r,a,s,i,o,l;if(null===t)return{};for(n={},a=0,s=(r=Object.keys(t)).length;a<s;a+=1)i=r[a],o=String(t[i]),"!!"===i.slice(0,2)&&(i="tag:yaml.org,2002:"+i.slice(2)),(l=e.compiledTypeMap.fallback[i])&&Ge.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[i]=o;return n}(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType='"'===e.quotingType?kt:wt,this.forceQuotes=e.forceQuotes||!1,this.replacer="function"==typeof e.replacer?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function xt(e,t){for(var n,r=m.repeat(" ",t),a=0,s=-1,i="",o=e.length;a<o;)-1===(s=e.indexOf("\n",a))?(n=e.slice(a),a=o):(n=e.slice(a,s+1),a=s+1),n.length&&"\n"!==n&&(i+=r),i+=n;return i}function Mt(e,t){return"\n"+m.repeat(" ",e.indent*t)}function At(e){return e===Ye||e===$e}function Ct(e){return 32<=e&&e<=126||161<=e&&e<=55295&&8232!==e&&8233!==e||57344<=e&&e<=65533&&e!==Ve||65536<=e&&e<=1114111}function Lt(e){return Ct(e)&&e!==Ve&&e!==Qe&&e!==We}function St(e,t,n){var r=Lt(e),a=r&&!At(e);return(n?r:r&&e!==rt&&e!==ct&&e!==pt&&e!==mt&&e!==ft)&&e!==Ze&&!(t===st&&!a)||Lt(t)&&!At(t)&&e===Ze||t===st&&a}function Tt(e,t){var n,r=e.charCodeAt(t);return r>=55296&&r<=56319&&t+1<e.length&&(n=e.charCodeAt(t+1))>=56320&&n<=57343?1024*(r-55296)+n-56320+65536:r}function jt(e){return/^\n* /.test(e)}var qt=1,Pt=2,Et=3,Ot=4,It=5;function zt(e,t,n,r,a,s,i,o){var l,u,c=0,p=null,d=!1,m=!1,h=-1!==r,f=-1,g=Ct(u=Tt(e,0))&&u!==Ve&&!At(u)&&u!==at&&u!==lt&&u!==st&&u!==rt&&u!==ct&&u!==pt&&u!==mt&&u!==ft&&u!==Ze&&u!==et&&u!==nt&&u!==Je&&u!==ht&&u!==it&&u!==ot&&u!==tt&&u!==Ke&&u!==Xe&&u!==ut&&u!==dt&&function(e){return!At(e)&&e!==st}(Tt(e,e.length-1));if(t||i)for(l=0;l<e.length;c>=65536?l+=2:l++){if(!Ct(c=Tt(e,l)))return It;g=g&&St(c,p,o),p=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if((c=Tt(e,l))===We)d=!0,h&&(m=m||l-f-1>r&&" "!==e[f+1],f=l);else if(!Ct(c))return It;g=g&&St(c,p,o),p=c}m=m||h&&l-f-1>r&&" "!==e[f+1]}return d||m?n>9&&jt(e)?It:i?s===kt?It:Pt:m?Ot:Et:!g||i||a(e)?s===kt?It:Pt:qt}function Dt(e,t,n,r,a){e.dump=function(){if(0===t.length)return e.quotingType===kt?'""':"''";if(!e.noCompatMode&&(-1!==bt.indexOf(t)||vt.test(t)))return e.quotingType===kt?'"'+t+'"':"'"+t+"'";var s=e.indent*Math.max(1,n),i=-1===e.lineWidth?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-s),o=r||e.flowLevel>-1&&n>=e.flowLevel;switch(zt(t,o,e.indent,i,(function(t){return function(e,t){var n,r;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(e.implicitTypes[n].resolve(t))return!0;return!1}(e,t)}),e.quotingType,e.forceQuotes&&!r,a)){case qt:return t;case Pt:return"'"+t.replace(/'/g,"''")+"'";case Et:return"|"+Bt(t,e.indent)+Rt(xt(t,s));case Ot:return">"+Bt(t,e.indent)+Rt(xt(function(e,t){var n,r,a=/(\n+)([^\n]*)/g,s=(o=e.indexOf("\n"),o=-1!==o?o:e.length,a.lastIndex=o,Nt(e.slice(0,o),t)),i="\n"===e[0]||" "===e[0];var o;for(;r=a.exec(e);){var l=r[1],u=r[2];n=" "===u[0],s+=l+(i||n||""===u?"":"\n")+Nt(u,t),i=n}return s}(t,i),s));case It:return'"'+function(e){for(var t,n="",r=0,a=0;a<e.length;r>=65536?a+=2:a++)r=Tt(e,a),!(t=gt[r])&&Ct(r)?(n+=e[a],r>=65536&&(n+=e[a+1])):n+=t||_t(r);return n}(t)+'"';default:throw new g("impossible error: invalid scalar style")}}()}function Bt(e,t){var n=jt(e)?String(t):"",r="\n"===e[e.length-1];return n+(r&&("\n"===e[e.length-2]||"\n"===e)?"+":r?"":"-")+"\n"}function Rt(e){return"\n"===e[e.length-1]?e.slice(0,-1):e}function Nt(e,t){if(""===e||" "===e[0])return e;for(var n,r,a=/ [^ ]/g,s=0,i=0,o=0,l="";n=a.exec(e);)(o=n.index)-s>t&&(r=i>s?i:o,l+="\n"+e.slice(s,r),s=r+1),i=o;return l+="\n",e.length-s>t&&i>s?l+=e.slice(s,i)+"\n"+e.slice(i+1):l+=e.slice(s),l.slice(1)}function Ht(e,t,n,r){var a,s,i,o="",l=e.tag;for(a=0,s=n.length;a<s;a+=1)i=n[a],e.replacer&&(i=e.replacer.call(n,String(a),i)),(Ut(e,t+1,i,!0,!0,!1,!0)||void 0===i&&Ut(e,t+1,null,!0,!0,!1,!0))&&(r&&""===o||(o+=Mt(e,t)),e.dump&&We===e.dump.charCodeAt(0)?o+="-":o+="- ",o+=e.dump);e.tag=l,e.dump=o||"[]"}function Ft(e,t,n){var r,a,s,i,o,l;for(s=0,i=(a=n?e.explicitTypes:e.implicitTypes).length;s<i;s+=1)if(((o=a[s]).instanceOf||o.predicate)&&(!o.instanceOf||"object"==typeof t&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,"[object Function]"===Ue.call(o.represent))r=o.represent(t,l);else{if(!Ge.call(o.represent,l))throw new g("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');r=o.represent[l](t,l)}e.dump=r}return!0}return!1}function Ut(e,t,n,r,a,s,i){e.tag=null,e.dump=n,Ft(e,n,!1)||Ft(e,n,!0);var o,l=Ue.call(e.dump),u=r;r&&(r=e.flowLevel<0||e.flowLevel>t);var c,p,d="[object Object]"===l||"[object Array]"===l;if(d&&(p=-1!==(c=e.duplicates.indexOf(n))),(null!==e.tag&&"?"!==e.tag||p||2!==e.indent&&t>0)&&(a=!1),p&&e.usedDuplicates[c])e.dump="*ref_"+c;else{if(d&&p&&!e.usedDuplicates[c]&&(e.usedDuplicates[c]=!0),"[object Object]"===l)r&&0!==Object.keys(e.dump).length?(!function(e,t,n,r){var a,s,i,o,l,u,c="",p=e.tag,d=Object.keys(n);if(!0===e.sortKeys)d.sort();else if("function"==typeof e.sortKeys)d.sort(e.sortKeys);else if(e.sortKeys)throw new g("sortKeys must be a boolean or a function");for(a=0,s=d.length;a<s;a+=1)u="",r&&""===c||(u+=Mt(e,t)),o=n[i=d[a]],e.replacer&&(o=e.replacer.call(n,i,o)),Ut(e,t+1,i,!0,!0,!0)&&((l=null!==e.tag&&"?"!==e.tag||e.dump&&e.dump.length>1024)&&(e.dump&&We===e.dump.charCodeAt(0)?u+="?":u+="? "),u+=e.dump,l&&(u+=Mt(e,t)),Ut(e,t+1,o,!0,l)&&(e.dump&&We===e.dump.charCodeAt(0)?u+=":":u+=": ",c+=u+=e.dump));e.tag=p,e.dump=c||"{}"}(e,t,e.dump,a),p&&(e.dump="&ref_"+c+e.dump)):(!function(e,t,n){var r,a,s,i,o,l="",u=e.tag,c=Object.keys(n);for(r=0,a=c.length;r<a;r+=1)o="",""!==l&&(o+=", "),e.condenseFlow&&(o+='"'),i=n[s=c[r]],e.replacer&&(i=e.replacer.call(n,s,i)),Ut(e,t,s,!1,!1)&&(e.dump.length>1024&&(o+="? "),o+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),Ut(e,t,i,!1,!1)&&(l+=o+=e.dump));e.tag=u,e.dump="{"+l+"}"}(e,t,e.dump),p&&(e.dump="&ref_"+c+" "+e.dump));else if("[object Array]"===l)r&&0!==e.dump.length?(e.noArrayIndent&&!i&&t>0?Ht(e,t-1,e.dump,a):Ht(e,t,e.dump,a),p&&(e.dump="&ref_"+c+e.dump)):(!function(e,t,n){var r,a,s,i="",o=e.tag;for(r=0,a=n.length;r<a;r+=1)s=n[r],e.replacer&&(s=e.replacer.call(n,String(r),s)),(Ut(e,t,s,!1,!1)||void 0===s&&Ut(e,t,null,!1,!1))&&(""!==i&&(i+=","+(e.condenseFlow?"":" ")),i+=e.dump);e.tag=o,e.dump="["+i+"]"}(e,t,e.dump),p&&(e.dump="&ref_"+c+" "+e.dump));else{if("[object String]"!==l){if("[object Undefined]"===l)return!1;if(e.skipInvalid)return!1;throw new g("unacceptable kind of an object to dump "+l)}"?"!==e.tag&&Dt(e,e.dump,t,s,u)}null!==e.tag&&"?"!==e.tag&&(o=encodeURI("!"===e.tag[0]?e.tag.slice(1):e.tag).replace(/!/g,"%21"),o="!"===e.tag[0]?"!"+o:"tag:yaml.org,2002:"===o.slice(0,18)?"!!"+o.slice(18):"!<"+o+">",e.dump=o+" "+e.dump)}return!0}function Gt(e,t){var n,r,a=[],s=[];for(Vt(e,a,s),n=0,r=s.length;n<r;n+=1)t.duplicates.push(a[s[n]]);t.usedDuplicates=new Array(r)}function Vt(e,t,n){var r,a,s;if(null!==e&&"object"==typeof e)if(-1!==(a=t.indexOf(e)))-1===n.indexOf(a)&&n.push(a);else if(t.push(e),Array.isArray(e))for(a=0,s=e.length;a<s;a+=1)Vt(e[a],t,n);else for(a=0,s=(r=Object.keys(e)).length;a<s;a+=1)Vt(e[r[a]],t,n)}function $t(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var Wt={Type:y,Schema:A,FAILSAFE_SCHEMA:T,JSON_SCHEMA:B,CORE_SCHEMA:R,DEFAULT_SCHEMA:X,load:Fe.load,loadAll:Fe.loadAll,dump:{dump:function(e,t){var n=new yt(t=t||{});n.noRefs||Gt(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),Ut(n,0,r,!0,!0)?n.dump+"\n":""}}.dump,YAMLException:g,types:{binary:V,float:D,map:S,null:j,pairs:J,set:Z,timestamp:F,bool:q,int:O,merge:U,omap:Q,seq:L,str:C},safeLoad:$t("safeLoad","load"),safeLoadAll:$t("safeLoadAll","loadAll"),safeDump:$t("safeDump","dump")};let Qt,Yt={addOns:e.yaml.addOns,avatar:e.yaml.avatar,bots:e.yaml.bots,detectBadWords:e.yaml.detectBadWords,defaultMessage:e.yaml.defaultMessage,dynamicContent:e.yaml.dynamicContent,favicon:e.yaml.favicon,footer:e.yaml.footer,maths:e.yaml.maths,obfuscate:e.yaml.obfuscate,responsesTitles:e.yaml.responsesTitles,searchInContent:e.yaml.searchInContent,style:e.yaml.style,theme:e.yaml.theme,typeWriter:e.yaml.typeWriter,useLLM:e.yaml.useLLM,userInput:e.yaml.userInput,variables:e.yaml.variables};function Jt(t){if(t.split("---").length>2&&t.startsWith("---"))try{const n=Wt.load(t.split("---")[1]);if(Yt=n?p(Yt,n):Yt,!0===Yt.maths&&(Yt.addOns=Yt.addOns?Yt.addOns+",textFit":"textFit",Promise.all([i("https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"),o("https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css")])),Yt.addOns){Yt.addOns=Yt.addOns.replace(" ","").split(",");let t=[];for(const[n,r]of Object.entries(e.addOnsDependencies))if(Yt.addOns.includes(n))for(const e of r)t.push(e);Yt.addOns.push(...t);for(const t of Yt.addOns){const n=[],r=e.allowedAddOns[t];r&&(r.js&&n.push(i(r.js)),r.css&&n.push(o(r.css)),Promise.all(n))}}if((Yt.titresRéponses||Yt.responsesTitles)&&(Yt.responsesTitles=Yt.titresRéponses?Yt.titresRéponses:Yt.responsesTitles,"string"==typeof Yt.responsesTitles&&(Yt.responsesTitles=[Yt.responsesTitles])),Yt.style){const e=document.createElement("style");e.innerHTML=Yt.style,document.body.appendChild(e)}if(!1!==Yt.userInput&&!1!==Yt.clavier&&!1!==Yt.keyboard||(Yt.userInput=!1,document.body.classList.add("hideControls")),(Yt.searchInContent||Yt.rechercheContenu)&&(Yt.searchInContent=Yt.rechercheContenu?Yt.rechercheContenu:Yt.searchInContent),(Yt.gestionGrosMots||Yt.detectBadWords)&&(Yt.detectBadWords=Yt.gestionGrosMots?Yt.gestionGrosMots:Yt.detectBadWords,!0===Yt.detectBadWords&&Promise.all([i("js/externals/leo-profanity.js"),i("js/externals/badWords-fr.js")]).then((()=>{Qt=window.LeoProfanity,Qt.add(badWordsFR)})).catch((e=>{console.error("Une erreur s'est produite lors du chargement des scripts :",e)}))),Yt.favicon){document.getElementById("favicon").href=Yt.favicon}if(Yt.avatar){const e=`\n\t\t\t\t\t.bot-message > :first-child:before {\n\t\t\t\t\tbackground-image: url("${Yt.avatar}");\n\t\t\t\t`,t=document.createElement("style");t.textContent=e,document.head.appendChild(t)}if(Yt.defaultMessage||Yt.messageParDéfaut)for(e.defaultMessage=Yt.messageParDéfaut?Object.values(Yt.messageParDéfaut):Yt.defaultMessage;e.defaultMessage.length<5;)e.defaultMessage.push(...e.defaultMessage);if(!1===Yt.footer?function(){const e=document.getElementById("controls");u.style.display="none",e.style.height="70px";const t=document.createElement("style");t.innerText="@media screen and (max-width: 500px) { #controls {height:110px!important}}",document.head.appendChild(t)}():"string"==typeof Yt.footer&&(u.innerHTML=Yt.footer),Yt.theme){o(Yt.theme.endsWith(".css")?"css/themes/"+Yt.theme:"css/themes/"+Yt.theme+".css")}if((Yt.dynamicContent||Yt.contenuDynamique)&&(Yt.dynamicContent=Yt.contenuDynamique?Yt.contenuDynamique:Yt.dynamicContent),!1!==Yt.typeWriter&&!1!==Yt.effetDactylo||(Yt.typeWriter=!1),Yt.obfuscate&&(Yt.obfuscate=!!Yt.obfuscate),Yt.bots)for(const[e,t]of Object.entries(Yt.bots)){const n=t.avatar?'background-image:url("'+t.avatar+'"); ':"",r=t.cssAvatar?t.cssAvatar:"",a="<style>"+(".botName-"+e+">:first-child:before {"+n+r+"}")+" .botName-"+e+"{"+(t.cssMessage?t.cssMessage:"")+"}</style>";Promise.all([o(a)])}(Yt.useLLM.url||Yt.utiliserLLM.url)&&(Yt.useLLM=Yt.utiliserLLM?Yt.utiliserLLM:Yt.useLLM,Yt.useLLM.RAGinformations=Yt.useLLM.informations?Yt.useLLM.informations:Yt.useLLM.RAGinformations,Yt.useLLM.RAGmaxTopElements=Yt.useLLM.maxTopElements?Yt.useLLM.maxTopElements:Yt.useLLM.RAGmaxTopElements,Yt.useLLM.RAGseparator=Yt.useLLM.separator?Yt.useLLM.separator:Yt.useLLM.RAGseparator,!0===Yt.useLLM.askAPIkey?Yt.useLLM.apiKey=prompt("Ce chatbot peut se connecter à une IA pour enrichir les réponses proposées. Entrez votre clé API, puis cliquez sur “OK” pour pouvoir bénéficier de cette fonctionnalité. Sinon, cliquez sur “Annuler”."):Yt.useLLM.apiKey=Yt.useLLM.askAPIkey?Yt.useLLM.askAPIkey:"")}catch(e){}}function Kt(){return Kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kt.apply(this,arguments)}var Zt={strings:["These are the default values...","You know what you should do?","Use your own!","Have a great day!"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:"typed-fade-out",fadeOutDelay:500,loop:!1,loopCount:1/0,showCursor:!0,cursorChar:"|",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:"html",onBegin:function(e){},onComplete:function(e){},preStringTyped:function(e,t){},onStringTyped:function(e,t){},onLastStringBackspaced:function(e){},onTypingPaused:function(e,t){},onTypingResumed:function(e,t){},onReset:function(e){},onStop:function(e,t){},onStart:function(e,t){},onDestroy:function(e){}},Xt=new(function(){function e(){}var t=e.prototype;return t.load=function(e,t,n){if(e.el="string"==typeof n?document.querySelector(n):n,e.options=Kt({},Zt,t),e.isInput="input"===e.el.tagName.toLowerCase(),e.attr=e.options.attr,e.bindInputFocusEvents=e.options.bindInputFocusEvents,e.showCursor=!e.isInput&&e.options.showCursor,e.cursorChar=e.options.cursorChar,e.cursorBlinking=!0,e.elContent=e.attr?e.el.getAttribute(e.attr):e.el.textContent,e.contentType=e.options.contentType,e.typeSpeed=e.options.typeSpeed,e.startDelay=e.options.startDelay,e.backSpeed=e.options.backSpeed,e.smartBackspace=e.options.smartBackspace,e.backDelay=e.options.backDelay,e.fadeOut=e.options.fadeOut,e.fadeOutClass=e.options.fadeOutClass,e.fadeOutDelay=e.options.fadeOutDelay,e.isPaused=!1,e.strings=e.options.strings.map((function(e){return e.trim()})),e.stringsElement="string"==typeof e.options.stringsElement?document.querySelector(e.options.stringsElement):e.options.stringsElement,e.stringsElement){e.strings=[],e.stringsElement.style.cssText="clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;";var r=Array.prototype.slice.apply(e.stringsElement.children),a=r.length;if(a)for(var s=0;s<a;s+=1)e.strings.push(r[s].innerHTML.trim())}for(var i in e.strPos=0,e.currentElContent=this.getCurrentElContent(e),e.currentElContent&&e.currentElContent.length>0&&(e.strPos=e.currentElContent.length-1,e.strings.unshift(e.currentElContent)),e.sequence=[],e.strings)e.sequence[i]=i;e.arrayPos=0,e.stopNum=0,e.loop=e.options.loop,e.loopCount=e.options.loopCount,e.curLoop=0,e.shuffle=e.options.shuffle,e.pause={status:!1,typewrite:!0,curString:"",curStrPos:0},e.typingComplete=!1,e.autoInsertCss=e.options.autoInsertCss,e.autoInsertCss&&(this.appendCursorAnimationCss(e),this.appendFadeOutAnimationCss(e))},t.getCurrentElContent=function(e){return e.attr?e.el.getAttribute(e.attr):e.isInput?e.el.value:"html"===e.contentType?e.el.innerHTML:e.el.textContent},t.appendCursorAnimationCss=function(e){var t="data-typed-js-cursor-css";if(e.showCursor&&!document.querySelector("["+t+"]")){var n=document.createElement("style");n.setAttribute(t,"true"),n.innerHTML="\n        .typed-cursor{\n          opacity: 1;\n        }\n        .typed-cursor.typed-cursor--blink{\n          animation: typedjsBlink 0.7s infinite;\n          -webkit-animation: typedjsBlink 0.7s infinite;\n                  animation: typedjsBlink 0.7s infinite;\n        }\n        @keyframes typedjsBlink{\n          50% { opacity: 0.0; }\n        }\n        @-webkit-keyframes typedjsBlink{\n          0% { opacity: 1; }\n          50% { opacity: 0.0; }\n          100% { opacity: 1; }\n        }\n      ",document.body.appendChild(n)}},t.appendFadeOutAnimationCss=function(e){var t="data-typed-fadeout-js-css";if(e.fadeOut&&!document.querySelector("["+t+"]")){var n=document.createElement("style");n.setAttribute(t,"true"),n.innerHTML="\n        .typed-fade-out{\n          opacity: 0;\n          transition: opacity .25s;\n        }\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\n          -webkit-animation: 0;\n          animation: 0;\n        }\n      ",document.body.appendChild(n)}},e}()),en=new(function(){function e(){}var t=e.prototype;return t.typeHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var r=e.substring(t).charAt(0);if("<"===r||"&"===r){var a;for(a="<"===r?">":";";e.substring(t+1).charAt(0)!==a&&!(1+ ++t>e.length););t++}return t},t.backSpaceHtmlChars=function(e,t,n){if("html"!==n.contentType)return t;var r=e.substring(t).charAt(0);if(">"===r||";"===r){var a;for(a=">"===r?"<":"&";e.substring(t-1).charAt(0)!==a&&!(--t<0););t--}return t},e}()),tn=function(){function e(e,t){Xt.load(this,t,e),this.begin()}var t=e.prototype;return t.toggle=function(){this.pause.status?this.start():this.stop()},t.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},t.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},t.destroy=function(){this.reset(!1),this.options.onDestroy(this)},t.reset=function(e){void 0===e&&(e=!0),clearInterval(this.timeout),this.replaceText(""),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,e&&(this.insertCursor(),this.options.onReset(this),this.begin())},t.begin=function(){var e=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout((function(){0===e.strPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],e.strPos):e.backspace(e.strings[e.sequence[e.arrayPos]],e.strPos)}),this.startDelay)},t.typewrite=function(e,t){var n=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var r=this.humanizer(this.typeSpeed),a=1;!0!==this.pause.status?this.timeout=setTimeout((function(){t=en.typeHtmlChars(e,t,n);var r=0,s=e.substring(t);if("^"===s.charAt(0)&&/^\^\d+/.test(s)){var i=1;i+=(s=/\d+/.exec(s)[0]).length,r=parseInt(s),n.temporaryPause=!0,n.options.onTypingPaused(n.arrayPos,n),e=e.substring(0,t)+e.substring(t+i),n.toggleBlinking(!0)}if("`"===s.charAt(0)){for(;"`"!==e.substring(t+a).charAt(0)&&(a++,!(t+a>e.length)););var o=e.substring(0,t),l=e.substring(o.length+1,t+a),u=e.substring(t+a+1);e=o+l+u,a--}n.timeout=setTimeout((function(){n.toggleBlinking(!1),t>=e.length?n.doneTyping(e,t):n.keepTyping(e,t,a),n.temporaryPause&&(n.temporaryPause=!1,n.options.onTypingResumed(n.arrayPos,n))}),r)}),r):this.setPauseStatus(e,t,!0)},t.keepTyping=function(e,t,n){0===t&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var r=e.substring(0,t+=n);this.replaceText(r),this.typewrite(e,t)},t.doneTyping=function(e,t){var n=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout((function(){n.backspace(e,t)}),this.backDelay))},t.backspace=function(e,t){var n=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var r=this.humanizer(this.backSpeed);this.timeout=setTimeout((function(){t=en.backSpaceHtmlChars(e,t,n);var r=e.substring(0,t);if(n.replaceText(r),n.smartBackspace){var a=n.strings[n.arrayPos+1];n.stopNum=a&&r===a.substring(0,t)?t:0}t>n.stopNum?(t--,n.backspace(e,t)):t<=n.stopNum&&(n.arrayPos++,n.arrayPos===n.strings.length?(n.arrayPos=0,n.options.onLastStringBackspaced(),n.shuffleStringsIfNeeded(),n.begin()):n.typewrite(n.strings[n.sequence[n.arrayPos]],t))}),r)}else this.setPauseStatus(e,t,!1)},t.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},t.setPauseStatus=function(e,t,n){this.pause.typewrite=n,this.pause.curString=e,this.pause.curStrPos=t},t.toggleBlinking=function(e){this.cursor&&(this.pause.status||this.cursorBlinking!==e&&(this.cursorBlinking=e,e?this.cursor.classList.add("typed-cursor--blink"):this.cursor.classList.remove("typed-cursor--blink")))},t.humanizer=function(e){return Math.round(Math.random()*e/2)+e},t.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort((function(){return Math.random()-.5})))},t.initFadeOut=function(){var e=this;return this.el.className+=" "+this.fadeOutClass,this.cursor&&(this.cursor.className+=" "+this.fadeOutClass),setTimeout((function(){e.arrayPos++,e.replaceText(""),e.strings.length>e.arrayPos?e.typewrite(e.strings[e.sequence[e.arrayPos]],0):(e.typewrite(e.strings[0],0),e.arrayPos=0)}),this.fadeOutDelay)},t.replaceText=function(e){this.attr?this.el.setAttribute(this.attr,e):this.isInput?this.el.value=e:"html"===this.contentType?this.el.innerHTML=e:this.el.textContent=e},t.bindFocusEvents=function(){var e=this;this.isInput&&(this.el.addEventListener("focus",(function(t){e.stop()})),this.el.addEventListener("blur",(function(t){e.el.value&&0!==e.el.value.length||e.start()})))},t.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement("span"),this.cursor.className="typed-cursor",this.cursor.setAttribute("aria-hidden",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},e}();const nn=document.getElementById("chat"),rn=document.getElementById("user-input"),an=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),sn=!an,on=10,ln=/(<pre(.|\n)*<\/pre>)/gm,un=/(<ul class="messageOptions"\>[\s\S]*<\/ul>)/gm,cn=/(<iframe(.|\n)*<\/iframe>)/gm;let pn;const dn={childList:!0,subtree:!0},mn=an?"Clic sur “Envoyer” pour stopper l'effet “machine à écrire”":window.innerWidth>880?"Appuyez sur “Enter” pour stopper l'effet “machine à écrire” et afficher la réponse immédiatement":"“Enter” pour stopper l'effet “machine à écrire”";let hn;const fn="^300 ",gn="^200 ",bn=800;function vn(e,t,n){nn.appendChild(n),t||window.matchMedia("(prefers-reduced-motion: reduce)").matches||!1===Yt.typeWriter?n.innerHTML=e:function(e,t){function n(e){hn.stop(),hn.reset();const t=(e=(e=e.replaceAll("`","")).replace(un,"`$1`")).replaceAll(ln,(function(e){return e.replaceAll("\n","RETURNCHARACTER")})).split("\n").map((e=>e.startsWith(fn)?e.replace(fn,"").replaceAll("RETURNCHARACTER","\n")+"`":e.endsWith("`")?"`"+e.replaceAll("RETURNCHARACTER","\n"):"`"+e.replaceAll("RETURNCHARACTER","\n").replace(gn,"")+"`"));hn.strings=[t.join(" ")],hn.start(),hn.destroy()}function r(t){"Enter"===t.key&&(pn.disconnect(),i=!1,n(e))}let a=0;const s=Date.now();let i=!0;function o(){const t=Date.now()-s;50==a&&t>bn&&i&&(n(e),i=!1,pn.disconnect()),l(),a++}e=(e=e.replace(un,fn+"`$1`")).replaceAll(cn,"`$1`"),hn=new tn(t,{strings:[e],typeSpeed:-5e3,startDelay:100,showCursor:!1,onBegin:()=>{function e(){pn.observe(nn,dn)}sn&&rn.focus(),rn.addEventListener("keypress",r),rn.setAttribute("placeholder",mn),pn=new MutationObserver(o),e(),setTimeout((()=>{document.addEventListener("mousemove",(function(e){(Math.abs(e.movementX)>on||Math.abs(e.movementY)>on)&&(i=!1,pn.disconnect())})),document.addEventListener("wheel",(function(t){t.deltaY>0&&window.scrollY+window.innerHeight>=document.body.offsetHeight?e():(i=!1,pn.disconnect())})),document.addEventListener("touchstart",(function(){i=!1,pn.disconnect(),setTimeout((()=>{window.scrollY+window.innerHeight+200>=document.documentElement.scrollHeight&&e()}),5e3)}))}),1e3)},onComplete:()=>{Yt.addOns&&Yt.addOns.includes("textFit")&&window.textFit(t.querySelectorAll(".katex-display")),rn.removeEventListener("keypress",r),rn.getAttribute("placeholder")==mn&&rn.setAttribute("placeholder","Écrivez votre message"),i=!1,pn.disconnect()}})}(e,n)}let _n={goto:"",lastMessageFromBot:"",selected:"",onlyIfKeywords:!1,errorsCounter:0,maxErrors:3,messageIfKeywordsNotFound:""};function wn(e,t=!1){const r=t?/@{(_\S+)}/g:/@{(\S+)}/g;return e.replaceAll(r,(function(r,a,s){const i=e.lastIndexOf(r);if(Yt.variables&&Yt.variables[a]){const e=n(Yt.variables[a].split("///"));return t&&s==i&&delete Yt.variables[a],e}return"@{"+a+"}"}))}let kn=!1;const yn=["+","-","*","/","<=",">=","<",">","==","!=","&&","||","!","(",")"];function xn(t,n){t=e.secureMode?t:function(e){let t=e.replace(/tryConvertStringToNumber\(.*?\]\)/g,"");return yn.forEach((e=>{t=t.replaceAll(e,"///")})),t=t.replace(/[0-9]*/g,""),t=t.replace(/".*?"/g,"///"),t.split("///").forEach((t=>{e=e.replaceAll(t,"")})),e}(t);return new Function("dynamicVariables","tryConvertStringToNumber","return "+t)(n,c)}function Mn(e,t){return xn(e.replace(/@(\w+)/g,(function(e,t){return'tryConvertStringToNumber(dynamicVariables["'+t.trim()+'"])'})),t)}function An(e,t,n){if(n)e=e.replaceAll(/@([^\s]*?)\=(.*)/g,(function(e,n,r,a){if(e.includes("calc("))try{const e=Mn(r.replace("calc(","").trim().slice(0,-1),t);t[n]=e}catch(t){return console.error("Error evaluating :",e,t),"\x3c!--"+e+"--\x3e"}else t[n]=r;return 0==a?r:""})),kn?kn&&kn.length>0?(t[kn[0]]=e,_n.goto=kn[1],kn=!1):_n.goto="":_n.goto=_n.onlyIfKeywords?_n.goto:"";else{e=(e=e.replaceAll(/\`@([^\s]*?) ?= ?(?<!@)(.*?)\`/g,(function(e,n,r){return e.includes("calc(")||e.includes("@INPUT")?e:(t[n]=r,e.includes("KEYBOARD")?"\x3c!--"+e+"--\x3e":"")}))).replaceAll("\x3c!--\x3c!--","\x3c!--").replaceAll("--\x3e--\x3e","--\x3e"),!1===Yt.userInput?"true"==t.KEYBOARD?(document.body.classList.remove("hideControls"),t.KEYBOARD="false"):document.body.classList.add("hideControls"):"false"==t.KEYBOARD?(document.body.classList.add("hideControls"),t.KEYBOARD="true"):document.body.classList.remove("hideControls");const n=!!(e=e.replaceAll(/\`@([^\s]*?)\`/g,(function(e,n){return e.includes("=")?e:t[n]?t[n]:e}))).includes("calc(");e=e.replaceAll(/\`@([^\s]*?) ?= ?calc\((.*)\)\`/g,(function(e,n,r){try{const e=Mn(r,t);return t[n]=e,""}catch(t){return console.error("Error evaluating :",e,t),"\x3c!--"+e+"--\x3e"}})),(n||e.includes("`@"))&&(e=e.replaceAll(/\`@([^\s]*?)\`/g,(function(e,n){return e.includes("=")?e:t[n]?t[n]:""}))),e=(e=(e=(e=e.replaceAll(/\`@([^\s]*?) ?= ?@INPUT : (.*)\`/g,(function(e,t,n){return kn=!!e&&[t,n],""}))).replaceAll(/ (@[^\s]*?\=.*?)\</g,'<span class="hidden">$1</span><')).replaceAll(/>(@[^\s]*?\=)/g,'><span class="hidden">$1</span>')).replaceAll(/\`if (.*?)\`((\n|.*)*?)\`endif\`/g,(function(e,n,r){if(!n)return"";try{n=(n=n.replace(/@([^\s()&|!=<>]+)/g,(function(e,t){return'tryConvertStringToNumber(dynamicVariables["'+t.trim()+'"])'}))).replaceAll(/(==|!=|<=|>=|<|>) ?(.*?) ?(\)|\&|\||$)/g,(function(e,t,n,r){return`${t}"${n}" ${r}`})).replaceAll('""','"').replace('"undefined"',"undefined");return xn(n,t)?r:""}catch(e){return console.error("Error evaluating condition:",n,e),"\x3c!--"+n+"--\x3e"}})),e=e.replaceAll(/\n\n\n*/g,"\n\n")}return e}var Cn=function(){function e(e){var t={omitExtraWLInCodeBlocks:{defaultValue:!1,describe:"Omit the default extra whiteline added to code blocks",type:"boolean"},noHeaderId:{defaultValue:!1,describe:"Turn on/off generated header id",type:"boolean"},prefixHeaderId:{defaultValue:!1,describe:"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix",type:"string"},rawPrefixHeaderId:{defaultValue:!1,describe:'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the " char is used in the prefix)',type:"boolean"},ghCompatibleHeaderId:{defaultValue:!1,describe:"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)",type:"boolean"},rawHeaderId:{defaultValue:!1,describe:"Remove only spaces, ' and \" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids",type:"boolean"},headerLevelStart:{defaultValue:!1,describe:"The header blocks level start",type:"integer"},parseImgDimensions:{defaultValue:!1,describe:"Turn on/off image dimension parsing",type:"boolean"},simplifiedAutoLink:{defaultValue:!1,describe:"Turn on/off GFM autolink style",type:"boolean"},literalMidWordUnderscores:{defaultValue:!1,describe:"Parse midword underscores as literal underscores",type:"boolean"},literalMidWordAsterisks:{defaultValue:!1,describe:"Parse midword asterisks as literal asterisks",type:"boolean"},strikethrough:{defaultValue:!1,describe:"Turn on/off strikethrough support",type:"boolean"},tables:{defaultValue:!1,describe:"Turn on/off tables support",type:"boolean"},tablesHeaderId:{defaultValue:!1,describe:"Add an id to table headers",type:"boolean"},ghCodeBlocks:{defaultValue:!0,describe:"Turn on/off GFM fenced code blocks support",type:"boolean"},tasklists:{defaultValue:!1,describe:"Turn on/off GFM tasklist support",type:"boolean"},smoothLivePreview:{defaultValue:!1,describe:"Prevents weird effects in live previews due to incomplete input",type:"boolean"},smartIndentationFix:{defaultValue:!1,description:"Tries to smartly fix indentation in es6 strings",type:"boolean"},disableForced4SpacesIndentedSublists:{defaultValue:!1,description:"Disables the requirement of indenting nested sublists by 4 spaces",type:"boolean"},simpleLineBreaks:{defaultValue:!1,description:"Parses simple line breaks as <br> (GFM Style)",type:"boolean"},requireSpaceBeforeHeadingText:{defaultValue:!1,description:"Makes adding a space between `#` and the header text mandatory (GFM Style)",type:"boolean"},ghMentions:{defaultValue:!1,description:"Enables github @mentions",type:"boolean"},ghMentionsLink:{defaultValue:"https://github.com/{u}",description:"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.",type:"string"},encodeEmails:{defaultValue:!0,description:"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities",type:"boolean"},openLinksInNewWindow:{defaultValue:!1,description:"Open all links in new windows",type:"boolean"},backslashEscapesHTMLTags:{defaultValue:!1,description:"Support for HTML Tag escaping. ex: <div>foo</div>",type:"boolean"},emoji:{defaultValue:!1,description:"Enable emoji support. Ex: `this is a :smile: emoji`",type:"boolean"},underline:{defaultValue:!1,description:"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`",type:"boolean"},completeHTMLDocument:{defaultValue:!1,description:"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags",type:"boolean"},metadata:{defaultValue:!1,description:"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).",type:"boolean"},splitAdjacentBlockquotes:{defaultValue:!1,description:"Split adjacent blockquote blocks",type:"boolean"}};if(!1===e)return JSON.parse(JSON.stringify(t));var n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r].defaultValue);return n}var t={},n={},r={},a=e(!0),s="vanilla",i={github:{omitExtraWLInCodeBlocks:!0,simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,disableForced4SpacesIndentedSublists:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghCompatibleHeaderId:!0,ghMentions:!0,backslashEscapesHTMLTags:!0,emoji:!0,splitAdjacentBlockquotes:!0},original:{noHeaderId:!0,ghCodeBlocks:!1},ghost:{omitExtraWLInCodeBlocks:!0,parseImgDimensions:!0,simplifiedAutoLink:!0,literalMidWordUnderscores:!0,strikethrough:!0,tables:!0,tablesHeaderId:!0,ghCodeBlocks:!0,tasklists:!0,smoothLivePreview:!0,simpleLineBreaks:!0,requireSpaceBeforeHeadingText:!0,ghMentions:!1,encodeEmails:!0},vanilla:e(!0),allOn:function(){var t=e(!0),n={};for(var r in t)t.hasOwnProperty(r)&&(n[r]=!0);return n}()};function o(e,n){var r=n?"Error in "+n+" extension->":"Error in unnamed extension",a={valid:!0,error:""};t.helper.isArray(e)||(e=[e]);for(var s=0;s<e.length;++s){var i=r+" sub-extension "+s+": ",o=e[s];if("object"!=typeof o)return a.valid=!1,a.error=i+"must be an object, but "+typeof o+" given",a;if(!t.helper.isString(o.type))return a.valid=!1,a.error=i+'property "type" must be a string, but '+typeof o.type+" given",a;var l=o.type=o.type.toLowerCase();if("language"===l&&(l=o.type="lang"),"html"===l&&(l=o.type="output"),"lang"!==l&&"output"!==l&&"listener"!==l)return a.valid=!1,a.error=i+"type "+l+' is not recognized. Valid values: "lang/language", "output/html" or "listener"',a;if("listener"===l){if(t.helper.isUndefined(o.listeners))return a.valid=!1,a.error=i+'. Extensions of type "listener" must have a property called "listeners"',a}else if(t.helper.isUndefined(o.filter)&&t.helper.isUndefined(o.regex))return a.valid=!1,a.error=i+l+' extensions must define either a "regex" property or a "filter" method',a;if(o.listeners){if("object"!=typeof o.listeners)return a.valid=!1,a.error=i+'"listeners" property must be an object but '+typeof o.listeners+" given",a;for(var u in o.listeners)if(o.listeners.hasOwnProperty(u)&&"function"!=typeof o.listeners[u])return a.valid=!1,a.error=i+'"listeners" property must be an hash of [event name]: [callback]. listeners.'+u+" must be a function but "+typeof o.listeners[u]+" given",a}if(o.filter){if("function"!=typeof o.filter)return a.valid=!1,a.error=i+'"filter" must be a function, but '+typeof o.filter+" given",a}else if(o.regex){if(t.helper.isString(o.regex)&&(o.regex=new RegExp(o.regex,"g")),!(o.regex instanceof RegExp))return a.valid=!1,a.error=i+'"regex" property must either be a string or a RegExp object, but '+typeof o.regex+" given",a;if(t.helper.isUndefined(o.replace))return a.valid=!1,a.error=i+'"regex" extensions must implement a replace string or function',a}}return a}if(t.helper={},t.extensions={},t.setOption=function(e,t){return a[e]=t,this},t.getOption=function(e){return a[e]},t.getOptions=function(){return a},t.resetOptions=function(){a=e(!0)},t.setFlavor=function(e){if(!i.hasOwnProperty(e))throw Error(e+" flavor was not found");t.resetOptions();var n=i[e];for(var r in s=e,n)n.hasOwnProperty(r)&&(a[r]=n[r])},t.getFlavor=function(){return s},t.getFlavorOptions=function(e){if(i.hasOwnProperty(e))return i[e]},t.getDefaultOptions=function(t){return e(t)},t.subParser=function(e,r){if(!t.helper.isString(e))throw Error("showdown.subParser function first argument must be a string (the name of the subparser)");if(void 0===r){if(n.hasOwnProperty(e))return n[e];throw Error("SubParser named "+e+" not registered!")}n[e]=r},t.extension=function(e,n){if(!t.helper.isString(e))throw Error("Extension 'name' must be a string");if(e=t.helper.stdExtName(e),t.helper.isUndefined(n)){if(!r.hasOwnProperty(e))throw Error("Extension named "+e+" is not registered!");return r[e]}"function"==typeof n&&(n=n()),t.helper.isArray(n)||(n=[n]);var a=o(n,e);if(!a.valid)throw Error(a.error);r[e]=n},t.getAllExtensions=function(){return r},t.removeExtension=function(e){delete r[e]},t.resetExtensions=function(){r={}},t.validateExtension=function(e){var t=o(e,null);return!!t.valid||(console.warn(t.error),!1)},t.hasOwnProperty("helper")||(t.helper={}),"undefined"==typeof document&&"undefined"==typeof window){var l=require("jsdom");window=new l.JSDOM("",{}).window}function u(e,t){return"¨E"+t.charCodeAt(0)+"E"}t.helper.document=window.document,t.helper.isString=function(e){return"string"==typeof e||e instanceof String},t.helper.isFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},t.helper.isArray=function(e){return Array.isArray(e)},t.helper.isUndefined=function(e){return void 0===e},t.helper.forEach=function(e,n){if(t.helper.isUndefined(e))throw new Error("obj param is required");if(t.helper.isUndefined(n))throw new Error("callback param is required");if(!t.helper.isFunction(n))throw new Error("callback param must be a function/closure");if("function"==typeof e.forEach)e.forEach(n);else if(t.helper.isArray(e))for(var r=0;r<e.length;r++)n(e[r],r,e);else{if("object"!=typeof e)throw new Error("obj does not seem to be an array or an iterable object");for(var a in e)e.hasOwnProperty(a)&&n(e[a],a,e)}},t.helper.stdExtName=function(e){return e.replace(/[_?*+\/\\.^-]/g,"").replace(/\s/g,"").toLowerCase()},t.helper.escapeCharactersCallback=u,t.helper.escapeCharacters=function(e,t,n){var r="(["+t.replace(/([\[\]\\])/g,"\\$1")+"])";n&&(r="\\\\"+r);var a=new RegExp(r,"g");return e=e.replace(a,u)};var c=function(e,t,n,r){var a,s,i,o,l,u=r||"",c=u.indexOf("g")>-1,p=new RegExp(t+"|"+n,"g"+u.replace(/g/g,"")),d=new RegExp(t,u.replace(/g/g,"")),m=[];do{for(a=0;i=p.exec(e);)if(d.test(i[0]))a++||(o=(s=p.lastIndex)-i[0].length);else if(a&&! --a){l=i.index+i[0].length;var h={left:{start:o,end:s},match:{start:s,end:i.index},right:{start:i.index,end:l},wholeMatch:{start:o,end:l}};if(m.push(h),!c)return m}}while(a&&(p.lastIndex=s));return m};return t.helper.matchRecursiveRegExp=function(e,t,n,r){for(var a=c(e,t,n,r),s=[],i=0;i<a.length;++i)s.push([e.slice(a[i].wholeMatch.start,a[i].wholeMatch.end),e.slice(a[i].match.start,a[i].match.end),e.slice(a[i].left.start,a[i].left.end),e.slice(a[i].right.start,a[i].right.end)]);return s},t.helper.replaceRecursiveRegExp=function(e,n,r,a,s){if(!t.helper.isFunction(n)){var i=n;n=function(){return i}}var o=c(e,r,a,s),l=e,u=o.length;if(u>0){var p=[];0!==o[0].wholeMatch.start&&p.push(e.slice(0,o[0].wholeMatch.start));for(var d=0;d<u;++d)p.push(n(e.slice(o[d].wholeMatch.start,o[d].wholeMatch.end),e.slice(o[d].match.start,o[d].match.end),e.slice(o[d].left.start,o[d].left.end),e.slice(o[d].right.start,o[d].right.end))),d<u-1&&p.push(e.slice(o[d].wholeMatch.end,o[d+1].wholeMatch.start));o[u-1].wholeMatch.end<e.length&&p.push(e.slice(o[u-1].wholeMatch.end)),l=p.join("")}return l},t.helper.regexIndexOf=function(e,n,r){if(!t.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";if(n instanceof RegExp==!1)throw"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp";var a=e.substring(r||0).search(n);return a>=0?a+(r||0):a},t.helper.splitAtIndex=function(e,n){if(!t.helper.isString(e))throw"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string";return[e.substring(0,n),e.substring(n)]},t.helper.encodeEmailAddress=function(e){var t=[function(e){return"&#"+e.charCodeAt(0)+";"},function(e){return"&#x"+e.charCodeAt(0).toString(16)+";"},function(e){return e}];return e=e.replace(/./g,(function(e){if("@"===e)e=t[Math.floor(2*Math.random())](e);else{var n=Math.random();e=n>.9?t[2](e):n>.45?t[1](e):t[0](e)}return e}))},t.helper.padEnd=function(e,t,n){return t|=0,n=String(n||" "),e.length>t?String(e):((t-=e.length)>n.length&&(n+=n.repeat(t/n.length)),String(e)+n.slice(0,t))},t.helper.unescapeHTMLEntities=function(e){return e.replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")},t.helper._hashHTMLSpan=function(e,t){return"¨C"+(t.gHtmlSpans.push(e)-1)+"C"},t.helper.Event=function(e,t,n){var r=n.regexp||null,a=n.matches||{},s=n.options||{},i=n.converter||null,o=n.globals||{};this.getName=function(){return e},this.getEventName=function(){return e},this._stopExecution=!1,this.parsedText=n.parsedText||null,this.getRegexp=function(){return r},this.getOptions=function(){return s},this.getConverter=function(){return i},this.getGlobals=function(){return o},this.getCapturedText=function(){return t},this.getText=function(){return t},this.setText=function(e){t=e},this.getMatches=function(){return a},this.setMatches=function(e){a=e},this.preventDefault=function(e){this._stopExecution=!e}},"undefined"==typeof console&&(console={warn:function(e){alert(e)},log:function(e){alert(e)},error:function(e){throw e}}),t.helper.regexes={asteriskDashTildeAndColon:/([*_:~])/g,asteriskDashAndTilde:/([*_~])/g},t.helper.emojis={"+1":"👍","-1":"👎",100:"💯",1234:"🔢","1st_place_medal":"🥇","2nd_place_medal":"🥈","3rd_place_medal":"🥉","8ball":"🎱",a:"🅰️",ab:"🆎",abc:"🔤",abcd:"🔡",accept:"🉑",aerial_tramway:"🚡",airplane:"✈️",alarm_clock:"⏰",alembic:"⚗️",alien:"👽",ambulance:"🚑",amphora:"🏺",anchor:"⚓️",angel:"👼",anger:"💢",angry:"😠",anguished:"😧",ant:"🐜",apple:"🍎",aquarius:"♒️",aries:"♈️",arrow_backward:"◀️",arrow_double_down:"⏬",arrow_double_up:"⏫",arrow_down:"⬇️",arrow_down_small:"🔽",arrow_forward:"▶️",arrow_heading_down:"⤵️",arrow_heading_up:"⤴️",arrow_left:"⬅️",arrow_lower_left:"↙️",arrow_lower_right:"↘️",arrow_right:"➡️",arrow_right_hook:"↪️",arrow_up:"⬆️",arrow_up_down:"↕️",arrow_up_small:"🔼",arrow_upper_left:"↖️",arrow_upper_right:"↗️",arrows_clockwise:"🔃",arrows_counterclockwise:"🔄",art:"🎨",articulated_lorry:"🚛",artificial_satellite:"🛰",astonished:"😲",athletic_shoe:"👟",atm:"🏧",atom_symbol:"⚛️",avocado:"🥑",b:"🅱️",baby:"👶",baby_bottle:"🍼",baby_chick:"🐤",baby_symbol:"🚼",back:"🔙",bacon:"🥓",badminton:"🏸",baggage_claim:"🛄",baguette_bread:"🥖",balance_scale:"⚖️",balloon:"🎈",ballot_box:"🗳",ballot_box_with_check:"☑️",bamboo:"🎍",banana:"🍌",bangbang:"‼️",bank:"🏦",bar_chart:"📊",barber:"💈",baseball:"⚾️",basketball:"🏀",basketball_man:"⛹️",basketball_woman:"⛹️&zwj;♀️",bat:"🦇",bath:"🛀",bathtub:"🛁",battery:"🔋",beach_umbrella:"🏖",bear:"🐻",bed:"🛏",bee:"🐝",beer:"🍺",beers:"🍻",beetle:"🐞",beginner:"🔰",bell:"🔔",bellhop_bell:"🛎",bento:"🍱",biking_man:"🚴",bike:"🚲",biking_woman:"🚴&zwj;♀️",bikini:"👙",biohazard:"☣️",bird:"🐦",birthday:"🎂",black_circle:"⚫️",black_flag:"🏴",black_heart:"🖤",black_joker:"🃏",black_large_square:"⬛️",black_medium_small_square:"◾️",black_medium_square:"◼️",black_nib:"✒️",black_small_square:"▪️",black_square_button:"🔲",blonde_man:"👱",blonde_woman:"👱&zwj;♀️",blossom:"🌼",blowfish:"🐡",blue_book:"📘",blue_car:"🚙",blue_heart:"💙",blush:"😊",boar:"🐗",boat:"⛵️",bomb:"💣",book:"📖",bookmark:"🔖",bookmark_tabs:"📑",books:"📚",boom:"💥",boot:"👢",bouquet:"💐",bowing_man:"🙇",bow_and_arrow:"🏹",bowing_woman:"🙇&zwj;♀️",bowling:"🎳",boxing_glove:"🥊",boy:"👦",bread:"🍞",bride_with_veil:"👰",bridge_at_night:"🌉",briefcase:"💼",broken_heart:"💔",bug:"🐛",building_construction:"🏗",bulb:"💡",bullettrain_front:"🚅",bullettrain_side:"🚄",burrito:"🌯",bus:"🚌",business_suit_levitating:"🕴",busstop:"🚏",bust_in_silhouette:"👤",busts_in_silhouette:"👥",butterfly:"🦋",cactus:"🌵",cake:"🍰",calendar:"📆",call_me_hand:"🤙",calling:"📲",camel:"🐫",camera:"📷",camera_flash:"📸",camping:"🏕",cancer:"♋️",candle:"🕯",candy:"🍬",canoe:"🛶",capital_abcd:"🔠",capricorn:"♑️",car:"🚗",card_file_box:"🗃",card_index:"📇",card_index_dividers:"🗂",carousel_horse:"🎠",carrot:"🥕",cat:"🐱",cat2:"🐈",cd:"💿",chains:"⛓",champagne:"🍾",chart:"💹",chart_with_downwards_trend:"📉",chart_with_upwards_trend:"📈",checkered_flag:"🏁",cheese:"🧀",cherries:"🍒",cherry_blossom:"🌸",chestnut:"🌰",chicken:"🐔",children_crossing:"🚸",chipmunk:"🐿",chocolate_bar:"🍫",christmas_tree:"🎄",church:"⛪️",cinema:"🎦",circus_tent:"🎪",city_sunrise:"🌇",city_sunset:"🌆",cityscape:"🏙",cl:"🆑",clamp:"🗜",clap:"👏",clapper:"🎬",classical_building:"🏛",clinking_glasses:"🥂",clipboard:"📋",clock1:"🕐",clock10:"🕙",clock1030:"🕥",clock11:"🕚",clock1130:"🕦",clock12:"🕛",clock1230:"🕧",clock130:"🕜",clock2:"🕑",clock230:"🕝",clock3:"🕒",clock330:"🕞",clock4:"🕓",clock430:"🕟",clock5:"🕔",clock530:"🕠",clock6:"🕕",clock630:"🕡",clock7:"🕖",clock730:"🕢",clock8:"🕗",clock830:"🕣",clock9:"🕘",clock930:"🕤",closed_book:"📕",closed_lock_with_key:"🔐",closed_umbrella:"🌂",cloud:"☁️",cloud_with_lightning:"🌩",cloud_with_lightning_and_rain:"⛈",cloud_with_rain:"🌧",cloud_with_snow:"🌨",clown_face:"🤡",clubs:"♣️",cocktail:"🍸",coffee:"☕️",coffin:"⚰️",cold_sweat:"😰",comet:"☄️",computer:"💻",computer_mouse:"🖱",confetti_ball:"🎊",confounded:"😖",confused:"😕",congratulations:"㊗️",construction:"🚧",construction_worker_man:"👷",construction_worker_woman:"👷&zwj;♀️",control_knobs:"🎛",convenience_store:"🏪",cookie:"🍪",cool:"🆒",policeman:"👮",copyright:"©️",corn:"🌽",couch_and_lamp:"🛋",couple:"👫",couple_with_heart_woman_man:"💑",couple_with_heart_man_man:"👨&zwj;❤️&zwj;👨",couple_with_heart_woman_woman:"👩&zwj;❤️&zwj;👩",couplekiss_man_man:"👨&zwj;❤️&zwj;💋&zwj;👨",couplekiss_man_woman:"💏",couplekiss_woman_woman:"👩&zwj;❤️&zwj;💋&zwj;👩",cow:"🐮",cow2:"🐄",cowboy_hat_face:"🤠",crab:"🦀",crayon:"🖍",credit_card:"💳",crescent_moon:"🌙",cricket:"🏏",crocodile:"🐊",croissant:"🥐",crossed_fingers:"🤞",crossed_flags:"🎌",crossed_swords:"⚔️",crown:"👑",cry:"😢",crying_cat_face:"😿",crystal_ball:"🔮",cucumber:"🥒",cupid:"💘",curly_loop:"➰",currency_exchange:"💱",curry:"🍛",custard:"🍮",customs:"🛃",cyclone:"🌀",dagger:"🗡",dancer:"💃",dancing_women:"👯",dancing_men:"👯&zwj;♂️",dango:"🍡",dark_sunglasses:"🕶",dart:"🎯",dash:"💨",date:"📅",deciduous_tree:"🌳",deer:"🦌",department_store:"🏬",derelict_house:"🏚",desert:"🏜",desert_island:"🏝",desktop_computer:"🖥",male_detective:"🕵️",diamond_shape_with_a_dot_inside:"💠",diamonds:"♦️",disappointed:"😞",disappointed_relieved:"😥",dizzy:"💫",dizzy_face:"😵",do_not_litter:"🚯",dog:"🐶",dog2:"🐕",dollar:"💵",dolls:"🎎",dolphin:"🐬",door:"🚪",doughnut:"🍩",dove:"🕊",dragon:"🐉",dragon_face:"🐲",dress:"👗",dromedary_camel:"🐪",drooling_face:"🤤",droplet:"💧",drum:"🥁",duck:"🦆",dvd:"📀","e-mail":"📧",eagle:"🦅",ear:"👂",ear_of_rice:"🌾",earth_africa:"🌍",earth_americas:"🌎",earth_asia:"🌏",egg:"🥚",eggplant:"🍆",eight_pointed_black_star:"✴️",eight_spoked_asterisk:"✳️",electric_plug:"🔌",elephant:"🐘",email:"✉️",end:"🔚",envelope_with_arrow:"📩",euro:"💶",european_castle:"🏰",european_post_office:"🏤",evergreen_tree:"🌲",exclamation:"❗️",expressionless:"😑",eye:"👁",eye_speech_bubble:"👁&zwj;🗨",eyeglasses:"👓",eyes:"👀",face_with_head_bandage:"🤕",face_with_thermometer:"🤒",fist_oncoming:"👊",factory:"🏭",fallen_leaf:"🍂",family_man_woman_boy:"👪",family_man_boy:"👨&zwj;👦",family_man_boy_boy:"👨&zwj;👦&zwj;👦",family_man_girl:"👨&zwj;👧",family_man_girl_boy:"👨&zwj;👧&zwj;👦",family_man_girl_girl:"👨&zwj;👧&zwj;👧",family_man_man_boy:"👨&zwj;👨&zwj;👦",family_man_man_boy_boy:"👨&zwj;👨&zwj;👦&zwj;👦",family_man_man_girl:"👨&zwj;👨&zwj;👧",family_man_man_girl_boy:"👨&zwj;👨&zwj;👧&zwj;👦",family_man_man_girl_girl:"👨&zwj;👨&zwj;👧&zwj;👧",family_man_woman_boy_boy:"👨&zwj;👩&zwj;👦&zwj;👦",family_man_woman_girl:"👨&zwj;👩&zwj;👧",family_man_woman_girl_boy:"👨&zwj;👩&zwj;👧&zwj;👦",family_man_woman_girl_girl:"👨&zwj;👩&zwj;👧&zwj;👧",family_woman_boy:"👩&zwj;👦",family_woman_boy_boy:"👩&zwj;👦&zwj;👦",family_woman_girl:"👩&zwj;👧",family_woman_girl_boy:"👩&zwj;👧&zwj;👦",family_woman_girl_girl:"👩&zwj;👧&zwj;👧",family_woman_woman_boy:"👩&zwj;👩&zwj;👦",family_woman_woman_boy_boy:"👩&zwj;👩&zwj;👦&zwj;👦",family_woman_woman_girl:"👩&zwj;👩&zwj;👧",family_woman_woman_girl_boy:"👩&zwj;👩&zwj;👧&zwj;👦",family_woman_woman_girl_girl:"👩&zwj;👩&zwj;👧&zwj;👧",fast_forward:"⏩",fax:"📠",fearful:"😨",feet:"🐾",female_detective:"🕵️&zwj;♀️",ferris_wheel:"🎡",ferry:"⛴",field_hockey:"🏑",file_cabinet:"🗄",file_folder:"📁",film_projector:"📽",film_strip:"🎞",fire:"🔥",fire_engine:"🚒",fireworks:"🎆",first_quarter_moon:"🌓",first_quarter_moon_with_face:"🌛",fish:"🐟",fish_cake:"🍥",fishing_pole_and_fish:"🎣",fist_raised:"✊",fist_left:"🤛",fist_right:"🤜",flags:"🎏",flashlight:"🔦",fleur_de_lis:"⚜️",flight_arrival:"🛬",flight_departure:"🛫",floppy_disk:"💾",flower_playing_cards:"🎴",flushed:"😳",fog:"🌫",foggy:"🌁",football:"🏈",footprints:"👣",fork_and_knife:"🍴",fountain:"⛲️",fountain_pen:"🖋",four_leaf_clover:"🍀",fox_face:"🦊",framed_picture:"🖼",free:"🆓",fried_egg:"🍳",fried_shrimp:"🍤",fries:"🍟",frog:"🐸",frowning:"😦",frowning_face:"☹️",frowning_man:"🙍&zwj;♂️",frowning_woman:"🙍",middle_finger:"🖕",fuelpump:"⛽️",full_moon:"🌕",full_moon_with_face:"🌝",funeral_urn:"⚱️",game_die:"🎲",gear:"⚙️",gem:"💎",gemini:"♊️",ghost:"👻",gift:"🎁",gift_heart:"💝",girl:"👧",globe_with_meridians:"🌐",goal_net:"🥅",goat:"🐐",golf:"⛳️",golfing_man:"🏌️",golfing_woman:"🏌️&zwj;♀️",gorilla:"🦍",grapes:"🍇",green_apple:"🍏",green_book:"📗",green_heart:"💚",green_salad:"🥗",grey_exclamation:"❕",grey_question:"❔",grimacing:"😬",grin:"😁",grinning:"😀",guardsman:"💂",guardswoman:"💂&zwj;♀️",guitar:"🎸",gun:"🔫",haircut_woman:"💇",haircut_man:"💇&zwj;♂️",hamburger:"🍔",hammer:"🔨",hammer_and_pick:"⚒",hammer_and_wrench:"🛠",hamster:"🐹",hand:"✋",handbag:"👜",handshake:"🤝",hankey:"💩",hatched_chick:"🐥",hatching_chick:"🐣",headphones:"🎧",hear_no_evil:"🙉",heart:"❤️",heart_decoration:"💟",heart_eyes:"😍",heart_eyes_cat:"😻",heartbeat:"💓",heartpulse:"💗",hearts:"♥️",heavy_check_mark:"✔️",heavy_division_sign:"➗",heavy_dollar_sign:"💲",heavy_heart_exclamation:"❣️",heavy_minus_sign:"➖",heavy_multiplication_x:"✖️",heavy_plus_sign:"➕",helicopter:"🚁",herb:"🌿",hibiscus:"🌺",high_brightness:"🔆",high_heel:"👠",hocho:"🔪",hole:"🕳",honey_pot:"🍯",horse:"🐴",horse_racing:"🏇",hospital:"🏥",hot_pepper:"🌶",hotdog:"🌭",hotel:"🏨",hotsprings:"♨️",hourglass:"⌛️",hourglass_flowing_sand:"⏳",house:"🏠",house_with_garden:"🏡",houses:"🏘",hugs:"🤗",hushed:"😯",ice_cream:"🍨",ice_hockey:"🏒",ice_skate:"⛸",icecream:"🍦",id:"🆔",ideograph_advantage:"🉐",imp:"👿",inbox_tray:"📥",incoming_envelope:"📨",tipping_hand_woman:"💁",information_source:"ℹ️",innocent:"😇",interrobang:"⁉️",iphone:"📱",izakaya_lantern:"🏮",jack_o_lantern:"🎃",japan:"🗾",japanese_castle:"🏯",japanese_goblin:"👺",japanese_ogre:"👹",jeans:"👖",joy:"😂",joy_cat:"😹",joystick:"🕹",kaaba:"🕋",key:"🔑",keyboard:"⌨️",keycap_ten:"🔟",kick_scooter:"🛴",kimono:"👘",kiss:"💋",kissing:"😗",kissing_cat:"😽",kissing_closed_eyes:"😚",kissing_heart:"😘",kissing_smiling_eyes:"😙",kiwi_fruit:"🥝",koala:"🐨",koko:"🈁",label:"🏷",large_blue_circle:"🔵",large_blue_diamond:"🔷",large_orange_diamond:"🔶",last_quarter_moon:"🌗",last_quarter_moon_with_face:"🌜",latin_cross:"✝️",laughing:"😆",leaves:"🍃",ledger:"📒",left_luggage:"🛅",left_right_arrow:"↔️",leftwards_arrow_with_hook:"↩️",lemon:"🍋",leo:"♌️",leopard:"🐆",level_slider:"🎚",libra:"♎️",light_rail:"🚈",link:"🔗",lion:"🦁",lips:"👄",lipstick:"💄",lizard:"🦎",lock:"🔒",lock_with_ink_pen:"🔏",lollipop:"🍭",loop:"➿",loud_sound:"🔊",loudspeaker:"📢",love_hotel:"🏩",love_letter:"💌",low_brightness:"🔅",lying_face:"🤥",m:"Ⓜ️",mag:"🔍",mag_right:"🔎",mahjong:"🀄️",mailbox:"📫",mailbox_closed:"📪",mailbox_with_mail:"📬",mailbox_with_no_mail:"📭",man:"👨",man_artist:"👨&zwj;🎨",man_astronaut:"👨&zwj;🚀",man_cartwheeling:"🤸&zwj;♂️",man_cook:"👨&zwj;🍳",man_dancing:"🕺",man_facepalming:"🤦&zwj;♂️",man_factory_worker:"👨&zwj;🏭",man_farmer:"👨&zwj;🌾",man_firefighter:"👨&zwj;🚒",man_health_worker:"👨&zwj;⚕️",man_in_tuxedo:"🤵",man_judge:"👨&zwj;⚖️",man_juggling:"🤹&zwj;♂️",man_mechanic:"👨&zwj;🔧",man_office_worker:"👨&zwj;💼",man_pilot:"👨&zwj;✈️",man_playing_handball:"🤾&zwj;♂️",man_playing_water_polo:"🤽&zwj;♂️",man_scientist:"👨&zwj;🔬",man_shrugging:"🤷&zwj;♂️",man_singer:"👨&zwj;🎤",man_student:"👨&zwj;🎓",man_teacher:"👨&zwj;🏫",man_technologist:"👨&zwj;💻",man_with_gua_pi_mao:"👲",man_with_turban:"👳",tangerine:"🍊",mans_shoe:"👞",mantelpiece_clock:"🕰",maple_leaf:"🍁",martial_arts_uniform:"🥋",mask:"😷",massage_woman:"💆",massage_man:"💆&zwj;♂️",meat_on_bone:"🍖",medal_military:"🎖",medal_sports:"🏅",mega:"📣",melon:"🍈",memo:"📝",men_wrestling:"🤼&zwj;♂️",menorah:"🕎",mens:"🚹",metal:"🤘",metro:"🚇",microphone:"🎤",microscope:"🔬",milk_glass:"🥛",milky_way:"🌌",minibus:"🚐",minidisc:"💽",mobile_phone_off:"📴",money_mouth_face:"🤑",money_with_wings:"💸",moneybag:"💰",monkey:"🐒",monkey_face:"🐵",monorail:"🚝",moon:"🌔",mortar_board:"🎓",mosque:"🕌",motor_boat:"🛥",motor_scooter:"🛵",motorcycle:"🏍",motorway:"🛣",mount_fuji:"🗻",mountain:"⛰",mountain_biking_man:"🚵",mountain_biking_woman:"🚵&zwj;♀️",mountain_cableway:"🚠",mountain_railway:"🚞",mountain_snow:"🏔",mouse:"🐭",mouse2:"🐁",movie_camera:"🎥",moyai:"🗿",mrs_claus:"🤶",muscle:"💪",mushroom:"🍄",musical_keyboard:"🎹",musical_note:"🎵",musical_score:"🎼",mute:"🔇",nail_care:"💅",name_badge:"📛",national_park:"🏞",nauseated_face:"🤢",necktie:"👔",negative_squared_cross_mark:"❎",nerd_face:"🤓",neutral_face:"😐",new:"🆕",new_moon:"🌑",new_moon_with_face:"🌚",newspaper:"📰",newspaper_roll:"🗞",next_track_button:"⏭",ng:"🆖",no_good_man:"🙅&zwj;♂️",no_good_woman:"🙅",night_with_stars:"🌃",no_bell:"🔕",no_bicycles:"🚳",no_entry:"⛔️",no_entry_sign:"🚫",no_mobile_phones:"📵",no_mouth:"😶",no_pedestrians:"🚷",no_smoking:"🚭","non-potable_water":"🚱",nose:"👃",notebook:"📓",notebook_with_decorative_cover:"📔",notes:"🎶",nut_and_bolt:"🔩",o:"⭕️",o2:"🅾️",ocean:"🌊",octopus:"🐙",oden:"🍢",office:"🏢",oil_drum:"🛢",ok:"🆗",ok_hand:"👌",ok_man:"🙆&zwj;♂️",ok_woman:"🙆",old_key:"🗝",older_man:"👴",older_woman:"👵",om:"🕉",on:"🔛",oncoming_automobile:"🚘",oncoming_bus:"🚍",oncoming_police_car:"🚔",oncoming_taxi:"🚖",open_file_folder:"📂",open_hands:"👐",open_mouth:"😮",open_umbrella:"☂️",ophiuchus:"⛎",orange_book:"📙",orthodox_cross:"☦️",outbox_tray:"📤",owl:"🦉",ox:"🐂",package:"📦",page_facing_up:"📄",page_with_curl:"📃",pager:"📟",paintbrush:"🖌",palm_tree:"🌴",pancakes:"🥞",panda_face:"🐼",paperclip:"📎",paperclips:"🖇",parasol_on_ground:"⛱",parking:"🅿️",part_alternation_mark:"〽️",partly_sunny:"⛅️",passenger_ship:"🛳",passport_control:"🛂",pause_button:"⏸",peace_symbol:"☮️",peach:"🍑",peanuts:"🥜",pear:"🍐",pen:"🖊",pencil2:"✏️",penguin:"🐧",pensive:"😔",performing_arts:"🎭",persevere:"😣",person_fencing:"🤺",pouting_woman:"🙎",phone:"☎️",pick:"⛏",pig:"🐷",pig2:"🐖",pig_nose:"🐽",pill:"💊",pineapple:"🍍",ping_pong:"🏓",pisces:"♓️",pizza:"🍕",place_of_worship:"🛐",plate_with_cutlery:"🍽",play_or_pause_button:"⏯",point_down:"👇",point_left:"👈",point_right:"👉",point_up:"☝️",point_up_2:"👆",police_car:"🚓",policewoman:"👮&zwj;♀️",poodle:"🐩",popcorn:"🍿",post_office:"🏣",postal_horn:"📯",postbox:"📮",potable_water:"🚰",potato:"🥔",pouch:"👝",poultry_leg:"🍗",pound:"💷",rage:"😡",pouting_cat:"😾",pouting_man:"🙎&zwj;♂️",pray:"🙏",prayer_beads:"📿",pregnant_woman:"🤰",previous_track_button:"⏮",prince:"🤴",princess:"👸",printer:"🖨",purple_heart:"💜",purse:"👛",pushpin:"📌",put_litter_in_its_place:"🚮",question:"❓",rabbit:"🐰",rabbit2:"🐇",racehorse:"🐎",racing_car:"🏎",radio:"📻",radio_button:"🔘",radioactive:"☢️",railway_car:"🚃",railway_track:"🛤",rainbow:"🌈",rainbow_flag:"🏳️&zwj;🌈",raised_back_of_hand:"🤚",raised_hand_with_fingers_splayed:"🖐",raised_hands:"🙌",raising_hand_woman:"🙋",raising_hand_man:"🙋&zwj;♂️",ram:"🐏",ramen:"🍜",rat:"🐀",record_button:"⏺",recycle:"♻️",red_circle:"🔴",registered:"®️",relaxed:"☺️",relieved:"😌",reminder_ribbon:"🎗",repeat:"🔁",repeat_one:"🔂",rescue_worker_helmet:"⛑",restroom:"🚻",revolving_hearts:"💞",rewind:"⏪",rhinoceros:"🦏",ribbon:"🎀",rice:"🍚",rice_ball:"🍙",rice_cracker:"🍘",rice_scene:"🎑",right_anger_bubble:"🗯",ring:"💍",robot:"🤖",rocket:"🚀",rofl:"🤣",roll_eyes:"🙄",roller_coaster:"🎢",rooster:"🐓",rose:"🌹",rosette:"🏵",rotating_light:"🚨",round_pushpin:"📍",rowing_man:"🚣",rowing_woman:"🚣&zwj;♀️",rugby_football:"🏉",running_man:"🏃",running_shirt_with_sash:"🎽",running_woman:"🏃&zwj;♀️",sa:"🈂️",sagittarius:"♐️",sake:"🍶",sandal:"👡",santa:"🎅",satellite:"📡",saxophone:"🎷",school:"🏫",school_satchel:"🎒",scissors:"✂️",scorpion:"🦂",scorpius:"♏️",scream:"😱",scream_cat:"🙀",scroll:"📜",seat:"💺",secret:"㊙️",see_no_evil:"🙈",seedling:"🌱",selfie:"🤳",shallow_pan_of_food:"🥘",shamrock:"☘️",shark:"🦈",shaved_ice:"🍧",sheep:"🐑",shell:"🐚",shield:"🛡",shinto_shrine:"⛩",ship:"🚢",shirt:"👕",shopping:"🛍",shopping_cart:"🛒",shower:"🚿",shrimp:"🦐",signal_strength:"📶",six_pointed_star:"🔯",ski:"🎿",skier:"⛷",skull:"💀",skull_and_crossbones:"☠️",sleeping:"😴",sleeping_bed:"🛌",sleepy:"😪",slightly_frowning_face:"🙁",slightly_smiling_face:"🙂",slot_machine:"🎰",small_airplane:"🛩",small_blue_diamond:"🔹",small_orange_diamond:"🔸",small_red_triangle:"🔺",small_red_triangle_down:"🔻",smile:"😄",smile_cat:"😸",smiley:"😃",smiley_cat:"😺",smiling_imp:"😈",smirk:"😏",smirk_cat:"😼",smoking:"🚬",snail:"🐌",snake:"🐍",sneezing_face:"🤧",snowboarder:"🏂",snowflake:"❄️",snowman:"⛄️",snowman_with_snow:"☃️",sob:"😭",soccer:"⚽️",soon:"🔜",sos:"🆘",sound:"🔉",space_invader:"👾",spades:"♠️",spaghetti:"🍝",sparkle:"❇️",sparkler:"🎇",sparkles:"✨",sparkling_heart:"💖",speak_no_evil:"🙊",speaker:"🔈",speaking_head:"🗣",speech_balloon:"💬",speedboat:"🚤",spider:"🕷",spider_web:"🕸",spiral_calendar:"🗓",spiral_notepad:"🗒",spoon:"🥄",squid:"🦑",stadium:"🏟",star:"⭐️",star2:"🌟",star_and_crescent:"☪️",star_of_david:"✡️",stars:"🌠",station:"🚉",statue_of_liberty:"🗽",steam_locomotive:"🚂",stew:"🍲",stop_button:"⏹",stop_sign:"🛑",stopwatch:"⏱",straight_ruler:"📏",strawberry:"🍓",stuck_out_tongue:"😛",stuck_out_tongue_closed_eyes:"😝",stuck_out_tongue_winking_eye:"😜",studio_microphone:"🎙",stuffed_flatbread:"🥙",sun_behind_large_cloud:"🌥",sun_behind_rain_cloud:"🌦",sun_behind_small_cloud:"🌤",sun_with_face:"🌞",sunflower:"🌻",sunglasses:"😎",sunny:"☀️",sunrise:"🌅",sunrise_over_mountains:"🌄",surfing_man:"🏄",surfing_woman:"🏄&zwj;♀️",sushi:"🍣",suspension_railway:"🚟",sweat:"😓",sweat_drops:"💦",sweat_smile:"😅",sweet_potato:"🍠",swimming_man:"🏊",swimming_woman:"🏊&zwj;♀️",symbols:"🔣",synagogue:"🕍",syringe:"💉",taco:"🌮",tada:"🎉",tanabata_tree:"🎋",taurus:"♉️",taxi:"🚕",tea:"🍵",telephone_receiver:"📞",telescope:"🔭",tennis:"🎾",tent:"⛺️",thermometer:"🌡",thinking:"🤔",thought_balloon:"💭",ticket:"🎫",tickets:"🎟",tiger:"🐯",tiger2:"🐅",timer_clock:"⏲",tipping_hand_man:"💁&zwj;♂️",tired_face:"😫",tm:"™️",toilet:"🚽",tokyo_tower:"🗼",tomato:"🍅",tongue:"👅",top:"🔝",tophat:"🎩",tornado:"🌪",trackball:"🖲",tractor:"🚜",traffic_light:"🚥",train:"🚋",train2:"🚆",tram:"🚊",triangular_flag_on_post:"🚩",triangular_ruler:"📐",trident:"🔱",triumph:"😤",trolleybus:"🚎",trophy:"🏆",tropical_drink:"🍹",tropical_fish:"🐠",truck:"🚚",trumpet:"🎺",tulip:"🌷",tumbler_glass:"🥃",turkey:"🦃",turtle:"🐢",tv:"📺",twisted_rightwards_arrows:"🔀",two_hearts:"💕",two_men_holding_hands:"👬",two_women_holding_hands:"👭",u5272:"🈹",u5408:"🈴",u55b6:"🈺",u6307:"🈯️",u6708:"🈷️",u6709:"🈶",u6e80:"🈵",u7121:"🈚️",u7533:"🈸",u7981:"🈲",u7a7a:"🈳",umbrella:"☔️",unamused:"😒",underage:"🔞",unicorn:"🦄",unlock:"🔓",up:"🆙",upside_down_face:"🙃",v:"✌️",vertical_traffic_light:"🚦",vhs:"📼",vibration_mode:"📳",video_camera:"📹",video_game:"🎮",violin:"🎻",virgo:"♍️",volcano:"🌋",volleyball:"🏐",vs:"🆚",vulcan_salute:"🖖",walking_man:"🚶",walking_woman:"🚶&zwj;♀️",waning_crescent_moon:"🌘",waning_gibbous_moon:"🌖",warning:"⚠️",wastebasket:"🗑",watch:"⌚️",water_buffalo:"🐃",watermelon:"🍉",wave:"👋",wavy_dash:"〰️",waxing_crescent_moon:"🌒",wc:"🚾",weary:"😩",wedding:"💒",weight_lifting_man:"🏋️",weight_lifting_woman:"🏋️&zwj;♀️",whale:"🐳",whale2:"🐋",wheel_of_dharma:"☸️",wheelchair:"♿️",white_check_mark:"✅",white_circle:"⚪️",white_flag:"🏳️",white_flower:"💮",white_large_square:"⬜️",white_medium_small_square:"◽️",white_medium_square:"◻️",white_small_square:"▫️",white_square_button:"🔳",wilted_flower:"🥀",wind_chime:"🎐",wind_face:"🌬",wine_glass:"🍷",wink:"😉",wolf:"🐺",woman:"👩",woman_artist:"👩&zwj;🎨",woman_astronaut:"👩&zwj;🚀",woman_cartwheeling:"🤸&zwj;♀️",woman_cook:"👩&zwj;🍳",woman_facepalming:"🤦&zwj;♀️",woman_factory_worker:"👩&zwj;🏭",woman_farmer:"👩&zwj;🌾",woman_firefighter:"👩&zwj;🚒",woman_health_worker:"👩&zwj;⚕️",woman_judge:"👩&zwj;⚖️",woman_juggling:"🤹&zwj;♀️",woman_mechanic:"👩&zwj;🔧",woman_office_worker:"👩&zwj;💼",woman_pilot:"👩&zwj;✈️",woman_playing_handball:"🤾&zwj;♀️",woman_playing_water_polo:"🤽&zwj;♀️",woman_scientist:"👩&zwj;🔬",woman_shrugging:"🤷&zwj;♀️",woman_singer:"👩&zwj;🎤",woman_student:"👩&zwj;🎓",woman_teacher:"👩&zwj;🏫",woman_technologist:"👩&zwj;💻",woman_with_turban:"👳&zwj;♀️",womans_clothes:"👚",womans_hat:"👒",women_wrestling:"🤼&zwj;♀️",womens:"🚺",world_map:"🗺",worried:"😟",wrench:"🔧",writing_hand:"✍️",x:"❌",yellow_heart:"💛",yen:"💴",yin_yang:"☯️",yum:"😋",zap:"⚡️",zipper_mouth_face:"🤐",zzz:"💤",octocat:'<img width="20" height="20" align="absmiddle" src="https://assets-cdn.github.com/images/icons/emoji/octocat.png">',showdown:'<img width="20" height="20" align="absmiddle" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAS1BMVEX///8jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS3b1q3b1q3b1q3b1q3b1q3b1q3b1q3b1q0565CIAAAAGXRSTlMAQHCAYCCw/+DQwPCQUBAwoHCAEP+wwFBgS2fvBgAAAUZJREFUeAHs1cGy7BAUheFFsEDw/k97VTq3T6ge2EmdM+pvrP6Iwd74XV9Kb52xuMU4/uc1YNgZLFOeV8FGdhGrNk5SEgUyPxAEdj4LlMRDyhVAMVEa2M7TBSeVZAFPdqHgzSZJwPKgcLFLAooHDJo4EDCw4gAtBoJA5UFj4Ng5LOGLwVXZuoIlji/jeQHFk7+baHxrCjeUwB9+s88KndvlhcyBN5BSkYNQIVVb4pV+Npm7hhuKDs/uMP5KxT3WzSNNLIuuoDpMmuAVMruMSeDyQBi24DTr43LAY7ILA1QYaWkgfHzFthYYzg67SQsCbB8GhJUEGCtO9n0rSaCLxgJQjS/JSgMTg2eBDEHAJ+H350AsjYNYscrErgI2e/l+mdR967TCX/v6N0EhPECYCP0i+IAoYQOE8BogNhQMEMdrgAQWHaMAAGi5I5euoY9NAAAAAElFTkSuQmCC">'},t.subParser("makehtml.blockGamut",(function(e,n,r){return e=r.converter._dispatch("makehtml.blockGamut.before",e,n,r).getText(),e=t.subParser("makehtml.blockQuotes")(e,n,r),e=t.subParser("makehtml.headers")(e,n,r),e=t.subParser("makehtml.horizontalRule")(e,n,r),e=t.subParser("makehtml.lists")(e,n,r),e=t.subParser("makehtml.codeBlocks")(e,n,r),e=t.subParser("makehtml.tables")(e,n,r),e=t.subParser("makehtml.hashHTMLBlocks")(e,n,r),e=t.subParser("makehtml.paragraphs")(e,n,r),e=r.converter._dispatch("makehtml.blockGamut.after",e,n,r).getText()})),t.subParser("makehtml.blockQuotes",(function(e,n,r){e=r.converter._dispatch("makehtml.blockQuotes.before",e,n,r).getText(),e+="\n\n";var a=/(^ {0,3}>[ \t]?.+\n(.+\n)*\n*)+/gm;return n.splitAdjacentBlockquotes&&(a=/^ {0,3}>[\s\S]*?(?:\n\n)/gm),e=e.replace(a,(function(e){return e=(e=(e=e.replace(/^[ \t]*>[ \t]?/gm,"")).replace(/¨0/g,"")).replace(/^[ \t]+$/gm,""),e=t.subParser("makehtml.githubCodeBlocks")(e,n,r),e=(e=(e=t.subParser("makehtml.blockGamut")(e,n,r)).replace(/(^|\n)/g,"$1  ")).replace(/(\s*<pre>[^\r]+?<\/pre>)/gm,(function(e,t){var n=t;return n=(n=n.replace(/^  /gm,"¨0")).replace(/¨0/g,"")})),t.subParser("makehtml.hashBlock")("<blockquote>\n"+e+"\n</blockquote>",n,r)})),e=r.converter._dispatch("makehtml.blockQuotes.after",e,n,r).getText()})),t.subParser("makehtml.codeBlocks",(function(e,n,r){e=r.converter._dispatch("makehtml.codeBlocks.before",e,n,r).getText();return e=(e=(e+="¨0").replace(/(?:\n\n|^)((?:(?:[ ]{4}|\t).*\n+)+)(\n*[ ]{0,3}[^ \t\n]|(?=¨0))/g,(function(e,a,s){var i=a,o=s,l="\n";return i=t.subParser("makehtml.outdent")(i,n,r),i=t.subParser("makehtml.encodeCode")(i,n,r),i=(i=(i=t.subParser("makehtml.detab")(i,n,r)).replace(/^\n+/g,"")).replace(/\n+$/g,""),n.omitExtraWLInCodeBlocks&&(l=""),i="<pre><code>"+i+l+"</code></pre>",t.subParser("makehtml.hashBlock")(i,n,r)+o}))).replace(/¨0/,""),e=r.converter._dispatch("makehtml.codeBlocks.after",e,n,r).getText()})),t.subParser("makehtml.codeSpans",(function(e,n,r){return void 0===(e=r.converter._dispatch("makehtml.codeSpans.before",e,n,r).getText())&&(e=""),e=e.replace(/(^|[^\\])(`+)([^\r]*?[^`])\2(?!`)/gm,(function(e,a,s,i){var o=i;return o=(o=o.replace(/^([ \t]*)/g,"")).replace(/[ \t]*$/g,""),o=a+"<code>"+(o=t.subParser("makehtml.encodeCode")(o,n,r))+"</code>",o=t.subParser("makehtml.hashHTMLSpans")(o,n,r)})),e=r.converter._dispatch("makehtml.codeSpans.after",e,n,r).getText()})),t.subParser("makehtml.completeHTMLDocument",(function(e,t,n){if(!t.completeHTMLDocument)return e;e=n.converter._dispatch("makehtml.completeHTMLDocument.before",e,t,n).getText();var r="html",a="<!DOCTYPE HTML>\n",s="",i='<meta charset="utf-8">\n',o="",l="";for(var u in void 0!==n.metadata.parsed.doctype&&(a="<!DOCTYPE "+n.metadata.parsed.doctype+">\n","html"!==(r=n.metadata.parsed.doctype.toString().toLowerCase())&&"html5"!==r||(i='<meta charset="utf-8">')),n.metadata.parsed)if(n.metadata.parsed.hasOwnProperty(u))switch(u.toLowerCase()){case"doctype":break;case"title":s="<title>"+n.metadata.parsed.title+"</title>\n";break;case"charset":i="html"===r||"html5"===r?'<meta charset="'+n.metadata.parsed.charset+'">\n':'<meta name="charset" content="'+n.metadata.parsed.charset+'">\n';break;case"language":case"lang":o=' lang="'+n.metadata.parsed[u]+'"',l+='<meta name="'+u+'" content="'+n.metadata.parsed[u]+'">\n';break;default:l+='<meta name="'+u+'" content="'+n.metadata.parsed[u]+'">\n'}return e=a+"<html"+o+">\n<head>\n"+s+i+l+"</head>\n<body>\n"+e.trim()+"\n</body>\n</html>",e=n.converter._dispatch("makehtml.completeHTMLDocument.after",e,t,n).getText()})),t.subParser("makehtml.detab",(function(e,t,n){return e=(e=(e=(e=n.converter._dispatch("makehtml.detab.before",e,t,n).getText()).replace(/\t(?=\t)/g,"    ")).replace(/\t/g,"¨A¨B")).replace(/¨B(.+?)¨A/g,(function(e,t){for(var n=t,r=4-n.length%4,a=0;a<r;a++)n+=" ";return n})),e=(e=e.replace(/¨A/g,"    ")).replace(/¨B/g,""),e=n.converter._dispatch("makehtml.detab.after",e,t,n).getText()})),t.subParser("makehtml.ellipsis",(function(e,t,n){return e=(e=n.converter._dispatch("makehtml.ellipsis.before",e,t,n).getText()).replace(/\.\.\./g,"…"),e=n.converter._dispatch("makehtml.ellipsis.after",e,t,n).getText()})),t.subParser("makehtml.emoji",(function(e,n,r){if(!n.emoji)return e;return e=(e=r.converter._dispatch("makehtml.emoji.before",e,n,r).getText()).replace(/:([\S]+?):/g,(function(e,n){return t.helper.emojis.hasOwnProperty(n)?t.helper.emojis[n]:e})),e=r.converter._dispatch("makehtml.emoji.after",e,n,r).getText()})),t.subParser("makehtml.encodeAmpsAndAngles",(function(e,t,n){return e=(e=(e=(e=(e=n.converter._dispatch("makehtml.encodeAmpsAndAngles.before",e,t,n).getText()).replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\w+);)/g,"&amp;")).replace(/<(?![a-z\/?$!])/gi,"&lt;")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"),e=n.converter._dispatch("makehtml.encodeAmpsAndAngles.after",e,t,n).getText()})),t.subParser("makehtml.encodeBackslashEscapes",(function(e,n,r){return e=(e=(e=r.converter._dispatch("makehtml.encodeBackslashEscapes.before",e,n,r).getText()).replace(/\\(\\)/g,t.helper.escapeCharactersCallback)).replace(/\\([`*_{}\[\]()>#+.!~=|:-])/g,t.helper.escapeCharactersCallback),e=r.converter._dispatch("makehtml.encodeBackslashEscapes.after",e,n,r).getText()})),t.subParser("makehtml.encodeCode",(function(e,n,r){return e=(e=r.converter._dispatch("makehtml.encodeCode.before",e,n,r).getText()).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/([*_{}\[\]\\=~-])/g,t.helper.escapeCharactersCallback),e=r.converter._dispatch("makehtml.encodeCode.after",e,n,r).getText()})),t.subParser("makehtml.escapeSpecialCharsWithinTagAttributes",(function(e,n,r){return e=(e=(e=r.converter._dispatch("makehtml.escapeSpecialCharsWithinTagAttributes.before",e,n,r).getText()).replace(/<\/?[a-z\d_:-]+(?:[\s]+[\s\S]+?)?>/gi,(function(e){return e.replace(/(.)<\/?code>(?=.)/g,"$1`").replace(/([\\`*_~=|])/g,t.helper.escapeCharactersCallback)}))).replace(/<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi,(function(e){return e.replace(/([\\`*_~=|])/g,t.helper.escapeCharactersCallback)})),e=r.converter._dispatch("makehtml.escapeSpecialCharsWithinTagAttributes.after",e,n,r).getText()})),t.subParser("makehtml.githubCodeBlocks",(function(e,n,r){return n.ghCodeBlocks?(e=r.converter._dispatch("makehtml.githubCodeBlocks.before",e,n,r).getText(),e=(e=(e+="¨0").replace(/(?:^|\n)(?: {0,3})(```+|~~~+)(?: *)([^\s`~]*)\n([\s\S]*?)\n(?: {0,3})\1/g,(function(e,a,s,i){var o=n.omitExtraWLInCodeBlocks?"":"\n";return i=t.subParser("makehtml.encodeCode")(i,n,r),i="<pre><code"+(s?' class="'+s+" language-"+s+'"':"")+">"+(i=(i=(i=t.subParser("makehtml.detab")(i,n,r)).replace(/^\n+/g,"")).replace(/\n+$/g,""))+o+"</code></pre>",i=t.subParser("makehtml.hashBlock")(i,n,r),"\n\n¨G"+(r.ghCodeBlocks.push({text:e,codeblock:i})-1)+"G\n\n"}))).replace(/¨0/,""),r.converter._dispatch("makehtml.githubCodeBlocks.after",e,n,r).getText()):e})),t.subParser("makehtml.hashBlock",(function(e,t,n){return e=(e=n.converter._dispatch("makehtml.hashBlock.before",e,t,n).getText()).replace(/(^\n+|\n+$)/g,""),e="\n\n¨K"+(n.gHtmlBlocks.push(e)-1)+"K\n\n",e=n.converter._dispatch("makehtml.hashBlock.after",e,t,n).getText()})),t.subParser("makehtml.hashCodeTags",(function(e,n,r){e=r.converter._dispatch("makehtml.hashCodeTags.before",e,n,r).getText();return e=t.helper.replaceRecursiveRegExp(e,(function(e,a,s,i){var o=s+t.subParser("makehtml.encodeCode")(a,n,r)+i;return"¨C"+(r.gHtmlSpans.push(o)-1)+"C"}),"<code\\b[^>]*>","</code>","gim"),e=r.converter._dispatch("makehtml.hashCodeTags.after",e,n,r).getText()})),t.subParser("makehtml.hashElement",(function(e,t,n){return function(e,t){var r=t;return r=(r=(r=r.replace(/\n\n/g,"\n")).replace(/^\n/,"")).replace(/\n+$/g,""),r="\n\n¨K"+(n.gHtmlBlocks.push(r)-1)+"K\n\n"}})),t.subParser("makehtml.hashHTMLBlocks",(function(e,n,r){e=r.converter._dispatch("makehtml.hashHTMLBlocks.before",e,n,r).getText();var a=["pre","div","h1","h2","h3","h4","h5","h6","blockquote","table","dl","ol","ul","script","noscript","form","fieldset","iframe","math","style","section","header","footer","nav","article","aside","address","audio","canvas","figure","hgroup","output","video","p"],s=function(e,t,n,a){var s=e;return-1!==n.search(/\bmarkdown\b/)&&(s=n+r.converter.makeHtml(t)+a),"\n\n¨K"+(r.gHtmlBlocks.push(s)-1)+"K\n\n"};n.backslashEscapesHTMLTags&&(e=e.replace(/\\<(\/?[^>]+?)>/g,(function(e,t){return"&lt;"+t+"&gt;"})));for(var i=0;i<a.length;++i)for(var o,l=new RegExp("^ {0,3}(<"+a[i]+"\\b[^>]*>)","im"),u="<"+a[i]+"\\b[^>]*>",c="</"+a[i]+">";-1!==(o=t.helper.regexIndexOf(e,l));){var p=t.helper.splitAtIndex(e,o),d=t.helper.replaceRecursiveRegExp(p[1],s,u,c,"im");if(d===p[1])break;e=p[0].concat(d)}return e=e.replace(/(\n {0,3}(<(hr)\b([^<>])*?\/?>)[ \t]*(?=\n{2,}))/g,t.subParser("makehtml.hashElement")(e,n,r)),e=(e=t.helper.replaceRecursiveRegExp(e,(function(e){return"\n\n¨K"+(r.gHtmlBlocks.push(e)-1)+"K\n\n"}),"^ {0,3}\x3c!--","--\x3e","gm")).replace(/(?:\n\n)( {0,3}(?:<([?%])[^\r]*?\2>)[ \t]*(?=\n{2,}))/g,t.subParser("makehtml.hashElement")(e,n,r)),e=r.converter._dispatch("makehtml.hashHTMLBlocks.after",e,n,r).getText()})),t.subParser("makehtml.hashHTMLSpans",(function(e,n,r){return e=(e=(e=(e=(e=r.converter._dispatch("makehtml.hashHTMLSpans.before",e,n,r).getText()).replace(/<[^>]+?\/>/gi,(function(e){return t.helper._hashHTMLSpan(e,r)}))).replace(/<([^>]+?)>[\s\S]*?<\/\1>/g,(function(e){return t.helper._hashHTMLSpan(e,r)}))).replace(/<([^>]+?)\s[^>]+?>[\s\S]*?<\/\1>/g,(function(e){return t.helper._hashHTMLSpan(e,r)}))).replace(/<[^>]+?>/gi,(function(e){return t.helper._hashHTMLSpan(e,r)})),e=r.converter._dispatch("makehtml.hashHTMLSpans.after",e,n,r).getText()})),t.subParser("makehtml.unhashHTMLSpans",(function(e,t,n){e=n.converter._dispatch("makehtml.unhashHTMLSpans.before",e,t,n).getText();for(var r=0;r<n.gHtmlSpans.length;++r){for(var a=n.gHtmlSpans[r],s=0;/¨C(\d+)C/.test(a);){var i=RegExp.$1;if(a=a.replace("¨C"+i+"C",n.gHtmlSpans[i]),10===s){console.error("maximum nesting of 10 spans reached!!!");break}++s}e=e.replace("¨C"+r+"C",a)}return e=n.converter._dispatch("makehtml.unhashHTMLSpans.after",e,t,n).getText()})),t.subParser("makehtml.hashPreCodeTags",(function(e,n,r){e=r.converter._dispatch("makehtml.hashPreCodeTags.before",e,n,r).getText();return e=t.helper.replaceRecursiveRegExp(e,(function(e,a,s,i){var o=s+t.subParser("makehtml.encodeCode")(a,n,r)+i;return"\n\n¨G"+(r.ghCodeBlocks.push({text:e,codeblock:o})-1)+"G\n\n"}),"^ {0,3}<pre\\b[^>]*>\\s*<code\\b[^>]*>","^ {0,3}</code>\\s*</pre>","gim"),e=r.converter._dispatch("makehtml.hashPreCodeTags.after",e,n,r).getText()})),t.subParser("makehtml.headers",(function(e,n,r){e=r.converter._dispatch("makehtml.headers.before",e,n,r).getText();var a=isNaN(parseInt(n.headerLevelStart))?1:parseInt(n.headerLevelStart),s=n.smoothLivePreview?/^(.+)[ \t]*\n={2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n=+[ \t]*\n+/gm,i=n.smoothLivePreview?/^(.+)[ \t]*\n-{2,}[ \t]*\n+/gm:/^(.+)[ \t]*\n-+[ \t]*\n+/gm;e=(e=e.replace(s,(function(e,s){var i=t.subParser("makehtml.spanGamut")(s,n,r),o=n.noHeaderId?"":' id="'+l(s)+'"',u="<h"+a+o+">"+i+"</h"+a+">";return t.subParser("makehtml.hashBlock")(u,n,r)}))).replace(i,(function(e,s){var i=t.subParser("makehtml.spanGamut")(s,n,r),o=n.noHeaderId?"":' id="'+l(s)+'"',u=a+1,c="<h"+u+o+">"+i+"</h"+u+">";return t.subParser("makehtml.hashBlock")(c,n,r)}));var o=n.requireSpaceBeforeHeadingText?/^(#{1,6})[ \t]+(.+?)[ \t]*#*\n+/gm:/^(#{1,6})[ \t]*(.+?)[ \t]*#*\n+/gm;function l(e){var a,s;if(n.customizedHeaderId){var i=e.match(/\{([^{]+?)}\s*$/);i&&i[1]&&(e=i[1])}return a=e,s=t.helper.isString(n.prefixHeaderId)?n.prefixHeaderId:!0===n.prefixHeaderId?"section-":"",n.rawPrefixHeaderId||(a=s+a),a=n.ghCompatibleHeaderId?a.replace(/ /g,"-").replace(/&amp;/g,"").replace(/¨T/g,"").replace(/¨D/g,"").replace(/[&+$,\/:;=?@"#{}|^¨~\[\]`\\*)(%.!'<>]/g,"").toLowerCase():n.rawHeaderId?a.replace(/ /g,"-").replace(/&amp;/g,"&").replace(/¨T/g,"¨").replace(/¨D/g,"$").replace(/["']/g,"-").toLowerCase():a.replace(/[^\w]/g,"").toLowerCase(),n.rawPrefixHeaderId&&(a=s+a),r.hashLinkCounts[a]?a=a+"-"+r.hashLinkCounts[a]++:r.hashLinkCounts[a]=1,a}return e=e.replace(o,(function(e,s,i){var o=i;n.customizedHeaderId&&(o=i.replace(/\s?\{([^{]+?)}\s*$/,""));var u=t.subParser("makehtml.spanGamut")(o,n,r),c=n.noHeaderId?"":' id="'+l(i)+'"',p=a-1+s.length,d="<h"+p+c+">"+u+"</h"+p+">";return t.subParser("makehtml.hashBlock")(d,n,r)})),e=r.converter._dispatch("makehtml.headers.after",e,n,r).getText()})),t.subParser("makehtml.horizontalRule",(function(e,n,r){e=r.converter._dispatch("makehtml.horizontalRule.before",e,n,r).getText();var a=t.subParser("makehtml.hashBlock")("<hr />",n,r);return e=(e=(e=e.replace(/^ {0,2}( ?-){3,}[ \t]*$/gm,a)).replace(/^ {0,2}( ?\*){3,}[ \t]*$/gm,a)).replace(/^ {0,2}( ?_){3,}[ \t]*$/gm,a),e=r.converter._dispatch("makehtml.horizontalRule.after",e,n,r).getText()})),t.subParser("makehtml.images",(function(e,n,r){function a(e,n,a,s,i,o,l,u){var c=r.gUrls,p=r.gTitles,d=r.gDimensions;if(a=a.toLowerCase(),u||(u=""),e.search(/\(<?\s*>? ?(['"].*['"])?\)$/m)>-1)s="";else if(""===s||null===s){if(""!==a&&null!==a||(a=n.toLowerCase().replace(/ ?\n/g," ")),s="#"+a,t.helper.isUndefined(c[a]))return e;s=c[a],t.helper.isUndefined(p[a])||(u=p[a]),t.helper.isUndefined(d[a])||(i=d[a].width,o=d[a].height)}n=n.replace(/"/g,"&quot;").replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback);var m='<img src="'+(s=s.replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback))+'" alt="'+n+'"';return u&&t.helper.isString(u)&&(m+=' title="'+(u=u.replace(/"/g,"&quot;").replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback))+'"'),i&&o&&(m+=' width="'+(i="*"===i?"auto":i)+'"',m+=' height="'+(o="*"===o?"auto":o)+'"'),m+=" />"}return e=(e=(e=(e=(e=(e=r.converter._dispatch("makehtml.images.before",e,n,r).getText()).replace(/!\[([^\]]*?)] ?(?:\n *)?\[([\s\S]*?)]()()()()()/g,a)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,(function(e,t,n,r,s,i,o,l){return a(e,t,n,r=r.replace(/\s/g,""),s,i,o,l)}))).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<([^>]*)>(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(?:(["'])([^"]*?)\6))?[ \t]?\)/g,a)).replace(/!\[([^\]]*?)][ \t]*()\([ \t]?<?([\S]+?(?:\([\S]*?\)[\S]*?)?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*(?:(["'])([^"]*?)\6)?[ \t]?\)/g,a)).replace(/!\[([^\[\]]+)]()()()()()/g,a),e=r.converter._dispatch("makehtml.images.after",e,n,r).getText()})),t.subParser("makehtml.italicsAndBold",(function(e,t,n){function r(e,t,n){return t+e+n}return e=n.converter._dispatch("makehtml.italicsAndBold.before",e,t,n).getText(),e=(e=(e=(e=t.literalMidWordUnderscores?(e=(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,(function(e,t){return r(t,"<strong><em>","</em></strong>")}))).replace(/\b__(\S[\s\S]*?)__\b/g,(function(e,t){return r(t,"<strong>","</strong>")}))).replace(/\b_(\S[\s\S]*?)_\b/g,(function(e,t){return r(t,"<em>","</em>")})):(e=(e=e.replace(/___(\S[\s\S]*?)___/g,(function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e}))).replace(/__(\S[\s\S]*?)__/g,(function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e}))).replace(/_([^\s_][\s\S]*?)_/g,(function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e}))).replace(/\*\*\*(\S[\s\S]*?)\*\*\*/g,(function(e,t){return/\S$/.test(t)?r(t,"<strong><em>","</em></strong>"):e}))).replace(/\*\*(\S[\s\S]*?)\*\*/g,(function(e,t){return/\S$/.test(t)?r(t,"<strong>","</strong>"):e}))).replace(/\*([^\s*][\s\S]*?)\*/g,(function(e,t){return/\S$/.test(t)?r(t,"<em>","</em>"):e})),e=n.converter._dispatch("makehtml.italicsAndBold.after",e,t,n).getText()})),function(){function e(e,t,a,s,i){return i=!!i,function(o,l,u,c,p,d,m){return/\n\n/.test(o)?o:r(n(e,t+".captureStart",o,l,u,c,m,a,s),a,s,i)}}function n(e,t,n,r,a,s,i,o,l){return l.converter._dispatch(t,n,o,l,{regexp:e,matches:{wholeMatch:n,text:r,id:a,url:s,title:i}})}function r(e,n,r,a){var s=e.getMatches().wholeMatch,i=e.getMatches().text,o=e.getMatches().id,l=e.getMatches().url,u=e.getMatches().title,c="";if(u||(u=""),o=o?o.toLowerCase():"",a)l="";else if(!l){if(o||(o=i.toLowerCase().replace(/ ?\n/g," ")),l="#"+o,t.helper.isUndefined(r.gUrls[o]))return s;l=r.gUrls[o],t.helper.isUndefined(r.gTitles[o])||(u=r.gTitles[o])}l=l.replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback),""!==u&&null!==u&&(u=' title="'+(u=(u=u.replace(/"/g,"&quot;")).replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback))+'"'),n.openLinksInNewWindow&&!/^#/.test(l)&&(c=' target="¨E95Eblank"'),i=t.subParser("makehtml.codeSpans")(i,n,r),i=t.subParser("makehtml.emoji")(i,n,r),i=t.subParser("makehtml.underline")(i,n,r),i=t.subParser("makehtml.italicsAndBold")(i,n,r),i=t.subParser("makehtml.strikethrough")(i,n,r),i=t.subParser("makehtml.ellipsis")(i,n,r);var p='<a href="'+l+'"'+u+c+">"+(i=t.subParser("makehtml.hashHTMLSpans")(i,n,r))+"</a>";return p=t.subParser("makehtml.hashHTMLSpans")(p,n,r)}var a="makehtml.links";t.subParser("makehtml.links",(function(e,n,r){return e=r.converter._dispatch(a+".start",e,n,r).getText(),e=t.subParser("makehtml.links.reference")(e,n,r),e=t.subParser("makehtml.links.inline")(e,n,r),e=t.subParser("makehtml.links.referenceShortcut")(e,n,r),e=t.subParser("makehtml.links.angleBrackets")(e,n,r),e=(e=(e=t.subParser("makehtml.links.ghMentions")(e,n,r)).replace(/<a\s[^>]*>[\s\S]*<\/a>/g,(function(e){return t.helper._hashHTMLSpan(e,r)}))).replace(/<img\s[^>]*\/?>/g,(function(e){return t.helper._hashHTMLSpan(e,r)})),e=t.subParser("makehtml.links.naked")(e,n,r),e=r.converter._dispatch(a+".end",e,n,r).getText()})),t.subParser("makehtml.links.inline",(function(t,n,r){var a=a+".inline",s=/\[(.*?)]()()()()\(<? ?>? ?(?:["'](.*)["'])?\)/g,i=/\[((?:\[[^\]]*]|[^\[\]])*)]()\s?\([ \t]?<([^>]*)>(?:[ \t]*((["'])([^"]*?)\5))?[ \t]?\)/g,o=/\[([\S ]*?)]\s?()\( *<?([^\s'"]*?(?:\([\S]*?\)[\S]*?)?)>?\s*(?:()(['"])(.*?)\5)? *\)/g,l=/\[([\S ]*?)]\s?()\( *<?([^\s'"]*?(?:\([\S]*?\)[\S]*?)?)>?\s+()()\((.*?)\) *\)/g;return t=(t=(t=(t=(t=r.converter._dispatch(a+".start",t,n,r).getText()).replace(s,e(s,a,n,r,!0))).replace(i,e(i,a,n,r))).replace(o,e(o,a,n,r))).replace(l,e(l,a,n,r)),t=r.converter._dispatch(a+".end",t,n,r).getText()})),t.subParser("makehtml.links.reference",(function(t,n,r){var a=a+".reference",s=/\[((?:\[[^\]]*]|[^\[\]])*)] ?(?:\n *)?\[(.*?)]()()()()/g;return t=(t=r.converter._dispatch(a+".start",t,n,r).getText()).replace(s,e(s,a,n,r)),t=r.converter._dispatch(a+".end",t,n,r).getText()})),t.subParser("makehtml.links.referenceShortcut",(function(t,n,r){var a=a+".referenceShortcut",s=/\[([^\[\]]+)]()()()()()/g;return t=(t=r.converter._dispatch(a+".start",t,n,r).getText()).replace(s,e(s,a,n,r)),t=r.converter._dispatch(a+".end",t,n,r).getText()})),t.subParser("makehtml.links.ghMentions",(function(e,a,s){var i=i+"ghMentions";if(!a.ghMentions)return e;e=s.converter._dispatch(i+".start",e,a,s).getText();var o=/(^|\s)(\\)?(@([a-z\d]+(?:[a-z\d._-]+?[a-z\d]+)*))/gi;return e=e.replace(o,(function(e,l,u,c,p){if("\\"===u)return l+c;if(!t.helper.isString(a.ghMentionsLink))throw new Error("ghMentionsLink option must be a string");var d=a.ghMentionsLink.replace(/{u}/g,p);return l+r(n(o,i+".captureStart",e,c,null,d,null,a,s),a,s)})),e=s.converter._dispatch(i+".end",e,a,s).getText()})),t.subParser("makehtml.links.angleBrackets",(function(e,a,s){var i="makehtml.links.angleBrackets";e=s.converter._dispatch(i+".start",e,a,s).getText();var o=/<(((?:https?|ftp):\/\/|www\.)[^'">\s]+)>/gi;e=e.replace(o,(function(e,t,l){return r(n(o,i+".captureStart",e,t,null,t="www."===l?"http://"+t:t,null,a,s),a,s)}));var l=/<(?:mailto:)?([-.\w]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)>/gi;return e=e.replace(l,(function(e,o){var u="mailto:";return o=t.subParser("makehtml.unescapeSpecialChars")(o,a,s),a.encodeEmails?(u=t.helper.encodeEmailAddress(u+o),o=t.helper.encodeEmailAddress(o)):u+=o,r(n(l,i+".captureStart",e,o,null,u,null,a,s),a,s)})),e=s.converter._dispatch(i+".end",e,a,s).getText()})),t.subParser("makehtml.links.naked",(function(e,a,s){if(!a.simplifiedAutoLink)return e;var i="makehtml.links.naked";e=s.converter._dispatch(i+".start",e,a,s).getText();var o=/([_*~]*?)(((?:https?|ftp):\/\/|www\.)[^\s<>"'`´.-][^\s<>"'`´]*?\.[a-z\d.]+[^\s<>"']*)\1/gi;e=e.replace(o,(function(e,l,u,c){for(var p="",d=u.length-1;d>=0;--d){var m=u.charAt(d);if(/[_*~,;:.!?]/.test(m))u=u.slice(0,-1),p=m+p;else if(/\)/.test(m)){var h=u.match(/\(/g)||[],f=u.match(/\)/g);if(!(h.length<f.length))break;u=u.slice(0,-1),p=m+p}else{if(!/]/.test(m))break;var g=u.match(/\[/g)||[],b=u.match(/\]/g);if(!(g.length<b.length))break;u=u.slice(0,-1),p=m+p}}var v=u;return u="www."===c?"http://"+u:u,v=v.replace(t.helper.regexes.asteriskDashTildeAndColon,t.helper.escapeCharactersCallback),l+r(n(o,i+".captureStart",e,v,null,u,null,a,s),a,s)+p+l}));var l=/(^|\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\.[-a-z0-9]+)*\.[a-z]+)(?=$|\s)/gim;return e=e.replace(l,(function(e,o,u){var c="mailto:";return u=t.subParser("makehtml.unescapeSpecialChars")(u,a,s),a.encodeEmails?(c=t.helper.encodeEmailAddress(c+u),u=t.helper.encodeEmailAddress(u)):c+=u,o+r(n(l,i+".captureStart",e,u,null,c,null,a,s),a,s)})),e=s.converter._dispatch(i+".end",e,a,s).getText()}))}(),t.subParser("makehtml.lists",(function(e,n,r){function a(e,a){r.gListLevel++,e=e.replace(/\n{2,}$/,"\n");var s=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0| {0,3}([*+-]|\d+[.])[ \t]+))/gm,i=/\n[ \t]*\n(?!¨0)/.test(e+="¨0");return n.disableForced4SpacesIndentedSublists&&(s=/(\n)?(^ {0,3})([*+-]|\d+[.])[ \t]+((\[(x|X| )?])?[ \t]*[^\r]+?(\n{1,2}))(?=\n*(¨0|\2([*+-]|\d+[.])[ \t]+))/gm),e=(e=e.replace(s,(function(e,a,s,o,l,u,c){c=c&&""!==c.trim();var p=t.subParser("makehtml.outdent")(l,n,r),d="";return u&&n.tasklists&&(d=' class="task-list-item" style="list-style-type: none;"',p=p.replace(/^[ \t]*\[(x|X| )?]/m,(function(){var e='<input type="checkbox" disabled style="margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;"';return c&&(e+=" checked"),e+=">"}))),p=p.replace(/^([-*+]|\d\.)[ \t]+[\S\n ]*/g,(function(e){return"¨A"+e})),/^#+.+\n.+/.test(p)&&(p=p.replace(/^(#+.+)$/m,"$1\n")),a||p.search(/\n{2,}/)>-1?(p=t.subParser("makehtml.githubCodeBlocks")(p,n,r),p=t.subParser("makehtml.blockGamut")(p,n,r)):(p=(p=t.subParser("makehtml.lists")(p,n,r)).replace(/\n$/,""),p=(p=t.subParser("makehtml.hashHTMLBlocks")(p,n,r)).replace(/\n\n+/g,"\n\n"),p=i?t.subParser("makehtml.paragraphs")(p,n,r):t.subParser("makehtml.spanGamut")(p,n,r)),p="<li"+d+">"+(p=p.replace("¨A",""))+"</li>\n"}))).replace(/¨0/g,""),r.gListLevel--,a&&(e=e.replace(/\s+$/,"")),e}function s(e,t){if("ol"===t){var n=e.match(/^ *(\d+)\./);if(n&&"1"!==n[1])return' start="'+n[1]+'"'}return""}function i(e,t,r){var i=n.disableForced4SpacesIndentedSublists?/^ ?\d+\.[ \t]/gm:/^ {0,3}\d+\.[ \t]/gm,o=n.disableForced4SpacesIndentedSublists?/^ ?[*+-][ \t]/gm:/^ {0,3}[*+-][ \t]/gm,l="ul"===t?i:o,u="";if(-1!==e.search(l))!function n(c){var p=c.search(l),d=s(e,t);-1!==p?(u+="\n\n<"+t+d+">\n"+a(c.slice(0,p),!!r)+"</"+t+">\n",l="ul"===(t="ul"===t?"ol":"ul")?i:o,n(c.slice(p))):u+="\n\n<"+t+d+">\n"+a(c,!!r)+"</"+t+">\n"}(e);else{var c=s(e,t);u="\n\n<"+t+c+">\n"+a(e,!!r)+"</"+t+">\n"}return u}return e=r.converter._dispatch("lists.before",e,n,r).getText(),e+="¨0",e=(e=r.gListLevel?e.replace(/^(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,(function(e,t,n){return i(t,n.search(/[*+-]/g)>-1?"ul":"ol",!0)})):e.replace(/(\n\n|^\n?)(( {0,3}([*+-]|\d+[.])[ \t]+)[^\r]+?(¨0|\n{2,}(?=\S)(?![ \t]*(?:[*+-]|\d+[.])[ \t]+)))/gm,(function(e,t,n,r){return i(n,r.search(/[*+-]/g)>-1?"ul":"ol",!1)}))).replace(/¨0/,""),e=r.converter._dispatch("makehtml.lists.after",e,n,r).getText()})),t.subParser("makehtml.metadata",(function(e,t,n){if(!t.metadata)return e;function r(e){n.metadata.raw=e,(e=(e=e.replace(/&/g,"&amp;").replace(/"/g,"&quot;")).replace(/\n {4}/g," ")).replace(/^([\S ]+): +([\s\S]+?)$/gm,(function(e,t,r){return n.metadata.parsed[t]=r,""}))}return e=(e=(e=(e=n.converter._dispatch("makehtml.metadata.before",e,t,n).getText()).replace(/^\s*«««+(\S*?)\n([\s\S]+?)\n»»»+\n/,(function(e,t,n){return r(n),"¨M"}))).replace(/^\s*---+(\S*?)\n([\s\S]+?)\n---+\n/,(function(e,t,a){return t&&(n.metadata.format=t),r(a),"¨M"}))).replace(/¨M/g,""),e=n.converter._dispatch("makehtml.metadata.after",e,t,n).getText()})),t.subParser("makehtml.outdent",(function(e,t,n){return e=(e=(e=n.converter._dispatch("makehtml.outdent.before",e,t,n).getText()).replace(/^(\t|[ ]{1,4})/gm,"¨0")).replace(/¨0/g,""),e=n.converter._dispatch("makehtml.outdent.after",e,t,n).getText()})),t.subParser("makehtml.paragraphs",(function(e,n,r){for(var a=(e=(e=(e=r.converter._dispatch("makehtml.paragraphs.before",e,n,r).getText()).replace(/^\n+/g,"")).replace(/\n+$/g,"")).split(/\n{2,}/g),s=[],i=a.length,o=0;o<i;o++){var l=a[o];l.search(/¨(K|G)(\d+)\1/g)>=0?s.push(l):l.search(/\S/)>=0&&(l=(l=t.subParser("makehtml.spanGamut")(l,n,r)).replace(/^([ \t]*)/g,"<p>"),l+="</p>",s.push(l))}for(i=s.length,o=0;o<i;o++){for(var u="",c=s[o],p=!1;/¨(K|G)(\d+)\1/.test(c);){var d=RegExp.$1,m=RegExp.$2;u=(u="K"===d?r.gHtmlBlocks[m]:p?t.subParser("makehtml.encodeCode")(r.ghCodeBlocks[m].text,n,r):r.ghCodeBlocks[m].codeblock).replace(/\$/g,"$$$$"),c=c.replace(/(\n\n)?¨(K|G)\d+\2(\n\n)?/,u),/^<pre\b[^>]*>\s*<code\b[^>]*>/.test(c)&&(p=!0)}s[o]=c}return e=(e=(e=s.join("\n")).replace(/^\n+/g,"")).replace(/\n+$/g,""),r.converter._dispatch("makehtml.paragraphs.after",e,n,r).getText()})),t.subParser("makehtml.runExtension",(function(e,t,n,r){if(e.filter)t=e.filter(t,r.converter,n);else if(e.regex){var a=e.regex;a instanceof RegExp||(a=new RegExp(a,"g")),t=t.replace(a,e.replace)}return t})),t.subParser("makehtml.spanGamut",(function(e,n,r){return e=r.converter._dispatch("makehtml.span.before",e,n,r).getText(),e=t.subParser("makehtml.codeSpans")(e,n,r),e=t.subParser("makehtml.escapeSpecialCharsWithinTagAttributes")(e,n,r),e=t.subParser("makehtml.encodeBackslashEscapes")(e,n,r),e=t.subParser("makehtml.images")(e,n,r),e=r.converter._dispatch("smakehtml.links.before",e,n,r).getText(),e=t.subParser("makehtml.links")(e,n,r),e=r.converter._dispatch("smakehtml.links.after",e,n,r).getText(),e=t.subParser("makehtml.emoji")(e,n,r),e=t.subParser("makehtml.underline")(e,n,r),e=t.subParser("makehtml.italicsAndBold")(e,n,r),e=t.subParser("makehtml.strikethrough")(e,n,r),e=t.subParser("makehtml.ellipsis")(e,n,r),e=t.subParser("makehtml.hashHTMLSpans")(e,n,r),e=t.subParser("makehtml.encodeAmpsAndAngles")(e,n,r),n.simpleLineBreaks?/\n\n¨K/.test(e)||(e=e.replace(/\n+/g,"<br />\n")):e=e.replace(/  +\n/g,"<br />\n"),e=r.converter._dispatch("makehtml.spanGamut.after",e,n,r).getText()})),t.subParser("makehtml.strikethrough",(function(e,t,n){return t.strikethrough&&(e=(e=n.converter._dispatch("makehtml.strikethrough.before",e,t,n).getText()).replace(/(?:~){2}([\s\S]+?)(?:~){2}/g,(function(e,t){return"<del>"+t+"</del>"})),e=n.converter._dispatch("makehtml.strikethrough.after",e,t,n).getText()),e})),t.subParser("makehtml.stripLinkDefinitions",(function(e,n,r){var a=function(e,a,s,i,o,l,u){return a=a.toLowerCase(),s.match(/^data:.+?\/.+?;base64,/)?r.gUrls[a]=s.replace(/\s/g,""):r.gUrls[a]=t.subParser("makehtml.encodeAmpsAndAngles")(s,n,r),l?l+u:(u&&(r.gTitles[a]=u.replace(/"|'/g,"&quot;")),n.parseImgDimensions&&i&&o&&(r.gDimensions[a]={width:i,height:o}),"")};return e=(e=(e=(e+="¨0").replace(/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?(data:.+?\/.+?;base64,[A-Za-z0-9+/=\n]+?)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n\n|(?=¨0)|(?=\n\[))/gm,a)).replace(/^ {0,3}\[(.+)]:[ \t]*\n?[ \t]*<?([^>\s]+)>?(?: =([*\d]+[A-Za-z%]{0,4})x([*\d]+[A-Za-z%]{0,4}))?[ \t]*\n?[ \t]*(?:(\n*)["|'(](.+?)["|')][ \t]*)?(?:\n+|(?=¨0))/gm,a)).replace(/¨0/,"")})),t.subParser("makehtml.tables",(function(e,n,r){if(!n.tables)return e;function a(e,a){return"<td"+a+">"+t.subParser("makehtml.spanGamut")(e,n,r)+"</td>\n"}function s(e){var s,i=e.split("\n");for(s=0;s<i.length;++s)/^ {0,3}\|/.test(i[s])&&(i[s]=i[s].replace(/^ {0,3}\|/,"")),/\|[ \t]*$/.test(i[s])&&(i[s]=i[s].replace(/\|[ \t]*$/,"")),i[s]=t.subParser("makehtml.codeSpans")(i[s],n,r);var o,l,u,c,p=i[0].split("|").map((function(e){return e.trim()})),d=i[1].split("|").map((function(e){return e.trim()})),m=[],h=[],f=[],g=[];for(i.shift(),i.shift(),s=0;s<i.length;++s)""!==i[s].trim()&&m.push(i[s].split("|").map((function(e){return e.trim()})));if(p.length<d.length)return e;for(s=0;s<d.length;++s)f.push((o=d[s],/^:[ \t]*--*$/.test(o)?' style="text-align:left;"':/^--*[ \t]*:[ \t]*$/.test(o)?' style="text-align:right;"':/^:[ \t]*--*[ \t]*:$/.test(o)?' style="text-align:center;"':""));for(s=0;s<p.length;++s)t.helper.isUndefined(f[s])&&(f[s]=""),h.push((l=p[s],u=f[s],c=void 0,c="",l=l.trim(),(n.tablesHeaderId||n.tableHeaderId)&&(c=' id="'+l.replace(/ /g,"_").toLowerCase()+'"'),"<th"+c+u+">"+(l=t.subParser("makehtml.spanGamut")(l,n,r))+"</th>\n"));for(s=0;s<m.length;++s){for(var b=[],v=0;v<h.length;++v)t.helper.isUndefined(m[s][v]),b.push(a(m[s][v],f[v]));g.push(b)}return function(e,t){for(var n="<table>\n<thead>\n<tr>\n",r=e.length,a=0;a<r;++a)n+=e[a];for(n+="</tr>\n</thead>\n<tbody>\n",a=0;a<t.length;++a){n+="<tr>\n";for(var s=0;s<r;++s)n+=t[a][s];n+="</tr>\n"}return n+"</tbody>\n</table>\n"}(h,g)}return e=(e=(e=(e=r.converter._dispatch("makehtml.tables.before",e,n,r).getText()).replace(/\\(\|)/g,t.helper.escapeCharactersCallback)).replace(/^ {0,3}\|?.+\|.+\n {0,3}\|?[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*:?[ \t]*(?:[-=]){2,}[\s\S]+?(?:\n\n|¨0)/gm,s)).replace(/^ {0,3}\|.+\|[ \t]*\n {0,3}\|[ \t]*:?[ \t]*(?:[-=]){2,}[ \t]*:?[ \t]*\|[ \t]*\n( {0,3}\|.+\|[ \t]*\n)*(?:\n|¨0)/gm,s),e=r.converter._dispatch("makehtml.tables.after",e,n,r).getText()})),t.subParser("makehtml.underline",(function(e,n,r){return n.underline?(e=r.converter._dispatch("makehtml.underline.before",e,n,r).getText(),e=(e=n.literalMidWordUnderscores?(e=e.replace(/\b___(\S[\s\S]*?)___\b/g,(function(e,t){return"<u>"+t+"</u>"}))).replace(/\b__(\S[\s\S]*?)__\b/g,(function(e,t){return"<u>"+t+"</u>"})):(e=e.replace(/___(\S[\s\S]*?)___/g,(function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e}))).replace(/__(\S[\s\S]*?)__/g,(function(e,t){return/\S$/.test(t)?"<u>"+t+"</u>":e}))).replace(/(_)/g,t.helper.escapeCharactersCallback),e=r.converter._dispatch("makehtml.underline.after",e,n,r).getText()):e})),t.subParser("makehtml.unescapeSpecialChars",(function(e,t,n){return e=(e=n.converter._dispatch("makehtml.unescapeSpecialChars.before",e,t,n).getText()).replace(/¨E(\d+)E/g,(function(e,t){var n=parseInt(t);return String.fromCharCode(n)})),e=n.converter._dispatch("makehtml.unescapeSpecialChars.after",e,t,n).getText()})),t.subParser("makeMarkdown.blockquote",(function(e,n){var r="";if(e.hasChildNodes())for(var a=e.childNodes,s=a.length,i=0;i<s;++i){var o=t.subParser("makeMarkdown.node")(a[i],n);""!==o&&(r+=o)}return r="> "+(r=r.trim()).split("\n").join("\n> ")})),t.subParser("makeMarkdown.codeBlock",(function(e,t){var n=e.getAttribute("language"),r=e.getAttribute("precodenum");return"```"+n+"\n"+t.preList[r]+"\n```"})),t.subParser("makeMarkdown.codeSpan",(function(e){return"`"+e.innerHTML+"`"})),t.subParser("makeMarkdown.emphasis",(function(e,n){var r="";if(e.hasChildNodes()){r+="*";for(var a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);r+="*"}return r})),t.subParser("makeMarkdown.header",(function(e,n,r){var a=new Array(r+1).join("#"),s="";if(e.hasChildNodes()){s=a+" ";for(var i=e.childNodes,o=i.length,l=0;l<o;++l)s+=t.subParser("makeMarkdown.node")(i[l],n)}return s})),t.subParser("makeMarkdown.hr",(function(){return"---"})),t.subParser("makeMarkdown.image",(function(e){var t="";return e.hasAttribute("src")&&(t+="!["+e.getAttribute("alt")+"](",t+="<"+e.getAttribute("src")+">",e.hasAttribute("width")&&e.hasAttribute("height")&&(t+=" ="+e.getAttribute("width")+"x"+e.getAttribute("height")),e.hasAttribute("title")&&(t+=' "'+e.getAttribute("title")+'"'),t+=")"),t})),t.subParser("makeMarkdown.links",(function(e,n){var r="";if(e.hasChildNodes()&&e.hasAttribute("href")){var a=e.childNodes,s=a.length;r="[";for(var i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);r+="](",r+="<"+e.getAttribute("href")+">",e.hasAttribute("title")&&(r+=' "'+e.getAttribute("title")+'"'),r+=")"}return r})),t.subParser("makeMarkdown.list",(function(e,n,r){var a="";if(!e.hasChildNodes())return"";for(var s=e.childNodes,i=s.length,o=e.getAttribute("start")||1,l=0;l<i;++l)if(void 0!==s[l].tagName&&"li"===s[l].tagName.toLowerCase()){a+=("ol"===r?o.toString()+". ":"- ")+t.subParser("makeMarkdown.listItem")(s[l],n),++o}return a.trim()})),t.subParser("makeMarkdown.listItem",(function(e,n){for(var r="",a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);return/\n$/.test(r)?r=r.split("\n").join("\n    ").replace(/^ {4}$/gm,"").replace(/\n\n+/g,"\n\n"):r+="\n",r})),t.subParser("makeMarkdown.node",(function(e,n,r){r=r||!1;var a="";if(3===e.nodeType)return t.subParser("makeMarkdown.txt")(e,n);if(8===e.nodeType)return"\x3c!--"+e.data+"--\x3e\n\n";if(1!==e.nodeType)return"";switch(e.tagName.toLowerCase()){case"h1":r||(a=t.subParser("makeMarkdown.header")(e,n,1)+"\n\n");break;case"h2":r||(a=t.subParser("makeMarkdown.header")(e,n,2)+"\n\n");break;case"h3":r||(a=t.subParser("makeMarkdown.header")(e,n,3)+"\n\n");break;case"h4":r||(a=t.subParser("makeMarkdown.header")(e,n,4)+"\n\n");break;case"h5":r||(a=t.subParser("makeMarkdown.header")(e,n,5)+"\n\n");break;case"h6":r||(a=t.subParser("makeMarkdown.header")(e,n,6)+"\n\n");break;case"p":r||(a=t.subParser("makeMarkdown.paragraph")(e,n)+"\n\n");break;case"blockquote":r||(a=t.subParser("makeMarkdown.blockquote")(e,n)+"\n\n");break;case"hr":r||(a=t.subParser("makeMarkdown.hr")(e,n)+"\n\n");break;case"ol":r||(a=t.subParser("makeMarkdown.list")(e,n,"ol")+"\n\n");break;case"ul":r||(a=t.subParser("makeMarkdown.list")(e,n,"ul")+"\n\n");break;case"precode":r||(a=t.subParser("makeMarkdown.codeBlock")(e,n)+"\n\n");break;case"pre":r||(a=t.subParser("makeMarkdown.pre")(e,n)+"\n\n");break;case"table":r||(a=t.subParser("makeMarkdown.table")(e,n)+"\n\n");break;case"code":a=t.subParser("makeMarkdown.codeSpan")(e,n);break;case"em":case"i":a=t.subParser("makeMarkdown.emphasis")(e,n);break;case"strong":case"b":a=t.subParser("makeMarkdown.strong")(e,n);break;case"del":a=t.subParser("makeMarkdown.strikethrough")(e,n);break;case"a":a=t.subParser("makeMarkdown.links")(e,n);break;case"img":a=t.subParser("makeMarkdown.image")(e,n);break;default:a=e.outerHTML+"\n\n"}return a})),t.subParser("makeMarkdown.paragraph",(function(e,n){var r="";if(e.hasChildNodes())for(var a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);return r=r.trim()})),t.subParser("makeMarkdown.pre",(function(e,t){var n=e.getAttribute("prenum");return"<pre>"+t.preList[n]+"</pre>"})),t.subParser("makeMarkdown.strikethrough",(function(e,n){var r="";if(e.hasChildNodes()){r+="~~";for(var a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);r+="~~"}return r})),t.subParser("makeMarkdown.strong",(function(e,n){var r="";if(e.hasChildNodes()){r+="**";for(var a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n);r+="**"}return r})),t.subParser("makeMarkdown.table",(function(e,n){var r,a,s="",i=[[],[]],o=e.querySelectorAll("thead>tr>th"),l=e.querySelectorAll("tbody>tr");for(r=0;r<o.length;++r){var u=t.subParser("makeMarkdown.tableCell")(o[r],n),c="---";if(o[r].hasAttribute("style"))switch(o[r].getAttribute("style").toLowerCase().replace(/\s/g,"")){case"text-align:left;":c=":---";break;case"text-align:right;":c="---:";break;case"text-align:center;":c=":---:"}i[0][r]=u.trim(),i[1][r]=c}for(r=0;r<l.length;++r){var p=i.push([])-1,d=l[r].getElementsByTagName("td");for(a=0;a<o.length;++a){var m=" ";void 0!==d[a]&&(m=t.subParser("makeMarkdown.tableCell")(d[a],n)),i[p].push(m)}}var h=3;for(r=0;r<i.length;++r)for(a=0;a<i[r].length;++a){var f=i[r][a].length;f>h&&(h=f)}for(r=0;r<i.length;++r){for(a=0;a<i[r].length;++a)1===r?":"===i[r][a].slice(-1)?i[r][a]=t.helper.padEnd(i[r][a].slice(-1),h-1,"-")+":":i[r][a]=t.helper.padEnd(i[r][a],h,"-"):i[r][a]=t.helper.padEnd(i[r][a],h);s+="| "+i[r].join(" | ")+" |\n"}return s.trim()})),t.subParser("makeMarkdown.tableCell",(function(e,n){var r="";if(!e.hasChildNodes())return"";for(var a=e.childNodes,s=a.length,i=0;i<s;++i)r+=t.subParser("makeMarkdown.node")(a[i],n,!0);return r.trim()})),t.subParser("makeMarkdown.txt",(function(e){var n=e.nodeValue;return n=(n=n.replace(/ +/g," ")).replace(/¨NBSP;/g," "),n=(n=(n=(n=(n=(n=(n=(n=(n=t.helper.unescapeHTMLEntities(n)).replace(/([*_~|`])/g,"\\$1")).replace(/^(\s*)>/g,"\\$1>")).replace(/^#/gm,"\\#")).replace(/^(\s*)([-=]{3,})(\s*)$/,"$1\\$2$3")).replace(/^( {0,3}\d+)\./gm,"$1\\.")).replace(/^( {0,3})([+-])/gm,"$1\\$2")).replace(/]([\s]*)\(/g,"\\]$1\\(")).replace(/^ {0,3}\[([\S \t]*?)]:/gm,"\\[$1]:")})),t.Converter=function(e){var n={},l=[],u=[],c={},p=s,d={parsed:{},raw:"",format:""};function m(e,n){if(n=n||null,t.helper.isString(e)){if(n=e=t.helper.stdExtName(e),t.extensions[e])return console.warn("DEPRECATION WARNING: "+e+" is an old extension that uses a deprecated loading method.Please inform the developer that the extension should be updated!"),void function(e,n){"function"==typeof e&&(e=e(new t.Converter));t.helper.isArray(e)||(e=[e]);var r=o(e,n);if(!r.valid)throw Error(r.error);for(var a=0;a<e.length;++a)switch(e[a].type){case"lang":l.push(e[a]);break;case"output":u.push(e[a]);break;default:throw Error("Extension loader error: Type unrecognized!!!")}}(t.extensions[e],e);if(t.helper.isUndefined(r[e]))throw Error('Extension "'+e+'" could not be loaded. It was either not found or is not a valid extension.');e=r[e]}"function"==typeof e&&(e=e()),t.helper.isArray(e)||(e=[e]);var a=o(e,n);if(!a.valid)throw Error(a.error);for(var s=0;s<e.length;++s){switch(e[s].type){case"lang":l.push(e[s]);break;case"output":u.push(e[s])}if(e[s].hasOwnProperty("listeners"))for(var i in e[s].listeners)e[s].listeners.hasOwnProperty(i)&&h(i,e[s].listeners[i])}}function h(e,n){if(!t.helper.isString(e))throw Error("Invalid argument in converter.listen() method: name must be a string, but "+typeof e+" given");if("function"!=typeof n)throw Error("Invalid argument in converter.listen() method: callback must be a function, but "+typeof n+" given");e=e.toLowerCase(),c.hasOwnProperty(e)||(c[e]=[]),c[e].push(n)}!function(){for(var r in e=e||{},a)a.hasOwnProperty(r)&&(n[r]=a[r]);if("object"!=typeof e)throw Error("Converter expects the passed parameter to be an object, but "+typeof e+" was passed instead.");for(var s in e)e.hasOwnProperty(s)&&(n[s]=e[s]);n.extensions&&t.helper.forEach(n.extensions,m)}(),this._dispatch=function(e,n,r,a,s){e=e.toLowerCase();var i=s||{};i.converter=this,i.text=n,i.options=r,i.globals=a;var o=new t.helper.Event(e,n,i);if(c.hasOwnProperty(e))for(var l=0;l<c[e].length;++l){var u=c[e][l](o);u&&void 0!==u&&o.setText(u)}return o},this.listen=function(e,t){return h(e,t),this},this.makeHtml=function(e){if(!e)return e;var r={gHtmlBlocks:[],gHtmlMdBlocks:[],gHtmlSpans:[],gUrls:{},gTitles:{},gDimensions:{},gListLevel:0,hashLinkCounts:{},langExtensions:l,outputModifiers:u,converter:this,ghCodeBlocks:[],metadata:{parsed:{},raw:"",format:""}};return e=(e=(e=(e=(e=e.replace(/¨/g,"¨T")).replace(/\$/g,"¨D")).replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\u00A0/g,"&nbsp;"),n.smartIndentationFix&&(e=function(e){var t=e.match(/^\s*/)[0].length,n=new RegExp("^\\s{0,"+t+"}","gm");return e.replace(n,"")}(e)),e="\n\n"+e+"\n\n",e=(e=t.subParser("makehtml.detab")(e,n,r)).replace(/^[ \t]+$/gm,""),t.helper.forEach(l,(function(a){e=t.subParser("makehtml.runExtension")(a,e,n,r)})),e=t.subParser("makehtml.metadata")(e,n,r),e=t.subParser("makehtml.hashPreCodeTags")(e,n,r),e=t.subParser("makehtml.githubCodeBlocks")(e,n,r),e=t.subParser("makehtml.hashHTMLBlocks")(e,n,r),e=t.subParser("makehtml.hashCodeTags")(e,n,r),e=t.subParser("makehtml.stripLinkDefinitions")(e,n,r),e=t.subParser("makehtml.blockGamut")(e,n,r),e=t.subParser("makehtml.unhashHTMLSpans")(e,n,r),e=(e=(e=t.subParser("makehtml.unescapeSpecialChars")(e,n,r)).replace(/¨D/g,"$$")).replace(/¨T/g,"¨"),e=t.subParser("makehtml.completeHTMLDocument")(e,n,r),t.helper.forEach(u,(function(a){e=t.subParser("makehtml.runExtension")(a,e,n,r)})),d=r.metadata,e},this.makeMarkdown=function(e){e=(e=(e=e.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/>[ \t]+</,">¨NBSP;<");var n=t.helper.document.createElement("div");n.innerHTML=e;var r={preList:function(e){for(var n=e.querySelectorAll("pre"),r=[],a=0;a<n.length;++a)if(1===n[a].childElementCount&&"code"===n[a].firstChild.tagName.toLowerCase()){var s=n[a].firstChild.innerHTML.trim(),i=n[a].firstChild.getAttribute("data-language")||"";if(""===i)for(var o=n[a].firstChild.className.split(" "),l=0;l<o.length;++l){var u=o[l].match(/^language-(.+)$/);if(null!==u){i=u[1];break}}s=t.helper.unescapeHTMLEntities(s),r.push(s),n[a].outerHTML='<precode language="'+i+'" precodenum="'+a.toString()+'"></precode>'}else r.push(n[a].innerHTML),n[a].innerHTML="",n[a].setAttribute("prenum",a.toString());return r}(n)};!function e(t){for(var n=0;n<t.childNodes.length;++n){var r=t.childNodes[n];3===r.nodeType?/\S/.test(r.nodeValue)?(r.nodeValue=r.nodeValue.split("\n").join(" "),r.nodeValue=r.nodeValue.replace(/(\s)+/g,"$1")):(t.removeChild(r),--n):1===r.nodeType&&e(r)}}(n);for(var a=n.childNodes,s="",i=0;i<a.length;i++)s+=t.subParser("makeMarkdown.node")(a[i],r);return s},this.setOption=function(e,t){n[e]=t},this.getOption=function(e){return n[e]},this.getOptions=function(){return n},this.addExtension=function(e,t){m(e,t=t||null)},this.useExtension=function(e){m(e)},this.setFlavor=function(e){if(!i.hasOwnProperty(e))throw Error(e+" flavor was not found");var t=i[e];for(var r in p=e,t)t.hasOwnProperty(r)&&(n[r]=t[r])},this.getFlavor=function(){return p},this.removeExtension=function(e){t.helper.isArray(e)||(e=[e]);for(var n=0;n<e.length;++n){for(var r=e[n],a=0;a<l.length;++a)l[a]===r&&l[a].splice(a,1);for(;0<u.length;++a)u[0]===r&&u[0].splice(a,1)}},this.getAllExtensions=function(){return{language:l,output:u}},this.getMetadata=function(e){return e?d.raw:d.parsed},this.getMetadataFormat=function(){return d.format},this._setMetadataPair=function(e,t){d.parsed[e]=t},this._setMetadataFormat=function(e){d.format=e},this._setMetadataRaw=function(e){d.raw=e}},t}.call(void 0);const Ln=new Cn.Converter({emoji:!0,parseImgDimensions:!0,simpleLineBreaks:!0,simplifiedAutoLink:!0,tables:!0,openLinksInNewWindow:!0,extensions:[function(){return[{type:"output",filter:e=>{const t=(e=e.replaceAll(/<p>:::(.*?)<\/p>/g,":::$1")).match(/:::(.*?)\n(.*?):::/gs);if(t){let n=e;for(const r of t){const t=/:::(.*?)\s(.*?)\n(.*?):::/s.exec(r),a=e.indexOf(r);if(!("<code>"==e.substring(a-6,a))){let e=t[1],a=t[2];e.includes("<br")&&(e=e.replace("<br",""),a="");const s=t[3];let i;a.includes("collapsible")?(a=a.replace("collapsible",""),i=`<div><div class="admonition ${e}"><details><summary class="admonitionTitle">${a}</summary><div class="admonitionContent">${s}</div></details></div></div>`):i=`<div><div class="admonition ${e}"><div class="admonitionTitle">${a}</div><div class="admonitionContent">${s}</div></div></div>`,n=n.replaceAll(r,i)}}return n}return e}}]}]});function Sn(e,t){const n=e.length,r=t.length;if(0===n)return r;if(0===r)return n;const a=[];for(let e=0;e<=r;e++)a[e]=[e];for(let e=0;e<=n;e++)a[0][e]=e;for(let s=1;s<=r;s++)for(let r=1;r<=n;r++){const n=e[r-1]===t[s-1]?0:1;a[s][r]=Math.min(a[s-1][r]+1,a[s][r-1]+1,a[s-1][r-1]+n)}return a[r][n]}function Tn(e,t,n){const r=e.split(" ");for(const e of r){if(Sn(e,t)<n)return!0}return!1}function jn(e){const t={"à":"a","â":"a","é":"e","è":"e","ê":"e","ë":"e","î":"i","ï":"i","ô":"o","ö":"o","û":"u","ü":"u","ÿ":"y","ç":"c","À":"A","Â":"A","É":"E","È":"E","Ê":"E","Ë":"E","Î":"I","Ï":"I","Ô":"O","Ö":"O","Û":"U","Ü":"U","Ÿ":"Y","Ç":"C"};return e.replace(/[àâéèêëîïôöûüÿçÀÂÉÈÊËÎÏÔÖÛÜŸÇ]/g,(e=>t[e]||e))}function qn(e){let t=0;for(const n in e)t+=e[n]**2;return Math.sqrt(t)}function Pn(e,t){const n=function(e,t){let n=e.toLowerCase();n=n.replace(/,|\.|\:|\?|\!|\(|\)|\[|\||\/\]/g,""),n=n.replaceAll("/"," "),n=jn(n),n=n.split(/\s|'/).map((e=>e.trim())).filter((e=>e.length>=5))||[];const r=[],a=[0,0,0,0,.4,.6,.8],s=_n.goto?100:10;function i(e,n,r){let i=a[n-1];i=0===e?i+.2:i;const o=r.substring(e,e+n);return t&&(t=t.toLowerCase()).includes(o)&&(i+=s),{token:o,weight:i}}const o=n.length;for(let e=0;e<o;e++){const t=n[e];r.push({token:t,weight:5});const a=t.length;if(a>=5)for(let e=0;e<=a-5;e++)r.push(i(e,5,t));if(a>=6)for(let e=0;e<=a-6;e++)r.push(i(e,6,t));if(a>=7)for(let e=0;e<=a-7;e++)r.push(i(e,7,t))}return r}(e,t),r={};for(const{token:e,weight:t}of n)e&&(r[e]=(r[e]||0)+t);return r}function En(e,t){const n=Pn(e),r=function(e,t){const n=new Set([...Object.keys(e),...Object.keys(t)]);let r=0;for(const a of n)r+=(e[a]||0)*(t[a]||0);return r}(n,t),a=qn(n),s=qn(t);return 0===a||0===s?0:r/(a*s)}let On=!1;document.body.addEventListener("click",(()=>{On=!1})),document.body.addEventListener("keypress",(e=>{"Enter"===e.key&&(On=!1)}));let In={model:Yt.useLLM.model,stream:!0,max_tokens:Yt.useLLM.maxTokens,frequency_penalty:0,presence_penalty:0,temperature:.7,top_p:.95};function zn(e){const t=document.createElement("div");t.classList.add("message"),t.classList.add("bot-message"),nn.appendChild(t),t.textContent="Pour répondre à cette question, je dois faire appel à une IA générative : la connexion à cette IA n'a pas été correctement configurée ou bien ne fonctionne pas",e&&(console.error("Erreur:",e.message),console.log("Une erreur s'est produite : "+e))}function Dn(e,t){t.length>0&&(t=Yt.useLLM.RAGprompt+t);const n=Yt.useLLM.url.includes("cohere");n?In.message=Yt.useLLM.preprompt+e+Yt.useLLM.postprompt+t:In.messages=[{content:Yt.useLLM.systemPrompt,role:"system"},{content:Yt.useLLM.preprompt+e+Yt.useLLM.postprompt+t,role:"user"}];try{fetch(Yt.useLLM.url,{method:"POST",headers:{Authorization:"Bearer "+Yt.useLLM.apiKey,"Content-Type":"application/json"},body:JSON.stringify(In)}).then((e=>{if(e.ok){On=!0;const t=document.createElement("div");t.classList.add("message"),t.classList.add("bot-message"),nn.appendChild(t),async function(e,t,n){for await(const r of e)(new TextDecoder).decode(r).trim().split("\n").filter((e=>e.trim().length>0)).forEach((e=>{if(n){const n=JSON.parse(e.trim());if("text-generation"==n.event_type&&On){const e=n.text;t.innerHTML=t.innerHTML+e}On=!n.is_finished}else{const n=e.replace("data: ","");if(!n.includes("[DONE]")&&On){const e=JSON.parse(n).choices[0].delta.content;t.innerHTML=t.innerHTML+e}else On=!1}window.scrollTo(0,document.body.scrollHeight)}))}(e.body,t,n)}else zn()})).catch((e=>{zn(e)}))}catch(e){zn(e)}}function Bn(e,t){if(t){if("auto"==t){function n(e,t=600){let n=[],r=0;for(;r<e.length;){let a=r+t;if(a<e.length){let t=e.lastIndexOf(" ",a);t>r&&(a=t)}n.push(e.slice(r,a).trim()),r=a+1}return n}return n(e)}return"break"==Yt.useLLM.RAGseparator?e.split("---").map((e=>e.replaceAll("\n"," ").trim())):e.split(Yt.useLLM.RAGseparator)}return e.split("\n").filter((e=>""!==e.trim()))}let Rn=[],Nn=[];function Hn(e){if(e){if(!e.includes("http")){let t;return e.toString().includes("useFile")?(t=t.trim(),Yt.useLLM.RAGinformations=Bn(t,Yt.useLLM.RAGseparator)):(t=e.trim(),Yt.useLLM.RAGinformations=Bn(t,Yt.useLLM.RAGseparator)),Yt.useLLM.RAGinformations}{const t=s(e);fetch(t).then((e=>e.text())).then((e=>{Rn=Bn(e,Yt.useLLM.RAGseparator);const t=function(e){if(e){const t=e.length;for(let n=0;n<t;n++){const t=Pn(e[n]);Nn.push(t)}return Nn}}(Rn);return t}))}}}const Fn=document.getElementById("send-button");async function Un(t){let r={};const s={...Object.fromEntries(new URLSearchParams(document.location.search)),...Object.fromEntries(new URLSearchParams(document.location.hash.replace(/#.*\?/,"")))};for(const[e,t]of Object.entries(s))r["GET"+e]=t;const i=t.pop();let o=t.pop();const u=t.length;document.getElementById("chatbot-name").textContent=i,document.title=i;let c=null,p=Math.floor(Math.random()*e.defaultMessage.length),d=[];function m(e,t){const a=document.createElement("div");a.classList.add("message"),a.classList.add(t?"user-message":"bot-message"),_n.selected=void 0,Yt.variables&&(e=wn(e)),t||(e=function(e){const t=e.split("\n---\n");if(t.length>1){const r=e.indexOf('<ul class="messageOptions">');if(r>-1){const t=e.substring(0,r),a=e.substring(r);e=n(t.split("---"))+a}else e=n(t)}return e}(e)),Yt.dynamicContent&&(e=An(e,r,t)),t||(Yt.bots&&(e=function(e,t){return e.replace(/!Bot:(.*)/,(function(e,n){return e&&n&&(n=n.trim().replaceAll(" ",""),t.classList.add("botName-"+n)),""}))}(e,a)),e=function(e){return e.replaceAll(/!SelectNext:(.*)/g,(function(e,t){if(e){const e=t.split("/");return _n.lastMessageFromBot="",_n.goto="",_n.onlyIfKeywords=!1,_n.selected=n(e).trim(),""}_n.selected=""}))}(e=function(e){return e=e.replaceAll(/!Next ?:(.*)/g,(function(t,n){const r=n.split("/");let a;return r.length>0?(n=r[0],a=r[1]):n=r[0],_n.lastMessageFromBot=e,_n.goto=n.trim(),_n.onlyIfKeywords=!0,_n.messageIfKeywordsNotFound=a?a.trim():"Ce n'était pas la bonne réponse, merci de réessayer !",_n.messageIfKeywordsNotFound=_n.messageIfKeywordsNotFound+"\n\n",_n.errorsCounter++,t&&_n.errorsCounter<_n.maxErrors?"":`<ul class="messageOptions"><li><a href="#${Yt.obfuscate?btoa(_n.goto):_n.goto}">Passer à la suite !</a></li></ul>`}))}(e=function(e){return(e=e.replaceAll(/<audio[\s\S]*?src="([^"]+)"[\s\S]*?<\/audio>/gm,(function(e,t){return e.includes("autoplay")?(new Audio(t).play(),`\x3c!--${e}--\x3e`):e}))).replaceAll(/!Audio:(.*)/g,(function(e,t){return new Audio(t.trim()).play(),""}))}(e))),Yt.addOns&&Yt.addOns.includes("kroki")&&(e=function(e){return e=e.replaceAll(/```(mermaid|tikz|graphviz|plantuml|excalidraw|vegalite|vega)((.|\n)*?)```/gm,(function(e,t,n){return n=n.replaceAll("\n\n\n","\n\n"),window.krokiCreateImageFromSource(t,n)})),e}(e)));let s=(i=(i=e).replaceAll("\n\n|","|"),Ln.makeHtml(i).replaceAll("&amp;#96","`&#96`"));var i;Yt.bots&&(s=function(e){const t=e.split("<p>!Bot:"),n=t.length;if(n>1){let r=t[0];for(let e=1;e<n;e++){const n=t[e].trim().match(/(.*?)<\/p>((.|\n)*)/),a=n[1].trim(),s=n[2].trim();r=r+gn+'<div class="message bot-message botName-'+a+'">'+s+"</div>"}e=r}return e}(s)),!0===Yt.maths?(s=function(e){let t=(e=e.replace(/\$\$(.*?)\$\$/g,"&#92;[$1&#92;]").replace(/\$(.*?)\$/g,"&#92;($1&#92;)")).match(new RegExp(/&#92;\[.*?&#92;\]|&#92;\(.*?&#92;\)/g));if(t)for(let n of t){const t=!!n.includes("&#92;[");let r=n.replace("&#92;[","").replace("&#92;]","");r=r.replace("&#92;(","").replace("&#92;)",""),r=r.replaceAll("&lt;","\\lt").replaceAll("&gt;","\\gt"),r=r.replaceAll("<em>","_").replaceAll("</em>","_").replaceAll("&amp;","&").replaceAll(" ","\\ ");const a=window.katex.renderToString(r,{displayMode:t});e=e.replace(n,a)}return!0===Yt.typeWriter&&(e=(e=e.replaceAll(/(<span class="katex-mathml">(.|\n)*?<\/span>)/gm,"`$1`")).replaceAll(/(<span class=".?strut">.*?<\/span>)/g,"`$1`")),e}(s),setTimeout((()=>{vn(s,t,a)}),100)):vn(s,t,a),_n.selected&&_(_n.selected)}const h=3,f=5,g=.55;function b(e){if(""!=e)for(let n=0;n<u;n++){let r=t[n][0];if(r=Yt.obfuscate?btoa(r):r,e==r){let e=t[n][2];const r=t[n][3];e=Array.isArray(e)?e.join("\n\n"):e,c=r,e=r?w(e,r):e,m(e,!1);break}}else m(o,!1)}let v=[];if(Yt.searchInContent||Yt.useLLM.url)for(let e=0;e<u;e++){const n=t[e][2];let r=Array.isArray(n)?n.join(" ").toLowerCase():n.toLowerCase();const a=t[e][0];r=a+" "+r;const s=Pn(r,a);v.push(s)}function _(r){""==_n.goto||_n.onlyIfKeywords||(r=_n.goto);let a,s="";if(Yt.useLLM.url&&(r=r.replace('<span class="hidden">!useLLM</span>',"!useLLM"),a=r.trim().replace("!useLLM",""),Yt.useLLM.RAGinformations)){const e=function(e,t){let n;return n=e.length<t?e.map(((e,t)=>[e,t])):e.reduce(((e,n,r)=>(e.length<t?(e.push([n,r]),e.sort(((e,t)=>e[0]-t[0]))):n>e[0][0]&&(e[0]=[n,r],e.sort(((e,t)=>e[0]-t[0]))),e)),[]),n.sort(((e,t)=>t[0]-e[0])),n}(Nn.map((e=>En(a,e))),Yt.useLLM.RAGmaxTopElements);s=e.map((e=>Rn[e[1]])).join("\n")}if(!0===Yt.detectBadWords&&Qt&&Qt.check(r))return void m(n(e.badWordsMessage),!1);let i,o,l,_=null,k=0,y=0,x=r.toLowerCase();if(c&&(o=c.map((e=>e[0].toLowerCase())),l=o.indexOf(x)),c&&l>-1){b(c[l][1])}else{for(let e=0;e<u;e++){const n=t[e][0],r=t[e][1];if(_n.onlyIfKeywords&&n!=_n.goto)continue;_n.onlyIfKeywords&&n==_n.goto&&0==r.length&&(x=_n.goto.toLowerCase());const a=r.concat(n),s=t[e][2];let o=0,l=0;if(Yt.searchInContent){o=o+En(x,v[e])+.5}for(let e of a){let t=e.toLowerCase();if(x.includes(t)){let e=!1;if(_n.onlyIfKeywords){x=jn(x),t=jn(t);new RegExp(`\\b${t}\\b`).test(x)&&(e=!0)}else e=!0;e&&(o+=f,o+=t.length/10)}else x.length>4&&Tn(x,e,h)&&l++}0!=o||_n.onlyIfKeywords||l>y&&(o++,y=l),o>0&&_n.onlyIfKeywords&&n==_n.goto&&(o+=f),o>k&&(_=s,k=o,i=e)}if(_&&k>g||_n.onlyIfKeywords){_&&_n.onlyIfKeywords&&(_n.lastMessageFromBot="",_n.goto="",_n.errorsCounter=0,_n.onlyIfKeywords=!1);let e=_?Array.isArray(_)?_.join("\n\n"):_:"";const n=_?t[i][0]:"";let o,l=_?t[i][3]:[];if(o=_n.onlyIfKeywords&&n!==_n.goto?_n.lastMessageFromBot.includes(_n.messageIfKeywordsNotFound)?_n.lastMessageFromBot:_n.messageIfKeywordsNotFound+_n.lastMessageFromBot:w(e,l),Yt.useLLM.url&&Yt.useLLM.model&&Yt.useLLM.always||r.includes("!useLLM"))return void Dn(a.trim(),e+"\n"+s);m(o,!1)}else{if(Yt.useLLM.url&&Yt.useLLM.model&&Yt.useLLM.always||r.includes("!useLLM"))return void Dn(a,s);{for(;d.includes(p);)p=Math.floor(Math.random()*e.defaultMessage.length);d.length>4&&d.shift(),d.push(p);let t=e.defaultMessage[p];if(Yt.useLLM.url&&Yt.useLLM.model&&!Yt.useLLM.always){t=w(t,[["Voir une réponse générée par une IA","!useLLM "+r.replaceAll('"',"“")]])}m(t,!1)}}}}function w(e,t){if(Yt.dynamicContent&&Object.keys(r).length>0&&t&&(t=t.filter((e=>{let t=e[3];return!t||(t=t.replace(/@([^\s()&|!=<>]+)/g,(function(e,t){return'tryConvertStringToNumber(dynamicVariables["'+t.trim()+'"])'})),t=t.replaceAll(/(==|!=|<=|>=|<|>) ?(.*?) ?(\)|\&|\||$)/g,(function(e,t,n,r){return`${t}"${n}" ${r}`})).replaceAll('""','"').replace('"undefined"',"undefined"),xn(t,r))}))),[e,t]=function(e,t){return[e=e.replaceAll(/\!Select ?: ?([0-9]*)/g,(function(e,n){return e&&n<=t.length?(t=a(t).slice(0,n),"\x3c!--"+e+"--\x3e"):""})),t]}(e,t),function(e){if(Array.isArray(e)){const t=e.length;for(let n=0;n<t;n++)if(!0===e[n][2])return!0}return!1}(t)&&(t=function(e){let t=[];e.forEach((function(e){e[2]&&t.push(e)})),t=a(t);var n=[];return e.forEach((function(e){e[2]?n.push(t.shift()):n.push(e)})),n}(t)),t){c=t;let n='\n<ul class="messageOptions">';const r=t.length;for(let e=0;e<r;e++){const r=t[e],a=r[0];n=n+'<li><a href="#'+r[1]+'">'+a+"</a></li>\n"}n+="</ul>",e+=n}else c=null;return e}Yt.useLLM.url&&Yt.useLLM.RAGinformations&&Hn(Yt.useLLM.RAGinformations),Fn.addEventListener("click",(()=>{const e=rn.innerText;if(""!==e.trim())m(e,!0),setTimeout((()=>{_(e),l()}),100),rn.innerText="";else{const e=new KeyboardEvent("keypress",{key:"Enter",keyCode:13,which:13});rn.dispatchEvent(e)}})),document.addEventListener("keypress",(e=>{rn.focus(),"Enter"===e.key?(e.preventDefault(),Fn.click(),l()):rn.parentElement.parentElement.classList.contains("hideControls")&&e.preventDefault()})),rn.focus({preventScroll:!0}),rn.addEventListener("focus",(function(){this.classList.remove("placeholder")})),rn.addEventListener("blur",(function(){this.classList.add("placeholder")})),nn.addEventListener("click",(e=>function(e){const t=e.target;if("A"===t.tagName){const n=window.location.href,r=t.getAttribute("href");if(r.startsWith(n)&&window.open(r),r.startsWith("#")){e.preventDefault(),_n.lastMessageFromBot="",_n.goto="",_n.onlyIfKeywords=!1;let n=t.innerText;const a=Yt.obfuscate?atob(r.replace("#","")):r;Yt.useLLM.url&&Yt.useLLM.model&&a.includes("!useLLM")?(n=a.replace("#","").replace("!useLLM",'<span class="hidden">!useLLM</span>').trim(),m(n,!0),_(n)):(m(n,!0),b(r.substring(1)),document.activeElement.blur(),sn&&rn.focus()),_n.errorsCounter=0,l()}}}(e))),o=w(o[0].join("\n"),o[1]),Yt.dynamicContent&&(o=An(o,r,!1)),m(o,!1),o=o.replace(/<span class=\"unique\">.*?<\/span>/,"")}let Gn,Vn="---\ngestionGrosMots: true\n---\n\n# ChatMD\n\nBonjour, je suis **ChatMD**, un outil libre et gratuit qui permet de créer facilement un chatbot personnalisé à partir d'un simple fichier en Markdown.\n\n:::info C'est très simple !\n1. Créez un fichier en Markdown accessible en ligne.\n2. Respectez la syntaxe de ChatMD pour définir votre chatbot.\n3. Votre chatbot est alors accessible à l'adresse suivante : [https://chatmd.forge.apps.education.fr/#URL](https://chatmd.forge.apps.education.fr/#URL) <br>(Mettez l'url de votre fichier à la place de URL) !\n:::\n\nOn peut imaginer **de nombreux usages** :\n- Tutoriel pour un outil informatique\n- Guide méthodologique\n- Soutien pour la révision d'un cours, quiz interactif,\n- Discussion avec un personnage historique,\n- Histoire dont vous êtes le héros …\n\nLa syntaxe de base est simple, mais ChatMD peut être configuré pour des **usages plus complexes** : personnalisation de l'interface, utilisation de variables, de choix aléatoires, intégration avec un LLM, possibilité de faire du RAG …\n\n1. [Qu'est-ce que le Markdown ?](Markdown)\n2. [Comment créer un fichier en Markdown accessible en ligne ?](Comment créer un fichier en Markdown accessible en ligne ?)\n3. [Quelle syntaxe faut-il respecter pour ChatMD ?](Syntaxe)\n4. [Donne-moi des exemples !](Exemples)\n5. [Quelles sont les options de configuration plus avancées ?](Options de configuration)\n6. [Comment intégrer mon chatbot dans un site ?](Comment intégrer mon chatbot sur un site ?)\n7. [Qui a créé ChatMD ?](Qui a créé ChatMD ?)\n\n## Markdown\n- markdown\n\nLe Markdown est un format de balisage très léger qui permet d'écrire rapidement du texte formaté.\n\nPar exemple on écrit `**texte en gras**` pour écrire du **texte en gras**, ou alors `_texte en italique_` pour écrire du _texte en italique_.\n\nPour découvrir le Markdown, vous pouvez suivre ce [tutoriel](https://www.markdowntutorial.com/fr/).\n\n1. [OK, j'ai compris ce qu'est le Markdown, mais comment créer un fichier en Markdown accessible en ligne ?](Comment créer un fichier en Markdown accessible en ligne ?)\n2. [J'ai compris la syntaxe du Markdown, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## Comment créer un fichier en Markdown accessible en ligne ?\n- codimd\n- codi\n- forge\n- en ligne\n- digipage\n- hedgedoc\n- framapad\n\nIl existe plusieurs services pour créer un fichier Markdown accessible en ligne.\n\nSi vous êtes prof en France et que avez des identifiants académiques, vous pouvez utiliser [CodiMD](https://codimd.apps.education.fr/) sur le [portail Apps Edu](https://portail.apps.education.fr/).\n\nD'autres outils fonctionnent avec ChatMD et notamment : [Digipage](https://digipage.app/) de La Digitale et [Framapad](https://framapad.org/) de Framasoft\n\nIl est également possible d'utiliser la [Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/).\n\n1. [Qu'est-ce qu'une forge ?](forge)\n2. [J'ai compris comment créer mon fichier, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## forge\n- forge\n\nUne forge est un outil qui permet d'héberger des fichiers texte et de les transformer en site web, en carte mentale, ou encore ici en chatbot ! ChatMD est présent sur la [Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/) et vous pouvez aussi mettre vos fichiers sur cette forge.\n\nSi vous êtes prof en France et que vous souhaitez utiliser la forge, rejoignez le [groupe Tchap de LaForgeÉdu](https://www.tchap.gouv.fr/#/room/!fnVhKrpqraWfsSirBK:agent.education.tchap.gouv.fr) pour plus d'explications !\n\n1. [J'ai compris comment créer mon fichier, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## Syntaxe\n- syntaxe\n- règles\n- comment\n\nLa syntaxe pour écrire un chatbot avec chatMD est la suivante, mais c'est peut-être plus simple de [voir des exemples](#Exemples) ou bien de [récupérer un modèle](https://codimd.apps.education.fr/mBGbHStJSVOSrlGfGb981A?both).\n\n```\n​# Titre du chatbot\n​Message initial\n​1​. [Premier choix](Réponse 1)\n2​. [Deuxième choix](Réponse 2)\n​\n​## Réponse 1\n- déclencheur 1 (optionnel)\n- déclencheur 2 (optionnel)\nContenu de la réponse\n​1​. [Proposition 1](Titre Proposition 1)\n2​. [Proposition 2](Titre Proposition 2)\n```\n\nDans le message initial et le contenu de chaque réponse, **on peut utiliser toute la syntaxe Markdown** : intégrer des images, des vidéos, des iframes, et même utiliser des balises HTML.\n\nLes **titres de niveau 2** servent à identifier les réponses possibles du chatbot\n\n### Deux manières pour déclencher une réponse\n\n:::info Avec la souris, l'utilisateur clique sur une proposition\nPour créer des boutons qui déclenchent des réponses quand on clique dessus, il faut utiliser une liste ordonnée en Markdown, qui doit avoir la forme suivante : \n` 1. [intitulé de l'option qui s'affiche pour l'utilisateur](titre de la réponse correspondante dans le fichier en Markdown)`\n:::\n\n:::info Avec le clavier, l'utilisateur pose une question\nPour permettre au chatbot de renvoyer la réponse la plus adéquate, on indique sous le titre de la réponse des déclencheurs (mots clés ou expressions) qui vont renforcer le choix de cette réponse. On utilise une liste non ordonnée en Markdown.\n:::\n\nIl est préférable de combiner ces 2 options pour être sûr que l'utilisateur trouve les réponses à ses questions !\n\n1. [J'ai compris la syntaxe de base, mais quelles sont les options de configuration plus avancées](Options de configuration)\n2. [Si on utilise des déclencheurs, comment fonctionne le choix de la réponse la plus adéquate ?](explication choix réponse adéquate)\n\n## explication choix réponse adéquate\n\nSi on utilise des déclencheurs, ChatMD calcule la réponse la plus adéquate.\n\nCe n'est pas une simple recherche d'occurrences : le calcul intègre une décomposition en tokens et un calcul de distance lexicale.\n\nLa décomposition en tokens permet de retrouver des racines communes et la distance lexicale permet de trouver une réponse malgré des fautes d'orthographe.\n\n## Options de configuration\n- options\n- configuration\n- avancé\n- personnalisation\n- personnaliser\n\nPlusieurs options de configuration sont disponibles !\nLa plupart des options reposent sur l'ajout de paramètres dans l'en-tête YAML du fichier Markdown.\n\nQue voulez-vous faire ?\n\n1. [Améliorer l'algorithme de choix d'une réponse](option : Améliorer l'algorithme)\n2. [Personnaliser l'apparence du chatbot](option : Personnaliser l'apparence)\n3. [Gérer des contenus particuliers : admonitions, mathématiques, schémas, sons …](option : Gérer des contenus particuliers)\n4. [Organiser mon fichier source](option : Organiser son fichier source)\n5. [Utiliser ChatMD pour faire des quiz](option : Utiliser ChatMD pour faire des quiz)\n6. [Introduire de l'aléatoire dans les réponses ou les propositions en fin de message](option : Introduire de l'aléatoire)\n7. [Utiliser des variables dynamiques et du conditionnement en fonction de ces variables](option : Variables dynamiques)\n8. [Connecter ChatMD à un LLM, faire du RAG](option : Connecter ChatMD à un LLM, faire du RAG)\n9. [Avoir plusieurs bots différents](option: Avoir plusieurs bots différents)\n10. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n\n## Explication en-tête yaml\n\nUn en-tête YAML est une section spéciale dans laquelle on déclare certaines variables, qu'un programme comme ChatMD peut ensuite utiliser.\nCet en-tête doit se trouver au tout début du fichier. Il faut commencer et terminer l'en-tête par trois tirets `-​-​-`.\n\nVoici un exemple d'en-tête YAML :\n\n```\n-​-​-\ngestionGrosMots: true\n-​-​-\n```\n\n## option : Améliorer l'algorithme\n- algorithme\n- gros mot\n- insulte\n- message par défaut\n\nPour améliorer l'algorithme de choix d'une réponse, vous pouvez utiliser ces paramètres dans l'en-tête YAML : \n\n- si on ajoute `rechercheContenu: true`, alors l'algorithme ne se contente pas de comparer le message de l'utilisateur avec le titre de la réponse et les déclencheurs, mais il compare aussi ce message avec le contenu entier de la réponse. Attention, dans ce cas, le chatbot peut mettre un peu plus de temps à se charger.\n- `gestionGrosMots: true` permet de détecter les gros mots et les insultes envoyés par l'utilisateur et de formuler une réponse adéquate si l'utilisateur en utilise.\n- `messageParDéfaut: [\"message 1\", \"message 2\", \"message 3\"]` permet de modifier le message par défaut qui s'affiche aléatoirement quand le chatbot n'a pas trouvé de réponse pertinente.\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Personnaliser l'apparence\n- personnaliser l'apparence\n- modifier l'apparence\n- changer l'apparence\n- avatar\n- effet\n- clavier\n- style\n- css\n- thème\n- favicon\n\nPour personnaliser l'apparence du chatbot, vous pouvez utiliser ces paramètres dans l'en-tête YAML :\n\n- `style: a{color:red}` permet d'ajouter des styles CSS personnalisés.\n- `avatar: URL` permet de changer l'avatar du chatbot (il faut mettre l'url de son image à la place de URL)\n- `favicon: URL` permet de changer l'icône du chatbot dans les onglets (il faut mettre l'url de son image à la place de URL)\n- `footer: false` permet de supprimer le pied de page\n- `footer: 'Mon footer'` permet de customiser ce qui apparaît dans le pied de page\n- `theme: bubbles` permet d'utiliser un thème CSS particulier (ici le thème \"bubbles\")\n- `typewriter: false` désactive l'effet “machine à écrire”\n- `clavier: false` désactive le champ d'entrée clavier si on souhaite simplement guider l'utilisateur avec les options proposées en fin de chaque réponse.\n\nSi on veut activer ou désactiver le clavier pour certaines réponses, on met `&#96@​KEYBOARD = true&#96` ou `&#96@​KEYBOARD = false&#96` à l'intérieur de son code markdown pour les réponses en question..\n\nSi on veut désactiver l'effet typewriter pour un passage seulement de son texte, on utilise la syntaxe suivante dans son code markdown : `\\\\&#96texte sans effet typewriter\\\\&#96`\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Gérer des contenus particuliers\n- admonition\n- iframe\n- audio\n- son\n- latex\n- mathématiques\n- schémas\n- h5p\n\n### Admonitions\n\nDans le contenu en Markdown, vous pouvez utiliser des admonitions, c'est-à-dire des encadrés pour mettre en valeur certains contenus. Il faut utiliser la syntaxe suivante : \n```\n:​:​:info\ncontenu\n:​:​:\n```\n\nPlusieurs types d'admonitions sont disponibles (voir cet [exemple](https://codimd.apps.education.fr/9U7L4wpOSmaRFl6aRK-J9Q?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/9U7L4wpOSmaRFl6aRK-J9Q))\n\n### iframes et audio\n\nVous pouvez aussi utiliser :\n1. des iframes pour intégrer des contenus interactifs comme H5P. Attention, il vaut mieux que le contenu en iframe soit le dernier contenu de votre réponse, car sinon votre iframe risque de mettre du temps à s'afficher.\n2. la directive `!​Audio : URLduFichierAudio` pour jouer automatiquement un son lors du déclenchement d'une réponse (voir cet [exemple](https://codimd.apps.education.fr/24OabQgvQ_yPd2WE3DrIEg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/24OabQgvQ_yPd2WE3DrIEg)).\n\n### Latex\n\nPour utiliser le Latex pour les mathématiques, il faut ajouter `maths: true` dans le YAML. On peut alors écrire des formules mathématiques en Latex avec la syntaxe `$Latex$` (à l'intérieur d'un paragraphe) ou `$$Latex$$` (pour un paragraphe à part).\n\t\n### Schémas & graphiques\n\nPour pouvoir générer des schémas et graphiques via le service Kroki, il faut ajouter `addOns: kroki` dans le YAML. Cela permet de générer des schémas avec la syntaxe de Tikz, GraphViz, Mermaid, PlantUML ou Excalidraw, et des graphiques avec Vega ou Vegalite (voir cet [exemple](https://codimd.apps.education.fr/dJpCzTg0SPyPmbj24SSKbg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/dJpCzTg0SPyPmbj24SSKbg)).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Organiser son fichier source\n- organiser\n- variables fixes\n- plusieurs fichiers\n\n### Variables fixes\n\nSi votre chatbot devient un peu long et complexe, vous pouvez définir des variables fixes dans le YAML.\n\n```\nvariables:\n\tmaVariable1: \"Ceci est ma variable 1\"\n\tmaVariable2: \"Ceci est ma variable 2\"\n```\n\nDans votre contenu en Markdown, vous pourrez alors utiliser vos variables ainsi : &#64;{maVariable1}\n\nLes variables fixes qui ne commencent pas par `_` sont interprétées au moment du déclenchement de la réponse, ce qui permet d'intégrer de l'aléatoire, en séparant les contenus possibles par `///`.\nLes variables fixes qui commencent par `_` sont interprétées au moment de la génération du chatbot, ce qui permet de créer des variables fixes qui intègrent des propositions en fin de message.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/WySjMI5iQKOtTSJ3XhCZBQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/WySjMI5iQKOtTSJ3XhCZBQ)\n\n### Source répartie entre plusieurs fichiers\n\nSi votre chatbot est très long, vous pouvez répartir la source de votre fichier dans plusieurs fichiers. Pour cela, il faut d'abord dupliquer le projet sur la forge.\n\nVous pourrez ensuite modifier le contenu du fichier `data/main.md` et ajouter des dossiers et des fichiers `.md` dans le dossier `data`. Tous les fichiers `.md` dans ce dossier seront combinés pour définir la source du chatbot en exécutant le script python `scripts/combine-scripts.py`. Pensez à minifier ensuite le fichier de sortie `script.min.js`. Si vous utilisez VSCode, la tâche par défaut est déjà définie pour exécuter toutes ces opérations.\n\nVous pouvez également utiliser la fonction “raccourci” afin d'indiquer comme source plusieurs fichiers (en utilisant une _array_ d'URL). \n\n### Structuration du document\n\nSi vous souhaitez pouvoir structurer les propositions en fin de message avec des titres, il faut écrire les options avec le code HTML nécessaire directement et non pas avec la syntaxe Markdown (voir cet [exemple](https://codimd.apps.education.fr/NJs77ZWnQgalVyA6nfuDLQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/NJs77ZWnQgalVyA6nfuDLQ)).\n\nVous pouvez aussi ajouter dans le contenu Markdown des liens vers d'autres réponses, sans générer de bouton en fin de message, avec la syntaxe suivante : `[intitulé du lien]​(#titre de la réponse)`\n\n`titresRéponses: [\"### \", \"#### \"]` dans le YAML permet de changer les identifiants possibles des réponses du chatbot si on veut pouvoir structurer autrement les réponses du chatbot dans son document\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Utiliser ChatMD pour faire des quiz\n- quiz\n\nUn chatbot sert souvent à répondre à des questions, mais on peut aussi utiliser ChatMD pour poser des questions !\n\nSi on veut que l'utilisateur réponde avec le clavier, la directive `!​Next: Titreréponse`, dans le contenu du Markdown, va forcer la redirection vers une réponse particulière : le message de l'utilisateur sera alors comparé aux déclencheurs choisis pour cette réponse ou même au contenu entier de la réponse si on a ajouté `rechercheContenu: true` dans le YAML. Si le message correspond, alors la réponse de l'utilisateur est considérée comme juste (voir cet [exemple](https://codimd.apps.education.fr/sp8dwq5rQGq3pIj2DPBD0A?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/sp8dwq5rQGq3pIj2DPBD0A)).\n\nSi on veut que l'utilisateur réponde en cliquant sur des propositions, on peut utiliser la propriété `obfuscate: true` dans l'en-tête YAML pour cacher le titre des liens, afin d'éviter de donner un indice en survolant un lien (voir cet [exemple](https://codimd.apps.education.fr/hWgravuHTTmfRydTUfjgWQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/hWgravuHTTmfRydTUfjgWQ)).\n\nOn peut aussi introduire de l'aléatoire dans le choix des propositions (voir ci-dessous).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Comment introduire de l'aléatoire ?](option : Introduire de l'aléatoire)\n3. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Introduire de l'aléatoire\n- aléatoire\n\nDans le contenu du Markdown, on peut indiquer plusieurs versions d'une même réponse en les séparant avec le séparateur `-​-​-`. Le chatbot sélectionnera aléatoirement l'une de ces versions.\n\nOn peut également choisir d'afficher seulement les propositions en fin de message de manière aléatoire. Si on met `1. [intitulé]​(lien)` : la proposition reste à la place indiquée, alors que si on met `1) [intitulé]​(lien)` : la proposition est réordonnée de manière aléatoire.\n\nDans le contenu du Markdown, la directive : `!​Select: x` peut être ajoutée juste avant la liste des propositions en fin de message, afin de sélectionner aléatoirement x propositions parmi cette liste (voir cet [exemple](https://codimd.apps.education.fr/f6QP57QNT2S-crAjOwdahg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/f6QP57QNT2S-crAjOwdahg)).\n\nEnfin, la directive `!​SelectNext: titre question 1 / titre question 2 / titre question 3` permet de renvoyer de manière aléatoire vers une question parmi un ensemble de questions qu'on a choisies (voir cet [exemple](https://codimd.apps.education.fr/Yvq5u2btTOmrTFCFoXGTwg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/Yvq5u2btTOmrTFCFoXGTwg)).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Variables dynamiques\n- variables dynamiques\n- conditionnement\n- conditionner\n- paramètres dans l'URL\n- paramètres URL\n\nPour utiliser les variables dynamiques, il faut ajouter `contenuDynamique: true` dans le YAML.\n\nOn peut avoir des variables dynamiques définies selon le parcours de l'utilisateur, et conditionner du contenu en fonction de ces variables.\n\nOn définit une variable soit dans le contenu en Markdown de la réponse, soit dans un bouton de réponse en fin de message. On utilise la syntaxe suivante : `@​mavariable=contenu de ma variable` que l'on place soit dans un bloc code dans le contenu de sa réponse : `&#96@​mavariable=contenu de ma variable&#96`, soit directement dans l'intitulé du lien du bouton de réponse : `1. [intitulé @​mavariable=contenu de ma variable](titre réponse)`.\n\nPour le conditionnement, on commence un bloc code avec `i​f` puis l'ensemble des conditions (par exemple `&#96i​f @​mavariable1 == valeur1 && @​mavariable == valeur2&#96`), puis on met ensuite ce qui doit s'afficher si cette condition est vérifiée, et on termine par un bloc code :  `&#96end​if&#96`.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/1l7Md8q-SjG0yLGHfH4wbg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/1l7Md8q-SjG0yLGHfH4wbg)\n\nOn peut également récupérer des paramètres dans l'URL pour les utiliser ensuite. Chaque paramètre est récupéré dans une variable : `@​GE​Tnomduparamètre` que l'on peut utiliser comme les autres variables dynamiques.\n\nOn peut récupérer le contenu d'un message entré par un utilisateur pour l'assigner à une variable dynamique en utilisant la syntaxe : `@​mavariable  = @​INPUT : Titre réponse`. Le message de l'utilisateur sera assigné à la variable et l'utilisateur sera redirigé automatiquement vers la réponse dont on a indiqué le titre.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/_2I1TWwBT22IML7BsR7sWw?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/_2I1TWwBT22IML7BsR7sWw)\n\nOn peut enfin utiliser des opérations élémentaires pour calculer la valeur d'une variable (afin de calculer un score par exemple). Par exemple, on pourrait écrire : `@​mavariable  = c​alc(@​score+1)` soit dans un bloc code, soit dans un bouton en fin de message. À la place de `c​alc(@​score+1)`, on peut mettre une expression plus complexes avec plusieurs variables dynamiques. Les opérations autorisées sont l'addition, la soustraction, la multiplication, la division, la concaténation (avec le même signe que pour l'addition).\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/6ZFeM407RbyCPxpAxKU8ow?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/6ZFeM407RbyCPxpAxKU8ow)\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Connecter ChatMD à un LLM, faire du RAG\n- LLM\n- RAG\n\nChatMD peut se connecter à un LLM en ligne ou en local : on peut choisir le modèle que l'on souhaite et tout configurer (préprompt, nombre de tokens, etc.). Pour faire appel à ce LLM, on peut soit décider de toujours produire la réponse par le LLM, en prenant en compte les éléments prédéfinis, soit n'utiliser le LLM qu'à des moments bien précis, par exemple pour enrichir une réponse préprogrammée.\n\nChatMD permet également de faire du RAG de manière simplifiée : on peut indiquer des sources d'informations, qui seront utilisées par le LLM pour produire sa réponse.\nCe RAG ne repose pas sur une vectorisation préalable de l'information. On pourrait le faire, mais l'intérêt est ici de ne pas multiplier les appels à une API externe, afin d'avoir un usage plus sobre de l'IA.\n\nPour comprendre comment tout cela fonctionne, le mieux est de regarder ces deux exemples :\n- [Utiliser ChatMD avec un LLM en local](https://codimd.apps.education.fr/unR-D6xRSMOnvySa5-kCdg?both)\n- [Utiliser ChatMD avec un LLM en ligne](https://codimd.apps.education.fr/nVOl6sQKTfqq_OWAUmxcYg?both)\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option: Avoir plusieurs bots différents\n- plusieurs bots\n- plusieurs chatbots\n- plusieurs avatars\n- différents bots\n- différents chatbots\n- différents avatars\n\nOn peut utiliser ChatMD pour gérer plusieurs bots différents.\n\nIl faut d'abord déclarer les bots dans le yaml ainsi :\n\n```\nbots:\n\tnomBot1:\n\t\tavatar: URLimageBot1\n\t\tcssAvatar: \"CSS particulier pour l'avatar du Bot1\"\n\t\tcssMessage: \"CSS particulier pour les messages du Bot1\"\n\tnomBot2:\n\t\tavatar: URLimageBot2\n\t\tcssAvatar: \"CSS particulier pour l'avatar du Bot2\"\n\t\tcssMessage: \"CSS particulier pour les messages du Bot2\"\n```\n\nPour utiliser un bot, on utilise la directive `!​Bot: botName` pour indiquer que la réponse doit être faite par le bot qui a pour nom `botName`.\n\nOn peut même avoir plusieurs bots qui se répondent successivement dans un même message.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/pKXavCOeTfityYVTTS6aMA?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/pKXavCOeTfityYVTTS6aMA)\n\n\n## Exemples\n- exemple\n- donner un exemple\n- concret\n- concrètement\n- modèle\n- template\n\nVoici un modèle que vous pouvez récupérer pour construire votre chatbot : [modèle à récupérer](https://codimd.apps.education.fr/mBGbHStJSVOSrlGfGb981A?both)\n\nVoici quelques exemples de chatbot créés avec ChatMD : \n\n- [Méthode de la dissertation en philosophie](https://chatmd.forge.apps.education.fr/#https://eyssette.forge.apps.education.fr/chatbot/dissertation-philosophie.md)\n- [Utilisation d'un microscope](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/xGNHIJSeTVCk6FHas-_71g) : un chatbot créé à partir du travail de  Sylvain Tissier, Guillaume Berthelot et de Jérémy Navoizat [voir la source](https://codimd.apps.education.fr/xGNHIJSeTVCk6FHas-_71g?both)\n\nN'hésitez pas à partager vos exemples de chatbot avec moi ! Vous pouvez me contacter sur [Mastodon](https://scholar.social/@eyssette).\n\n## Comment intégrer mon chatbot sur un site ?\n- widget\n- dans son site\n- dans mon site\n- intégrer\n- intégration\n- sur mon site\n- sur son site\n- iframe\n\nVous pouvez intégrer chatMD dans votre site de deux manières : soit avec une balise iframe, soit en tant que widget.\n\n### Iframe\nPour utiliser ChatMD avec une balise iframe, vous pouvez utiliser le code suivant (en modifiant le style CSS si nécessaire) :\n\n```html\n<iframe src=https://chatmd.forge.apps.education.fr/#URLDEVOTRECHATBOT\" style=\"border:0; width:100%; height:700px\"></iframe>\n```\n\n### Widget\nPour utiliser ChatMD en tant que widget, il faut avoir accès au HTML et insérer ce code (en bas de page dans l'élément `body`).\n\n```js\n<script id=\"chatmdWidgetScript\" src=\"https://chatmd.forge.apps.education.fr/widget.min.js\" data-chatbot=\"URL_SOURCE_CHATBOT\"><\/script>\n```\n\nIl faut bien sûr remplacer `URL_SOURCE_CHATBOT` par l'URL de la source de votre chatbot.\n\nOn peut customiser l'image du widget en ajoutant `data-image=\"URL_IMAGE\"` comme paramètre.\n\n## Qui a créé ChatMD ?\n- qui\n\nChatMD a été créé par Cédric Eyssette, professeur de philosophie et chargé de projet à la DRANE à Lyon.\n\nC'est un logiciel libre sous licence MIT. Les sources sont disponibles sur [la Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/chatMD/chatMD.forge.apps.education.fr).\n\nChatMD n'aurait pas pu exister sans le soutien institutionnel de la DRANE Lyon et de la DNE, dans le cadre de leur politique de développement des communs numériques et du libre.\n\nMerci également à Perrine Douhéret, Laetitia Allegrini, Romain Estampes, Charlie Rollo, Mélanie Fenaert pour leurs suggestions d'amélioration de l'outil, et merci à toutes les personnes qui ont pu tester ChatMD et me faire des retours !\n\nChatMD est un logiciel libre qui repose également sur d'autres logiciels libres :\n- [js-yaml](https://github.com/nodeca/js-yaml) pour la gestion des en-têtes yaml\n- [typed.js](https://github.com/mattboldt/typed.js) pour l'effet \"machine à écrire\"\n- [showdown](https://github.com/showdownjs/showdown) pour la conversion du markdown en html\n- [leo-profanity](https://github.com/jojoee/leo-profanity) et [french-badwords-list](https://github.com/darwiin/french-badwords-list/) pour la gestion des gros mots\n- [katex](https://katex.org/) pour la gestion des mathématiques en Latex\n- [textFit](https://github.com/STRML/textFit) pour la gestion du redimensionnement automatique (ici : des formules mathématiques en Latex).\n\nSi vous aimez ce travail, vous aimerez peut-être aussi les autres outils ou sites que je propose sur [mon site perso](https://eyssette.forge.apps.education.fr).\n\n\n---\ngestionGrosMots: true\n---\n\n# ChatMD\n\nBonjour, je suis **ChatMD**, un outil libre et gratuit qui permet de créer facilement un chatbot personnalisé à partir d'un simple fichier en Markdown.\n\n:::info C'est très simple !\n1. Créez un fichier en Markdown accessible en ligne.\n2. Respectez la syntaxe de ChatMD pour définir votre chatbot.\n3. Votre chatbot est alors accessible à l'adresse suivante : [https://chatmd.forge.apps.education.fr/#URL](https://chatmd.forge.apps.education.fr/#URL) <br>(Mettez l'url de votre fichier à la place de URL) !\n:::\n\nOn peut imaginer **de nombreux usages** :\n- Tutoriel pour un outil informatique\n- Guide méthodologique\n- Soutien pour la révision d'un cours, quiz interactif,\n- Discussion avec un personnage historique,\n- Histoire dont vous êtes le héros …\n\nLa syntaxe de base est simple, mais ChatMD peut être configuré pour des **usages plus complexes** : personnalisation de l'interface, utilisation de variables, de choix aléatoires, intégration avec un LLM, possibilité de faire du RAG …\n\n1. [Qu'est-ce que le Markdown ?](Markdown)\n2. [Comment créer un fichier en Markdown accessible en ligne ?](Comment créer un fichier en Markdown accessible en ligne ?)\n3. [Quelle syntaxe faut-il respecter pour ChatMD ?](Syntaxe)\n4. [Donne-moi des exemples !](Exemples)\n5. [Quelles sont les options de configuration plus avancées ?](Options de configuration)\n6. [Comment intégrer mon chatbot dans un site ?](Comment intégrer mon chatbot sur un site ?)\n7. [Qui a créé ChatMD ?](Qui a créé ChatMD ?)\n\n## Markdown\n- markdown\n\nLe Markdown est un format de balisage très léger qui permet d'écrire rapidement du texte formaté.\n\nPar exemple on écrit `**texte en gras**` pour écrire du **texte en gras**, ou alors `_texte en italique_` pour écrire du _texte en italique_.\n\nPour découvrir le Markdown, vous pouvez suivre ce [tutoriel](https://www.markdowntutorial.com/fr/).\n\n1. [OK, j'ai compris ce qu'est le Markdown, mais comment créer un fichier en Markdown accessible en ligne ?](Comment créer un fichier en Markdown accessible en ligne ?)\n2. [J'ai compris la syntaxe du Markdown, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## Comment créer un fichier en Markdown accessible en ligne ?\n- codimd\n- codi\n- forge\n- en ligne\n- digipage\n- hedgedoc\n- framapad\n\nIl existe plusieurs services pour créer un fichier Markdown accessible en ligne.\n\nSi vous êtes prof en France et que avez des identifiants académiques, vous pouvez utiliser [CodiMD](https://codimd.apps.education.fr/) sur le [portail Apps Edu](https://portail.apps.education.fr/).\n\nD'autres outils fonctionnent avec ChatMD et notamment : [Digipage](https://digipage.app/) de La Digitale et [Framapad](https://framapad.org/) de Framasoft\n\nIl est également possible d'utiliser la [Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/).\n\n1. [Qu'est-ce qu'une forge ?](forge)\n2. [J'ai compris comment créer mon fichier, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## forge\n- forge\n\nUne forge est un outil qui permet d'héberger des fichiers texte et de les transformer en site web, en carte mentale, ou encore ici en chatbot ! ChatMD est présent sur la [Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/) et vous pouvez aussi mettre vos fichiers sur cette forge.\n\nSi vous êtes prof en France et que vous souhaitez utiliser la forge, rejoignez le [groupe Tchap de LaForgeÉdu](https://www.tchap.gouv.fr/#/room/!fnVhKrpqraWfsSirBK:agent.education.tchap.gouv.fr) pour plus d'explications !\n\n1. [J'ai compris comment créer mon fichier, mais quelle est la syntaxe à respecter pour ChatMD ?](Syntaxe)\n\n## Syntaxe\n- syntaxe\n- règles\n- comment\n\nLa syntaxe pour écrire un chatbot avec chatMD est la suivante, mais c'est peut-être plus simple de [voir des exemples](#Exemples) ou bien de [récupérer un modèle](https://codimd.apps.education.fr/mBGbHStJSVOSrlGfGb981A?both).\n\n```\n​# Titre du chatbot\n​Message initial\n​1​. [Premier choix](Réponse 1)\n2​. [Deuxième choix](Réponse 2)\n​\n​## Réponse 1\n- déclencheur 1 (optionnel)\n- déclencheur 2 (optionnel)\nContenu de la réponse\n​1​. [Proposition 1](Titre Proposition 1)\n2​. [Proposition 2](Titre Proposition 2)\n```\n\nDans le message initial et le contenu de chaque réponse, **on peut utiliser toute la syntaxe Markdown** : intégrer des images, des vidéos, des iframes, et même utiliser des balises HTML.\n\nLes **titres de niveau 2** servent à identifier les réponses possibles du chatbot\n\n### Deux manières pour déclencher une réponse\n\n:::info Avec la souris, l'utilisateur clique sur une proposition\nPour créer des boutons qui déclenchent des réponses quand on clique dessus, il faut utiliser une liste ordonnée en Markdown, qui doit avoir la forme suivante : \n` 1. [intitulé de l'option qui s'affiche pour l'utilisateur](titre de la réponse correspondante dans le fichier en Markdown)`\n:::\n\n:::info Avec le clavier, l'utilisateur pose une question\nPour permettre au chatbot de renvoyer la réponse la plus adéquate, on indique sous le titre de la réponse des déclencheurs (mots clés ou expressions) qui vont renforcer le choix de cette réponse. On utilise une liste non ordonnée en Markdown.\n:::\n\nIl est préférable de combiner ces 2 options pour être sûr que l'utilisateur trouve les réponses à ses questions !\n\n1. [J'ai compris la syntaxe de base, mais quelles sont les options de configuration plus avancées](Options de configuration)\n2. [Si on utilise des déclencheurs, comment fonctionne le choix de la réponse la plus adéquate ?](explication choix réponse adéquate)\n\n## explication choix réponse adéquate\n\nSi on utilise des déclencheurs, ChatMD calcule la réponse la plus adéquate.\n\nCe n'est pas une simple recherche d'occurrences : le calcul intègre une décomposition en tokens et un calcul de distance lexicale.\n\nLa décomposition en tokens permet de retrouver des racines communes et la distance lexicale permet de trouver une réponse malgré des fautes d'orthographe.\n\n## Options de configuration\n- options\n- configuration\n- avancé\n- personnalisation\n- personnaliser\n\nPlusieurs options de configuration sont disponibles !\nLa plupart des options reposent sur l'ajout de paramètres dans l'en-tête YAML du fichier Markdown.\n\nQue voulez-vous faire ?\n\n1. [Améliorer l'algorithme de choix d'une réponse](option : Améliorer l'algorithme)\n2. [Personnaliser l'apparence du chatbot](option : Personnaliser l'apparence)\n3. [Gérer des contenus particuliers : admonitions, mathématiques, schémas, sons …](option : Gérer des contenus particuliers)\n4. [Organiser mon fichier source](option : Organiser son fichier source)\n5. [Utiliser ChatMD pour faire des quiz](option : Utiliser ChatMD pour faire des quiz)\n6. [Introduire de l'aléatoire dans les réponses ou les propositions en fin de message](option : Introduire de l'aléatoire)\n7. [Utiliser des variables dynamiques et du conditionnement en fonction de ces variables](option : Variables dynamiques)\n8. [Connecter ChatMD à un LLM, faire du RAG](option : Connecter ChatMD à un LLM, faire du RAG)\n9. [Avoir plusieurs bots différents](option: Avoir plusieurs bots différents)\n10. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n\n## Explication en-tête yaml\n\nUn en-tête YAML est une section spéciale dans laquelle on déclare certaines variables, qu'un programme comme ChatMD peut ensuite utiliser.\nCet en-tête doit se trouver au tout début du fichier. Il faut commencer et terminer l'en-tête par trois tirets `-​-​-`.\n\nVoici un exemple d'en-tête YAML :\n\n```\n-​-​-\ngestionGrosMots: true\n-​-​-\n```\n\n## option : Améliorer l'algorithme\n- algorithme\n- gros mot\n- insulte\n- message par défaut\n\nPour améliorer l'algorithme de choix d'une réponse, vous pouvez utiliser ces paramètres dans l'en-tête YAML : \n\n- si on ajoute `rechercheContenu: true`, alors l'algorithme ne se contente pas de comparer le message de l'utilisateur avec le titre de la réponse et les déclencheurs, mais il compare aussi ce message avec le contenu entier de la réponse. Attention, dans ce cas, le chatbot peut mettre un peu plus de temps à se charger.\n- `gestionGrosMots: true` permet de détecter les gros mots et les insultes envoyés par l'utilisateur et de formuler une réponse adéquate si l'utilisateur en utilise.\n- `messageParDéfaut: [\"message 1\", \"message 2\", \"message 3\"]` permet de modifier le message par défaut qui s'affiche aléatoirement quand le chatbot n'a pas trouvé de réponse pertinente.\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Personnaliser l'apparence\n- personnaliser l'apparence\n- modifier l'apparence\n- changer l'apparence\n- avatar\n- effet\n- clavier\n- style\n- css\n- thème\n- favicon\n\nPour personnaliser l'apparence du chatbot, vous pouvez utiliser ces paramètres dans l'en-tête YAML :\n\n- `style: a{color:red}` permet d'ajouter des styles CSS personnalisés.\n- `avatar: URL` permet de changer l'avatar du chatbot (il faut mettre l'url de son image à la place de URL)\n- `favicon: URL` permet de changer l'icône du chatbot dans les onglets (il faut mettre l'url de son image à la place de URL)\n- `footer: false` permet de supprimer le pied de page\n- `footer: 'Mon footer'` permet de customiser ce qui apparaît dans le pied de page\n- `theme: bubbles` permet d'utiliser un thème CSS particulier (ici le thème \"bubbles\")\n- `typewriter: false` désactive l'effet “machine à écrire”\n- `clavier: false` désactive le champ d'entrée clavier si on souhaite simplement guider l'utilisateur avec les options proposées en fin de chaque réponse.\n\nSi on veut activer ou désactiver le clavier pour certaines réponses, on met `&#96@​KEYBOARD = true&#96` ou `&#96@​KEYBOARD = false&#96` à l'intérieur de son code markdown pour les réponses en question..\n\nSi on veut désactiver l'effet typewriter pour un passage seulement de son texte, on utilise la syntaxe suivante dans son code markdown : `\\\\&#96texte sans effet typewriter\\\\&#96`\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Gérer des contenus particuliers\n- admonition\n- iframe\n- audio\n- son\n- latex\n- mathématiques\n- schémas\n- h5p\n\n### Admonitions\n\nDans le contenu en Markdown, vous pouvez utiliser des admonitions, c'est-à-dire des encadrés pour mettre en valeur certains contenus. Il faut utiliser la syntaxe suivante : \n```\n:​:​:info\ncontenu\n:​:​:\n```\n\nPlusieurs types d'admonitions sont disponibles (voir cet [exemple](https://codimd.apps.education.fr/9U7L4wpOSmaRFl6aRK-J9Q?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/9U7L4wpOSmaRFl6aRK-J9Q))\n\n### iframes et audio\n\nVous pouvez aussi utiliser :\n1. des iframes pour intégrer des contenus interactifs comme H5P. Attention, il vaut mieux que le contenu en iframe soit le dernier contenu de votre réponse, car sinon votre iframe risque de mettre du temps à s'afficher.\n2. la directive `!​Audio : URLduFichierAudio` pour jouer automatiquement un son lors du déclenchement d'une réponse (voir cet [exemple](https://codimd.apps.education.fr/24OabQgvQ_yPd2WE3DrIEg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/24OabQgvQ_yPd2WE3DrIEg)).\n\n### Latex\n\nPour utiliser le Latex pour les mathématiques, il faut ajouter `maths: true` dans le YAML. On peut alors écrire des formules mathématiques en Latex avec la syntaxe `$Latex$` (à l'intérieur d'un paragraphe) ou `$$Latex$$` (pour un paragraphe à part).\n\t\n### Schémas & graphiques\n\nPour pouvoir générer des schémas et graphiques via le service Kroki, il faut ajouter `addOns: kroki` dans le YAML. Cela permet de générer des schémas avec la syntaxe de Tikz, GraphViz, Mermaid, PlantUML ou Excalidraw, et des graphiques avec Vega ou Vegalite (voir cet [exemple](https://codimd.apps.education.fr/dJpCzTg0SPyPmbj24SSKbg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/dJpCzTg0SPyPmbj24SSKbg)).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option : Organiser son fichier source\n- organiser\n- variables fixes\n- plusieurs fichiers\n\n### Variables fixes\n\nSi votre chatbot devient un peu long et complexe, vous pouvez définir des variables fixes dans le YAML.\n\n```\nvariables:\n\tmaVariable1: \"Ceci est ma variable 1\"\n\tmaVariable2: \"Ceci est ma variable 2\"\n```\n\nDans votre contenu en Markdown, vous pourrez alors utiliser vos variables ainsi : &#64;{maVariable1}\n\nLes variables fixes qui ne commencent pas par `_` sont interprétées au moment du déclenchement de la réponse, ce qui permet d'intégrer de l'aléatoire, en séparant les contenus possibles par `///`.\nLes variables fixes qui commencent par `_` sont interprétées au moment de la génération du chatbot, ce qui permet de créer des variables fixes qui intègrent des propositions en fin de message.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/WySjMI5iQKOtTSJ3XhCZBQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/WySjMI5iQKOtTSJ3XhCZBQ)\n\n### Source répartie entre plusieurs fichiers\n\nSi votre chatbot est très long, vous pouvez répartir la source de votre fichier dans plusieurs fichiers. Pour cela, il faut d'abord dupliquer le projet sur la forge.\n\nVous pourrez ensuite modifier le contenu du fichier `data/main.md` et ajouter des dossiers et des fichiers `.md` dans le dossier `data`. Tous les fichiers `.md` dans ce dossier seront combinés pour définir la source du chatbot en exécutant le script python `scripts/combine-scripts.py`. Pensez à minifier ensuite le fichier de sortie `script.min.js`. Si vous utilisez VSCode, la tâche par défaut est déjà définie pour exécuter toutes ces opérations.\n\nVous pouvez également utiliser la fonction “raccourci” afin d'indiquer comme source plusieurs fichiers (en utilisant une _array_ d'URL). \n\n### Structuration du document\n\nSi vous souhaitez pouvoir structurer les propositions en fin de message avec des titres, il faut écrire les options avec le code HTML nécessaire directement et non pas avec la syntaxe Markdown (voir cet [exemple](https://codimd.apps.education.fr/NJs77ZWnQgalVyA6nfuDLQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/NJs77ZWnQgalVyA6nfuDLQ)).\n\nVous pouvez aussi ajouter dans le contenu Markdown des liens vers d'autres réponses, sans générer de bouton en fin de message, avec la syntaxe suivante : `[intitulé du lien]​(#titre de la réponse)`\n\n`titresRéponses: [\"### \", \"#### \"]` dans le YAML permet de changer les identifiants possibles des réponses du chatbot si on veut pouvoir structurer autrement les réponses du chatbot dans son document\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Utiliser ChatMD pour faire des quiz\n- quiz\n\nUn chatbot sert souvent à répondre à des questions, mais on peut aussi utiliser ChatMD pour poser des questions !\n\nSi on veut que l'utilisateur réponde avec le clavier, la directive `!​Next: Titreréponse`, dans le contenu du Markdown, va forcer la redirection vers une réponse particulière : le message de l'utilisateur sera alors comparé aux déclencheurs choisis pour cette réponse ou même au contenu entier de la réponse si on a ajouté `rechercheContenu: true` dans le YAML. Si le message correspond, alors la réponse de l'utilisateur est considérée comme juste (voir cet [exemple](https://codimd.apps.education.fr/sp8dwq5rQGq3pIj2DPBD0A?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/sp8dwq5rQGq3pIj2DPBD0A)).\n\nSi on veut que l'utilisateur réponde en cliquant sur des propositions, on peut utiliser la propriété `obfuscate: true` dans l'en-tête YAML pour cacher le titre des liens, afin d'éviter de donner un indice en survolant un lien (voir cet [exemple](https://codimd.apps.education.fr/hWgravuHTTmfRydTUfjgWQ?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/hWgravuHTTmfRydTUfjgWQ)).\n\nOn peut aussi introduire de l'aléatoire dans le choix des propositions (voir ci-dessous).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Comment introduire de l'aléatoire ?](option : Introduire de l'aléatoire)\n3. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Introduire de l'aléatoire\n- aléatoire\n\nDans le contenu du Markdown, on peut indiquer plusieurs versions d'une même réponse en les séparant avec le séparateur `-​-​-`. Le chatbot sélectionnera aléatoirement l'une de ces versions.\n\nOn peut également choisir d'afficher seulement les propositions en fin de message de manière aléatoire. Si on met `1. [intitulé]​(lien)` : la proposition reste à la place indiquée, alors que si on met `1) [intitulé]​(lien)` : la proposition est réordonnée de manière aléatoire.\n\nDans le contenu du Markdown, la directive : `!​Select: x` peut être ajoutée juste avant la liste des propositions en fin de message, afin de sélectionner aléatoirement x propositions parmi cette liste (voir cet [exemple](https://codimd.apps.education.fr/f6QP57QNT2S-crAjOwdahg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/f6QP57QNT2S-crAjOwdahg)).\n\nEnfin, la directive `!​SelectNext: titre question 1 / titre question 2 / titre question 3` permet de renvoyer de manière aléatoire vers une question parmi un ensemble de questions qu'on a choisies (voir cet [exemple](https://codimd.apps.education.fr/Yvq5u2btTOmrTFCFoXGTwg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/Yvq5u2btTOmrTFCFoXGTwg)).\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Variables dynamiques\n- variables dynamiques\n- conditionnement\n- conditionner\n- paramètres dans l'URL\n- paramètres URL\n\nPour utiliser les variables dynamiques, il faut ajouter `contenuDynamique: true` dans le YAML.\n\nOn peut avoir des variables dynamiques définies selon le parcours de l'utilisateur, et conditionner du contenu en fonction de ces variables.\n\nOn définit une variable soit dans le contenu en Markdown de la réponse, soit dans un bouton de réponse en fin de message. On utilise la syntaxe suivante : `@​mavariable=contenu de ma variable` que l'on place soit dans un bloc code dans le contenu de sa réponse : `&#96@​mavariable=contenu de ma variable&#96`, soit directement dans l'intitulé du lien du bouton de réponse : `1. [intitulé @​mavariable=contenu de ma variable](titre réponse)`.\n\nPour le conditionnement, on commence un bloc code avec `i​f` puis l'ensemble des conditions (par exemple `&#96i​f @​mavariable1 == valeur1 && @​mavariable == valeur2&#96`), puis on met ensuite ce qui doit s'afficher si cette condition est vérifiée, et on termine par un bloc code :  `&#96end​if&#96`.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/1l7Md8q-SjG0yLGHfH4wbg?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/1l7Md8q-SjG0yLGHfH4wbg)\n\nOn peut également récupérer des paramètres dans l'URL pour les utiliser ensuite. Chaque paramètre est récupéré dans une variable : `@​GE​Tnomduparamètre` que l'on peut utiliser comme les autres variables dynamiques.\n\nOn peut récupérer le contenu d'un message entré par un utilisateur pour l'assigner à une variable dynamique en utilisant la syntaxe : `@​mavariable  = @​INPUT : Titre réponse`. Le message de l'utilisateur sera assigné à la variable et l'utilisateur sera redirigé automatiquement vers la réponse dont on a indiqué le titre.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/_2I1TWwBT22IML7BsR7sWw?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/_2I1TWwBT22IML7BsR7sWw)\n\nOn peut enfin utiliser des opérations élémentaires pour calculer la valeur d'une variable (afin de calculer un score par exemple). Par exemple, on pourrait écrire : `@​mavariable  = c​alc(@​score+1)` soit dans un bloc code, soit dans un bouton en fin de message. À la place de `c​alc(@​score+1)`, on peut mettre une expression plus complexes avec plusieurs variables dynamiques. Les opérations autorisées sont l'addition, la soustraction, la multiplication, la division, la concaténation (avec le même signe que pour l'addition).\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/6ZFeM407RbyCPxpAxKU8ow?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/6ZFeM407RbyCPxpAxKU8ow)\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n\n## option : Connecter ChatMD à un LLM, faire du RAG\n- LLM\n- RAG\n\nChatMD peut se connecter à un LLM en ligne ou en local : on peut choisir le modèle que l'on souhaite et tout configurer (préprompt, nombre de tokens, etc.). Pour faire appel à ce LLM, on peut soit décider de toujours produire la réponse par le LLM, en prenant en compte les éléments prédéfinis, soit n'utiliser le LLM qu'à des moments bien précis, par exemple pour enrichir une réponse préprogrammée.\n\nChatMD permet également de faire du RAG de manière simplifiée : on peut indiquer des sources d'informations, qui seront utilisées par le LLM pour produire sa réponse.\nCe RAG ne repose pas sur une vectorisation préalable de l'information. On pourrait le faire, mais l'intérêt est ici de ne pas multiplier les appels à une API externe, afin d'avoir un usage plus sobre de l'IA.\n\nPour comprendre comment tout cela fonctionne, le mieux est de regarder ces deux exemples :\n- [Utiliser ChatMD avec un LLM en local](https://codimd.apps.education.fr/unR-D6xRSMOnvySa5-kCdg?both)\n- [Utiliser ChatMD avec un LLM en ligne](https://codimd.apps.education.fr/nVOl6sQKTfqq_OWAUmxcYg?both)\n\n1. [Qu'est-ce qu'un en-tête YAML ?](Explication en-tête yaml)\n2. [Je veux voir les autres options de configurations](Options de configuration)\n\n## option: Avoir plusieurs bots différents\n- plusieurs bots\n- plusieurs chatbots\n- plusieurs avatars\n- différents bots\n- différents chatbots\n- différents avatars\n\nOn peut utiliser ChatMD pour gérer plusieurs bots différents.\n\nIl faut d'abord déclarer les bots dans le yaml ainsi :\n\n```\nbots:\n\tnomBot1:\n\t\tavatar: URLimageBot1\n\t\tcssAvatar: \"CSS particulier pour l'avatar du Bot1\"\n\t\tcssMessage: \"CSS particulier pour les messages du Bot1\"\n\tnomBot2:\n\t\tavatar: URLimageBot2\n\t\tcssAvatar: \"CSS particulier pour l'avatar du Bot2\"\n\t\tcssMessage: \"CSS particulier pour les messages du Bot2\"\n```\n\nPour utiliser un bot, on utilise la directive `!​Bot: botName` pour indiquer que la réponse doit être faite par le bot qui a pour nom `botName`.\n\nOn peut même avoir plusieurs bots qui se répondent successivement dans un même message.\n\n&rArr; Voir cet [exemple](https://codimd.apps.education.fr/pKXavCOeTfityYVTTS6aMA?both) et le [chatbot correspondant](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/pKXavCOeTfityYVTTS6aMA)\n\n\n## Exemples\n- exemple\n- donner un exemple\n- concret\n- concrètement\n- modèle\n- template\n\nVoici un modèle que vous pouvez récupérer pour construire votre chatbot : [modèle à récupérer](https://codimd.apps.education.fr/mBGbHStJSVOSrlGfGb981A?both)\n\nVoici quelques exemples de chatbot créés avec ChatMD : \n\n- [Méthode de la dissertation en philosophie](https://chatmd.forge.apps.education.fr/#https://eyssette.forge.apps.education.fr/chatbot/dissertation-philosophie.md)\n- [Utilisation d'un microscope](https://chatmd.forge.apps.education.fr/#https://codimd.apps.education.fr/xGNHIJSeTVCk6FHas-_71g) : un chatbot créé à partir du travail de  Sylvain Tissier, Guillaume Berthelot et de Jérémy Navoizat [voir la source](https://codimd.apps.education.fr/xGNHIJSeTVCk6FHas-_71g?both)\n\nN'hésitez pas à partager vos exemples de chatbot avec moi ! Vous pouvez me contacter sur [Mastodon](https://scholar.social/@eyssette).\n\n## Comment intégrer mon chatbot sur un site ?\n- widget\n- dans son site\n- dans mon site\n- intégrer\n- intégration\n- sur mon site\n- sur son site\n- iframe\n\nVous pouvez intégrer chatMD dans votre site de deux manières : soit avec une balise iframe, soit en tant que widget.\n\n### Iframe\nPour utiliser ChatMD avec une balise iframe, vous pouvez utiliser le code suivant (en modifiant le style CSS si nécessaire) :\n\n```html\n<iframe src=https://chatmd.forge.apps.education.fr/#URLDEVOTRECHATBOT\" style=\"border:0; width:100%; height:700px\"></iframe>\n```\n\n### Widget\nPour utiliser ChatMD en tant que widget, il faut avoir accès au HTML et insérer ce code (en bas de page dans l'élément `body`).\n\n```js\n<script id=\"chatmdWidgetScript\" src=\"https://chatmd.forge.apps.education.fr/widget.min.js\" data-chatbot=\"URL_SOURCE_CHATBOT\"><\/script>\n```\n\nIl faut bien sûr remplacer `URL_SOURCE_CHATBOT` par l'URL de la source de votre chatbot.\n\nOn peut customiser l'image du widget en ajoutant `data-image=\"URL_IMAGE\"` comme paramètre.\n\n## Qui a créé ChatMD ?\n- qui\n\nChatMD a été créé par Cédric Eyssette, professeur de philosophie et chargé de projet à la DRANE à Lyon.\n\nC'est un logiciel libre sous licence MIT. Les sources sont disponibles sur [la Forge des Communs Numériques Éducatifs](https://forge.apps.education.fr/chatMD/chatMD.forge.apps.education.fr).\n\nChatMD n'aurait pas pu exister sans le soutien institutionnel de la DRANE Lyon et de la DNE, dans le cadre de leur politique de développement des communs numériques et du libre.\n\nMerci également à Perrine Douhéret, Laetitia Allegrini, Romain Estampes, Charlie Rollo, Mélanie Fenaert pour leurs suggestions d'amélioration de l'outil, et merci à toutes les personnes qui ont pu tester ChatMD et me faire des retours !\n\nChatMD est un logiciel libre qui repose également sur d'autres logiciels libres :\n- [js-yaml](https://github.com/nodeca/js-yaml) pour la gestion des en-têtes yaml\n- [typed.js](https://github.com/mattboldt/typed.js) pour l'effet \"machine à écrire\"\n- [showdown](https://github.com/showdownjs/showdown) pour la conversion du markdown en html\n- [leo-profanity](https://github.com/jojoee/leo-profanity) et [french-badwords-list](https://github.com/darwiin/french-badwords-list/) pour la gestion des gros mots\n- [katex](https://katex.org/) pour la gestion des mathématiques en Latex\n- [textFit](https://github.com/STRML/textFit) pour la gestion du redimensionnement automatique (ici : des formules mathématiques en Latex).\n\nSi vous aimez ce travail, vous aimerez peut-être aussi les autres outils ou sites que je propose sur [mon site perso](https://eyssette.forge.apps.education.fr).\n\n";function $n(e){Jt(e);let t=[],n=null,a=[],s=[],i=null;const o=/^\d{1,3}(\.|\))\s\[/,l=/^\d{1,3}\)/,u=/\`if (.*?)\`/;let c=!1,p=[],d=[],m=!1,h=e.indexOf("# ");const f=e.indexOf("## ");f>-1&&f==h-1&&(h=0);let g=e.substring(h);Yt.variables&&(g=wn(g,!0));const b=g.substring(1),v=["# ","## ","### ","#### ","##### "].map((e=>b.indexOf(e))).filter((e=>e>0)),_=Math.min(...v),w=g.substring(0,_),k=w.match(/# .*/),y=k?k[0]:"Chatbot",x=y?[y.replace("# ","").trim()]:[""],M=w.indexOf(y),A=(k?w.substring(M+y.length):w.substring(M)).split("\n");for(let e of A)if(e=e.replace(/^>\s?/,"").trim(),o.test(e)){m=l.test(e);const t=e.replace(/^\d+(\.|\))\s/,"").trim();let n=t.replace(/^\[.*?\]\(/,"").replace(/\)$/,"");n=Yt.obfuscate?btoa(n):n;const r=t.replace(/\]\(.*/,"").replace(/^\[/,"");d.push([r,n,m])}else p.push(e);const C=g.substring(_).split("\n");let L="";for(let e of C)if(r(e,Yt.responsesTitles))n&&t.push([n,a,s,i]),n=e.replace(r(e,Yt.responsesTitles),"").trim(),a=[],i=null,c=!1,s=[];else if(e.startsWith("- ")&&!c)a.push(e.replace("- ","").trim());else if(Yt.dynamicContent&&u.test(e))L=e.match(u)[1]?e.match(u)[1]:"",s.push(e+"\n"),c=!0;else if(Yt.dynamicContent&&e.includes("`endif`"))L="",s.push(e+"\n"),c=!0;else if(o.test(e)){c=!1,i||(i=[]),m=l.test(e);const t=e.replace(/^\d+(\.|\))\s/,"").trim();let n=t.replace(/^\[.*?\]\(/,"").replace(/\)$/,"");n=Yt.obfuscate?btoa(n):n;const r=t.replace(/\]\(.*/,"").replace(/^\[/,"");i.push([r,n,m,L])}else e.length>0&&!e.startsWith("# ")&&(e=e.replaceAll(/\[(.*?)\]\((#.*?)\)/g,'<a href="$2">$1</a>'),s.push(e),c=!0);t.push([n,a,s,i]);const S=[p,d];return t.push(S),t.push(x),t}!function(){const e=s(window.location.hash.substring(1).replace(/\?.*/,""));if(""!==e)if(Array.isArray(e)){const t=e.map((e=>fetch(e).then((e=>e.text()))));Promise.all(t).then((e=>{Vn=e.join("\n"),Gn=$n(Vn),Un(Gn)})).catch((e=>console.error(e)))}else fetch(e).then((e=>e.text())).then((e=>{Vn=e,Gn=$n(Vn),Un(Gn)})).catch((e=>console.error(e)));else Un($n(Vn))}()}();
//# sourceMappingURL=script.min.js.map
