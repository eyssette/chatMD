{"version":3,"file":"script.min.js","sources":["js/config.mjs","js/utils/urls.mjs","js/core/chatbot/helpers/fetch.mjs","js/lib/js-yaml.mjs","js/utils/objects.mjs","js/utils/ui.mjs","js/ai/helpers/keyDecoder.mjs","js/shared/selectors.mjs","js/utils/css.mjs","js/markdown/custom/yaml.mjs","js/utils/strings.mjs","js/core/chatbot/getContent.mjs","js/core/chatbot/helpers/validate.mjs","js/core/chatbot/parsers/helpers/detectChoiceOption.mjs","js/core/chatbot/parsers/helpers/detectResponseTitle.mjs","js/core/chatbot/parsers/helpers/processorsChatbotContent.mjs","js/utils/arrays.mjs","js/markdown/custom/variablesFixed.mjs","js/core/chatbot/parseMarkdown.mjs","js/core/chatbot/parsers/helpers/removeYaml.mjs","js/core/chatbot/parsers/extractIntroduction.mjs","js/core/chatbot/parsers/getChatbotInformations.mjs","js/lib/showdown.mjs","js/markdown/parser.mjs","js/utils/nlp.mjs","js/core/interactions/helpers/choiceOptions.mjs","js/markdown/custom/directives/select.mjs","js/lib/typed.mjs","js/core/messages/helpers/scroll.mjs","js/shared/constants.mjs","js/core/messages/typewriter/sanitize.mjs","js/core/messages/typewriter/stop.mjs","js/core/messages/typewriter/start.mjs","js/core/messages/helpers/dom.mjs","js/markdown/latex.mjs","js/core/messages/helpers/plugins/lighbox.mjs","js/core/messages/helpers/plugins/textFitForMathBlocks.mjs","js/core/messages/displayMessage.mjs","js/core/messages/typewriter/checkPreferences.mjs","js/markdown/custom/directives/typewriter.mjs","js/markdown/custom/directives/bot.mjs","js/core/messages/helpers/plugins/waitForKatex.mjs","js/core/messages/helpers/plugins/copyCode.mjs","js/markdown/custom/directives/useLLM/extractMarkdownAndPrompts.mjs","js/ai/helpers/error.mjs","js/ai/helpers/detectApiType.mjs","js/ai/helpers/cohere.mjs","js/ai/helpers/parseChunks.mjs","js/ai/helpers/readStream.mjs","js/ai/getAnswerFromLLM.mjs","js/ai/rag/extractRelevantRAGInfo.mjs","js/core/interactions/helpers/processQuestionToLLM.mjs","js/core/interactions/helpers/getDefaultMessage.mjs","js/core/interactions/helpers/findBestResponse/processFinalResponse.mjs","js/core/interactions/helpers/findBestResponse.mjs","js/core/interactions/helpers/findBestResponse/matchOptionFromLastResponse.mjs","js/core/interactions/helpers/findBestResponse/computeSimilarityScore.mjs","js/core/interactions/getChatbotResponse.mjs","js/core/interactions/helpers/processGoToNextMessage.mjs","js/core/interactions/helpers/processBadWords.mjs","js/ai/rag/sources.mjs","js/ai/rag/prepareChunks.mjs","js/ai/rag/engine.mjs","js/markdown/custom/directives/useLLM/helpers/RAGparser.mjs","js/markdown/custom/directives/useLLM/processPromptWithRAG.mjs","js/utils/dom.mjs","js/markdown/custom/variablesDynamic/extractStructureFromMessage.mjs","js/markdown/custom/variablesDynamic/evaluateExpression.mjs","js/markdown/custom/variablesDynamic/helpers/evaluateSelector.mjs","js/markdown/custom/variablesDynamic/processSimpleBlock.mjs","js/markdown/custom/variablesDynamic/processBlocks.mjs","js/markdown/custom/variablesDynamic/checkConditionalBlock.mjs","js/core/messages/helpers/processConditionalBlocksAtDisplayTime.mjs","js/markdown/custom/variablesDynamic/handleUserMessage.mjs","js/markdown/custom/variablesDynamic/complexDynamicVariables.mjs","js/markdown/custom/variablesDynamic.mjs","js/markdown/custom/variablesDynamic/handleBotMessage.mjs","js/core/messages/helpers/processGeolocation.mjs","js/core/messages/helpers/processVariables.mjs","js/markdown/custom/random.mjs","js/core/messages/helpers/processDirectives.mjs","js/markdown/custom/directives/next.mjs","js/markdown/custom/directives/audio.mjs","js/markdown/custom/directives/selectNext.mjs","js/markdown/custom/directives/keyboard.mjs","js/utils/csv.mjs","js/core/messages/helpers/plugins/readCsv.mjs","js/core/messages/helpers/processPlugins.mjs","js/core/messages/helpers/plugins/processKroki.mjs","js/core/messages/createMessage.mjs","js/markdown/custom/directives/useLLM/processMessageWithPrompt.mjs","js/core/messages/helpers/plugins/scorm.mjs","js/core/interactions/events/helpers/adjustFooterToInputHeight.mjs","js/core/interactions/events/helpers/getNumberOfLines.mjs","js/core/interactions/events/keypress.mjs","js/core/interactions/events/helpers/insertLineBreak.mjs","js/core/interactions/events/click.mjs","js/core/interactions/events/helpers/modal.mjs","js/core/interactions/controlEvents.mjs","js/core/interactions/events/focus.mjs","js/core/interactions/events/paste.mjs","js/core/chatbot/helpers/actions.mjs","js/core/chatbot/initialize.mjs","js/core/chatbot/createChatbot.mjs","js/main.mjs"],"sourcesContent":["export let config = {};\n\nconfig.secureMode = false;\n// Si on utilise le mode sécurisé, il faut indiquer les chatbots qui sont autorisés, soit en utilisant 'authorizedChatbots', soit en utilisant les raccourcis ci-dessous\n// Les raccourcis définis plus bas sont également ajoutés aux chatbots autorisés si on utilise le mode sécurisé\nconfig.authorizedChatbots = [\n\t\"https://codimd.apps.education.fr/d3yEseF3RtWzeW3vcgn4MQ\",\n];\n\nconfig.defaultMessage = [\n\t\"Désolé, je ne comprends pas votre question.\",\n\t\"Pardonnez-moi, mais je ne saisis pas votre demande.\",\n\t\"Excusez-moi, je ne parviens pas à comprendre ce que vous demandez.\",\n\t\"Je suis navré, mais je ne parviens pas à saisir votre question.\",\n\t\"Malheureusement, je ne suis pas en mesure de comprendre votre question.\",\n\t\"Je suis désolé, mais je ne saisis pas votre question.\",\n\t\"Pardonnez-moi, mais je ne saisis pas le sens de votre question.\",\n\t\"Je m'excuse, mais je ne parviens pas à saisir votre demande. Pouvez-vous reformuler votre question, s'il vous plaît ?\",\n\t\"Je ne suis pas sûr de comprendre ce que vous demandez. Pouvez-vous expliquer davantage ?\",\n\t\"Je ne peux pas répondre à votre question telle qu'elle est formulée. Pouvez-vous la poser différemment ?\",\n\t\"Votre question ne semble pas correspondre à mes capacités actuelles. Pourriez-vous la reformuler autrement ?\",\n\t\"Je n'ai malheureusement pas compris votre requête.\",\n\t\"Je suis désolé, je ne suis pas capable de répondre.\",\n\t\"Malheureusement, je ne peux pas répondre à votre question.\",\n\t\"Malheureusement je n'arrive pas à comprendre votre requête.\",\n\t\"Excusez-moi, je ne comprends pas votre requête.\",\n\t\"Excusez-moi, je n'arrive pas à répondre à votre question.\",\n\t\"Je ne parviens pas à répondre à votre requête. Veuillez m'excuser.\",\n];\n\nconfig.badWordsMessage = [\n\t\"Même si je ne suis qu'un chatbot, merci de vous adresser à moi avec un langage approprié\",\n\t\"Je préférerais que nous restions courtois dans notre communication.\",\n\t\"Les insultes ne sont pas nécessaires. Comment puis-je vous aider autrement ?\",\n\t\"Essayons de garder une conversation respectueuse.\",\n\t\"Je préfère une conversation respectueuse et productive.\",\n\t\"Je vous encourage à reformuler votre question ou commentaire de manière respectueuse.\",\n\t\"Les mots offensants ne sont pas nécessaires ici. Comment puis-je vous aider de manière constructive ?\",\n\t\"Restons courtois dans nos échanges, s'il vous plaît.\",\n\t\"Injures et grossièretés ne mènent nulle part. Comment puis-je vous assister ?\",\n\t\"Je suis ouvert à la discussion, mais veuillez garder un langage respectueux.\",\n\t\"Essayons de communiquer de manière civilisée !\",\n];\n\n// Raccourcis vers des chatbots particuliers\nconfig.shortcuts = [\n\t[\n\t\t\"dissertation-philo\",\n\t\t\"https://raw.githubusercontent.com/eyssette/chatbot/main/dissertation-philosophie.md\",\n\t],\n\t[\n\t\t\"orientation\",\n\t\t\"https://codimd.apps.education.fr/UB1xium-TSqpdHEqdxipTw/download\",\n\t],\n\t[\n\t\t\"multiple-urls\",\n\t\t[\n\t\t\t\"https://codimd.apps.education.fr/t7yi1Ak7Q--r2r4oB-3Uhg\",\n\t\t\t\"https://codimd.apps.education.fr/fqjqvdIkQvWD-PVGONrq2g\",\n\t\t],\n\t],\n];\n\nconfig.corsProxy = \"https://corsproxy.io/?url=\";\n\n// Par défaut les titres des réponses sont définis par des titres en markdown niveau 2\nconfig.responsesTitles = [\"## \"];\n\n// Gestion des Plugins\nconfig.allowedPlugins = {\n\tmaths: {\n\t\tjs: \"js/plugins/katex/katex.min.js\",\n\t\tcss: \"js/plugins/katex/katex.min.css\",\n\t},\n\tpako: { js: \"js/plugins/pako.min.js\" },\n\tkroki: { js: \"js/plugins/kroki.js\" },\n\ttextFit: {\n\t\tjs: \"js/plugins/textFit.min.js\",\n\t\tcss: \"<style>.katex-display{max-width:80%} .katex-display .textFitted{white-space:nowrap}</style>\",\n\t},\n\tlightbox: { js: \"js/plugins/lightbox.js\" },\n\treadcsv: { js: \"js/plugins/papaparse.min.js\" },\n};\n\nconfig.pluginDependencies = {\n\tkroki: [\"pako\"],\n};\n\n// Paramètres dans l'en-tête YAML\nconfig.yaml = {\n\tplugins: \"\",\n\tavatar: \"\",\n\tavatarCircle: false,\n\tbots: {},\n\tdetectBadWords: false,\n\tdefaultMessage: config.defaultMessage,\n\tdynamicContent: false,\n\tfavicon: \"\",\n\tfooter: true,\n\tmaths: false,\n\tobfuscate: false,\n\tresponsesTitles: config.responsesTitles,\n\tsearchInContent: false,\n\tstyle: \"\",\n\ttheme: \"\",\n\t//useLLM : défini plus bas\n\ttypeWriter: true,\n\tuserInput: true,\n\tvariables: \"\",\n};\n\n// Paramètres pour l'utilisation d'un LLM\nconst defaultMaxTokens = 300;\nconst defaultSystemPrompt =\n\t\"Tu es un assistant efficace qui réponds en français et pas dans une autre langue. Les phrases de réponse doivent être courtes et claires.\";\nconst defaultPostprompt = \"\\nN'oublie pas de répondre en français.\";\nconst maxProcessingTime = 20000; // Limite de temps de 20 secondes pour la production d'une réponse par un LLM\n\nconfig.yaml.useLLM = {\n\turl: \"\",\n\taskAPIkey: false,\n\tapiKey: \"\", // Attention à ne pas mettre votre apiKey en public !\n\tmodel: \"\",\n\talways: false,\n\tsystemPrompt: defaultSystemPrompt,\n\tmaxTokens: defaultMaxTokens,\n\tpreprompt: \"\",\n\tpostprompt: defaultPostprompt,\n\tmaxProcessingTime: maxProcessingTime,\n};\n\n// Paramètres pour le RAG\nconst defaultRAGprompt = `\nVoici ci-dessous le contexte à partir duquel tu dois prioritairement partir pour construire ta réponse, tu dois sélectionner dans ce contexte l'information qui est en lien avec la question et ne pas parler du reste. Si l'information n'est pas dans le contexte, indique-le et essaie de répondre malgré tout.\nCONTEXTE : `;\n// const defaultRAGpromptStrict = `\n// Voici ci-dessous le contexte à partir duquel tu dois construire ta réponse, tu dois sélectionner dans ce contexte l'information pertinente et ne pas parler du reste. Si la réponse à la question n'est pas dans le contexte, tu ne dois pas répondre et dire : je ne sais pas.\n// CONTEXTE : `;\nconst RAG = {\n\tRAGinformations: \"\",\n\tRAGseparator: \"\\n\",\n\tRAGmaxTopElements: 3,\n\tRAGprompt: defaultRAGprompt,\n};\n\nconfig.yaml.useLLM = { ...config.yaml.useLLM, ...RAG };\n\n// Temps de pause par défaut quand on demande une pause pour l'effet machine à écrire\nconfig.defaultPauseTypeWriter = 300;\n\nconfig.defaultChoiceOptionText = \"suite\";\n","import { config } from \"../config.mjs\";\n\nfunction handleShorcuts(url) {\n\tconst foundShortcut = config.shortcuts.find(\n\t\t([shortcutUrl]) => shortcutUrl === url,\n\t);\n\treturn foundShortcut ? foundShortcut[1] : url;\n}\n\nfunction isAuthorized(url) {\n\treturn config.authorizedChatbots.find((element) => element == url);\n}\n\n// Gestion des fichiers hébergés sur github\nfunction handleURLfromGithub(url) {\n\treturn url\n\t\t.replace(\"https://github.com\", \"https://raw.githubusercontent.com\")\n\t\t.replace(\"/blob/\", \"/\");\n}\n\n// gestion des fichiers hébergés sur codiMD / le pad gouv / hedgedoc / digipage\nfunction isCodimdURL(url) {\n\treturn (\n\t\turl.startsWith(\"https://codimd\") ||\n\t\turl.startsWith(\"https://pad.numerique.gouv.fr/\") ||\n\t\turl.includes(\"hedgedoc\") ||\n\t\turl.includes(\"digipage\")\n\t);\n}\nfunction handleURLfromCodimd(url) {\n\turl = url\n\t\t.replace(\"?edit\", \"\")\n\t\t.replace(\"?both\", \"\")\n\t\t.replace(\"?view\", \"\")\n\t\t.replace(/#$/, \"\")\n\t\t.replace(/\\/$/, \"\");\n\turl = url.indexOf(\"download\") === -1 ? url + \"/download\" : url;\n\treturn url;\n}\n\n// gestion des fichiers hébergés sur framapad ou digidoc\nfunction isFramapadURL(url) {\n\treturn (\n\t\t(url.includes(\"framapad\") || url.includes(\"digidoc\")) &&\n\t\t!url.endsWith(\"/export/txt\")\n\t);\n}\nfunction handleURLfromFramapad(url) {\n\treturn url.replace(/\\?.*/, \"\") + \"/export/txt\";\n}\n\nfunction handleKnownHosts(url, shouldAddCorsProxy) {\n\tif (url.includes(\".forge\")) {\n\t\tshouldAddCorsProxy = false;\n\t} else if (url.startsWith(\"https://github.com\")) {\n\t\tshouldAddCorsProxy = false;\n\t\turl = handleURLfromGithub(url);\n\t} else if (isCodimdURL(url)) {\n\t\tshouldAddCorsProxy = false;\n\t\turl = handleURLfromCodimd(url);\n\t} else if (isFramapadURL(url)) {\n\t\tshouldAddCorsProxy = false;\n\t\turl = handleURLfromFramapad(url);\n\t}\n\treturn { url, shouldAddCorsProxy };\n}\n\nexport function normalizeUrl(url, options) {\n\tlet shouldAddCorsProxy = options && options.useCorsProxy ? true : false;\n\tconst hostResult = handleKnownHosts(url, shouldAddCorsProxy);\n\turl = hostResult.url;\n\tshouldAddCorsProxy = hostResult.shouldAddCorsProxy;\n\treturn shouldAddCorsProxy ? config.corsProxy + url : url;\n}\n\n// Pour gérer l'URL de la source du chatbot\nexport function handleURL(url, options) {\n\tif (!url) return url;\n\n\t// Gestion du mode sécurisé qui ne laisse passer que les chatbots autorisés\n\tif (config.secureMode && !isAuthorized(url)) {\n\t\treturn \"\";\n\t}\n\n\t// Gestion des éventuels raccourcis\n\turl = handleShorcuts(url);\n\n\tif (typeof url == \"string\") {\n\t\treturn normalizeUrl(url, options);\n\t} else {\n\t\treturn url.map((element) => normalizeUrl(element, options));\n\t}\n}\n\n// Pour charger des scripts\nexport function loadScript(src) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst script = document.createElement(\"script\");\n\t\tscript.src = src;\n\t\tscript.onload = resolve;\n\t\tscript.onerror = reject;\n\t\tdocument.head.appendChild(script);\n\t});\n}\n\n// Pour charger des CSS\nexport function loadCSS(src) {\n\treturn new Promise((resolve, reject) => {\n\t\tlet styleElement;\n\t\tif (src.startsWith(\"<style>\")) {\n\t\t\tstyleElement = document.createElement(\"style\");\n\t\t\tstyleElement.textContent = src\n\t\t\t\t.replace(\"<style>\", \"\")\n\t\t\t\t.replace(\"</style>\", \"\");\n\t\t} else {\n\t\t\tstyleElement = document.createElement(\"link\");\n\t\t\tstyleElement.href = src;\n\t\t\tstyleElement.rel = \"stylesheet\";\n\t\t\tstyleElement.onload = resolve;\n\t\t\tstyleElement.onerror = reject;\n\t\t}\n\t\tdocument.head.appendChild(styleElement);\n\t});\n}\n\n// Pour gérer les paramètres dans l'URL\nexport function getParamsFromURL(\n\tqueryString = window.location.search,\n\turlHash = window.location.hash,\n) {\n\tconst paramsFromQuery = Object.fromEntries(new URLSearchParams(queryString));\n\t// Version sécurisée (hashHasParams) : les paramètres sont dans le hash et ne sont donc pas envoyés au serveur\n\tconst hashHasParams = urlHash.includes(\"?\") && urlHash.includes(\"=\");\n\tconst hashQueryPart = hashHasParams ? urlHash.split(\"?\")[1] : \"\";\n\tconst paramsFromHash = hashHasParams\n\t\t? Object.fromEntries(new URLSearchParams(hashQueryPart))\n\t\t: {};\n\n\t// Les paramètres dans le hash (#hash?p=1) écrasent les paramètres classiques dans l'URL (?p=2)\n\treturn {\n\t\t...paramsFromQuery,\n\t\t...paramsFromHash,\n\t};\n}\n\n// Pour ouvrir un nouveau chatbot\nexport function goToNewChatbot(\n\turlNewChatbot,\n\tURLbaseChatbot = window.location.origin + window.location.pathname,\n) {\n\tif (urlNewChatbot && urlNewChatbot.indexOf(\".\") > -1) {\n\t\tURLbaseChatbot =\n\t\t\t!URLbaseChatbot || URLbaseChatbot == \"null\" ? \"\" : URLbaseChatbot;\n\t\tconst fullUrl = URLbaseChatbot + `/#${urlNewChatbot}`;\n\t\twindow.open(fullUrl, \"_blank\");\n\t} else {\n\t\twindow.alert(\"Veuillez entrer une URL valide.\");\n\t}\n}\n","import { config } from \"../../../config.mjs\";\nimport { handleURL } from \"../../../utils/urls.mjs\";\n\n// Pour récupérer le contenu d'un fichier à partir d'une URL directe\nexport async function fetchContent(url) {\n\tconst response = await fetch(url);\n\tif (!response.ok) {\n\t\tthrow new Error(`Erreur lors de la récupération du fichier : ${url}`);\n\t}\n\treturn response.text();\n}\n\n// Pour récupérer le contenu d'un fichier à partir d'une URL en utilisant un proxy si besoin\nexport async function fetchContentWithProxyIfNeeded(url) {\n\ttry {\n\t\t// On essaie de récupérer le contenu directement de l'URL\n\t\treturn await fetchContent(url);\n\t} catch (initialFetchError) {\n\t\ttry {\n\t\t\t// Si cela ne marche pas, on essaie d'ajouter l'extension .md à la fin de l'URL\n\t\t\t// Si on déploie ChatMD avec des fichiers dans son dépôt, on peut alors utiliser des URLs plus significatives, sans avoir à ajouter le .md dans l'URL\n\t\t\treturn await fetchContent(`${url}.md`);\n\t\t} catch (mdFetchError) {\n\t\t\t// Si cela ne marche pas, on reprend l'URL initiale et on essaie avec un proxy CORS\n\t\t\tconst proxiedUrl = config.corsProxy + url;\n\t\t\ttry {\n\t\t\t\treturn await fetchContent(proxiedUrl);\n\t\t\t} catch (proxyFetchError) {\n\t\t\t\tconsole.error(\"Problème avec le fetch initial :\", initialFetchError);\n\t\t\t\tconsole.error(\"Échec de l'ajout de l'extension .md :\", mdFetchError);\n\t\t\t\tconsole.error(\"Échec de l'ajout du proxy :\", proxyFetchError);\n\t\t\t}\n\t\t}\n\t}\n}\n\n// Pour récupérer le contenu de plusieurs fichiers à partir d'un tableau d'URLS\nexport async function fetchContentFromMultipleSources(urls) {\n\tconst contents = await Promise.all(\n\t\turls.map((url) => fetchContent(handleURL(url))),\n\t);\n\treturn contents.join(\"\\n\");\n}\n","\n/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */\nfunction isNothing(subject) {\n\treturn (typeof subject === 'undefined') || (subject === null);\n  }\n  \n  \n  function isObject(subject) {\n\treturn (typeof subject === 'object') && (subject !== null);\n  }\n  \n  \n  function toArray(sequence) {\n\tif (Array.isArray(sequence)) return sequence;\n\telse if (isNothing(sequence)) return [];\n  \n\treturn [ sequence ];\n  }\n  \n  \n  function extend(target, source) {\n\tvar index, length, key, sourceKeys;\n  \n\tif (source) {\n\t  sourceKeys = Object.keys(source);\n  \n\t  for (index = 0, length = sourceKeys.length; index < length; index += 1) {\n\t\tkey = sourceKeys[index];\n\t\ttarget[key] = source[key];\n\t  }\n\t}\n  \n\treturn target;\n  }\n  \n  \n  function repeat(string, count) {\n\tvar result = '', cycle;\n  \n\tfor (cycle = 0; cycle < count; cycle += 1) {\n\t  result += string;\n\t}\n  \n\treturn result;\n  }\n  \n  \n  function isNegativeZero(number) {\n\treturn (number === 0) && (Number.NEGATIVE_INFINITY === 1 / number);\n  }\n  \n  \n  var isNothing_1      = isNothing;\n  var isObject_1       = isObject;\n  var toArray_1        = toArray;\n  var repeat_1         = repeat;\n  var isNegativeZero_1 = isNegativeZero;\n  var extend_1         = extend;\n  \n  var common = {\n\t  isNothing: isNothing_1,\n\t  isObject: isObject_1,\n\t  toArray: toArray_1,\n\t  repeat: repeat_1,\n\t  isNegativeZero: isNegativeZero_1,\n\t  extend: extend_1\n  };\n  \n  // YAML error class. http://stackoverflow.com/questions/8458984\n  \n  \n  function formatError(exception, compact) {\n\tvar where = '', message = exception.reason || '(unknown reason)';\n  \n\tif (!exception.mark) return message;\n  \n\tif (exception.mark.name) {\n\t  where += 'in \"' + exception.mark.name + '\" ';\n\t}\n  \n\twhere += '(' + (exception.mark.line + 1) + ':' + (exception.mark.column + 1) + ')';\n  \n\tif (!compact && exception.mark.snippet) {\n\t  where += '\\n\\n' + exception.mark.snippet;\n\t}\n  \n\treturn message + ' ' + where;\n  }\n  \n  \n  function YAMLException$1(reason, mark) {\n\t// Super constructor\n\tError.call(this);\n  \n\tthis.name = 'YAMLException';\n\tthis.reason = reason;\n\tthis.mark = mark;\n\tthis.message = formatError(this, false);\n  \n\t// Include stack trace in error object\n\tif (Error.captureStackTrace) {\n\t  // Chrome and NodeJS\n\t  Error.captureStackTrace(this, this.constructor);\n\t} else {\n\t  // FF, IE 10+ and Safari 6+. Fallback for others\n\t  this.stack = (new Error()).stack || '';\n\t}\n  }\n  \n  \n  // Inherit from Error\n  YAMLException$1.prototype = Object.create(Error.prototype);\n  YAMLException$1.prototype.constructor = YAMLException$1;\n  \n  \n  YAMLException$1.prototype.toString = function toString(compact) {\n\treturn this.name + ': ' + formatError(this, compact);\n  };\n  \n  \n  var exception = YAMLException$1;\n  \n  // get snippet for a single line, respecting maxLength\n  function getLine(buffer, lineStart, lineEnd, position, maxLineLength) {\n\tvar head = '';\n\tvar tail = '';\n\tvar maxHalfLength = Math.floor(maxLineLength / 2) - 1;\n  \n\tif (position - lineStart > maxHalfLength) {\n\t  head = ' ... ';\n\t  lineStart = position - maxHalfLength + head.length;\n\t}\n  \n\tif (lineEnd - position > maxHalfLength) {\n\t  tail = ' ...';\n\t  lineEnd = position + maxHalfLength - tail.length;\n\t}\n  \n\treturn {\n\t  str: head + buffer.slice(lineStart, lineEnd).replace(/\\t/g, '→') + tail,\n\t  pos: position - lineStart + head.length // relative position\n\t};\n  }\n  \n  \n  function padStart(string, max) {\n\treturn common.repeat(' ', max - string.length) + string;\n  }\n  \n  \n  function makeSnippet(mark, options) {\n\toptions = Object.create(options || null);\n  \n\tif (!mark.buffer) return null;\n  \n\tif (!options.maxLength) options.maxLength = 79;\n\tif (typeof options.indent      !== 'number') options.indent      = 1;\n\tif (typeof options.linesBefore !== 'number') options.linesBefore = 3;\n\tif (typeof options.linesAfter  !== 'number') options.linesAfter  = 2;\n  \n\tvar re = /\\r?\\n|\\r|\\0/g;\n\tvar lineStarts = [ 0 ];\n\tvar lineEnds = [];\n\tvar match;\n\tvar foundLineNo = -1;\n  \n\twhile ((match = re.exec(mark.buffer))) {\n\t  lineEnds.push(match.index);\n\t  lineStarts.push(match.index + match[0].length);\n  \n\t  if (mark.position <= match.index && foundLineNo < 0) {\n\t\tfoundLineNo = lineStarts.length - 2;\n\t  }\n\t}\n  \n\tif (foundLineNo < 0) foundLineNo = lineStarts.length - 1;\n  \n\tvar result = '', i, line;\n\tvar lineNoLength = Math.min(mark.line + options.linesAfter, lineEnds.length).toString().length;\n\tvar maxLineLength = options.maxLength - (options.indent + lineNoLength + 3);\n  \n\tfor (i = 1; i <= options.linesBefore; i++) {\n\t  if (foundLineNo - i < 0) break;\n\t  line = getLine(\n\t\tmark.buffer,\n\t\tlineStarts[foundLineNo - i],\n\t\tlineEnds[foundLineNo - i],\n\t\tmark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo - i]),\n\t\tmaxLineLength\n\t  );\n\t  result = common.repeat(' ', options.indent) + padStart((mark.line - i + 1).toString(), lineNoLength) +\n\t\t' | ' + line.str + '\\n' + result;\n\t}\n  \n\tline = getLine(mark.buffer, lineStarts[foundLineNo], lineEnds[foundLineNo], mark.position, maxLineLength);\n\tresult += common.repeat(' ', options.indent) + padStart((mark.line + 1).toString(), lineNoLength) +\n\t  ' | ' + line.str + '\\n';\n\tresult += common.repeat('-', options.indent + lineNoLength + 3 + line.pos) + '^' + '\\n';\n  \n\tfor (i = 1; i <= options.linesAfter; i++) {\n\t  if (foundLineNo + i >= lineEnds.length) break;\n\t  line = getLine(\n\t\tmark.buffer,\n\t\tlineStarts[foundLineNo + i],\n\t\tlineEnds[foundLineNo + i],\n\t\tmark.position - (lineStarts[foundLineNo] - lineStarts[foundLineNo + i]),\n\t\tmaxLineLength\n\t  );\n\t  result += common.repeat(' ', options.indent) + padStart((mark.line + i + 1).toString(), lineNoLength) +\n\t\t' | ' + line.str + '\\n';\n\t}\n  \n\treturn result.replace(/\\n$/, '');\n  }\n  \n  \n  var snippet = makeSnippet;\n  \n  var TYPE_CONSTRUCTOR_OPTIONS = [\n\t'kind',\n\t'multi',\n\t'resolve',\n\t'construct',\n\t'instanceOf',\n\t'predicate',\n\t'represent',\n\t'representName',\n\t'defaultStyle',\n\t'styleAliases'\n  ];\n  \n  var YAML_NODE_KINDS = [\n\t'scalar',\n\t'sequence',\n\t'mapping'\n  ];\n  \n  function compileStyleAliases(map) {\n\tvar result = {};\n  \n\tif (map !== null) {\n\t  Object.keys(map).forEach(function (style) {\n\t\tmap[style].forEach(function (alias) {\n\t\t  result[String(alias)] = style;\n\t\t});\n\t  });\n\t}\n  \n\treturn result;\n  }\n  \n  function Type$1(tag, options) {\n\toptions = options || {};\n  \n\tObject.keys(options).forEach(function (name) {\n\t  if (TYPE_CONSTRUCTOR_OPTIONS.indexOf(name) === -1) {\n\t\tthrow new exception('Unknown option \"' + name + '\" is met in definition of \"' + tag + '\" YAML type.');\n\t  }\n\t});\n  \n\t// TODO: Add tag format check.\n\tthis.options       = options; // keep original options in case user wants to extend this type later\n\tthis.tag           = tag;\n\tthis.kind          = options['kind']          || null;\n\tthis.resolve       = options['resolve']       || function () { return true; };\n\tthis.construct     = options['construct']     || function (data) { return data; };\n\tthis.instanceOf    = options['instanceOf']    || null;\n\tthis.predicate     = options['predicate']     || null;\n\tthis.represent     = options['represent']     || null;\n\tthis.representName = options['representName'] || null;\n\tthis.defaultStyle  = options['defaultStyle']  || null;\n\tthis.multi         = options['multi']         || false;\n\tthis.styleAliases  = compileStyleAliases(options['styleAliases'] || null);\n  \n\tif (YAML_NODE_KINDS.indexOf(this.kind) === -1) {\n\t  throw new exception('Unknown kind \"' + this.kind + '\" is specified for \"' + tag + '\" YAML type.');\n\t}\n  }\n  \n  var type = Type$1;\n  \n  /*eslint-disable max-len*/\n  \n  \n  \n  \n  \n  function compileList(schema, name) {\n\tvar result = [];\n  \n\tschema[name].forEach(function (currentType) {\n\t  var newIndex = result.length;\n  \n\t  result.forEach(function (previousType, previousIndex) {\n\t\tif (previousType.tag === currentType.tag &&\n\t\t\tpreviousType.kind === currentType.kind &&\n\t\t\tpreviousType.multi === currentType.multi) {\n  \n\t\t  newIndex = previousIndex;\n\t\t}\n\t  });\n  \n\t  result[newIndex] = currentType;\n\t});\n  \n\treturn result;\n  }\n  \n  \n  function compileMap(/* lists... */) {\n\tvar result = {\n\t\t  scalar: {},\n\t\t  sequence: {},\n\t\t  mapping: {},\n\t\t  fallback: {},\n\t\t  multi: {\n\t\t\tscalar: [],\n\t\t\tsequence: [],\n\t\t\tmapping: [],\n\t\t\tfallback: []\n\t\t  }\n\t\t}, index, length;\n  \n\tfunction collectType(type) {\n\t  if (type.multi) {\n\t\tresult.multi[type.kind].push(type);\n\t\tresult.multi['fallback'].push(type);\n\t  } else {\n\t\tresult[type.kind][type.tag] = result['fallback'][type.tag] = type;\n\t  }\n\t}\n  \n\tfor (index = 0, length = arguments.length; index < length; index += 1) {\n\t  arguments[index].forEach(collectType);\n\t}\n\treturn result;\n  }\n  \n  \n  function Schema$1(definition) {\n\treturn this.extend(definition);\n  }\n  \n  \n  Schema$1.prototype.extend = function extend(definition) {\n\tvar implicit = [];\n\tvar explicit = [];\n  \n\tif (definition instanceof type) {\n\t  // Schema.extend(type)\n\t  explicit.push(definition);\n  \n\t} else if (Array.isArray(definition)) {\n\t  // Schema.extend([ type1, type2, ... ])\n\t  explicit = explicit.concat(definition);\n  \n\t} else if (definition && (Array.isArray(definition.implicit) || Array.isArray(definition.explicit))) {\n\t  // Schema.extend({ explicit: [ type1, type2, ... ], implicit: [ type1, type2, ... ] })\n\t  if (definition.implicit) implicit = implicit.concat(definition.implicit);\n\t  if (definition.explicit) explicit = explicit.concat(definition.explicit);\n  \n\t} else {\n\t  throw new exception('Schema.extend argument should be a Type, [ Type ], ' +\n\t\t'or a schema definition ({ implicit: [...], explicit: [...] })');\n\t}\n  \n\timplicit.forEach(function (type$1) {\n\t  if (!(type$1 instanceof type)) {\n\t\tthrow new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n\t  }\n  \n\t  if (type$1.loadKind && type$1.loadKind !== 'scalar') {\n\t\tthrow new exception('There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.');\n\t  }\n  \n\t  if (type$1.multi) {\n\t\tthrow new exception('There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.');\n\t  }\n\t});\n  \n\texplicit.forEach(function (type$1) {\n\t  if (!(type$1 instanceof type)) {\n\t\tthrow new exception('Specified list of YAML types (or a single Type object) contains a non-Type object.');\n\t  }\n\t});\n  \n\tvar result = Object.create(Schema$1.prototype);\n  \n\tresult.implicit = (this.implicit || []).concat(implicit);\n\tresult.explicit = (this.explicit || []).concat(explicit);\n  \n\tresult.compiledImplicit = compileList(result, 'implicit');\n\tresult.compiledExplicit = compileList(result, 'explicit');\n\tresult.compiledTypeMap  = compileMap(result.compiledImplicit, result.compiledExplicit);\n  \n\treturn result;\n  };\n  \n  \n  var schema = Schema$1;\n  \n  var str = new type('tag:yaml.org,2002:str', {\n\tkind: 'scalar',\n\tconstruct: function (data) { return data !== null ? data : ''; }\n  });\n  \n  var seq = new type('tag:yaml.org,2002:seq', {\n\tkind: 'sequence',\n\tconstruct: function (data) { return data !== null ? data : []; }\n  });\n  \n  var map = new type('tag:yaml.org,2002:map', {\n\tkind: 'mapping',\n\tconstruct: function (data) { return data !== null ? data : {}; }\n  });\n  \n  var failsafe = new schema({\n\texplicit: [\n\t  str,\n\t  seq,\n\t  map\n\t]\n  });\n  \n  function resolveYamlNull(data) {\n\tif (data === null) return true;\n  \n\tvar max = data.length;\n  \n\treturn (max === 1 && data === '~') ||\n\t\t   (max === 4 && (data === 'null' || data === 'Null' || data === 'NULL'));\n  }\n  \n  function constructYamlNull() {\n\treturn null;\n  }\n  \n  function isNull(object) {\n\treturn object === null;\n  }\n  \n  var _null = new type('tag:yaml.org,2002:null', {\n\tkind: 'scalar',\n\tresolve: resolveYamlNull,\n\tconstruct: constructYamlNull,\n\tpredicate: isNull,\n\trepresent: {\n\t  canonical: function () { return '~';    },\n\t  lowercase: function () { return 'null'; },\n\t  uppercase: function () { return 'NULL'; },\n\t  camelcase: function () { return 'Null'; },\n\t  empty:     function () { return '';     }\n\t},\n\tdefaultStyle: 'lowercase'\n  });\n  \n  function resolveYamlBoolean(data) {\n\tif (data === null) return false;\n  \n\tvar max = data.length;\n  \n\treturn (max === 4 && (data === 'true' || data === 'True' || data === 'TRUE')) ||\n\t\t   (max === 5 && (data === 'false' || data === 'False' || data === 'FALSE'));\n  }\n  \n  function constructYamlBoolean(data) {\n\treturn data === 'true' ||\n\t\t   data === 'True' ||\n\t\t   data === 'TRUE';\n  }\n  \n  function isBoolean(object) {\n\treturn Object.prototype.toString.call(object) === '[object Boolean]';\n  }\n  \n  var bool = new type('tag:yaml.org,2002:bool', {\n\tkind: 'scalar',\n\tresolve: resolveYamlBoolean,\n\tconstruct: constructYamlBoolean,\n\tpredicate: isBoolean,\n\trepresent: {\n\t  lowercase: function (object) { return object ? 'true' : 'false'; },\n\t  uppercase: function (object) { return object ? 'TRUE' : 'FALSE'; },\n\t  camelcase: function (object) { return object ? 'True' : 'False'; }\n\t},\n\tdefaultStyle: 'lowercase'\n  });\n  \n  function isHexCode(c) {\n\treturn ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) ||\n\t\t   ((0x41/* A */ <= c) && (c <= 0x46/* F */)) ||\n\t\t   ((0x61/* a */ <= c) && (c <= 0x66/* f */));\n  }\n  \n  function isOctCode(c) {\n\treturn ((0x30/* 0 */ <= c) && (c <= 0x37/* 7 */));\n  }\n  \n  function isDecCode(c) {\n\treturn ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */));\n  }\n  \n  function resolveYamlInteger(data) {\n\tif (data === null) return false;\n  \n\tvar max = data.length,\n\t\tindex = 0,\n\t\thasDigits = false,\n\t\tch;\n  \n\tif (!max) return false;\n  \n\tch = data[index];\n  \n\t// sign\n\tif (ch === '-' || ch === '+') {\n\t  ch = data[++index];\n\t}\n  \n\tif (ch === '0') {\n\t  // 0\n\t  if (index + 1 === max) return true;\n\t  ch = data[++index];\n  \n\t  // base 2, base 8, base 16\n  \n\t  if (ch === 'b') {\n\t\t// base 2\n\t\tindex++;\n  \n\t\tfor (; index < max; index++) {\n\t\t  ch = data[index];\n\t\t  if (ch === '_') continue;\n\t\t  if (ch !== '0' && ch !== '1') return false;\n\t\t  hasDigits = true;\n\t\t}\n\t\treturn hasDigits && ch !== '_';\n\t  }\n  \n  \n\t  if (ch === 'x') {\n\t\t// base 16\n\t\tindex++;\n  \n\t\tfor (; index < max; index++) {\n\t\t  ch = data[index];\n\t\t  if (ch === '_') continue;\n\t\t  if (!isHexCode(data.charCodeAt(index))) return false;\n\t\t  hasDigits = true;\n\t\t}\n\t\treturn hasDigits && ch !== '_';\n\t  }\n  \n  \n\t  if (ch === 'o') {\n\t\t// base 8\n\t\tindex++;\n  \n\t\tfor (; index < max; index++) {\n\t\t  ch = data[index];\n\t\t  if (ch === '_') continue;\n\t\t  if (!isOctCode(data.charCodeAt(index))) return false;\n\t\t  hasDigits = true;\n\t\t}\n\t\treturn hasDigits && ch !== '_';\n\t  }\n\t}\n  \n\t// base 10 (except 0)\n  \n\t// value should not start with `_`;\n\tif (ch === '_') return false;\n  \n\tfor (; index < max; index++) {\n\t  ch = data[index];\n\t  if (ch === '_') continue;\n\t  if (!isDecCode(data.charCodeAt(index))) {\n\t\treturn false;\n\t  }\n\t  hasDigits = true;\n\t}\n  \n\t// Should have digits and should not end with `_`\n\tif (!hasDigits || ch === '_') return false;\n  \n\treturn true;\n  }\n  \n  function constructYamlInteger(data) {\n\tvar value = data, sign = 1, ch;\n  \n\tif (value.indexOf('_') !== -1) {\n\t  value = value.replace(/_/g, '');\n\t}\n  \n\tch = value[0];\n  \n\tif (ch === '-' || ch === '+') {\n\t  if (ch === '-') sign = -1;\n\t  value = value.slice(1);\n\t  ch = value[0];\n\t}\n  \n\tif (value === '0') return 0;\n  \n\tif (ch === '0') {\n\t  if (value[1] === 'b') return sign * parseInt(value.slice(2), 2);\n\t  if (value[1] === 'x') return sign * parseInt(value.slice(2), 16);\n\t  if (value[1] === 'o') return sign * parseInt(value.slice(2), 8);\n\t}\n  \n\treturn sign * parseInt(value, 10);\n  }\n  \n  function isInteger(object) {\n\treturn (Object.prototype.toString.call(object)) === '[object Number]' &&\n\t\t   (object % 1 === 0 && !common.isNegativeZero(object));\n  }\n  \n  var int = new type('tag:yaml.org,2002:int', {\n\tkind: 'scalar',\n\tresolve: resolveYamlInteger,\n\tconstruct: constructYamlInteger,\n\tpredicate: isInteger,\n\trepresent: {\n\t  binary:      function (obj) { return obj >= 0 ? '0b' + obj.toString(2) : '-0b' + obj.toString(2).slice(1); },\n\t  octal:       function (obj) { return obj >= 0 ? '0o'  + obj.toString(8) : '-0o'  + obj.toString(8).slice(1); },\n\t  decimal:     function (obj) { return obj.toString(10); },\n\t  /* eslint-disable max-len */\n\t  hexadecimal: function (obj) { return obj >= 0 ? '0x' + obj.toString(16).toUpperCase() :  '-0x' + obj.toString(16).toUpperCase().slice(1); }\n\t},\n\tdefaultStyle: 'decimal',\n\tstyleAliases: {\n\t  binary:      [ 2,  'bin' ],\n\t  octal:       [ 8,  'oct' ],\n\t  decimal:     [ 10, 'dec' ],\n\t  hexadecimal: [ 16, 'hex' ]\n\t}\n  });\n  \n  var YAML_FLOAT_PATTERN = new RegExp(\n\t// 2.5e4, 2.5 and integers\n\t'^(?:[-+]?(?:[0-9][0-9_]*)(?:\\\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?' +\n\t// .2e4, .2\n\t// special case, seems not from spec\n\t'|\\\\.[0-9_]+(?:[eE][-+]?[0-9]+)?' +\n\t// .inf\n\t'|[-+]?\\\\.(?:inf|Inf|INF)' +\n\t// .nan\n\t'|\\\\.(?:nan|NaN|NAN))$');\n  \n  function resolveYamlFloat(data) {\n\tif (data === null) return false;\n  \n\tif (!YAML_FLOAT_PATTERN.test(data) ||\n\t\t// Quick hack to not allow integers end with `_`\n\t\t// Probably should update regexp & check speed\n\t\tdata[data.length - 1] === '_') {\n\t  return false;\n\t}\n  \n\treturn true;\n  }\n  \n  function constructYamlFloat(data) {\n\tvar value, sign;\n  \n\tvalue  = data.replace(/_/g, '').toLowerCase();\n\tsign   = value[0] === '-' ? -1 : 1;\n  \n\tif ('+-'.indexOf(value[0]) >= 0) {\n\t  value = value.slice(1);\n\t}\n  \n\tif (value === '.inf') {\n\t  return (sign === 1) ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n  \n\t} else if (value === '.nan') {\n\t  return NaN;\n\t}\n\treturn sign * parseFloat(value, 10);\n  }\n  \n  \n  var SCIENTIFIC_WITHOUT_DOT = /^[-+]?[0-9]+e/;\n  \n  function representYamlFloat(object, style) {\n\tvar res;\n  \n\tif (isNaN(object)) {\n\t  switch (style) {\n\t\tcase 'lowercase': return '.nan';\n\t\tcase 'uppercase': return '.NAN';\n\t\tcase 'camelcase': return '.NaN';\n\t  }\n\t} else if (Number.POSITIVE_INFINITY === object) {\n\t  switch (style) {\n\t\tcase 'lowercase': return '.inf';\n\t\tcase 'uppercase': return '.INF';\n\t\tcase 'camelcase': return '.Inf';\n\t  }\n\t} else if (Number.NEGATIVE_INFINITY === object) {\n\t  switch (style) {\n\t\tcase 'lowercase': return '-.inf';\n\t\tcase 'uppercase': return '-.INF';\n\t\tcase 'camelcase': return '-.Inf';\n\t  }\n\t} else if (common.isNegativeZero(object)) {\n\t  return '-0.0';\n\t}\n  \n\tres = object.toString(10);\n  \n\t// JS stringifier can build scientific format without dots: 5e-100,\n\t// while YAML requres dot: 5.e-100. Fix it with simple hack\n  \n\treturn SCIENTIFIC_WITHOUT_DOT.test(res) ? res.replace('e', '.e') : res;\n  }\n  \n  function isFloat(object) {\n\treturn (Object.prototype.toString.call(object) === '[object Number]') &&\n\t\t   (object % 1 !== 0 || common.isNegativeZero(object));\n  }\n  \n  var float = new type('tag:yaml.org,2002:float', {\n\tkind: 'scalar',\n\tresolve: resolveYamlFloat,\n\tconstruct: constructYamlFloat,\n\tpredicate: isFloat,\n\trepresent: representYamlFloat,\n\tdefaultStyle: 'lowercase'\n  });\n  \n  var json = failsafe.extend({\n\timplicit: [\n\t  _null,\n\t  bool,\n\t  int,\n\t  float\n\t]\n  });\n  \n  var core = json;\n  \n  var YAML_DATE_REGEXP = new RegExp(\n\t'^([0-9][0-9][0-9][0-9])'          + // [1] year\n\t'-([0-9][0-9])'                    + // [2] month\n\t'-([0-9][0-9])$');                   // [3] day\n  \n  var YAML_TIMESTAMP_REGEXP = new RegExp(\n\t'^([0-9][0-9][0-9][0-9])'          + // [1] year\n\t'-([0-9][0-9]?)'                   + // [2] month\n\t'-([0-9][0-9]?)'                   + // [3] day\n\t'(?:[Tt]|[ \\\\t]+)'                 + // ...\n\t'([0-9][0-9]?)'                    + // [4] hour\n\t':([0-9][0-9])'                    + // [5] minute\n\t':([0-9][0-9])'                    + // [6] second\n\t'(?:\\\\.([0-9]*))?'                 + // [7] fraction\n\t'(?:[ \\\\t]*(Z|([-+])([0-9][0-9]?)' + // [8] tz [9] tz_sign [10] tz_hour\n\t'(?::([0-9][0-9]))?))?$');           // [11] tz_minute\n  \n  function resolveYamlTimestamp(data) {\n\tif (data === null) return false;\n\tif (YAML_DATE_REGEXP.exec(data) !== null) return true;\n\tif (YAML_TIMESTAMP_REGEXP.exec(data) !== null) return true;\n\treturn false;\n  }\n  \n  function constructYamlTimestamp(data) {\n\tvar match, year, month, day, hour, minute, second, fraction = 0,\n\t\tdelta = null, tz_hour, tz_minute, date;\n  \n\tmatch = YAML_DATE_REGEXP.exec(data);\n\tif (match === null) match = YAML_TIMESTAMP_REGEXP.exec(data);\n  \n\tif (match === null) throw new Error('Date resolve error');\n  \n\t// match: [1] year [2] month [3] day\n  \n\tyear = +(match[1]);\n\tmonth = +(match[2]) - 1; // JS month starts with 0\n\tday = +(match[3]);\n  \n\tif (!match[4]) { // no hour\n\t  return new Date(Date.UTC(year, month, day));\n\t}\n  \n\t// match: [4] hour [5] minute [6] second [7] fraction\n  \n\thour = +(match[4]);\n\tminute = +(match[5]);\n\tsecond = +(match[6]);\n  \n\tif (match[7]) {\n\t  fraction = match[7].slice(0, 3);\n\t  while (fraction.length < 3) { // milli-seconds\n\t\tfraction += '0';\n\t  }\n\t  fraction = +fraction;\n\t}\n  \n\t// match: [8] tz [9] tz_sign [10] tz_hour [11] tz_minute\n  \n\tif (match[9]) {\n\t  tz_hour = +(match[10]);\n\t  tz_minute = +(match[11] || 0);\n\t  delta = (tz_hour * 60 + tz_minute) * 60000; // delta in mili-seconds\n\t  if (match[9] === '-') delta = -delta;\n\t}\n  \n\tdate = new Date(Date.UTC(year, month, day, hour, minute, second, fraction));\n  \n\tif (delta) date.setTime(date.getTime() - delta);\n  \n\treturn date;\n  }\n  \n  function representYamlTimestamp(object /*, style*/) {\n\treturn object.toISOString();\n  }\n  \n  var timestamp = new type('tag:yaml.org,2002:timestamp', {\n\tkind: 'scalar',\n\tresolve: resolveYamlTimestamp,\n\tconstruct: constructYamlTimestamp,\n\tinstanceOf: Date,\n\trepresent: representYamlTimestamp\n  });\n  \n  function resolveYamlMerge(data) {\n\treturn data === '<<' || data === null;\n  }\n  \n  var merge = new type('tag:yaml.org,2002:merge', {\n\tkind: 'scalar',\n\tresolve: resolveYamlMerge\n  });\n  \n  /*eslint-disable no-bitwise*/\n  \n  \n  \n  \n  \n  // [ 64, 65, 66 ] -> [ padding, CR, LF ]\n  var BASE64_MAP = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\\n\\r';\n  \n  \n  function resolveYamlBinary(data) {\n\tif (data === null) return false;\n  \n\tvar code, idx, bitlen = 0, max = data.length, map = BASE64_MAP;\n  \n\t// Convert one by one.\n\tfor (idx = 0; idx < max; idx++) {\n\t  code = map.indexOf(data.charAt(idx));\n  \n\t  // Skip CR/LF\n\t  if (code > 64) continue;\n  \n\t  // Fail on illegal characters\n\t  if (code < 0) return false;\n  \n\t  bitlen += 6;\n\t}\n  \n\t// If there are any bits left, source was corrupted\n\treturn (bitlen % 8) === 0;\n  }\n  \n  function constructYamlBinary(data) {\n\tvar idx, tailbits,\n\t\tinput = data.replace(/[\\r\\n=]/g, ''), // remove CR/LF & padding to simplify scan\n\t\tmax = input.length,\n\t\tmap = BASE64_MAP,\n\t\tbits = 0,\n\t\tresult = [];\n  \n\t// Collect by 6*4 bits (3 bytes)\n  \n\tfor (idx = 0; idx < max; idx++) {\n\t  if ((idx % 4 === 0) && idx) {\n\t\tresult.push((bits >> 16) & 0xFF);\n\t\tresult.push((bits >> 8) & 0xFF);\n\t\tresult.push(bits & 0xFF);\n\t  }\n  \n\t  bits = (bits << 6) | map.indexOf(input.charAt(idx));\n\t}\n  \n\t// Dump tail\n  \n\ttailbits = (max % 4) * 6;\n  \n\tif (tailbits === 0) {\n\t  result.push((bits >> 16) & 0xFF);\n\t  result.push((bits >> 8) & 0xFF);\n\t  result.push(bits & 0xFF);\n\t} else if (tailbits === 18) {\n\t  result.push((bits >> 10) & 0xFF);\n\t  result.push((bits >> 2) & 0xFF);\n\t} else if (tailbits === 12) {\n\t  result.push((bits >> 4) & 0xFF);\n\t}\n  \n\treturn new Uint8Array(result);\n  }\n  \n  function representYamlBinary(object /*, style*/) {\n\tvar result = '', bits = 0, idx, tail,\n\t\tmax = object.length,\n\t\tmap = BASE64_MAP;\n  \n\t// Convert every three bytes to 4 ASCII characters.\n  \n\tfor (idx = 0; idx < max; idx++) {\n\t  if ((idx % 3 === 0) && idx) {\n\t\tresult += map[(bits >> 18) & 0x3F];\n\t\tresult += map[(bits >> 12) & 0x3F];\n\t\tresult += map[(bits >> 6) & 0x3F];\n\t\tresult += map[bits & 0x3F];\n\t  }\n  \n\t  bits = (bits << 8) + object[idx];\n\t}\n  \n\t// Dump tail\n  \n\ttail = max % 3;\n  \n\tif (tail === 0) {\n\t  result += map[(bits >> 18) & 0x3F];\n\t  result += map[(bits >> 12) & 0x3F];\n\t  result += map[(bits >> 6) & 0x3F];\n\t  result += map[bits & 0x3F];\n\t} else if (tail === 2) {\n\t  result += map[(bits >> 10) & 0x3F];\n\t  result += map[(bits >> 4) & 0x3F];\n\t  result += map[(bits << 2) & 0x3F];\n\t  result += map[64];\n\t} else if (tail === 1) {\n\t  result += map[(bits >> 2) & 0x3F];\n\t  result += map[(bits << 4) & 0x3F];\n\t  result += map[64];\n\t  result += map[64];\n\t}\n  \n\treturn result;\n  }\n  \n  function isBinary(obj) {\n\treturn Object.prototype.toString.call(obj) ===  '[object Uint8Array]';\n  }\n  \n  var binary = new type('tag:yaml.org,2002:binary', {\n\tkind: 'scalar',\n\tresolve: resolveYamlBinary,\n\tconstruct: constructYamlBinary,\n\tpredicate: isBinary,\n\trepresent: representYamlBinary\n  });\n  \n  var _hasOwnProperty$3 = Object.prototype.hasOwnProperty;\n  var _toString$2       = Object.prototype.toString;\n  \n  function resolveYamlOmap(data) {\n\tif (data === null) return true;\n  \n\tvar objectKeys = [], index, length, pair, pairKey, pairHasKey,\n\t\tobject = data;\n  \n\tfor (index = 0, length = object.length; index < length; index += 1) {\n\t  pair = object[index];\n\t  pairHasKey = false;\n  \n\t  if (_toString$2.call(pair) !== '[object Object]') return false;\n  \n\t  for (pairKey in pair) {\n\t\tif (_hasOwnProperty$3.call(pair, pairKey)) {\n\t\t  if (!pairHasKey) pairHasKey = true;\n\t\t  else return false;\n\t\t}\n\t  }\n  \n\t  if (!pairHasKey) return false;\n  \n\t  if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);\n\t  else return false;\n\t}\n  \n\treturn true;\n  }\n  \n  function constructYamlOmap(data) {\n\treturn data !== null ? data : [];\n  }\n  \n  var omap = new type('tag:yaml.org,2002:omap', {\n\tkind: 'sequence',\n\tresolve: resolveYamlOmap,\n\tconstruct: constructYamlOmap\n  });\n  \n  var _toString$1 = Object.prototype.toString;\n  \n  function resolveYamlPairs(data) {\n\tif (data === null) return true;\n  \n\tvar index, length, pair, keys, result,\n\t\tobject = data;\n  \n\tresult = new Array(object.length);\n  \n\tfor (index = 0, length = object.length; index < length; index += 1) {\n\t  pair = object[index];\n  \n\t  if (_toString$1.call(pair) !== '[object Object]') return false;\n  \n\t  keys = Object.keys(pair);\n  \n\t  if (keys.length !== 1) return false;\n  \n\t  result[index] = [ keys[0], pair[keys[0]] ];\n\t}\n  \n\treturn true;\n  }\n  \n  function constructYamlPairs(data) {\n\tif (data === null) return [];\n  \n\tvar index, length, pair, keys, result,\n\t\tobject = data;\n  \n\tresult = new Array(object.length);\n  \n\tfor (index = 0, length = object.length; index < length; index += 1) {\n\t  pair = object[index];\n  \n\t  keys = Object.keys(pair);\n  \n\t  result[index] = [ keys[0], pair[keys[0]] ];\n\t}\n  \n\treturn result;\n  }\n  \n  var pairs = new type('tag:yaml.org,2002:pairs', {\n\tkind: 'sequence',\n\tresolve: resolveYamlPairs,\n\tconstruct: constructYamlPairs\n  });\n  \n  var _hasOwnProperty$2 = Object.prototype.hasOwnProperty;\n  \n  function resolveYamlSet(data) {\n\tif (data === null) return true;\n  \n\tvar key, object = data;\n  \n\tfor (key in object) {\n\t  if (_hasOwnProperty$2.call(object, key)) {\n\t\tif (object[key] !== null) return false;\n\t  }\n\t}\n  \n\treturn true;\n  }\n  \n  function constructYamlSet(data) {\n\treturn data !== null ? data : {};\n  }\n  \n  var set = new type('tag:yaml.org,2002:set', {\n\tkind: 'mapping',\n\tresolve: resolveYamlSet,\n\tconstruct: constructYamlSet\n  });\n  \n  var _default = core.extend({\n\timplicit: [\n\t  timestamp,\n\t  merge\n\t],\n\texplicit: [\n\t  binary,\n\t  omap,\n\t  pairs,\n\t  set\n\t]\n  });\n  \n  /*eslint-disable max-len,no-use-before-define*/\n  \n  \n  \n  \n  \n  \n  \n  var _hasOwnProperty$1 = Object.prototype.hasOwnProperty;\n  \n  \n  var CONTEXT_FLOW_IN   = 1;\n  var CONTEXT_FLOW_OUT  = 2;\n  var CONTEXT_BLOCK_IN  = 3;\n  var CONTEXT_BLOCK_OUT = 4;\n  \n  \n  var CHOMPING_CLIP  = 1;\n  var CHOMPING_STRIP = 2;\n  var CHOMPING_KEEP  = 3;\n  \n  \n  var PATTERN_NON_PRINTABLE         = /[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x84\\x86-\\x9F\\uFFFE\\uFFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/;\n  var PATTERN_NON_ASCII_LINE_BREAKS = /[\\x85\\u2028\\u2029]/;\n  var PATTERN_FLOW_INDICATORS       = /[,\\[\\]\\{\\}]/;\n  var PATTERN_TAG_HANDLE            = /^(?:!|!!|![a-z\\-]+!)$/i;\n  var PATTERN_TAG_URI               = /^(?:!|[^,\\[\\]\\{\\}])(?:%[0-9a-f]{2}|[0-9a-z\\-#;\\/\\?:@&=\\+\\$,_\\.!~\\*'\\(\\)\\[\\]])*$/i;\n  \n  \n  function _class(obj) { return Object.prototype.toString.call(obj); }\n  \n  function is_EOL(c) {\n\treturn (c === 0x0A/* LF */) || (c === 0x0D/* CR */);\n  }\n  \n  function is_WHITE_SPACE(c) {\n\treturn (c === 0x09/* Tab */) || (c === 0x20/* Space */);\n  }\n  \n  function is_WS_OR_EOL(c) {\n\treturn (c === 0x09/* Tab */) ||\n\t\t   (c === 0x20/* Space */) ||\n\t\t   (c === 0x0A/* LF */) ||\n\t\t   (c === 0x0D/* CR */);\n  }\n  \n  function is_FLOW_INDICATOR(c) {\n\treturn c === 0x2C/* , */ ||\n\t\t   c === 0x5B/* [ */ ||\n\t\t   c === 0x5D/* ] */ ||\n\t\t   c === 0x7B/* { */ ||\n\t\t   c === 0x7D/* } */;\n  }\n  \n  function fromHexCode(c) {\n\tvar lc;\n  \n\tif ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n\t  return c - 0x30;\n\t}\n  \n\t/*eslint-disable no-bitwise*/\n\tlc = c | 0x20;\n  \n\tif ((0x61/* a */ <= lc) && (lc <= 0x66/* f */)) {\n\t  return lc - 0x61 + 10;\n\t}\n  \n\treturn -1;\n  }\n  \n  function escapedHexLen(c) {\n\tif (c === 0x78/* x */) { return 2; }\n\tif (c === 0x75/* u */) { return 4; }\n\tif (c === 0x55/* U */) { return 8; }\n\treturn 0;\n  }\n  \n  function fromDecimalCode(c) {\n\tif ((0x30/* 0 */ <= c) && (c <= 0x39/* 9 */)) {\n\t  return c - 0x30;\n\t}\n  \n\treturn -1;\n  }\n  \n  function simpleEscapeSequence(c) {\n\t/* eslint-disable indent */\n\treturn (c === 0x30/* 0 */) ? '\\x00' :\n\t\t  (c === 0x61/* a */) ? '\\x07' :\n\t\t  (c === 0x62/* b */) ? '\\x08' :\n\t\t  (c === 0x74/* t */) ? '\\x09' :\n\t\t  (c === 0x09/* Tab */) ? '\\x09' :\n\t\t  (c === 0x6E/* n */) ? '\\x0A' :\n\t\t  (c === 0x76/* v */) ? '\\x0B' :\n\t\t  (c === 0x66/* f */) ? '\\x0C' :\n\t\t  (c === 0x72/* r */) ? '\\x0D' :\n\t\t  (c === 0x65/* e */) ? '\\x1B' :\n\t\t  (c === 0x20/* Space */) ? ' ' :\n\t\t  (c === 0x22/* \" */) ? '\\x22' :\n\t\t  (c === 0x2F/* / */) ? '/' :\n\t\t  (c === 0x5C/* \\ */) ? '\\x5C' :\n\t\t  (c === 0x4E/* N */) ? '\\x85' :\n\t\t  (c === 0x5F/* _ */) ? '\\xA0' :\n\t\t  (c === 0x4C/* L */) ? '\\u2028' :\n\t\t  (c === 0x50/* P */) ? '\\u2029' : '';\n  }\n  \n  function charFromCodepoint(c) {\n\tif (c <= 0xFFFF) {\n\t  return String.fromCharCode(c);\n\t}\n\t// Encode UTF-16 surrogate pair\n\t// https://en.wikipedia.org/wiki/UTF-16#Code_points_U.2B010000_to_U.2B10FFFF\n\treturn String.fromCharCode(\n\t  ((c - 0x010000) >> 10) + 0xD800,\n\t  ((c - 0x010000) & 0x03FF) + 0xDC00\n\t);\n  }\n  \n  var simpleEscapeCheck = new Array(256); // integer, for fast access\n  var simpleEscapeMap = new Array(256);\n  for (var i = 0; i < 256; i++) {\n\tsimpleEscapeCheck[i] = simpleEscapeSequence(i) ? 1 : 0;\n\tsimpleEscapeMap[i] = simpleEscapeSequence(i);\n  }\n  \n  \n  function State$1(input, options) {\n\tthis.input = input;\n  \n\tthis.filename  = options['filename']  || null;\n\tthis.schema    = options['schema']    || _default;\n\tthis.onWarning = options['onWarning'] || null;\n\t// (Hidden) Remove? makes the loader to expect YAML 1.1 documents\n\t// if such documents have no explicit %YAML directive\n\tthis.legacy    = options['legacy']    || false;\n  \n\tthis.json      = options['json']      || false;\n\tthis.listener  = options['listener']  || null;\n  \n\tthis.implicitTypes = this.schema.compiledImplicit;\n\tthis.typeMap       = this.schema.compiledTypeMap;\n  \n\tthis.length     = input.length;\n\tthis.position   = 0;\n\tthis.line       = 0;\n\tthis.lineStart  = 0;\n\tthis.lineIndent = 0;\n  \n\t// position of first leading tab in the current line,\n\t// used to make sure there are no tabs in the indentation\n\tthis.firstTabInLine = -1;\n  \n\tthis.documents = [];\n  \n\t/*\n\tthis.version;\n\tthis.checkLineBreaks;\n\tthis.tagMap;\n\tthis.anchorMap;\n\tthis.tag;\n\tthis.anchor;\n\tthis.kind;\n\tthis.result;*/\n  \n  }\n  \n  \n  function generateError(state, message) {\n\tvar mark = {\n\t  name:     state.filename,\n\t  buffer:   state.input.slice(0, -1), // omit trailing \\0\n\t  position: state.position,\n\t  line:     state.line,\n\t  column:   state.position - state.lineStart\n\t};\n  \n\tmark.snippet = snippet(mark);\n  \n\treturn new exception(message, mark);\n  }\n  \n  function throwError(state, message) {\n\tthrow generateError(state, message);\n  }\n  \n  function throwWarning(state, message) {\n\tif (state.onWarning) {\n\t  state.onWarning.call(null, generateError(state, message));\n\t}\n  }\n  \n  \n  var directiveHandlers = {\n  \n\tYAML: function handleYamlDirective(state, name, args) {\n  \n\t  var match, major, minor;\n  \n\t  if (state.version !== null) {\n\t\tthrowError(state, 'duplication of %YAML directive');\n\t  }\n  \n\t  if (args.length !== 1) {\n\t\tthrowError(state, 'YAML directive accepts exactly one argument');\n\t  }\n  \n\t  match = /^([0-9]+)\\.([0-9]+)$/.exec(args[0]);\n  \n\t  if (match === null) {\n\t\tthrowError(state, 'ill-formed argument of the YAML directive');\n\t  }\n  \n\t  major = parseInt(match[1], 10);\n\t  minor = parseInt(match[2], 10);\n  \n\t  if (major !== 1) {\n\t\tthrowError(state, 'unacceptable YAML version of the document');\n\t  }\n  \n\t  state.version = args[0];\n\t  state.checkLineBreaks = (minor < 2);\n  \n\t  if (minor !== 1 && minor !== 2) {\n\t\tthrowWarning(state, 'unsupported YAML version of the document');\n\t  }\n\t},\n  \n\tTAG: function handleTagDirective(state, name, args) {\n  \n\t  var handle, prefix;\n  \n\t  if (args.length !== 2) {\n\t\tthrowError(state, 'TAG directive accepts exactly two arguments');\n\t  }\n  \n\t  handle = args[0];\n\t  prefix = args[1];\n  \n\t  if (!PATTERN_TAG_HANDLE.test(handle)) {\n\t\tthrowError(state, 'ill-formed tag handle (first argument) of the TAG directive');\n\t  }\n  \n\t  if (_hasOwnProperty$1.call(state.tagMap, handle)) {\n\t\tthrowError(state, 'there is a previously declared suffix for \"' + handle + '\" tag handle');\n\t  }\n  \n\t  if (!PATTERN_TAG_URI.test(prefix)) {\n\t\tthrowError(state, 'ill-formed tag prefix (second argument) of the TAG directive');\n\t  }\n  \n\t  try {\n\t\tprefix = decodeURIComponent(prefix);\n\t  } catch (err) {\n\t\tthrowError(state, 'tag prefix is malformed: ' + prefix);\n\t  }\n  \n\t  state.tagMap[handle] = prefix;\n\t}\n  };\n  \n  \n  function captureSegment(state, start, end, checkJson) {\n\tvar _position, _length, _character, _result;\n  \n\tif (start < end) {\n\t  _result = state.input.slice(start, end);\n  \n\t  if (checkJson) {\n\t\tfor (_position = 0, _length = _result.length; _position < _length; _position += 1) {\n\t\t  _character = _result.charCodeAt(_position);\n\t\t  if (!(_character === 0x09 ||\n\t\t\t\t(0x20 <= _character && _character <= 0x10FFFF))) {\n\t\t\tthrowError(state, 'expected valid JSON character');\n\t\t  }\n\t\t}\n\t  } else if (PATTERN_NON_PRINTABLE.test(_result)) {\n\t\tthrowError(state, 'the stream contains non-printable characters');\n\t  }\n  \n\t  state.result += _result;\n\t}\n  }\n  \n  function mergeMappings(state, destination, source, overridableKeys) {\n\tvar sourceKeys, key, index, quantity;\n  \n\tif (!common.isObject(source)) {\n\t  throwError(state, 'cannot merge mappings; the provided source object is unacceptable');\n\t}\n  \n\tsourceKeys = Object.keys(source);\n  \n\tfor (index = 0, quantity = sourceKeys.length; index < quantity; index += 1) {\n\t  key = sourceKeys[index];\n  \n\t  if (!_hasOwnProperty$1.call(destination, key)) {\n\t\tdestination[key] = source[key];\n\t\toverridableKeys[key] = true;\n\t  }\n\t}\n  }\n  \n  function storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode,\n\tstartLine, startLineStart, startPos) {\n  \n\tvar index, quantity;\n  \n\t// The output is a plain object here, so keys can only be strings.\n\t// We need to convert keyNode to a string, but doing so can hang the process\n\t// (deeply nested arrays that explode exponentially using aliases).\n\tif (Array.isArray(keyNode)) {\n\t  keyNode = Array.prototype.slice.call(keyNode);\n  \n\t  for (index = 0, quantity = keyNode.length; index < quantity; index += 1) {\n\t\tif (Array.isArray(keyNode[index])) {\n\t\t  throwError(state, 'nested arrays are not supported inside keys');\n\t\t}\n  \n\t\tif (typeof keyNode === 'object' && _class(keyNode[index]) === '[object Object]') {\n\t\t  keyNode[index] = '[object Object]';\n\t\t}\n\t  }\n\t}\n  \n\t// Avoid code execution in load() via toString property\n\t// (still use its own toString for arrays, timestamps,\n\t// and whatever user schema extensions happen to have @@toStringTag)\n\tif (typeof keyNode === 'object' && _class(keyNode) === '[object Object]') {\n\t  keyNode = '[object Object]';\n\t}\n  \n  \n\tkeyNode = String(keyNode);\n  \n\tif (_result === null) {\n\t  _result = {};\n\t}\n  \n\tif (keyTag === 'tag:yaml.org,2002:merge') {\n\t  if (Array.isArray(valueNode)) {\n\t\tfor (index = 0, quantity = valueNode.length; index < quantity; index += 1) {\n\t\t  mergeMappings(state, _result, valueNode[index], overridableKeys);\n\t\t}\n\t  } else {\n\t\tmergeMappings(state, _result, valueNode, overridableKeys);\n\t  }\n\t} else {\n\t  if (!state.json &&\n\t\t  !_hasOwnProperty$1.call(overridableKeys, keyNode) &&\n\t\t  _hasOwnProperty$1.call(_result, keyNode)) {\n\t\tstate.line = startLine || state.line;\n\t\tstate.lineStart = startLineStart || state.lineStart;\n\t\tstate.position = startPos || state.position;\n\t\tthrowError(state, 'duplicated mapping key');\n\t  }\n  \n\t  // used for this specific key only because Object.defineProperty is slow\n\t  if (keyNode === '__proto__') {\n\t\tObject.defineProperty(_result, keyNode, {\n\t\t  configurable: true,\n\t\t  enumerable: true,\n\t\t  writable: true,\n\t\t  value: valueNode\n\t\t});\n\t  } else {\n\t\t_result[keyNode] = valueNode;\n\t  }\n\t  delete overridableKeys[keyNode];\n\t}\n  \n\treturn _result;\n  }\n  \n  function readLineBreak(state) {\n\tvar ch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch === 0x0A/* LF */) {\n\t  state.position++;\n\t} else if (ch === 0x0D/* CR */) {\n\t  state.position++;\n\t  if (state.input.charCodeAt(state.position) === 0x0A/* LF */) {\n\t\tstate.position++;\n\t  }\n\t} else {\n\t  throwError(state, 'a line break is expected');\n\t}\n  \n\tstate.line += 1;\n\tstate.lineStart = state.position;\n\tstate.firstTabInLine = -1;\n  }\n  \n  function skipSeparationSpace(state, allowComments, checkIndent) {\n\tvar lineBreaks = 0,\n\t\tch = state.input.charCodeAt(state.position);\n  \n\twhile (ch !== 0) {\n\t  while (is_WHITE_SPACE(ch)) {\n\t\tif (ch === 0x09/* Tab */ && state.firstTabInLine === -1) {\n\t\t  state.firstTabInLine = state.position;\n\t\t}\n\t\tch = state.input.charCodeAt(++state.position);\n\t  }\n  \n\t  if (allowComments && ch === 0x23/* # */) {\n\t\tdo {\n\t\t  ch = state.input.charCodeAt(++state.position);\n\t\t} while (ch !== 0x0A/* LF */ && ch !== 0x0D/* CR */ && ch !== 0);\n\t  }\n  \n\t  if (is_EOL(ch)) {\n\t\treadLineBreak(state);\n  \n\t\tch = state.input.charCodeAt(state.position);\n\t\tlineBreaks++;\n\t\tstate.lineIndent = 0;\n  \n\t\twhile (ch === 0x20/* Space */) {\n\t\t  state.lineIndent++;\n\t\t  ch = state.input.charCodeAt(++state.position);\n\t\t}\n\t  } else {\n\t\tbreak;\n\t  }\n\t}\n  \n\tif (checkIndent !== -1 && lineBreaks !== 0 && state.lineIndent < checkIndent) {\n\t  throwWarning(state, 'deficient indentation');\n\t}\n  \n\treturn lineBreaks;\n  }\n  \n  function testDocumentSeparator(state) {\n\tvar _position = state.position,\n\t\tch;\n  \n\tch = state.input.charCodeAt(_position);\n  \n\t// Condition state.position === state.lineStart is tested\n\t// in parent on each call, for efficiency. No needs to test here again.\n\tif ((ch === 0x2D/* - */ || ch === 0x2E/* . */) &&\n\t\tch === state.input.charCodeAt(_position + 1) &&\n\t\tch === state.input.charCodeAt(_position + 2)) {\n  \n\t  _position += 3;\n  \n\t  ch = state.input.charCodeAt(_position);\n  \n\t  if (ch === 0 || is_WS_OR_EOL(ch)) {\n\t\treturn true;\n\t  }\n\t}\n  \n\treturn false;\n  }\n  \n  function writeFoldedLines(state, count) {\n\tif (count === 1) {\n\t  state.result += ' ';\n\t} else if (count > 1) {\n\t  state.result += common.repeat('\\n', count - 1);\n\t}\n  }\n  \n  \n  function readPlainScalar(state, nodeIndent, withinFlowCollection) {\n\tvar preceding,\n\t\tfollowing,\n\t\tcaptureStart,\n\t\tcaptureEnd,\n\t\thasPendingContent,\n\t\t_line,\n\t\t_lineStart,\n\t\t_lineIndent,\n\t\t_kind = state.kind,\n\t\t_result = state.result,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (is_WS_OR_EOL(ch)      ||\n\t\tis_FLOW_INDICATOR(ch) ||\n\t\tch === 0x23/* # */    ||\n\t\tch === 0x26/* & */    ||\n\t\tch === 0x2A/* * */    ||\n\t\tch === 0x21/* ! */    ||\n\t\tch === 0x7C/* | */    ||\n\t\tch === 0x3E/* > */    ||\n\t\tch === 0x27/* ' */    ||\n\t\tch === 0x22/* \" */    ||\n\t\tch === 0x25/* % */    ||\n\t\tch === 0x40/* @ */    ||\n\t\tch === 0x60/* ` */) {\n\t  return false;\n\t}\n  \n\tif (ch === 0x3F/* ? */ || ch === 0x2D/* - */) {\n\t  following = state.input.charCodeAt(state.position + 1);\n  \n\t  if (is_WS_OR_EOL(following) ||\n\t\t  withinFlowCollection && is_FLOW_INDICATOR(following)) {\n\t\treturn false;\n\t  }\n\t}\n  \n\tstate.kind = 'scalar';\n\tstate.result = '';\n\tcaptureStart = captureEnd = state.position;\n\thasPendingContent = false;\n  \n\twhile (ch !== 0) {\n\t  if (ch === 0x3A/* : */) {\n\t\tfollowing = state.input.charCodeAt(state.position + 1);\n  \n\t\tif (is_WS_OR_EOL(following) ||\n\t\t\twithinFlowCollection && is_FLOW_INDICATOR(following)) {\n\t\t  break;\n\t\t}\n  \n\t  } else if (ch === 0x23/* # */) {\n\t\tpreceding = state.input.charCodeAt(state.position - 1);\n  \n\t\tif (is_WS_OR_EOL(preceding)) {\n\t\t  break;\n\t\t}\n  \n\t  } else if ((state.position === state.lineStart && testDocumentSeparator(state)) ||\n\t\t\t\t withinFlowCollection && is_FLOW_INDICATOR(ch)) {\n\t\tbreak;\n  \n\t  } else if (is_EOL(ch)) {\n\t\t_line = state.line;\n\t\t_lineStart = state.lineStart;\n\t\t_lineIndent = state.lineIndent;\n\t\tskipSeparationSpace(state, false, -1);\n  \n\t\tif (state.lineIndent >= nodeIndent) {\n\t\t  hasPendingContent = true;\n\t\t  ch = state.input.charCodeAt(state.position);\n\t\t  continue;\n\t\t} else {\n\t\t  state.position = captureEnd;\n\t\t  state.line = _line;\n\t\t  state.lineStart = _lineStart;\n\t\t  state.lineIndent = _lineIndent;\n\t\t  break;\n\t\t}\n\t  }\n  \n\t  if (hasPendingContent) {\n\t\tcaptureSegment(state, captureStart, captureEnd, false);\n\t\twriteFoldedLines(state, state.line - _line);\n\t\tcaptureStart = captureEnd = state.position;\n\t\thasPendingContent = false;\n\t  }\n  \n\t  if (!is_WHITE_SPACE(ch)) {\n\t\tcaptureEnd = state.position + 1;\n\t  }\n  \n\t  ch = state.input.charCodeAt(++state.position);\n\t}\n  \n\tcaptureSegment(state, captureStart, captureEnd, false);\n  \n\tif (state.result) {\n\t  return true;\n\t}\n  \n\tstate.kind = _kind;\n\tstate.result = _result;\n\treturn false;\n  }\n  \n  function readSingleQuotedScalar(state, nodeIndent) {\n\tvar ch,\n\t\tcaptureStart, captureEnd;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch !== 0x27/* ' */) {\n\t  return false;\n\t}\n  \n\tstate.kind = 'scalar';\n\tstate.result = '';\n\tstate.position++;\n\tcaptureStart = captureEnd = state.position;\n  \n\twhile ((ch = state.input.charCodeAt(state.position)) !== 0) {\n\t  if (ch === 0x27/* ' */) {\n\t\tcaptureSegment(state, captureStart, state.position, true);\n\t\tch = state.input.charCodeAt(++state.position);\n  \n\t\tif (ch === 0x27/* ' */) {\n\t\t  captureStart = state.position;\n\t\t  state.position++;\n\t\t  captureEnd = state.position;\n\t\t} else {\n\t\t  return true;\n\t\t}\n  \n\t  } else if (is_EOL(ch)) {\n\t\tcaptureSegment(state, captureStart, captureEnd, true);\n\t\twriteFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n\t\tcaptureStart = captureEnd = state.position;\n  \n\t  } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\t\tthrowError(state, 'unexpected end of the document within a single quoted scalar');\n  \n\t  } else {\n\t\tstate.position++;\n\t\tcaptureEnd = state.position;\n\t  }\n\t}\n  \n\tthrowError(state, 'unexpected end of the stream within a single quoted scalar');\n  }\n  \n  function readDoubleQuotedScalar(state, nodeIndent) {\n\tvar captureStart,\n\t\tcaptureEnd,\n\t\thexLength,\n\t\thexResult,\n\t\ttmp,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch !== 0x22/* \" */) {\n\t  return false;\n\t}\n  \n\tstate.kind = 'scalar';\n\tstate.result = '';\n\tstate.position++;\n\tcaptureStart = captureEnd = state.position;\n  \n\twhile ((ch = state.input.charCodeAt(state.position)) !== 0) {\n\t  if (ch === 0x22/* \" */) {\n\t\tcaptureSegment(state, captureStart, state.position, true);\n\t\tstate.position++;\n\t\treturn true;\n  \n\t  } else if (ch === 0x5C/* \\ */) {\n\t\tcaptureSegment(state, captureStart, state.position, true);\n\t\tch = state.input.charCodeAt(++state.position);\n  \n\t\tif (is_EOL(ch)) {\n\t\t  skipSeparationSpace(state, false, nodeIndent);\n  \n\t\t  // TODO: rework to inline fn with no type cast?\n\t\t} else if (ch < 256 && simpleEscapeCheck[ch]) {\n\t\t  state.result += simpleEscapeMap[ch];\n\t\t  state.position++;\n  \n\t\t} else if ((tmp = escapedHexLen(ch)) > 0) {\n\t\t  hexLength = tmp;\n\t\t  hexResult = 0;\n  \n\t\t  for (; hexLength > 0; hexLength--) {\n\t\t\tch = state.input.charCodeAt(++state.position);\n  \n\t\t\tif ((tmp = fromHexCode(ch)) >= 0) {\n\t\t\t  hexResult = (hexResult << 4) + tmp;\n  \n\t\t\t} else {\n\t\t\t  throwError(state, 'expected hexadecimal character');\n\t\t\t}\n\t\t  }\n  \n\t\t  state.result += charFromCodepoint(hexResult);\n  \n\t\t  state.position++;\n  \n\t\t} else {\n\t\t  throwError(state, 'unknown escape sequence');\n\t\t}\n  \n\t\tcaptureStart = captureEnd = state.position;\n  \n\t  } else if (is_EOL(ch)) {\n\t\tcaptureSegment(state, captureStart, captureEnd, true);\n\t\twriteFoldedLines(state, skipSeparationSpace(state, false, nodeIndent));\n\t\tcaptureStart = captureEnd = state.position;\n  \n\t  } else if (state.position === state.lineStart && testDocumentSeparator(state)) {\n\t\tthrowError(state, 'unexpected end of the document within a double quoted scalar');\n  \n\t  } else {\n\t\tstate.position++;\n\t\tcaptureEnd = state.position;\n\t  }\n\t}\n  \n\tthrowError(state, 'unexpected end of the stream within a double quoted scalar');\n  }\n  \n  function readFlowCollection(state, nodeIndent) {\n\tvar readNext = true,\n\t\t_line,\n\t\t_lineStart,\n\t\t_pos,\n\t\t_tag     = state.tag,\n\t\t_result,\n\t\t_anchor  = state.anchor,\n\t\tfollowing,\n\t\tterminator,\n\t\tisPair,\n\t\tisExplicitPair,\n\t\tisMapping,\n\t\toverridableKeys = Object.create(null),\n\t\tkeyNode,\n\t\tkeyTag,\n\t\tvalueNode,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch === 0x5B/* [ */) {\n\t  terminator = 0x5D;/* ] */\n\t  isMapping = false;\n\t  _result = [];\n\t} else if (ch === 0x7B/* { */) {\n\t  terminator = 0x7D;/* } */\n\t  isMapping = true;\n\t  _result = {};\n\t} else {\n\t  return false;\n\t}\n  \n\tif (state.anchor !== null) {\n\t  state.anchorMap[state.anchor] = _result;\n\t}\n  \n\tch = state.input.charCodeAt(++state.position);\n  \n\twhile (ch !== 0) {\n\t  skipSeparationSpace(state, true, nodeIndent);\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  if (ch === terminator) {\n\t\tstate.position++;\n\t\tstate.tag = _tag;\n\t\tstate.anchor = _anchor;\n\t\tstate.kind = isMapping ? 'mapping' : 'sequence';\n\t\tstate.result = _result;\n\t\treturn true;\n\t  } else if (!readNext) {\n\t\tthrowError(state, 'missed comma between flow collection entries');\n\t  } else if (ch === 0x2C/* , */) {\n\t\t// \"flow collection entries can never be completely empty\", as per YAML 1.2, section 7.4\n\t\tthrowError(state, \"expected the node content, but found ','\");\n\t  }\n  \n\t  keyTag = keyNode = valueNode = null;\n\t  isPair = isExplicitPair = false;\n  \n\t  if (ch === 0x3F/* ? */) {\n\t\tfollowing = state.input.charCodeAt(state.position + 1);\n  \n\t\tif (is_WS_OR_EOL(following)) {\n\t\t  isPair = isExplicitPair = true;\n\t\t  state.position++;\n\t\t  skipSeparationSpace(state, true, nodeIndent);\n\t\t}\n\t  }\n  \n\t  _line = state.line; // Save the current line.\n\t  _lineStart = state.lineStart;\n\t  _pos = state.position;\n\t  composeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n\t  keyTag = state.tag;\n\t  keyNode = state.result;\n\t  skipSeparationSpace(state, true, nodeIndent);\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  if ((isExplicitPair || state.line === _line) && ch === 0x3A/* : */) {\n\t\tisPair = true;\n\t\tch = state.input.charCodeAt(++state.position);\n\t\tskipSeparationSpace(state, true, nodeIndent);\n\t\tcomposeNode(state, nodeIndent, CONTEXT_FLOW_IN, false, true);\n\t\tvalueNode = state.result;\n\t  }\n  \n\t  if (isMapping) {\n\t\tstoreMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos);\n\t  } else if (isPair) {\n\t\t_result.push(storeMappingPair(state, null, overridableKeys, keyTag, keyNode, valueNode, _line, _lineStart, _pos));\n\t  } else {\n\t\t_result.push(keyNode);\n\t  }\n  \n\t  skipSeparationSpace(state, true, nodeIndent);\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  if (ch === 0x2C/* , */) {\n\t\treadNext = true;\n\t\tch = state.input.charCodeAt(++state.position);\n\t  } else {\n\t\treadNext = false;\n\t  }\n\t}\n  \n\tthrowError(state, 'unexpected end of the stream within a flow collection');\n  }\n  \n  function readBlockScalar(state, nodeIndent) {\n\tvar captureStart,\n\t\tfolding,\n\t\tchomping       = CHOMPING_CLIP,\n\t\tdidReadContent = false,\n\t\tdetectedIndent = false,\n\t\ttextIndent     = nodeIndent,\n\t\temptyLines     = 0,\n\t\tatMoreIndented = false,\n\t\ttmp,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch === 0x7C/* | */) {\n\t  folding = false;\n\t} else if (ch === 0x3E/* > */) {\n\t  folding = true;\n\t} else {\n\t  return false;\n\t}\n  \n\tstate.kind = 'scalar';\n\tstate.result = '';\n  \n\twhile (ch !== 0) {\n\t  ch = state.input.charCodeAt(++state.position);\n  \n\t  if (ch === 0x2B/* + */ || ch === 0x2D/* - */) {\n\t\tif (CHOMPING_CLIP === chomping) {\n\t\t  chomping = (ch === 0x2B/* + */) ? CHOMPING_KEEP : CHOMPING_STRIP;\n\t\t} else {\n\t\t  throwError(state, 'repeat of a chomping mode identifier');\n\t\t}\n  \n\t  } else if ((tmp = fromDecimalCode(ch)) >= 0) {\n\t\tif (tmp === 0) {\n\t\t  throwError(state, 'bad explicit indentation width of a block scalar; it cannot be less than one');\n\t\t} else if (!detectedIndent) {\n\t\t  textIndent = nodeIndent + tmp - 1;\n\t\t  detectedIndent = true;\n\t\t} else {\n\t\t  throwError(state, 'repeat of an indentation width identifier');\n\t\t}\n  \n\t  } else {\n\t\tbreak;\n\t  }\n\t}\n  \n\tif (is_WHITE_SPACE(ch)) {\n\t  do { ch = state.input.charCodeAt(++state.position); }\n\t  while (is_WHITE_SPACE(ch));\n  \n\t  if (ch === 0x23/* # */) {\n\t\tdo { ch = state.input.charCodeAt(++state.position); }\n\t\twhile (!is_EOL(ch) && (ch !== 0));\n\t  }\n\t}\n  \n\twhile (ch !== 0) {\n\t  readLineBreak(state);\n\t  state.lineIndent = 0;\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  while ((!detectedIndent || state.lineIndent < textIndent) &&\n\t\t\t (ch === 0x20/* Space */)) {\n\t\tstate.lineIndent++;\n\t\tch = state.input.charCodeAt(++state.position);\n\t  }\n  \n\t  if (!detectedIndent && state.lineIndent > textIndent) {\n\t\ttextIndent = state.lineIndent;\n\t  }\n  \n\t  if (is_EOL(ch)) {\n\t\temptyLines++;\n\t\tcontinue;\n\t  }\n  \n\t  // End of the scalar.\n\t  if (state.lineIndent < textIndent) {\n  \n\t\t// Perform the chomping.\n\t\tif (chomping === CHOMPING_KEEP) {\n\t\t  state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\t\t} else if (chomping === CHOMPING_CLIP) {\n\t\t  if (didReadContent) { // i.e. only if the scalar is not empty.\n\t\t\tstate.result += '\\n';\n\t\t  }\n\t\t}\n  \n\t\t// Break this `while` cycle and go to the funciton's epilogue.\n\t\tbreak;\n\t  }\n  \n\t  // Folded style: use fancy rules to handle line breaks.\n\t  if (folding) {\n  \n\t\t// Lines starting with white space characters (more-indented lines) are not folded.\n\t\tif (is_WHITE_SPACE(ch)) {\n\t\t  atMoreIndented = true;\n\t\t  // except for the first content line (cf. Example 8.1)\n\t\t  state.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n  \n\t\t// End of more-indented block.\n\t\t} else if (atMoreIndented) {\n\t\t  atMoreIndented = false;\n\t\t  state.result += common.repeat('\\n', emptyLines + 1);\n  \n\t\t// Just one line break - perceive as the same line.\n\t\t} else if (emptyLines === 0) {\n\t\t  if (didReadContent) { // i.e. only if we have already read some scalar content.\n\t\t\tstate.result += ' ';\n\t\t  }\n  \n\t\t// Several line breaks - perceive as different lines.\n\t\t} else {\n\t\t  state.result += common.repeat('\\n', emptyLines);\n\t\t}\n  \n\t  // Literal style: just add exact number of line breaks between content lines.\n\t  } else {\n\t\t// Keep all line breaks except the header line break.\n\t\tstate.result += common.repeat('\\n', didReadContent ? 1 + emptyLines : emptyLines);\n\t  }\n  \n\t  didReadContent = true;\n\t  detectedIndent = true;\n\t  emptyLines = 0;\n\t  captureStart = state.position;\n  \n\t  while (!is_EOL(ch) && (ch !== 0)) {\n\t\tch = state.input.charCodeAt(++state.position);\n\t  }\n  \n\t  captureSegment(state, captureStart, state.position, false);\n\t}\n  \n\treturn true;\n  }\n  \n  function readBlockSequence(state, nodeIndent) {\n\tvar _line,\n\t\t_tag      = state.tag,\n\t\t_anchor   = state.anchor,\n\t\t_result   = [],\n\t\tfollowing,\n\t\tdetected  = false,\n\t\tch;\n  \n\t// there is a leading tab before this token, so it can't be a block sequence/mapping;\n\t// it can still be flow sequence/mapping or a scalar\n\tif (state.firstTabInLine !== -1) return false;\n  \n\tif (state.anchor !== null) {\n\t  state.anchorMap[state.anchor] = _result;\n\t}\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\twhile (ch !== 0) {\n\t  if (state.firstTabInLine !== -1) {\n\t\tstate.position = state.firstTabInLine;\n\t\tthrowError(state, 'tab characters must not be used in indentation');\n\t  }\n  \n\t  if (ch !== 0x2D/* - */) {\n\t\tbreak;\n\t  }\n  \n\t  following = state.input.charCodeAt(state.position + 1);\n  \n\t  if (!is_WS_OR_EOL(following)) {\n\t\tbreak;\n\t  }\n  \n\t  detected = true;\n\t  state.position++;\n  \n\t  if (skipSeparationSpace(state, true, -1)) {\n\t\tif (state.lineIndent <= nodeIndent) {\n\t\t  _result.push(null);\n\t\t  ch = state.input.charCodeAt(state.position);\n\t\t  continue;\n\t\t}\n\t  }\n  \n\t  _line = state.line;\n\t  composeNode(state, nodeIndent, CONTEXT_BLOCK_IN, false, true);\n\t  _result.push(state.result);\n\t  skipSeparationSpace(state, true, -1);\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n\t\tthrowError(state, 'bad indentation of a sequence entry');\n\t  } else if (state.lineIndent < nodeIndent) {\n\t\tbreak;\n\t  }\n\t}\n  \n\tif (detected) {\n\t  state.tag = _tag;\n\t  state.anchor = _anchor;\n\t  state.kind = 'sequence';\n\t  state.result = _result;\n\t  return true;\n\t}\n\treturn false;\n  }\n  \n  function readBlockMapping(state, nodeIndent, flowIndent) {\n\tvar following,\n\t\tallowCompact,\n\t\t_line,\n\t\t_keyLine,\n\t\t_keyLineStart,\n\t\t_keyPos,\n\t\t_tag          = state.tag,\n\t\t_anchor       = state.anchor,\n\t\t_result       = {},\n\t\toverridableKeys = Object.create(null),\n\t\tkeyTag        = null,\n\t\tkeyNode       = null,\n\t\tvalueNode     = null,\n\t\tatExplicitKey = false,\n\t\tdetected      = false,\n\t\tch;\n  \n\t// there is a leading tab before this token, so it can't be a block sequence/mapping;\n\t// it can still be flow sequence/mapping or a scalar\n\tif (state.firstTabInLine !== -1) return false;\n  \n\tif (state.anchor !== null) {\n\t  state.anchorMap[state.anchor] = _result;\n\t}\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\twhile (ch !== 0) {\n\t  if (!atExplicitKey && state.firstTabInLine !== -1) {\n\t\tstate.position = state.firstTabInLine;\n\t\tthrowError(state, 'tab characters must not be used in indentation');\n\t  }\n  \n\t  following = state.input.charCodeAt(state.position + 1);\n\t  _line = state.line; // Save the current line.\n  \n\t  //\n\t  // Explicit notation case. There are two separate blocks:\n\t  // first for the key (denoted by \"?\") and second for the value (denoted by \":\")\n\t  //\n\t  if ((ch === 0x3F/* ? */ || ch === 0x3A/* : */) && is_WS_OR_EOL(following)) {\n  \n\t\tif (ch === 0x3F/* ? */) {\n\t\t  if (atExplicitKey) {\n\t\t\tstoreMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n\t\t\tkeyTag = keyNode = valueNode = null;\n\t\t  }\n  \n\t\t  detected = true;\n\t\t  atExplicitKey = true;\n\t\t  allowCompact = true;\n  \n\t\t} else if (atExplicitKey) {\n\t\t  // i.e. 0x3A/* : */ === character after the explicit key.\n\t\t  atExplicitKey = false;\n\t\t  allowCompact = true;\n  \n\t\t} else {\n\t\t  throwError(state, 'incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line');\n\t\t}\n  \n\t\tstate.position += 1;\n\t\tch = following;\n  \n\t  //\n\t  // Implicit notation case. Flow-style node as the key first, then \":\", and the value.\n\t  //\n\t  } else {\n\t\t_keyLine = state.line;\n\t\t_keyLineStart = state.lineStart;\n\t\t_keyPos = state.position;\n  \n\t\tif (!composeNode(state, flowIndent, CONTEXT_FLOW_OUT, false, true)) {\n\t\t  // Neither implicit nor explicit notation.\n\t\t  // Reading is done. Go to the epilogue.\n\t\t  break;\n\t\t}\n  \n\t\tif (state.line === _line) {\n\t\t  ch = state.input.charCodeAt(state.position);\n  \n\t\t  while (is_WHITE_SPACE(ch)) {\n\t\t\tch = state.input.charCodeAt(++state.position);\n\t\t  }\n  \n\t\t  if (ch === 0x3A/* : */) {\n\t\t\tch = state.input.charCodeAt(++state.position);\n  \n\t\t\tif (!is_WS_OR_EOL(ch)) {\n\t\t\t  throwError(state, 'a whitespace character is expected after the key-value separator within a block mapping');\n\t\t\t}\n  \n\t\t\tif (atExplicitKey) {\n\t\t\t  storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n\t\t\t  keyTag = keyNode = valueNode = null;\n\t\t\t}\n  \n\t\t\tdetected = true;\n\t\t\tatExplicitKey = false;\n\t\t\tallowCompact = false;\n\t\t\tkeyTag = state.tag;\n\t\t\tkeyNode = state.result;\n  \n\t\t  } else if (detected) {\n\t\t\tthrowError(state, 'can not read an implicit mapping pair; a colon is missed');\n  \n\t\t  } else {\n\t\t\tstate.tag = _tag;\n\t\t\tstate.anchor = _anchor;\n\t\t\treturn true; // Keep the result of `composeNode`.\n\t\t  }\n  \n\t\t} else if (detected) {\n\t\t  throwError(state, 'can not read a block mapping entry; a multiline key may not be an implicit key');\n  \n\t\t} else {\n\t\t  state.tag = _tag;\n\t\t  state.anchor = _anchor;\n\t\t  return true; // Keep the result of `composeNode`.\n\t\t}\n\t  }\n  \n\t  //\n\t  // Common reading code for both explicit and implicit notations.\n\t  //\n\t  if (state.line === _line || state.lineIndent > nodeIndent) {\n\t\tif (atExplicitKey) {\n\t\t  _keyLine = state.line;\n\t\t  _keyLineStart = state.lineStart;\n\t\t  _keyPos = state.position;\n\t\t}\n  \n\t\tif (composeNode(state, nodeIndent, CONTEXT_BLOCK_OUT, true, allowCompact)) {\n\t\t  if (atExplicitKey) {\n\t\t\tkeyNode = state.result;\n\t\t  } else {\n\t\t\tvalueNode = state.result;\n\t\t  }\n\t\t}\n  \n\t\tif (!atExplicitKey) {\n\t\t  storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, valueNode, _keyLine, _keyLineStart, _keyPos);\n\t\t  keyTag = keyNode = valueNode = null;\n\t\t}\n  \n\t\tskipSeparationSpace(state, true, -1);\n\t\tch = state.input.charCodeAt(state.position);\n\t  }\n  \n\t  if ((state.line === _line || state.lineIndent > nodeIndent) && (ch !== 0)) {\n\t\tthrowError(state, 'bad indentation of a mapping entry');\n\t  } else if (state.lineIndent < nodeIndent) {\n\t\tbreak;\n\t  }\n\t}\n  \n\t//\n\t// Epilogue.\n\t//\n  \n\t// Special case: last mapping's node contains only the key in explicit notation.\n\tif (atExplicitKey) {\n\t  storeMappingPair(state, _result, overridableKeys, keyTag, keyNode, null, _keyLine, _keyLineStart, _keyPos);\n\t}\n  \n\t// Expose the resulting mapping.\n\tif (detected) {\n\t  state.tag = _tag;\n\t  state.anchor = _anchor;\n\t  state.kind = 'mapping';\n\t  state.result = _result;\n\t}\n  \n\treturn detected;\n  }\n  \n  function readTagProperty(state) {\n\tvar _position,\n\t\tisVerbatim = false,\n\t\tisNamed    = false,\n\t\ttagHandle,\n\t\ttagName,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch !== 0x21/* ! */) return false;\n  \n\tif (state.tag !== null) {\n\t  throwError(state, 'duplication of a tag property');\n\t}\n  \n\tch = state.input.charCodeAt(++state.position);\n  \n\tif (ch === 0x3C/* < */) {\n\t  isVerbatim = true;\n\t  ch = state.input.charCodeAt(++state.position);\n  \n\t} else if (ch === 0x21/* ! */) {\n\t  isNamed = true;\n\t  tagHandle = '!!';\n\t  ch = state.input.charCodeAt(++state.position);\n  \n\t} else {\n\t  tagHandle = '!';\n\t}\n  \n\t_position = state.position;\n  \n\tif (isVerbatim) {\n\t  do { ch = state.input.charCodeAt(++state.position); }\n\t  while (ch !== 0 && ch !== 0x3E/* > */);\n  \n\t  if (state.position < state.length) {\n\t\ttagName = state.input.slice(_position, state.position);\n\t\tch = state.input.charCodeAt(++state.position);\n\t  } else {\n\t\tthrowError(state, 'unexpected end of the stream within a verbatim tag');\n\t  }\n\t} else {\n\t  while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n  \n\t\tif (ch === 0x21/* ! */) {\n\t\t  if (!isNamed) {\n\t\t\ttagHandle = state.input.slice(_position - 1, state.position + 1);\n  \n\t\t\tif (!PATTERN_TAG_HANDLE.test(tagHandle)) {\n\t\t\t  throwError(state, 'named tag handle cannot contain such characters');\n\t\t\t}\n  \n\t\t\tisNamed = true;\n\t\t\t_position = state.position + 1;\n\t\t  } else {\n\t\t\tthrowError(state, 'tag suffix cannot contain exclamation marks');\n\t\t  }\n\t\t}\n  \n\t\tch = state.input.charCodeAt(++state.position);\n\t  }\n  \n\t  tagName = state.input.slice(_position, state.position);\n  \n\t  if (PATTERN_FLOW_INDICATORS.test(tagName)) {\n\t\tthrowError(state, 'tag suffix cannot contain flow indicator characters');\n\t  }\n\t}\n  \n\tif (tagName && !PATTERN_TAG_URI.test(tagName)) {\n\t  throwError(state, 'tag name cannot contain such characters: ' + tagName);\n\t}\n  \n\ttry {\n\t  tagName = decodeURIComponent(tagName);\n\t} catch (err) {\n\t  throwError(state, 'tag name is malformed: ' + tagName);\n\t}\n  \n\tif (isVerbatim) {\n\t  state.tag = tagName;\n  \n\t} else if (_hasOwnProperty$1.call(state.tagMap, tagHandle)) {\n\t  state.tag = state.tagMap[tagHandle] + tagName;\n  \n\t} else if (tagHandle === '!') {\n\t  state.tag = '!' + tagName;\n  \n\t} else if (tagHandle === '!!') {\n\t  state.tag = 'tag:yaml.org,2002:' + tagName;\n  \n\t} else {\n\t  throwError(state, 'undeclared tag handle \"' + tagHandle + '\"');\n\t}\n  \n\treturn true;\n  }\n  \n  function readAnchorProperty(state) {\n\tvar _position,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch !== 0x26/* & */) return false;\n  \n\tif (state.anchor !== null) {\n\t  throwError(state, 'duplication of an anchor property');\n\t}\n  \n\tch = state.input.charCodeAt(++state.position);\n\t_position = state.position;\n  \n\twhile (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n\t  ch = state.input.charCodeAt(++state.position);\n\t}\n  \n\tif (state.position === _position) {\n\t  throwError(state, 'name of an anchor node must contain at least one character');\n\t}\n  \n\tstate.anchor = state.input.slice(_position, state.position);\n\treturn true;\n  }\n  \n  function readAlias(state) {\n\tvar _position, alias,\n\t\tch;\n  \n\tch = state.input.charCodeAt(state.position);\n  \n\tif (ch !== 0x2A/* * */) return false;\n  \n\tch = state.input.charCodeAt(++state.position);\n\t_position = state.position;\n  \n\twhile (ch !== 0 && !is_WS_OR_EOL(ch) && !is_FLOW_INDICATOR(ch)) {\n\t  ch = state.input.charCodeAt(++state.position);\n\t}\n  \n\tif (state.position === _position) {\n\t  throwError(state, 'name of an alias node must contain at least one character');\n\t}\n  \n\talias = state.input.slice(_position, state.position);\n  \n\tif (!_hasOwnProperty$1.call(state.anchorMap, alias)) {\n\t  throwError(state, 'unidentified alias \"' + alias + '\"');\n\t}\n  \n\tstate.result = state.anchorMap[alias];\n\tskipSeparationSpace(state, true, -1);\n\treturn true;\n  }\n  \n  function composeNode(state, parentIndent, nodeContext, allowToSeek, allowCompact) {\n\tvar allowBlockStyles,\n\t\tallowBlockScalars,\n\t\tallowBlockCollections,\n\t\tindentStatus = 1, // 1: this>parent, 0: this=parent, -1: this<parent\n\t\tatNewLine  = false,\n\t\thasContent = false,\n\t\ttypeIndex,\n\t\ttypeQuantity,\n\t\ttypeList,\n\t\ttype,\n\t\tflowIndent,\n\t\tblockIndent;\n  \n\tif (state.listener !== null) {\n\t  state.listener('open', state);\n\t}\n  \n\tstate.tag    = null;\n\tstate.anchor = null;\n\tstate.kind   = null;\n\tstate.result = null;\n  \n\tallowBlockStyles = allowBlockScalars = allowBlockCollections =\n\t  CONTEXT_BLOCK_OUT === nodeContext ||\n\t  CONTEXT_BLOCK_IN  === nodeContext;\n  \n\tif (allowToSeek) {\n\t  if (skipSeparationSpace(state, true, -1)) {\n\t\tatNewLine = true;\n  \n\t\tif (state.lineIndent > parentIndent) {\n\t\t  indentStatus = 1;\n\t\t} else if (state.lineIndent === parentIndent) {\n\t\t  indentStatus = 0;\n\t\t} else if (state.lineIndent < parentIndent) {\n\t\t  indentStatus = -1;\n\t\t}\n\t  }\n\t}\n  \n\tif (indentStatus === 1) {\n\t  while (readTagProperty(state) || readAnchorProperty(state)) {\n\t\tif (skipSeparationSpace(state, true, -1)) {\n\t\t  atNewLine = true;\n\t\t  allowBlockCollections = allowBlockStyles;\n  \n\t\t  if (state.lineIndent > parentIndent) {\n\t\t\tindentStatus = 1;\n\t\t  } else if (state.lineIndent === parentIndent) {\n\t\t\tindentStatus = 0;\n\t\t  } else if (state.lineIndent < parentIndent) {\n\t\t\tindentStatus = -1;\n\t\t  }\n\t\t} else {\n\t\t  allowBlockCollections = false;\n\t\t}\n\t  }\n\t}\n  \n\tif (allowBlockCollections) {\n\t  allowBlockCollections = atNewLine || allowCompact;\n\t}\n  \n\tif (indentStatus === 1 || CONTEXT_BLOCK_OUT === nodeContext) {\n\t  if (CONTEXT_FLOW_IN === nodeContext || CONTEXT_FLOW_OUT === nodeContext) {\n\t\tflowIndent = parentIndent;\n\t  } else {\n\t\tflowIndent = parentIndent + 1;\n\t  }\n  \n\t  blockIndent = state.position - state.lineStart;\n  \n\t  if (indentStatus === 1) {\n\t\tif (allowBlockCollections &&\n\t\t\t(readBlockSequence(state, blockIndent) ||\n\t\t\t readBlockMapping(state, blockIndent, flowIndent)) ||\n\t\t\treadFlowCollection(state, flowIndent)) {\n\t\t  hasContent = true;\n\t\t} else {\n\t\t  if ((allowBlockScalars && readBlockScalar(state, flowIndent)) ||\n\t\t\t  readSingleQuotedScalar(state, flowIndent) ||\n\t\t\t  readDoubleQuotedScalar(state, flowIndent)) {\n\t\t\thasContent = true;\n  \n\t\t  } else if (readAlias(state)) {\n\t\t\thasContent = true;\n  \n\t\t\tif (state.tag !== null || state.anchor !== null) {\n\t\t\t  throwError(state, 'alias node should not have any properties');\n\t\t\t}\n  \n\t\t  } else if (readPlainScalar(state, flowIndent, CONTEXT_FLOW_IN === nodeContext)) {\n\t\t\thasContent = true;\n  \n\t\t\tif (state.tag === null) {\n\t\t\t  state.tag = '?';\n\t\t\t}\n\t\t  }\n  \n\t\t  if (state.anchor !== null) {\n\t\t\tstate.anchorMap[state.anchor] = state.result;\n\t\t  }\n\t\t}\n\t  } else if (indentStatus === 0) {\n\t\t// Special case: block sequences are allowed to have same indentation level as the parent.\n\t\t// http://www.yaml.org/spec/1.2/spec.html#id2799784\n\t\thasContent = allowBlockCollections && readBlockSequence(state, blockIndent);\n\t  }\n\t}\n  \n\tif (state.tag === null) {\n\t  if (state.anchor !== null) {\n\t\tstate.anchorMap[state.anchor] = state.result;\n\t  }\n  \n\t} else if (state.tag === '?') {\n\t  // Implicit resolving is not allowed for non-scalar types, and '?'\n\t  // non-specific tag is only automatically assigned to plain scalars.\n\t  //\n\t  // We only need to check kind conformity in case user explicitly assigns '?'\n\t  // tag, for example like this: \"!<?> [0]\"\n\t  //\n\t  if (state.result !== null && state.kind !== 'scalar') {\n\t\tthrowError(state, 'unacceptable node kind for !<?> tag; it should be \"scalar\", not \"' + state.kind + '\"');\n\t  }\n  \n\t  for (typeIndex = 0, typeQuantity = state.implicitTypes.length; typeIndex < typeQuantity; typeIndex += 1) {\n\t\ttype = state.implicitTypes[typeIndex];\n  \n\t\tif (type.resolve(state.result)) { // `state.result` updated in resolver if matched\n\t\t  state.result = type.construct(state.result);\n\t\t  state.tag = type.tag;\n\t\t  if (state.anchor !== null) {\n\t\t\tstate.anchorMap[state.anchor] = state.result;\n\t\t  }\n\t\t  break;\n\t\t}\n\t  }\n\t} else if (state.tag !== '!') {\n\t  if (_hasOwnProperty$1.call(state.typeMap[state.kind || 'fallback'], state.tag)) {\n\t\ttype = state.typeMap[state.kind || 'fallback'][state.tag];\n\t  } else {\n\t\t// looking for multi type\n\t\ttype = null;\n\t\ttypeList = state.typeMap.multi[state.kind || 'fallback'];\n  \n\t\tfor (typeIndex = 0, typeQuantity = typeList.length; typeIndex < typeQuantity; typeIndex += 1) {\n\t\t  if (state.tag.slice(0, typeList[typeIndex].tag.length) === typeList[typeIndex].tag) {\n\t\t\ttype = typeList[typeIndex];\n\t\t\tbreak;\n\t\t  }\n\t\t}\n\t  }\n  \n\t  if (!type) {\n\t\tthrowError(state, 'unknown tag !<' + state.tag + '>');\n\t  }\n  \n\t  if (state.result !== null && type.kind !== state.kind) {\n\t\tthrowError(state, 'unacceptable node kind for !<' + state.tag + '> tag; it should be \"' + type.kind + '\", not \"' + state.kind + '\"');\n\t  }\n  \n\t  if (!type.resolve(state.result, state.tag)) { // `state.result` updated in resolver if matched\n\t\tthrowError(state, 'cannot resolve a node with !<' + state.tag + '> explicit tag');\n\t  } else {\n\t\tstate.result = type.construct(state.result, state.tag);\n\t\tif (state.anchor !== null) {\n\t\t  state.anchorMap[state.anchor] = state.result;\n\t\t}\n\t  }\n\t}\n  \n\tif (state.listener !== null) {\n\t  state.listener('close', state);\n\t}\n\treturn state.tag !== null ||  state.anchor !== null || hasContent;\n  }\n  \n  function readDocument(state) {\n\tvar documentStart = state.position,\n\t\t_position,\n\t\tdirectiveName,\n\t\tdirectiveArgs,\n\t\thasDirectives = false,\n\t\tch;\n  \n\tstate.version = null;\n\tstate.checkLineBreaks = state.legacy;\n\tstate.tagMap = Object.create(null);\n\tstate.anchorMap = Object.create(null);\n  \n\twhile ((ch = state.input.charCodeAt(state.position)) !== 0) {\n\t  skipSeparationSpace(state, true, -1);\n  \n\t  ch = state.input.charCodeAt(state.position);\n  \n\t  if (state.lineIndent > 0 || ch !== 0x25/* % */) {\n\t\tbreak;\n\t  }\n  \n\t  hasDirectives = true;\n\t  ch = state.input.charCodeAt(++state.position);\n\t  _position = state.position;\n  \n\t  while (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\t\tch = state.input.charCodeAt(++state.position);\n\t  }\n  \n\t  directiveName = state.input.slice(_position, state.position);\n\t  directiveArgs = [];\n  \n\t  if (directiveName.length < 1) {\n\t\tthrowError(state, 'directive name must not be less than one character in length');\n\t  }\n  \n\t  while (ch !== 0) {\n\t\twhile (is_WHITE_SPACE(ch)) {\n\t\t  ch = state.input.charCodeAt(++state.position);\n\t\t}\n  \n\t\tif (ch === 0x23/* # */) {\n\t\t  do { ch = state.input.charCodeAt(++state.position); }\n\t\t  while (ch !== 0 && !is_EOL(ch));\n\t\t  break;\n\t\t}\n  \n\t\tif (is_EOL(ch)) break;\n  \n\t\t_position = state.position;\n  \n\t\twhile (ch !== 0 && !is_WS_OR_EOL(ch)) {\n\t\t  ch = state.input.charCodeAt(++state.position);\n\t\t}\n  \n\t\tdirectiveArgs.push(state.input.slice(_position, state.position));\n\t  }\n  \n\t  if (ch !== 0) readLineBreak(state);\n  \n\t  if (_hasOwnProperty$1.call(directiveHandlers, directiveName)) {\n\t\tdirectiveHandlers[directiveName](state, directiveName, directiveArgs);\n\t  } else {\n\t\tthrowWarning(state, 'unknown document directive \"' + directiveName + '\"');\n\t  }\n\t}\n  \n\tskipSeparationSpace(state, true, -1);\n  \n\tif (state.lineIndent === 0 &&\n\t\tstate.input.charCodeAt(state.position)     === 0x2D/* - */ &&\n\t\tstate.input.charCodeAt(state.position + 1) === 0x2D/* - */ &&\n\t\tstate.input.charCodeAt(state.position + 2) === 0x2D/* - */) {\n\t  state.position += 3;\n\t  skipSeparationSpace(state, true, -1);\n  \n\t} else if (hasDirectives) {\n\t  throwError(state, 'directives end mark is expected');\n\t}\n  \n\tcomposeNode(state, state.lineIndent - 1, CONTEXT_BLOCK_OUT, false, true);\n\tskipSeparationSpace(state, true, -1);\n  \n\tif (state.checkLineBreaks &&\n\t\tPATTERN_NON_ASCII_LINE_BREAKS.test(state.input.slice(documentStart, state.position))) {\n\t  throwWarning(state, 'non-ASCII line breaks are interpreted as content');\n\t}\n  \n\tstate.documents.push(state.result);\n  \n\tif (state.position === state.lineStart && testDocumentSeparator(state)) {\n  \n\t  if (state.input.charCodeAt(state.position) === 0x2E/* . */) {\n\t\tstate.position += 3;\n\t\tskipSeparationSpace(state, true, -1);\n\t  }\n\t  return;\n\t}\n  \n\tif (state.position < (state.length - 1)) {\n\t  throwError(state, 'end of the stream or a document separator is expected');\n\t} else {\n\t  return;\n\t}\n  }\n  \n  \n  function loadDocuments(input, options) {\n\tinput = String(input);\n\toptions = options || {};\n  \n\tif (input.length !== 0) {\n  \n\t  // Add tailing `\\n` if not exists\n\t  if (input.charCodeAt(input.length - 1) !== 0x0A/* LF */ &&\n\t\t  input.charCodeAt(input.length - 1) !== 0x0D/* CR */) {\n\t\tinput += '\\n';\n\t  }\n  \n\t  // Strip BOM\n\t  if (input.charCodeAt(0) === 0xFEFF) {\n\t\tinput = input.slice(1);\n\t  }\n\t}\n  \n\tvar state = new State$1(input, options);\n  \n\tvar nullpos = input.indexOf('\\0');\n  \n\tif (nullpos !== -1) {\n\t  state.position = nullpos;\n\t  throwError(state, 'null byte is not allowed in input');\n\t}\n  \n\t// Use 0 as string terminator. That significantly simplifies bounds check.\n\tstate.input += '\\0';\n  \n\twhile (state.input.charCodeAt(state.position) === 0x20/* Space */) {\n\t  state.lineIndent += 1;\n\t  state.position += 1;\n\t}\n  \n\twhile (state.position < (state.length - 1)) {\n\t  readDocument(state);\n\t}\n  \n\treturn state.documents;\n  }\n  \n  \n  function loadAll$1(input, iterator, options) {\n\tif (iterator !== null && typeof iterator === 'object' && typeof options === 'undefined') {\n\t  options = iterator;\n\t  iterator = null;\n\t}\n  \n\tvar documents = loadDocuments(input, options);\n  \n\tif (typeof iterator !== 'function') {\n\t  return documents;\n\t}\n  \n\tfor (var index = 0, length = documents.length; index < length; index += 1) {\n\t  iterator(documents[index]);\n\t}\n  }\n  \n  \n  function load$1(input, options) {\n\tvar documents = loadDocuments(input, options);\n  \n\tif (documents.length === 0) {\n\t  /*eslint-disable no-undefined*/\n\t  return undefined;\n\t} else if (documents.length === 1) {\n\t  return documents[0];\n\t}\n\tthrow new exception('expected a single document in the stream, but found more');\n  }\n  \n  \n  var loadAll_1 = loadAll$1;\n  var load_1    = load$1;\n  \n  var loader = {\n\t  loadAll: loadAll_1,\n\t  load: load_1\n  };\n  \n  /*eslint-disable no-use-before-define*/\n  \n  \n  \n  \n  \n  var _toString       = Object.prototype.toString;\n  var _hasOwnProperty = Object.prototype.hasOwnProperty;\n  \n  var CHAR_BOM                  = 0xFEFF;\n  var CHAR_TAB                  = 0x09; /* Tab */\n  var CHAR_LINE_FEED            = 0x0A; /* LF */\n  var CHAR_CARRIAGE_RETURN      = 0x0D; /* CR */\n  var CHAR_SPACE                = 0x20; /* Space */\n  var CHAR_EXCLAMATION          = 0x21; /* ! */\n  var CHAR_DOUBLE_QUOTE         = 0x22; /* \" */\n  var CHAR_SHARP                = 0x23; /* # */\n  var CHAR_PERCENT              = 0x25; /* % */\n  var CHAR_AMPERSAND            = 0x26; /* & */\n  var CHAR_SINGLE_QUOTE         = 0x27; /* ' */\n  var CHAR_ASTERISK             = 0x2A; /* * */\n  var CHAR_COMMA                = 0x2C; /* , */\n  var CHAR_MINUS                = 0x2D; /* - */\n  var CHAR_COLON                = 0x3A; /* : */\n  var CHAR_EQUALS               = 0x3D; /* = */\n  var CHAR_GREATER_THAN         = 0x3E; /* > */\n  var CHAR_QUESTION             = 0x3F; /* ? */\n  var CHAR_COMMERCIAL_AT        = 0x40; /* @ */\n  var CHAR_LEFT_SQUARE_BRACKET  = 0x5B; /* [ */\n  var CHAR_RIGHT_SQUARE_BRACKET = 0x5D; /* ] */\n  var CHAR_GRAVE_ACCENT         = 0x60; /* ` */\n  var CHAR_LEFT_CURLY_BRACKET   = 0x7B; /* { */\n  var CHAR_VERTICAL_LINE        = 0x7C; /* | */\n  var CHAR_RIGHT_CURLY_BRACKET  = 0x7D; /* } */\n  \n  var ESCAPE_SEQUENCES = {};\n  \n  ESCAPE_SEQUENCES[0x00]   = '\\\\0';\n  ESCAPE_SEQUENCES[0x07]   = '\\\\a';\n  ESCAPE_SEQUENCES[0x08]   = '\\\\b';\n  ESCAPE_SEQUENCES[0x09]   = '\\\\t';\n  ESCAPE_SEQUENCES[0x0A]   = '\\\\n';\n  ESCAPE_SEQUENCES[0x0B]   = '\\\\v';\n  ESCAPE_SEQUENCES[0x0C]   = '\\\\f';\n  ESCAPE_SEQUENCES[0x0D]   = '\\\\r';\n  ESCAPE_SEQUENCES[0x1B]   = '\\\\e';\n  ESCAPE_SEQUENCES[0x22]   = '\\\\\"';\n  ESCAPE_SEQUENCES[0x5C]   = '\\\\\\\\';\n  ESCAPE_SEQUENCES[0x85]   = '\\\\N';\n  ESCAPE_SEQUENCES[0xA0]   = '\\\\_';\n  ESCAPE_SEQUENCES[0x2028] = '\\\\L';\n  ESCAPE_SEQUENCES[0x2029] = '\\\\P';\n  \n  var DEPRECATED_BOOLEANS_SYNTAX = [\n\t'y', 'Y', 'yes', 'Yes', 'YES', 'on', 'On', 'ON',\n\t'n', 'N', 'no', 'No', 'NO', 'off', 'Off', 'OFF'\n  ];\n  \n  var DEPRECATED_BASE60_SYNTAX = /^[-+]?[0-9_]+(?::[0-9_]+)+(?:\\.[0-9_]*)?$/;\n  \n  function compileStyleMap(schema, map) {\n\tvar result, keys, index, length, tag, style, type;\n  \n\tif (map === null) return {};\n  \n\tresult = {};\n\tkeys = Object.keys(map);\n  \n\tfor (index = 0, length = keys.length; index < length; index += 1) {\n\t  tag = keys[index];\n\t  style = String(map[tag]);\n  \n\t  if (tag.slice(0, 2) === '!!') {\n\t\ttag = 'tag:yaml.org,2002:' + tag.slice(2);\n\t  }\n\t  type = schema.compiledTypeMap['fallback'][tag];\n  \n\t  if (type && _hasOwnProperty.call(type.styleAliases, style)) {\n\t\tstyle = type.styleAliases[style];\n\t  }\n  \n\t  result[tag] = style;\n\t}\n  \n\treturn result;\n  }\n  \n  function encodeHex(character) {\n\tvar string, handle, length;\n  \n\tstring = character.toString(16).toUpperCase();\n  \n\tif (character <= 0xFF) {\n\t  handle = 'x';\n\t  length = 2;\n\t} else if (character <= 0xFFFF) {\n\t  handle = 'u';\n\t  length = 4;\n\t} else if (character <= 0xFFFFFFFF) {\n\t  handle = 'U';\n\t  length = 8;\n\t} else {\n\t  throw new exception('code point within a string may not be greater than 0xFFFFFFFF');\n\t}\n  \n\treturn '\\\\' + handle + common.repeat('0', length - string.length) + string;\n  }\n  \n  \n  var QUOTING_TYPE_SINGLE = 1,\n\t  QUOTING_TYPE_DOUBLE = 2;\n  \n  function State(options) {\n\tthis.schema        = options['schema'] || _default;\n\tthis.indent        = Math.max(1, (options['indent'] || 2));\n\tthis.noArrayIndent = options['noArrayIndent'] || false;\n\tthis.skipInvalid   = options['skipInvalid'] || false;\n\tthis.flowLevel     = (common.isNothing(options['flowLevel']) ? -1 : options['flowLevel']);\n\tthis.styleMap      = compileStyleMap(this.schema, options['styles'] || null);\n\tthis.sortKeys      = options['sortKeys'] || false;\n\tthis.lineWidth     = options['lineWidth'] || 80;\n\tthis.noRefs        = options['noRefs'] || false;\n\tthis.noCompatMode  = options['noCompatMode'] || false;\n\tthis.condenseFlow  = options['condenseFlow'] || false;\n\tthis.quotingType   = options['quotingType'] === '\"' ? QUOTING_TYPE_DOUBLE : QUOTING_TYPE_SINGLE;\n\tthis.forceQuotes   = options['forceQuotes'] || false;\n\tthis.replacer      = typeof options['replacer'] === 'function' ? options['replacer'] : null;\n  \n\tthis.implicitTypes = this.schema.compiledImplicit;\n\tthis.explicitTypes = this.schema.compiledExplicit;\n  \n\tthis.tag = null;\n\tthis.result = '';\n  \n\tthis.duplicates = [];\n\tthis.usedDuplicates = null;\n  }\n  \n  // Indents every line in a string. Empty lines (\\n only) are not indented.\n  function indentString(string, spaces) {\n\tvar ind = common.repeat(' ', spaces),\n\t\tposition = 0,\n\t\tnext = -1,\n\t\tresult = '',\n\t\tline,\n\t\tlength = string.length;\n  \n\twhile (position < length) {\n\t  next = string.indexOf('\\n', position);\n\t  if (next === -1) {\n\t\tline = string.slice(position);\n\t\tposition = length;\n\t  } else {\n\t\tline = string.slice(position, next + 1);\n\t\tposition = next + 1;\n\t  }\n  \n\t  if (line.length && line !== '\\n') result += ind;\n  \n\t  result += line;\n\t}\n  \n\treturn result;\n  }\n  \n  function generateNextLine(state, level) {\n\treturn '\\n' + common.repeat(' ', state.indent * level);\n  }\n  \n  function testImplicitResolving(state, str) {\n\tvar index, length, type;\n  \n\tfor (index = 0, length = state.implicitTypes.length; index < length; index += 1) {\n\t  type = state.implicitTypes[index];\n  \n\t  if (type.resolve(str)) {\n\t\treturn true;\n\t  }\n\t}\n  \n\treturn false;\n  }\n  \n  // [33] s-white ::= s-space | s-tab\n  function isWhitespace(c) {\n\treturn c === CHAR_SPACE || c === CHAR_TAB;\n  }\n  \n  // Returns true if the character can be printed without escaping.\n  // From YAML 1.2: \"any allowed characters known to be non-printable\n  // should also be escaped. [However,] This isn’t mandatory\"\n  // Derived from nb-char - \\t - #x85 - #xA0 - #x2028 - #x2029.\n  function isPrintable(c) {\n\treturn  (0x00020 <= c && c <= 0x00007E)\n\t\t|| ((0x000A1 <= c && c <= 0x00D7FF) && c !== 0x2028 && c !== 0x2029)\n\t\t|| ((0x0E000 <= c && c <= 0x00FFFD) && c !== CHAR_BOM)\n\t\t||  (0x10000 <= c && c <= 0x10FFFF);\n  }\n  \n  // [34] ns-char ::= nb-char - s-white\n  // [27] nb-char ::= c-printable - b-char - c-byte-order-mark\n  // [26] b-char  ::= b-line-feed | b-carriage-return\n  // Including s-white (for some reason, examples doesn't match specs in this aspect)\n  // ns-char ::= c-printable - b-line-feed - b-carriage-return - c-byte-order-mark\n  function isNsCharOrWhitespace(c) {\n\treturn isPrintable(c)\n\t  && c !== CHAR_BOM\n\t  // - b-char\n\t  && c !== CHAR_CARRIAGE_RETURN\n\t  && c !== CHAR_LINE_FEED;\n  }\n  \n  // [127]  ns-plain-safe(c) ::= c = flow-out  ⇒ ns-plain-safe-out\n  //                             c = flow-in   ⇒ ns-plain-safe-in\n  //                             c = block-key ⇒ ns-plain-safe-out\n  //                             c = flow-key  ⇒ ns-plain-safe-in\n  // [128] ns-plain-safe-out ::= ns-char\n  // [129]  ns-plain-safe-in ::= ns-char - c-flow-indicator\n  // [130]  ns-plain-char(c) ::=  ( ns-plain-safe(c) - “:” - “#” )\n  //                            | ( /* An ns-char preceding */ “#” )\n  //                            | ( “:” /* Followed by an ns-plain-safe(c) */ )\n  function isPlainSafe(c, prev, inblock) {\n\tvar cIsNsCharOrWhitespace = isNsCharOrWhitespace(c);\n\tvar cIsNsChar = cIsNsCharOrWhitespace && !isWhitespace(c);\n\treturn (\n\t  // ns-plain-safe\n\t  inblock ? // c = flow-in\n\t\tcIsNsCharOrWhitespace\n\t\t: cIsNsCharOrWhitespace\n\t\t  // - c-flow-indicator\n\t\t  && c !== CHAR_COMMA\n\t\t  && c !== CHAR_LEFT_SQUARE_BRACKET\n\t\t  && c !== CHAR_RIGHT_SQUARE_BRACKET\n\t\t  && c !== CHAR_LEFT_CURLY_BRACKET\n\t\t  && c !== CHAR_RIGHT_CURLY_BRACKET\n\t)\n\t  // ns-plain-char\n\t  && c !== CHAR_SHARP // false on '#'\n\t  && !(prev === CHAR_COLON && !cIsNsChar) // false on ': '\n\t  || (isNsCharOrWhitespace(prev) && !isWhitespace(prev) && c === CHAR_SHARP) // change to true on '[^ ]#'\n\t  || (prev === CHAR_COLON && cIsNsChar); // change to true on ':[^ ]'\n  }\n  \n  // Simplified test for values allowed as the first character in plain style.\n  function isPlainSafeFirst(c) {\n\t// Uses a subset of ns-char - c-indicator\n\t// where ns-char = nb-char - s-white.\n\t// No support of ( ( “?” | “:” | “-” ) /* Followed by an ns-plain-safe(c)) */ ) part\n\treturn isPrintable(c) && c !== CHAR_BOM\n\t  && !isWhitespace(c) // - s-white\n\t  // - (c-indicator ::=\n\t  // “-” | “?” | “:” | “,” | “[” | “]” | “{” | “}”\n\t  && c !== CHAR_MINUS\n\t  && c !== CHAR_QUESTION\n\t  && c !== CHAR_COLON\n\t  && c !== CHAR_COMMA\n\t  && c !== CHAR_LEFT_SQUARE_BRACKET\n\t  && c !== CHAR_RIGHT_SQUARE_BRACKET\n\t  && c !== CHAR_LEFT_CURLY_BRACKET\n\t  && c !== CHAR_RIGHT_CURLY_BRACKET\n\t  // | “#” | “&” | “*” | “!” | “|” | “=” | “>” | “'” | “\"”\n\t  && c !== CHAR_SHARP\n\t  && c !== CHAR_AMPERSAND\n\t  && c !== CHAR_ASTERISK\n\t  && c !== CHAR_EXCLAMATION\n\t  && c !== CHAR_VERTICAL_LINE\n\t  && c !== CHAR_EQUALS\n\t  && c !== CHAR_GREATER_THAN\n\t  && c !== CHAR_SINGLE_QUOTE\n\t  && c !== CHAR_DOUBLE_QUOTE\n\t  // | “%” | “@” | “`”)\n\t  && c !== CHAR_PERCENT\n\t  && c !== CHAR_COMMERCIAL_AT\n\t  && c !== CHAR_GRAVE_ACCENT;\n  }\n  \n  // Simplified test for values allowed as the last character in plain style.\n  function isPlainSafeLast(c) {\n\t// just not whitespace or colon, it will be checked to be plain character later\n\treturn !isWhitespace(c) && c !== CHAR_COLON;\n  }\n  \n  // Same as 'string'.codePointAt(pos), but works in older browsers.\n  function codePointAt(string, pos) {\n\tvar first = string.charCodeAt(pos), second;\n\tif (first >= 0xD800 && first <= 0xDBFF && pos + 1 < string.length) {\n\t  second = string.charCodeAt(pos + 1);\n\t  if (second >= 0xDC00 && second <= 0xDFFF) {\n\t\t// https://mathiasbynens.be/notes/javascript-encoding#surrogate-formulae\n\t\treturn (first - 0xD800) * 0x400 + second - 0xDC00 + 0x10000;\n\t  }\n\t}\n\treturn first;\n  }\n  \n  // Determines whether block indentation indicator is required.\n  function needIndentIndicator(string) {\n\tvar leadingSpaceRe = /^\\n* /;\n\treturn leadingSpaceRe.test(string);\n  }\n  \n  var STYLE_PLAIN   = 1,\n\t  STYLE_SINGLE  = 2,\n\t  STYLE_LITERAL = 3,\n\t  STYLE_FOLDED  = 4,\n\t  STYLE_DOUBLE  = 5;\n  \n  // Determines which scalar styles are possible and returns the preferred style.\n  // lineWidth = -1 => no limit.\n  // Pre-conditions: str.length > 0.\n  // Post-conditions:\n  //    STYLE_PLAIN or STYLE_SINGLE => no \\n are in the string.\n  //    STYLE_LITERAL => no lines are suitable for folding (or lineWidth is -1).\n  //    STYLE_FOLDED => a line > lineWidth and can be folded (and lineWidth != -1).\n  function chooseScalarStyle(string, singleLineOnly, indentPerLevel, lineWidth,\n\ttestAmbiguousType, quotingType, forceQuotes, inblock) {\n  \n\tvar i;\n\tvar char = 0;\n\tvar prevChar = null;\n\tvar hasLineBreak = false;\n\tvar hasFoldableLine = false; // only checked if shouldTrackWidth\n\tvar shouldTrackWidth = lineWidth !== -1;\n\tvar previousLineBreak = -1; // count the first line correctly\n\tvar plain = isPlainSafeFirst(codePointAt(string, 0))\n\t\t\t&& isPlainSafeLast(codePointAt(string, string.length - 1));\n  \n\tif (singleLineOnly || forceQuotes) {\n\t  // Case: no block styles.\n\t  // Check for disallowed characters to rule out plain and single.\n\t  for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n\t\tchar = codePointAt(string, i);\n\t\tif (!isPrintable(char)) {\n\t\t  return STYLE_DOUBLE;\n\t\t}\n\t\tplain = plain && isPlainSafe(char, prevChar, inblock);\n\t\tprevChar = char;\n\t  }\n\t} else {\n\t  // Case: block styles permitted.\n\t  for (i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n\t\tchar = codePointAt(string, i);\n\t\tif (char === CHAR_LINE_FEED) {\n\t\t  hasLineBreak = true;\n\t\t  // Check if any line can be folded.\n\t\t  if (shouldTrackWidth) {\n\t\t\thasFoldableLine = hasFoldableLine ||\n\t\t\t  // Foldable line = too long, and not more-indented.\n\t\t\t  (i - previousLineBreak - 1 > lineWidth &&\n\t\t\t   string[previousLineBreak + 1] !== ' ');\n\t\t\tpreviousLineBreak = i;\n\t\t  }\n\t\t} else if (!isPrintable(char)) {\n\t\t  return STYLE_DOUBLE;\n\t\t}\n\t\tplain = plain && isPlainSafe(char, prevChar, inblock);\n\t\tprevChar = char;\n\t  }\n\t  // in case the end is missing a \\n\n\t  hasFoldableLine = hasFoldableLine || (shouldTrackWidth &&\n\t\t(i - previousLineBreak - 1 > lineWidth &&\n\t\t string[previousLineBreak + 1] !== ' '));\n\t}\n\t// Although every style can represent \\n without escaping, prefer block styles\n\t// for multiline, since they're more readable and they don't add empty lines.\n\t// Also prefer folding a super-long line.\n\tif (!hasLineBreak && !hasFoldableLine) {\n\t  // Strings interpretable as another type have to be quoted;\n\t  // e.g. the string 'true' vs. the boolean true.\n\t  if (plain && !forceQuotes && !testAmbiguousType(string)) {\n\t\treturn STYLE_PLAIN;\n\t  }\n\t  return quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n\t}\n\t// Edge case: block indentation indicator can only have one digit.\n\tif (indentPerLevel > 9 && needIndentIndicator(string)) {\n\t  return STYLE_DOUBLE;\n\t}\n\t// At this point we know block styles are valid.\n\t// Prefer literal style unless we want to fold.\n\tif (!forceQuotes) {\n\t  return hasFoldableLine ? STYLE_FOLDED : STYLE_LITERAL;\n\t}\n\treturn quotingType === QUOTING_TYPE_DOUBLE ? STYLE_DOUBLE : STYLE_SINGLE;\n  }\n  \n  // Note: line breaking/folding is implemented for only the folded style.\n  // NB. We drop the last trailing newline (if any) of a returned block scalar\n  //  since the dumper adds its own newline. This always works:\n  //    • No ending newline => unaffected; already using strip \"-\" chomping.\n  //    • Ending newline    => removed then restored.\n  //  Importantly, this keeps the \"+\" chomp indicator from gaining an extra line.\n  function writeScalar(state, string, level, iskey, inblock) {\n\tstate.dump = (function () {\n\t  if (string.length === 0) {\n\t\treturn state.quotingType === QUOTING_TYPE_DOUBLE ? '\"\"' : \"''\";\n\t  }\n\t  if (!state.noCompatMode) {\n\t\tif (DEPRECATED_BOOLEANS_SYNTAX.indexOf(string) !== -1 || DEPRECATED_BASE60_SYNTAX.test(string)) {\n\t\t  return state.quotingType === QUOTING_TYPE_DOUBLE ? ('\"' + string + '\"') : (\"'\" + string + \"'\");\n\t\t}\n\t  }\n  \n\t  var indent = state.indent * Math.max(1, level); // no 0-indent scalars\n\t  // As indentation gets deeper, let the width decrease monotonically\n\t  // to the lower bound min(state.lineWidth, 40).\n\t  // Note that this implies\n\t  //  state.lineWidth ≤ 40 + state.indent: width is fixed at the lower bound.\n\t  //  state.lineWidth > 40 + state.indent: width decreases until the lower bound.\n\t  // This behaves better than a constant minimum width which disallows narrower options,\n\t  // or an indent threshold which causes the width to suddenly increase.\n\t  var lineWidth = state.lineWidth === -1\n\t\t? -1 : Math.max(Math.min(state.lineWidth, 40), state.lineWidth - indent);\n  \n\t  // Without knowing if keys are implicit/explicit, assume implicit for safety.\n\t  var singleLineOnly = iskey\n\t\t// No block styles in flow mode.\n\t\t|| (state.flowLevel > -1 && level >= state.flowLevel);\n\t  function testAmbiguity(string) {\n\t\treturn testImplicitResolving(state, string);\n\t  }\n  \n\t  switch (chooseScalarStyle(string, singleLineOnly, state.indent, lineWidth,\n\t\ttestAmbiguity, state.quotingType, state.forceQuotes && !iskey, inblock)) {\n  \n\t\tcase STYLE_PLAIN:\n\t\t  return string;\n\t\tcase STYLE_SINGLE:\n\t\t  return \"'\" + string.replace(/'/g, \"''\") + \"'\";\n\t\tcase STYLE_LITERAL:\n\t\t  return '|' + blockHeader(string, state.indent)\n\t\t\t+ dropEndingNewline(indentString(string, indent));\n\t\tcase STYLE_FOLDED:\n\t\t  return '>' + blockHeader(string, state.indent)\n\t\t\t+ dropEndingNewline(indentString(foldString(string, lineWidth), indent));\n\t\tcase STYLE_DOUBLE:\n\t\t  return '\"' + escapeString(string) + '\"';\n\t\tdefault:\n\t\t  throw new exception('impossible error: invalid scalar style');\n\t  }\n\t}());\n  }\n  \n  // Pre-conditions: string is valid for a block scalar, 1 <= indentPerLevel <= 9.\n  function blockHeader(string, indentPerLevel) {\n\tvar indentIndicator = needIndentIndicator(string) ? String(indentPerLevel) : '';\n  \n\t// note the special case: the string '\\n' counts as a \"trailing\" empty line.\n\tvar clip =          string[string.length - 1] === '\\n';\n\tvar keep = clip && (string[string.length - 2] === '\\n' || string === '\\n');\n\tvar chomp = keep ? '+' : (clip ? '' : '-');\n  \n\treturn indentIndicator + chomp + '\\n';\n  }\n  \n  // (See the note for writeScalar.)\n  function dropEndingNewline(string) {\n\treturn string[string.length - 1] === '\\n' ? string.slice(0, -1) : string;\n  }\n  \n  // Note: a long line without a suitable break point will exceed the width limit.\n  // Pre-conditions: every char in str isPrintable, str.length > 0, width > 0.\n  function foldString(string, width) {\n\t// In folded style, $k$ consecutive newlines output as $k+1$ newlines—\n\t// unless they're before or after a more-indented line, or at the very\n\t// beginning or end, in which case $k$ maps to $k$.\n\t// Therefore, parse each chunk as newline(s) followed by a content line.\n\tvar lineRe = /(\\n+)([^\\n]*)/g;\n  \n\t// first line (possibly an empty line)\n\tvar result = (function () {\n\t  var nextLF = string.indexOf('\\n');\n\t  nextLF = nextLF !== -1 ? nextLF : string.length;\n\t  lineRe.lastIndex = nextLF;\n\t  return foldLine(string.slice(0, nextLF), width);\n\t}());\n\t// If we haven't reached the first content line yet, don't add an extra \\n.\n\tvar prevMoreIndented = string[0] === '\\n' || string[0] === ' ';\n\tvar moreIndented;\n  \n\t// rest of the lines\n\tvar match;\n\twhile ((match = lineRe.exec(string))) {\n\t  var prefix = match[1], line = match[2];\n\t  moreIndented = (line[0] === ' ');\n\t  result += prefix\n\t\t+ (!prevMoreIndented && !moreIndented && line !== ''\n\t\t  ? '\\n' : '')\n\t\t+ foldLine(line, width);\n\t  prevMoreIndented = moreIndented;\n\t}\n  \n\treturn result;\n  }\n  \n  // Greedy line breaking.\n  // Picks the longest line under the limit each time,\n  // otherwise settles for the shortest line over the limit.\n  // NB. More-indented lines *cannot* be folded, as that would add an extra \\n.\n  function foldLine(line, width) {\n\tif (line === '' || line[0] === ' ') return line;\n  \n\t// Since a more-indented line adds a \\n, breaks can't be followed by a space.\n\tvar breakRe = / [^ ]/g; // note: the match index will always be <= length-2.\n\tvar match;\n\t// start is an inclusive index. end, curr, and next are exclusive.\n\tvar start = 0, end, curr = 0, next = 0;\n\tvar result = '';\n  \n\t// Invariants: 0 <= start <= length-1.\n\t//   0 <= curr <= next <= max(0, length-2). curr - start <= width.\n\t// Inside the loop:\n\t//   A match implies length >= 2, so curr and next are <= length-2.\n\twhile ((match = breakRe.exec(line))) {\n\t  next = match.index;\n\t  // maintain invariant: curr - start <= width\n\t  if (next - start > width) {\n\t\tend = (curr > start) ? curr : next; // derive end <= length-2\n\t\tresult += '\\n' + line.slice(start, end);\n\t\t// skip the space that was output as \\n\n\t\tstart = end + 1;                    // derive start <= length-1\n\t  }\n\t  curr = next;\n\t}\n  \n\t// By the invariants, start <= length-1, so there is something left over.\n\t// It is either the whole string or a part starting from non-whitespace.\n\tresult += '\\n';\n\t// Insert a break if the remainder is too long and there is a break available.\n\tif (line.length - start > width && curr > start) {\n\t  result += line.slice(start, curr) + '\\n' + line.slice(curr + 1);\n\t} else {\n\t  result += line.slice(start);\n\t}\n  \n\treturn result.slice(1); // drop extra \\n joiner\n  }\n  \n  // Escapes a double-quoted string.\n  function escapeString(string) {\n\tvar result = '';\n\tvar char = 0;\n\tvar escapeSeq;\n  \n\tfor (var i = 0; i < string.length; char >= 0x10000 ? i += 2 : i++) {\n\t  char = codePointAt(string, i);\n\t  escapeSeq = ESCAPE_SEQUENCES[char];\n  \n\t  if (!escapeSeq && isPrintable(char)) {\n\t\tresult += string[i];\n\t\tif (char >= 0x10000) result += string[i + 1];\n\t  } else {\n\t\tresult += escapeSeq || encodeHex(char);\n\t  }\n\t}\n  \n\treturn result;\n  }\n  \n  function writeFlowSequence(state, level, object) {\n\tvar _result = '',\n\t\t_tag    = state.tag,\n\t\tindex,\n\t\tlength,\n\t\tvalue;\n  \n\tfor (index = 0, length = object.length; index < length; index += 1) {\n\t  value = object[index];\n  \n\t  if (state.replacer) {\n\t\tvalue = state.replacer.call(object, String(index), value);\n\t  }\n  \n\t  // Write only valid elements, put null instead of invalid elements.\n\t  if (writeNode(state, level, value, false, false) ||\n\t\t  (typeof value === 'undefined' &&\n\t\t   writeNode(state, level, null, false, false))) {\n  \n\t\tif (_result !== '') _result += ',' + (!state.condenseFlow ? ' ' : '');\n\t\t_result += state.dump;\n\t  }\n\t}\n  \n\tstate.tag = _tag;\n\tstate.dump = '[' + _result + ']';\n  }\n  \n  function writeBlockSequence(state, level, object, compact) {\n\tvar _result = '',\n\t\t_tag    = state.tag,\n\t\tindex,\n\t\tlength,\n\t\tvalue;\n  \n\tfor (index = 0, length = object.length; index < length; index += 1) {\n\t  value = object[index];\n  \n\t  if (state.replacer) {\n\t\tvalue = state.replacer.call(object, String(index), value);\n\t  }\n  \n\t  // Write only valid elements, put null instead of invalid elements.\n\t  if (writeNode(state, level + 1, value, true, true, false, true) ||\n\t\t  (typeof value === 'undefined' &&\n\t\t   writeNode(state, level + 1, null, true, true, false, true))) {\n  \n\t\tif (!compact || _result !== '') {\n\t\t  _result += generateNextLine(state, level);\n\t\t}\n  \n\t\tif (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n\t\t  _result += '-';\n\t\t} else {\n\t\t  _result += '- ';\n\t\t}\n  \n\t\t_result += state.dump;\n\t  }\n\t}\n  \n\tstate.tag = _tag;\n\tstate.dump = _result || '[]'; // Empty sequence if no valid values.\n  }\n  \n  function writeFlowMapping(state, level, object) {\n\tvar _result       = '',\n\t\t_tag          = state.tag,\n\t\tobjectKeyList = Object.keys(object),\n\t\tindex,\n\t\tlength,\n\t\tobjectKey,\n\t\tobjectValue,\n\t\tpairBuffer;\n  \n\tfor (index = 0, length = objectKeyList.length; index < length; index += 1) {\n  \n\t  pairBuffer = '';\n\t  if (_result !== '') pairBuffer += ', ';\n  \n\t  if (state.condenseFlow) pairBuffer += '\"';\n  \n\t  objectKey = objectKeyList[index];\n\t  objectValue = object[objectKey];\n  \n\t  if (state.replacer) {\n\t\tobjectValue = state.replacer.call(object, objectKey, objectValue);\n\t  }\n  \n\t  if (!writeNode(state, level, objectKey, false, false)) {\n\t\tcontinue; // Skip this pair because of invalid key;\n\t  }\n  \n\t  if (state.dump.length > 1024) pairBuffer += '? ';\n  \n\t  pairBuffer += state.dump + (state.condenseFlow ? '\"' : '') + ':' + (state.condenseFlow ? '' : ' ');\n  \n\t  if (!writeNode(state, level, objectValue, false, false)) {\n\t\tcontinue; // Skip this pair because of invalid value.\n\t  }\n  \n\t  pairBuffer += state.dump;\n  \n\t  // Both key and value are valid.\n\t  _result += pairBuffer;\n\t}\n  \n\tstate.tag = _tag;\n\tstate.dump = '{' + _result + '}';\n  }\n  \n  function writeBlockMapping(state, level, object, compact) {\n\tvar _result       = '',\n\t\t_tag          = state.tag,\n\t\tobjectKeyList = Object.keys(object),\n\t\tindex,\n\t\tlength,\n\t\tobjectKey,\n\t\tobjectValue,\n\t\texplicitPair,\n\t\tpairBuffer;\n  \n\t// Allow sorting keys so that the output file is deterministic\n\tif (state.sortKeys === true) {\n\t  // Default sorting\n\t  objectKeyList.sort();\n\t} else if (typeof state.sortKeys === 'function') {\n\t  // Custom sort function\n\t  objectKeyList.sort(state.sortKeys);\n\t} else if (state.sortKeys) {\n\t  // Something is wrong\n\t  throw new exception('sortKeys must be a boolean or a function');\n\t}\n  \n\tfor (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\t  pairBuffer = '';\n  \n\t  if (!compact || _result !== '') {\n\t\tpairBuffer += generateNextLine(state, level);\n\t  }\n  \n\t  objectKey = objectKeyList[index];\n\t  objectValue = object[objectKey];\n  \n\t  if (state.replacer) {\n\t\tobjectValue = state.replacer.call(object, objectKey, objectValue);\n\t  }\n  \n\t  if (!writeNode(state, level + 1, objectKey, true, true, true)) {\n\t\tcontinue; // Skip this pair because of invalid key.\n\t  }\n  \n\t  explicitPair = (state.tag !== null && state.tag !== '?') ||\n\t\t\t\t\t (state.dump && state.dump.length > 1024);\n  \n\t  if (explicitPair) {\n\t\tif (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n\t\t  pairBuffer += '?';\n\t\t} else {\n\t\t  pairBuffer += '? ';\n\t\t}\n\t  }\n  \n\t  pairBuffer += state.dump;\n  \n\t  if (explicitPair) {\n\t\tpairBuffer += generateNextLine(state, level);\n\t  }\n  \n\t  if (!writeNode(state, level + 1, objectValue, true, explicitPair)) {\n\t\tcontinue; // Skip this pair because of invalid value.\n\t  }\n  \n\t  if (state.dump && CHAR_LINE_FEED === state.dump.charCodeAt(0)) {\n\t\tpairBuffer += ':';\n\t  } else {\n\t\tpairBuffer += ': ';\n\t  }\n  \n\t  pairBuffer += state.dump;\n  \n\t  // Both key and value are valid.\n\t  _result += pairBuffer;\n\t}\n  \n\tstate.tag = _tag;\n\tstate.dump = _result || '{}'; // Empty mapping if no valid pairs.\n  }\n  \n  function detectType(state, object, explicit) {\n\tvar _result, typeList, index, length, type, style;\n  \n\ttypeList = explicit ? state.explicitTypes : state.implicitTypes;\n  \n\tfor (index = 0, length = typeList.length; index < length; index += 1) {\n\t  type = typeList[index];\n  \n\t  if ((type.instanceOf  || type.predicate) &&\n\t\t  (!type.instanceOf || ((typeof object === 'object') && (object instanceof type.instanceOf))) &&\n\t\t  (!type.predicate  || type.predicate(object))) {\n  \n\t\tif (explicit) {\n\t\t  if (type.multi && type.representName) {\n\t\t\tstate.tag = type.representName(object);\n\t\t  } else {\n\t\t\tstate.tag = type.tag;\n\t\t  }\n\t\t} else {\n\t\t  state.tag = '?';\n\t\t}\n  \n\t\tif (type.represent) {\n\t\t  style = state.styleMap[type.tag] || type.defaultStyle;\n  \n\t\t  if (_toString.call(type.represent) === '[object Function]') {\n\t\t\t_result = type.represent(object, style);\n\t\t  } else if (_hasOwnProperty.call(type.represent, style)) {\n\t\t\t_result = type.represent[style](object, style);\n\t\t  } else {\n\t\t\tthrow new exception('!<' + type.tag + '> tag resolver accepts not \"' + style + '\" style');\n\t\t  }\n  \n\t\t  state.dump = _result;\n\t\t}\n  \n\t\treturn true;\n\t  }\n\t}\n  \n\treturn false;\n  }\n  \n  // Serializes `object` and writes it to global `result`.\n  // Returns true on success, or false on invalid object.\n  //\n  function writeNode(state, level, object, block, compact, iskey, isblockseq) {\n\tstate.tag = null;\n\tstate.dump = object;\n  \n\tif (!detectType(state, object, false)) {\n\t  detectType(state, object, true);\n\t}\n  \n\tvar type = _toString.call(state.dump);\n\tvar inblock = block;\n\tvar tagStr;\n  \n\tif (block) {\n\t  block = (state.flowLevel < 0 || state.flowLevel > level);\n\t}\n  \n\tvar objectOrArray = type === '[object Object]' || type === '[object Array]',\n\t\tduplicateIndex,\n\t\tduplicate;\n  \n\tif (objectOrArray) {\n\t  duplicateIndex = state.duplicates.indexOf(object);\n\t  duplicate = duplicateIndex !== -1;\n\t}\n  \n\tif ((state.tag !== null && state.tag !== '?') || duplicate || (state.indent !== 2 && level > 0)) {\n\t  compact = false;\n\t}\n  \n\tif (duplicate && state.usedDuplicates[duplicateIndex]) {\n\t  state.dump = '*ref_' + duplicateIndex;\n\t} else {\n\t  if (objectOrArray && duplicate && !state.usedDuplicates[duplicateIndex]) {\n\t\tstate.usedDuplicates[duplicateIndex] = true;\n\t  }\n\t  if (type === '[object Object]') {\n\t\tif (block && (Object.keys(state.dump).length !== 0)) {\n\t\t  writeBlockMapping(state, level, state.dump, compact);\n\t\t  if (duplicate) {\n\t\t\tstate.dump = '&ref_' + duplicateIndex + state.dump;\n\t\t  }\n\t\t} else {\n\t\t  writeFlowMapping(state, level, state.dump);\n\t\t  if (duplicate) {\n\t\t\tstate.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n\t\t  }\n\t\t}\n\t  } else if (type === '[object Array]') {\n\t\tif (block && (state.dump.length !== 0)) {\n\t\t  if (state.noArrayIndent && !isblockseq && level > 0) {\n\t\t\twriteBlockSequence(state, level - 1, state.dump, compact);\n\t\t  } else {\n\t\t\twriteBlockSequence(state, level, state.dump, compact);\n\t\t  }\n\t\t  if (duplicate) {\n\t\t\tstate.dump = '&ref_' + duplicateIndex + state.dump;\n\t\t  }\n\t\t} else {\n\t\t  writeFlowSequence(state, level, state.dump);\n\t\t  if (duplicate) {\n\t\t\tstate.dump = '&ref_' + duplicateIndex + ' ' + state.dump;\n\t\t  }\n\t\t}\n\t  } else if (type === '[object String]') {\n\t\tif (state.tag !== '?') {\n\t\t  writeScalar(state, state.dump, level, iskey, inblock);\n\t\t}\n\t  } else if (type === '[object Undefined]') {\n\t\treturn false;\n\t  } else {\n\t\tif (state.skipInvalid) return false;\n\t\tthrow new exception('unacceptable kind of an object to dump ' + type);\n\t  }\n  \n\t  if (state.tag !== null && state.tag !== '?') {\n\t\t// Need to encode all characters except those allowed by the spec:\n\t\t//\n\t\t// [35] ns-dec-digit    ::=  [#x30-#x39] /* 0-9 */\n\t\t// [36] ns-hex-digit    ::=  ns-dec-digit\n\t\t//                         | [#x41-#x46] /* A-F */ | [#x61-#x66] /* a-f */\n\t\t// [37] ns-ascii-letter ::=  [#x41-#x5A] /* A-Z */ | [#x61-#x7A] /* a-z */\n\t\t// [38] ns-word-char    ::=  ns-dec-digit | ns-ascii-letter | “-”\n\t\t// [39] ns-uri-char     ::=  “%” ns-hex-digit ns-hex-digit | ns-word-char | “#”\n\t\t//                         | “;” | “/” | “?” | “:” | “@” | “&” | “=” | “+” | “$” | “,”\n\t\t//                         | “_” | “.” | “!” | “~” | “*” | “'” | “(” | “)” | “[” | “]”\n\t\t//\n\t\t// Also need to encode '!' because it has special meaning (end of tag prefix).\n\t\t//\n\t\ttagStr = encodeURI(\n\t\t  state.tag[0] === '!' ? state.tag.slice(1) : state.tag\n\t\t).replace(/!/g, '%21');\n  \n\t\tif (state.tag[0] === '!') {\n\t\t  tagStr = '!' + tagStr;\n\t\t} else if (tagStr.slice(0, 18) === 'tag:yaml.org,2002:') {\n\t\t  tagStr = '!!' + tagStr.slice(18);\n\t\t} else {\n\t\t  tagStr = '!<' + tagStr + '>';\n\t\t}\n  \n\t\tstate.dump = tagStr + ' ' + state.dump;\n\t  }\n\t}\n  \n\treturn true;\n  }\n  \n  function getDuplicateReferences(object, state) {\n\tvar objects = [],\n\t\tduplicatesIndexes = [],\n\t\tindex,\n\t\tlength;\n  \n\tinspectNode(object, objects, duplicatesIndexes);\n  \n\tfor (index = 0, length = duplicatesIndexes.length; index < length; index += 1) {\n\t  state.duplicates.push(objects[duplicatesIndexes[index]]);\n\t}\n\tstate.usedDuplicates = new Array(length);\n  }\n  \n  function inspectNode(object, objects, duplicatesIndexes) {\n\tvar objectKeyList,\n\t\tindex,\n\t\tlength;\n  \n\tif (object !== null && typeof object === 'object') {\n\t  index = objects.indexOf(object);\n\t  if (index !== -1) {\n\t\tif (duplicatesIndexes.indexOf(index) === -1) {\n\t\t  duplicatesIndexes.push(index);\n\t\t}\n\t  } else {\n\t\tobjects.push(object);\n  \n\t\tif (Array.isArray(object)) {\n\t\t  for (index = 0, length = object.length; index < length; index += 1) {\n\t\t\tinspectNode(object[index], objects, duplicatesIndexes);\n\t\t  }\n\t\t} else {\n\t\t  objectKeyList = Object.keys(object);\n  \n\t\t  for (index = 0, length = objectKeyList.length; index < length; index += 1) {\n\t\t\tinspectNode(object[objectKeyList[index]], objects, duplicatesIndexes);\n\t\t  }\n\t\t}\n\t  }\n\t}\n  }\n  \n  function dump$1(input, options) {\n\toptions = options || {};\n  \n\tvar state = new State(options);\n  \n\tif (!state.noRefs) getDuplicateReferences(input, state);\n  \n\tvar value = input;\n  \n\tif (state.replacer) {\n\t  value = state.replacer.call({ '': value }, '', value);\n\t}\n  \n\tif (writeNode(state, 0, value, true, true)) return state.dump + '\\n';\n  \n\treturn '';\n  }\n  \n  var dump_1 = dump$1;\n  \n  var dumper = {\n\t  dump: dump_1\n  };\n  \n  function renamed(from, to) {\n\treturn function () {\n\t  throw new Error('Function yaml.' + from + ' is removed in js-yaml 4. ' +\n\t\t'Use yaml.' + to + ' instead, which is now safe by default.');\n\t};\n  }\n  \n  \n  var Type                = type;\n  var Schema              = schema;\n  var FAILSAFE_SCHEMA     = failsafe;\n  var JSON_SCHEMA         = json;\n  var CORE_SCHEMA         = core;\n  var DEFAULT_SCHEMA      = _default;\n  var load                = loader.load;\n  var loadAll             = loader.loadAll;\n  var dump                = dumper.dump;\n  var YAMLException       = exception;\n  \n  // Re-export all types in case user wants to create custom schema\n  var types = {\n\tbinary:    binary,\n\tfloat:     float,\n\tmap:       map,\n\tnull:      _null,\n\tpairs:     pairs,\n\tset:       set,\n\ttimestamp: timestamp,\n\tbool:      bool,\n\tint:       int,\n\tmerge:     merge,\n\tomap:      omap,\n\tseq:       seq,\n\tstr:       str\n  };\n  \n  // Removed functions from JS-YAML 3.0.x\n  var safeLoad            = renamed('safeLoad', 'load');\n  var safeLoadAll         = renamed('safeLoadAll', 'loadAll');\n  var safeDump            = renamed('safeDump', 'dump');\n  \n  var jsYaml = {\n\t  Type: Type,\n\t  Schema: Schema,\n\t  FAILSAFE_SCHEMA: FAILSAFE_SCHEMA,\n\t  JSON_SCHEMA: JSON_SCHEMA,\n\t  CORE_SCHEMA: CORE_SCHEMA,\n\t  DEFAULT_SCHEMA: DEFAULT_SCHEMA,\n\t  load: load,\n\t  loadAll: loadAll,\n\t  dump: dump,\n\t  YAMLException: YAMLException,\n\t  types: types,\n\t  safeLoad: safeLoad,\n\t  safeLoadAll: safeLoadAll,\n\t  safeDump: safeDump\n  };\n  \n  export default jsYaml;\n  export { CORE_SCHEMA, DEFAULT_SCHEMA, FAILSAFE_SCHEMA, JSON_SCHEMA, Schema, Type, YAMLException, dump, load, loadAll, safeDump, safeLoad, safeLoadAll, types };","function isObject(obj) {\n\treturn obj && typeof obj === \"object\" && !Array.isArray(obj);\n}\n\nexport function deepMerge(baseObject, objectToMergeIn) {\n\tif (!isObject(objectToMergeIn)) return baseObject;\n\tif (!isObject(baseObject)) return objectToMergeIn;\n\n\tconst mergedObject = Object.assign({}, baseObject);\n\n\tfor (const [key, incomingValue] of Object.entries(objectToMergeIn)) {\n\t\tconst baseValue = mergedObject[key];\n\n\t\tif (isObject(incomingValue) && isObject(baseValue)) {\n\t\t\tmergedObject[key] = deepMerge(baseValue, incomingValue);\n\t\t} else {\n\t\t\tmergedObject[key] = incomingValue;\n\t\t}\n\t}\n\n\treturn mergedObject;\n}\n","// Gestion du scroll automatique vers le bas\nfunction scrollToBottomOfPage(behavior) {\n\tconst heightPage =\n\t\tMath.max(\n\t\t\tdocument.body.scrollHeight,\n\t\t\tdocument.documentElement.scrollHeight,\n\t\t) + 150;\n\twindow.scrollTo({\n\t\ttop: heightPage,\n\t\tbehavior: behavior,\n\t});\n}\n\nlet animationFrameId = null;\nexport function scrollWindow(option) {\n\tconst isSmooth = option && option.scrollMode == \"smooth\";\n\tif (animationFrameId !== null) {\n\t\twindow.cancelAnimationFrame(animationFrameId);\n\t\tanimationFrameId = null;\n\t}\n\n\tif (isSmooth) {\n\t\tanimationFrameId = window.requestAnimationFrame(() => {\n\t\t\tscrollToBottomOfPage(\"smooth\");\n\t\t\tanimationFrameId = null;\n\t\t});\n\t} else {\n\t\tscrollToBottomOfPage(\"auto\");\n\t}\n}\n\n// Pour définir le contenu du footer\nexport function setContentOfFooter(footerElement, html) {\n\tfooterElement.innerHTML = html;\n}\n\nexport function scrollToLastUserMessage() {\n\tconst userMessages = document.querySelectorAll(\".user-message\");\n\tif (userMessages.length > 0) {\n\t\tuserMessages[userMessages.length - 1].scrollIntoView({\n\t\t\tbehavior: \"smooth\",\n\t\t});\n\t}\n}\n","function xorEncryptDecrypt(message, password) {\n\tlet output = \"\";\n\tfor (let i = 0; i < message.length; i++) {\n\t\t// XOR chaque caractère de l'entrée avec le caractère correspondant du mot de passe (ou un cycle de celui-ci)\n\t\toutput += String.fromCharCode(\n\t\t\tmessage.charCodeAt(i) ^ password.charCodeAt(i % password.length),\n\t\t);\n\t}\n\treturn output;\n}\n\n// function xorEncrypt(message, passwordApiKey) {\n// \tconst xorMessage = xorEncryptDecrypt(message, passwordApiKey);\n// \tconst xorMessageEncoded = btoa(xorMessage);\n// \treturn xorMessageEncoded;\n// }\n\nfunction xorDecrypt(xorMessageEncoded, passwordApiKey) {\n\tconst xorMessage = atob(xorMessageEncoded);\n\tconst message = xorEncryptDecrypt(xorMessage, passwordApiKey);\n\treturn message;\n}\n\nexport function decodeApiKey(encryptedApiKey, passwordApiKey, method) {\n\tswitch (method) {\n\t\tcase \"XOR\":\n\t\t\treturn xorDecrypt(encryptedApiKey, passwordApiKey);\n\t\tdefault:\n\t\t\treturn \"\";\n\t}\n}\n","export const chatContainer = document.getElementById(\"chat\");\nexport const sendButton = document.getElementById(\"send-button\");\nexport const userInput = document.getElementById(\"user-input\");\nexport const controlsElement = document.getElementById(\"controls\");\nexport const footerElement = document.getElementById(\"footer\");\n","export function checkDarkModePreference() {\n\tif (\n\t\twindow.matchMedia &&\n\t\twindow.matchMedia(\"(prefers-color-scheme: dark)\").matches\n\t) {\n\t\tdocument.documentElement.classList.add(\"darkmode\");\n\t}\n}\n\nexport function scopeStyles(htmlString, prefix) {\n\treturn htmlString.replace(\n\t\t/<style\\s+[^>]*scoped[^>]*>([\\s\\S]*?)<\\/style>/gi,\n\t\t(match, css) => {\n\t\t\t// Nettoie le CSS et supprime les commentaires\n\t\t\tlet cleanCSS = css.replace(/\\/\\*[\\s\\S]*?\\*\\//g, \"\");\n\n\t\t\t// Extrait chaque bloc de règle CSS : sélecteur(s) { propriétés }\n\t\t\tconst ruleRegex = /([^{}]+)\\{([^{}]*)\\}/g;\n\n\t\t\tconst scopedCSS = cleanCSS.replace(\n\t\t\t\truleRegex,\n\t\t\t\t(fullMatch, selectors, properties) => {\n\t\t\t\t\t// Traite chaque sélecteur séparé par des virgules\n\t\t\t\t\tconst scopedSelectors = selectors\n\t\t\t\t\t\t.split(\",\")\n\t\t\t\t\t\t.map((sel) => sel.trim())\n\t\t\t\t\t\t.filter(Boolean)\n\t\t\t\t\t\t.map((sel) => {\n\t\t\t\t\t\t\t// Évite de doubler le préfixe\n\t\t\t\t\t\t\tif (sel.startsWith(prefix)) return sel;\n\n\t\t\t\t\t\t\t// Gère les @-rules (media queries, keyframes, etc.)\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tsel.startsWith(\"@\") ||\n\t\t\t\t\t\t\t\tsel.startsWith(\"from\") ||\n\t\t\t\t\t\t\t\tsel.startsWith(\"to\") ||\n\t\t\t\t\t\t\t\tsel.endsWith(\"%\")\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\treturn sel;\n\n\t\t\t\t\t\t\t// Ajoute le préfixe\n\t\t\t\t\t\t\t// Si on a une règle sur le message lui-même, il ne faut pas considérer le sélecteur comme enfant du message, mais comme portant sur le message lui-même\n\t\t\t\t\t\t\tconst sep = sel === \".message\" ? \"\" : \" \";\n\t\t\t\t\t\t\treturn `${prefix}${sep}${sel}`;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join(\", \");\n\n\t\t\t\t\t// Reconstruit la règle complète\n\t\t\t\t\treturn `${scopedSelectors} { ${properties} }`;\n\t\t\t\t},\n\t\t\t);\n\t\t\t// On désactive l'effet typewriter pour la balise style avec \\`\n\t\t\treturn `\\\\\\`\\n<style>${scopedCSS}</style>\\n\\\\\\``;\n\t\t},\n\t);\n}\n","import { config } from \"../../config.mjs\";\nimport { load as loadYAML } from \"../../lib/js-yaml.mjs\";\nimport { loadScript, loadCSS } from \"../../utils/urls.mjs\";\nimport { deepMerge } from \"../../utils/objects.mjs\";\nimport { setContentOfFooter } from \"../../utils/ui.mjs\";\nimport { decodeApiKey } from \"../../ai/helpers/keyDecoder.mjs\";\nimport { sendButton, footerElement } from \"../../shared/selectors.mjs\";\nimport { checkDarkModePreference } from \"../../utils/css.mjs\";\n\nexport let yaml = {\n\tplugins: config.yaml.plugins,\n\tavatar: config.yaml.avatar,\n\tavatarCircle: config.yaml.avatarCircle,\n\tbots: config.yaml.bots,\n\tdetectBadWords: config.yaml.detectBadWords,\n\tdefaultMessage: config.yaml.defaultMessage,\n\tdynamicContent: config.yaml.dynamicContent,\n\tfavicon: config.yaml.favicon,\n\tfooter: config.yaml.footer,\n\tmaths: config.yaml.maths,\n\tobfuscate: config.yaml.obfuscate,\n\tresponsesTitles: config.yaml.responsesTitles,\n\tsearchInContent: config.yaml.searchInContent,\n\tstyle: config.yaml.style,\n\ttheme: config.yaml.theme,\n\ttypeWriter: config.yaml.typeWriter,\n\tuseLLM: config.yaml.useLLM,\n\tuserInput: config.yaml.userInput,\n\tvariables: config.yaml.variables,\n};\n\nexport let filterBadWords;\nexport function processYAML(markdownContent) {\n\tif (\n\t\tmarkdownContent.split(\"---\").length > 2 &&\n\t\tmarkdownContent.startsWith(\"---\")\n\t) {\n\t\ttry {\n\t\t\t// Traitement des propriétés dans le YAML\n\t\t\tconst yamlData = loadYAML(markdownContent.split(\"---\")[1]);\n\t\t\tyaml = yamlData ? deepMerge(yaml, yamlData) : yaml;\n\t\t\tif (yaml.maths === true) {\n\t\t\t\tyaml.plugins = yaml.plugins\n\t\t\t\t\t? yaml.plugins + \",maths,textFit\"\n\t\t\t\t\t: \"maths,textFit\";\n\t\t\t}\n\t\t\tif (yaml.plugins || yaml.addOns) {\n\t\t\t\t// Gestion des plugins (scripts et css en plus)\n\t\t\t\tyaml.plugins = yaml.addOns\n\t\t\t\t\t? yaml.plugins + \",\" + yaml.addOns\n\t\t\t\t\t: yaml.plugins;\n\t\t\t\tyaml.plugins = yaml.plugins\n\t\t\t\t\t.replaceAll(\" \", \"\")\n\t\t\t\t\t.split(\",\")\n\t\t\t\t\t.filter((el) => el);\n\t\t\t\tlet pluginDependenciesArray = [];\n\t\t\t\t// On ajoute aussi les dépendances pour chaque plugin\n\t\t\t\tfor (const [plugin, pluginDependencies] of Object.entries(\n\t\t\t\t\tconfig.pluginDependencies,\n\t\t\t\t)) {\n\t\t\t\t\tif (yaml.plugins.includes(plugin)) {\n\t\t\t\t\t\tfor (const dependency of pluginDependencies) {\n\t\t\t\t\t\t\tpluginDependenciesArray.push(dependency);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tyaml.plugins.push(...pluginDependenciesArray);\n\t\t\t\t// Pour chaque plugin, on charge le JS ou le CSS correspondant\n\t\t\t\tfor (const desiredPlugin of yaml.plugins) {\n\t\t\t\t\tconst pluginsPromises = [];\n\t\t\t\t\tconst addDesiredPlugin = config.allowedPlugins[desiredPlugin];\n\t\t\t\t\tif (addDesiredPlugin) {\n\t\t\t\t\t\tif (addDesiredPlugin.js) {\n\t\t\t\t\t\t\tpluginsPromises.push(loadScript(addDesiredPlugin.js));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (addDesiredPlugin.css) {\n\t\t\t\t\t\t\tpluginsPromises.push(loadCSS(addDesiredPlugin.css));\n\t\t\t\t\t\t}\n\t\t\t\t\t\tPromise.all(pluginsPromises);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (yaml.preload) {\n\t\t\t\tfor (const resource of yaml.preload) {\n\t\t\t\t\t// On précharge chaque ressource\n\t\t\t\t\tfetch(resource)\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t// Ressource préchargée\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((e) => {\n\t\t\t\t\t\t\tconsole.e(\n\t\t\t\t\t\t\t\t`Erreur lors du préchargement de la ressource ${resource} :`,\n\t\t\t\t\t\t\t\te,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (yaml.titresRéponses || yaml.responsesTitles) {\n\t\t\t\tyaml.responsesTitles = yaml.titresRéponses\n\t\t\t\t\t? yaml.titresRéponses\n\t\t\t\t\t: yaml.responsesTitles;\n\t\t\t\tif (typeof yaml.responsesTitles === \"string\") {\n\t\t\t\t\t// Cas où le yaml pour les titres des réponses ne contient pas un tableau, mais un seul élément\n\t\t\t\t\tyaml.responsesTitles = [yaml.responsesTitles];\n\t\t\t\t} else if (typeof yaml.responsesTitles == \"object\") {\n\t\t\t\t\t// Cas où le yaml renvoie un objet : conversion en array\n\t\t\t\t\tyaml.responsesTitles = Object.values(yaml.responsesTitles);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (\n\t\t\t\tyaml.userInput === false ||\n\t\t\t\tyaml.clavier === false ||\n\t\t\t\tyaml.keyboard === false\n\t\t\t) {\n\t\t\t\tyaml.userInput = false;\n\t\t\t\tdocument.body.classList.add(\"hideControls\");\n\t\t\t\tsendButton.innerHTML = \"Afficher tout\";\n\t\t\t}\n\t\t\tif (yaml.searchInContent || yaml.rechercheContenu) {\n\t\t\t\tyaml.searchInContent = yaml.rechercheContenu\n\t\t\t\t\t? yaml.rechercheContenu\n\t\t\t\t\t: yaml.searchInContent;\n\t\t\t}\n\t\t\tif (yaml.gestionGrosMots || yaml.detectBadWords) {\n\t\t\t\tyaml.detectBadWords = yaml.gestionGrosMots\n\t\t\t\t\t? yaml.gestionGrosMots\n\t\t\t\t\t: yaml.detectBadWords;\n\t\t\t\tif (yaml.detectBadWords === true) {\n\t\t\t\t\tPromise.all([\n\t\t\t\t\t\tloadScript(\"js/plugins/leo-profanity.js\"),\n\t\t\t\t\t\tloadScript(\"js/plugins/badWords-fr.js\"),\n\t\t\t\t\t])\n\t\t\t\t\t\t.then(() => {\n\t\t\t\t\t\t\t// Les deux scripts sont chargés et prêts à être utilisés\n\t\t\t\t\t\t\tfilterBadWords = window.LeoProfanity;\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\tfilterBadWords.add(badWordsFR);\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((error) => {\n\t\t\t\t\t\t\tconsole.error(\n\t\t\t\t\t\t\t\t\"Une erreur s'est produite lors du chargement des scripts :\",\n\t\t\t\t\t\t\t\terror,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (yaml.favicon) {\n\t\t\t\tconst faviconElement = document.getElementById(\"favicon\");\n\t\t\t\tfaviconElement.href = yaml.favicon;\n\t\t\t}\n\t\t\tif (yaml.defaultMessage || yaml.messageParDéfaut) {\n\t\t\t\tconfig.defaultMessage = yaml.messageParDéfaut\n\t\t\t\t\t? Object.values(yaml.messageParDéfaut)\n\t\t\t\t\t: yaml.defaultMessage;\n\t\t\t\twhile (config.defaultMessage.length < 5) {\n\t\t\t\t\tconfig.defaultMessage.push(...config.defaultMessage);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (yaml.footer === false) {\n\t\t\t\tdocument.body.classList.add(\"hideFooter\");\n\t\t\t} else if (typeof yaml.footer == \"string\") {\n\t\t\t\tsetContentOfFooter(footerElement, yaml.footer);\n\t\t\t}\n\t\t\tif (yaml.darkmode !== false) {\n\t\t\t\tcheckDarkModePreference();\n\t\t\t}\n\t\t\tif (yaml.theme) {\n\t\t\t\t// compatiblité avec l'ancien nom pour le thème sms\n\t\t\t\tconst themeName = yaml.theme == \"bubbles\" ? \"sms\" : yaml.theme;\n\t\t\t\tconst cssFile = themeName.endsWith(\".css\")\n\t\t\t\t\t? \"css/themes/\" + themeName\n\t\t\t\t\t: \"css/themes/\" + themeName + \".css\";\n\t\t\t\tloadCSS(cssFile);\n\t\t\t}\n\t\t\tif (yaml.avatar) {\n\t\t\t\tconst isAvatarCircle = yaml.avatarCircle || yaml.avatarCercle;\n\t\t\t\tconst avatarCircleCSS = isAvatarCircle ? \"border-radius:50%;\" : \"\";\n\t\t\t\tconst avatarCSS = `\n\t\t\t\t\t.bot-message > :first-child:before {\n\t\t\t\t\t\tbackground-image: url(\"${yaml.avatar}\");\n\t\t\t\t\t\t${avatarCircleCSS}\n\t\t\t\t\t};`;\n\t\t\t\tconst avatarStyleElement = document.createElement(\"style\");\n\t\t\t\tavatarStyleElement.textContent = avatarCSS;\n\t\t\t\tdocument.head.appendChild(avatarStyleElement);\n\t\t\t}\n\t\t\tif (yaml.style) {\n\t\t\t\tconst styleElement = document.createElement(\"style\");\n\t\t\t\tstyleElement.innerHTML = yaml.style;\n\t\t\t\tdocument.body.appendChild(styleElement);\n\t\t\t}\n\t\t\tif (\n\t\t\t\tyaml.dynamicContent ||\n\t\t\t\tyaml.contenuDynamique ||\n\t\t\t\tyaml.dynamicVariables ||\n\t\t\t\tyaml.variablesDynamiques\n\t\t\t) {\n\t\t\t\tyaml.dynamicContent =\n\t\t\t\t\tyaml.contenuDynamique ||\n\t\t\t\t\tyaml.dynamicContent ||\n\t\t\t\t\tyaml.dynamicVariables ||\n\t\t\t\t\tyaml.variablesDynamiques;\n\t\t\t}\n\t\t\tif (\n\t\t\t\tyaml.typewriter === false ||\n\t\t\t\tyaml.typeWriter === false ||\n\t\t\t\tyaml.effetDactylo === false\n\t\t\t) {\n\t\t\t\tyaml.typeWriter = false;\n\t\t\t}\n\t\t\tif (yaml.obfuscate) {\n\t\t\t\tyaml.obfuscate = yaml.obfuscate ? true : false;\n\t\t\t}\n\t\t\tif (yaml.bots) {\n\t\t\t\tfor (const [botName, botProperties] of Object.entries(yaml.bots)) {\n\t\t\t\t\tconst botAvatarCustomImageCSS = botProperties.avatar\n\t\t\t\t\t\t? 'background-image:url(\"' + botProperties.avatar + '\"); '\n\t\t\t\t\t\t: \"\";\n\t\t\t\t\tconst botAvatarCSSfromYAML = botProperties.cssAvatar\n\t\t\t\t\t\t? botProperties.cssAvatar\n\t\t\t\t\t\t: \"\";\n\t\t\t\t\tconst botAvatarCSS =\n\t\t\t\t\t\t\".botName-\" +\n\t\t\t\t\t\tbotName +\n\t\t\t\t\t\t\">:first-child:before {\" +\n\t\t\t\t\t\tbotAvatarCustomImageCSS +\n\t\t\t\t\t\tbotAvatarCSSfromYAML +\n\t\t\t\t\t\t\"}\";\n\t\t\t\t\tconst botCSSmessage = botProperties.cssMessage\n\t\t\t\t\t\t? botProperties.cssMessage\n\t\t\t\t\t\t: \"\";\n\t\t\t\t\tconst botCSS =\n\t\t\t\t\t\t\"<style>\" +\n\t\t\t\t\t\tbotAvatarCSS +\n\t\t\t\t\t\t\" .botName-\" +\n\t\t\t\t\t\tbotName +\n\t\t\t\t\t\t\"{\" +\n\t\t\t\t\t\tbotCSSmessage +\n\t\t\t\t\t\t\"}</style>\";\n\t\t\t\t\tPromise.all([loadCSS(botCSS)]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (yaml.useLLM.url || (yaml.utiliserLLM && yaml.utiliserLLM.url)) {\n\t\t\t\tyaml.useLLM = yaml.utiliserLLM ? yaml.utiliserLLM : yaml.useLLM;\n\t\t\t\tyaml.useLLM.RAGinformations = yaml.useLLM.informations\n\t\t\t\t\t? yaml.useLLM.informations\n\t\t\t\t\t: yaml.useLLM.RAGinformations;\n\t\t\t\tyaml.useLLM.RAGmaxTopElements = yaml.useLLM.maxTopElements\n\t\t\t\t\t? yaml.useLLM.maxTopElements\n\t\t\t\t\t: yaml.useLLM.RAGmaxTopElements;\n\t\t\t\tyaml.useLLM.RAGseparator = yaml.useLLM.separator\n\t\t\t\t\t? yaml.useLLM.separator\n\t\t\t\t\t: yaml.useLLM.RAGseparator;\n\t\t\t\tif (yaml.useLLM.askAPIkey === true) {\n\t\t\t\t\tyaml.useLLM.apiKey = prompt(\n\t\t\t\t\t\t\"Ce chatbot peut se connecter à une IA pour enrichir les réponses proposées. Entrez votre clé API, puis cliquez sur “OK” pour pouvoir bénéficier de cette fonctionnalité. Sinon, cliquez sur “Annuler”.\",\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tif (yaml.useLLM.encryptedAPIkey) {\n\t\t\t\t\t\t// Si on met \"true\" comme valeur à yaml.useLLM.encryptedAPIkey, cela signifie qu'on utilise un serveur d'API qui cache par défaut la clé\n\t\t\t\t\t\tif (yaml.useLLM.encryptedAPIkey !== true) {\n\t\t\t\t\t\t\t// Sinon, cela signifie qu'on a chiffré la clé avec un mot de passe et qu'on demande donc le mot de passe à l'utilisateur\n\t\t\t\t\t\t\tyaml.useLLM.encryptionMethod = yaml.useLLM.encryptionMethod\n\t\t\t\t\t\t\t\t? yaml.useLLM.encryptionMethod\n\t\t\t\t\t\t\t\t: \"XOR\";\n\t\t\t\t\t\t\tconst apiKeyPassword = prompt(\n\t\t\t\t\t\t\t\t\"Ce chatbot peut se connecter à une IA pour enrichir les réponses proposées. Entrez le mot de passe qui vous a été communiqué, puis cliquez sur “OK” pour pouvoir bénéficier de cette fonctionnalité. Sinon, cliquez sur “Annuler”.\",\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tyaml.useLLM.apiKey = decodeApiKey(\n\t\t\t\t\t\t\t\tyaml.useLLM.encryptedAPIkey,\n\t\t\t\t\t\t\t\tapiKeyPassword,\n\t\t\t\t\t\t\t\tyaml.useLLM.encryptionMethod,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tyaml.useLLM.apiKey =\n\t\t\t\t\t\t\t// eslint-disable-next-line no-undef\n\t\t\t\t\t\t\tprocess && process.env && process.env.LLM_API_KEY // eslint-disable-next-line no-undef\n\t\t\t\t\t\t\t\t? process.env.LLM_API_KEY\n\t\t\t\t\t\t\t\t: \"\"; // Attention à ne pas diffuser publiquement votre clé API, il vaut mieux la définir dans une variable d'environnement\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tconsole.log(\"erreur processYAML : \" + e);\n\t\t}\n\t} else {\n\t\tcheckDarkModePreference();\n\t}\n\treturn yaml;\n}\n","// Pour vérifier si une variable texte commence par un élément d'un tableau\nexport function startsWithAnyOf(string, array) {\n\tfor (const element of array) {\n\t\tif (string.startsWith(element)) {\n\t\t\treturn element;\n\t\t}\n\t}\n}\n\nexport function tryConvertStringToNumber(input) {\n\tconst number = parseFloat(input);\n\tif (!isNaN(number) && number.toString() === input.toString().trim()) {\n\t\treturn number;\n\t} else {\n\t\treturn input;\n\t}\n}\n\n// Pour vérifier si une chaîne de caractère se termine par un signe qui marque la fin d'un texte.\nexport function hasSentenceEndMark(str) {\n\tconst trimmed = str.trim();\n\tconst lastChar = trimmed.slice(-1);\n\treturn [\".\", \"!\", \"?\", \"…\", \">\"].includes(lastChar);\n}\n\nexport function sanitizeHtml(html, allowedTags) {\n\treturn html.replace(/<[^>]+>/g, (tag) => {\n\t\treturn allowedTags.includes(tag) ? tag : \"\";\n\t});\n}\n\n// Pour créer des chunkjs entourés de backticks\n// chunkSize définit le nombre de caractères maximum de chaque chunk\nexport function chunkWithBackticks(string, chunkSize = 5) {\n\tif (!string) return \"\";\n\n\tconst chunks = [];\n\tfor (let i = 0; i < string.length; i += chunkSize) {\n\t\tconst substring = string.slice(i, i + chunkSize);\n\t\tchunks.push(\"`\" + substring + \"`\");\n\t}\n\treturn chunks.join(\"\");\n}\n\nfunction isBacktickWrapped(string) {\n\treturn string.startsWith(\"`\") && string.endsWith(\"`\");\n}\nfunction hasPauseMarker(string) {\n\treturn /\\^\\d+/.test(string);\n}\n\n// Pour découper un texte en chunks de N caractères (afin de l'afficher plus rapidement), sans découper les balises HTML et sans découper le texte qui est déjà entre des backticks\nexport function splitHtmlIntoChunks(html, chunkSize) {\n\t// Divise le texte sur les backticks\n\tconst parts = html.split(/(`[^`]*`)/);\n\t// Traite chaque partie\n\tconst processedParts = parts.map((part) => {\n\t\t// Si la partie est entre backticks, on la garde telle quelle\n\t\tif (isBacktickWrapped(part)) {\n\t\t\treturn part;\n\t\t} else {\n\t\t\tlet processed = part;\n\n\t\t\t// Cas 1 : texte entre balises HTML\n\t\t\tprocessed = processed.replace(/>([^<]*)</g, (match, textBetweenTags) => {\n\t\t\t\tconst processedText = hasPauseMarker(textBetweenTags)\n\t\t\t\t\t? textBetweenTags\n\t\t\t\t\t: chunkWithBackticks(textBetweenTags, chunkSize);\n\t\t\t\treturn `>${processedText}<`;\n\t\t\t});\n\n\t\t\t// Cas 2 : il reste une balise HTML ouvrante en début (mais il n'y avait pas de balise HTML fermante)\n\t\t\tprocessed = processed.replace(/>([^<]*)$/, (match, text) => {\n\t\t\t\tconst processedText = hasPauseMarker(text)\n\t\t\t\t\t? text\n\t\t\t\t\t: chunkWithBackticks(text, chunkSize);\n\t\t\t\treturn match.replace(text, processedText);\n\t\t\t});\n\n\t\t\t// Cas 3 : il reste une balise HTML fermante à la fin (mais il n'y avait pas de balise HTML ouvrante)\n\t\t\tprocessed = processed.replace(/^([^<]*)<.*$/, (match, text) => {\n\t\t\t\tconst processedText = hasPauseMarker(text)\n\t\t\t\t\t? text\n\t\t\t\t\t: chunkWithBackticks(text, chunkSize);\n\t\t\t\treturn match.replace(text, processedText);\n\t\t\t});\n\n\t\t\treturn processed;\n\t\t}\n\t});\n\treturn processedParts.join(\"\");\n}\n\nexport function encodeString(str) {\n\treturn window.btoa(encodeURIComponent(str));\n}\n\nexport function decodeString(str) {\n\treturn decodeURIComponent(window.atob(str));\n}\n\n// Obfuscation Unicode-safe\nexport function obfuscateString(str) {\n\tconst bytes = new TextEncoder().encode(str); // UTF-8 encoding\n\tlet binary = \"\";\n\tfor (const b of bytes) {\n\t\tbinary += String.fromCharCode(b);\n\t}\n\treturn btoa(binary);\n}\n\n// Désobfuscation Unicode-safe\nexport function deobfuscateString(str) {\n\tconst binary = atob(str);\n\tconst bytes = new Uint8Array(binary.length);\n\tfor (let i = 0; i < binary.length; i++) {\n\t\tbytes[i] = binary.charCodeAt(i);\n\t}\n\treturn new TextDecoder().decode(bytes); // UTF-8 decoding\n}\n\n// Vérifie si une chaîne de caractère se termine par une balise HTML non fermée\nexport function endsWithUnclosedHtmlTag(str) {\n\tconst lastOpenBracket = str.lastIndexOf(\"<\");\n\tconst lastCloseBracket = str.lastIndexOf(\">\");\n\n\tif (lastOpenBracket === -1 || lastCloseBracket <= lastOpenBracket) {\n\t\treturn false;\n\t}\n\n\tconst contentInsideLastBrackets = str\n\t\t.slice(lastOpenBracket + 1, lastCloseBracket)\n\t\t.trim();\n\n\treturn (\n\t\t!contentInsideLastBrackets.endsWith(\"/\") &&\n\t\t!contentInsideLastBrackets.startsWith(\"/\") &&\n\t\tcontentInsideLastBrackets !== \"br\" &&\n\t\tcontentInsideLastBrackets !== \"hr\"\n\t);\n}\n","import { handleURL } from \"../../utils/urls.mjs\";\nimport {\n\tfetchContentFromMultipleSources,\n\tfetchContentWithProxyIfNeeded,\n} from \"./helpers/fetch.mjs\";\nimport { processYAML } from \"../../markdown/custom/yaml.mjs\";\nimport { validateMarkdown } from \"./helpers/validate.mjs\";\nimport { decodeString } from \"../../utils/strings.mjs\";\n\nexport async function getContent(defaultMd, params) {\n\tlet content = defaultMd;\n\tlet yaml;\n\t// On récupère la source du chatbot dans le hash s'il y en a une\n\tconst hash = window.location.hash.substring(1).replace(/\\?.*/, \"\");\n\n\t// Si la source n'est pas une URL, mais directement le texte du chatbot (encodé en base64), on renvoie ce texte comme source\n\tif (params && params.raw) {\n\t\tconst rawContent = decodeString(hash);\n\t\treturn { markdown: rawContent, yaml: processYAML(rawContent) };\n\t}\n\t// Si la source est une URL, on la traite pour pouvoir récupérer correctement la source du chatbot\n\tlet sourceChatBot = handleURL(hash);\n\n\tif (!sourceChatBot && navigator.language.includes(\"en-\")) {\n\t\tsourceChatBot = \"https://chatmd.forge.apps.education.fr/_i18n/index.en.md\";\n\t}\n\n\tif (sourceChatBot) {\n\t\tif (Array.isArray(sourceChatBot)) {\n\t\t\t// Cas où la source est répartie dans plusieurs fichiers (via un raccourci qui indique de récupérer plusieurs fichiers)\n\t\t\tcontent = await fetchContentFromMultipleSources(sourceChatBot);\n\t\t} else {\n\t\t\t// Récupération du contenu du fichier\n\t\t\tcontent = await fetchContentWithProxyIfNeeded(sourceChatBot);\n\t\t}\n\t}\n\tyaml = processYAML(content);\n\tif (yaml && yaml.include) {\n\t\t// Cas où on doit inclure le contenu d'autres fichiers à la suite du premier (fichiers définis dans l'en-tête YAML du premier fichier, avec le paramètre \"include\")\n\t\tconst includes =\n\t\t\ttypeof yaml.include === \"object\"\n\t\t\t\t? yaml.include\n\t\t\t\t: { include: yaml.include };\n\t\tconst contentToInclude = await fetchContentFromMultipleSources(includes);\n\t\tcontent = content + \"\\n\\n\" + contentToInclude;\n\t}\n\t// On valide le Markdown, sinon on obtient un message d'erreur\n\tcontent = validateMarkdown(content, defaultMd);\n\treturn { markdown: content, yaml: yaml ? yaml : processYAML(content) };\n}\n","export function validateMarkdown(md, defaultMd) {\n\tif (!md.includes(\"# \")) {\n\t\talert(\n\t\t\t\"L'URL indiquée ne renvoie pas à un fichier en Markdown avec une syntaxe correcte\",\n\t\t);\n\t\tmd = defaultMd;\n\t}\n\treturn md;\n}\n","import { startsWithAnyOf } from \"../../../../utils/strings.mjs\";\n\nconst regexOrderedList = /^\\d{1,3}[.)]\\s\\[([^\\]]*?)\\]\\(([^)]*)\\)\\s*$/;\nconst regexOrderedListRandom = /^\\d{1,3}\\)/;\nconst externalLinks = [\"http\", \"mailto:\", \"tel:\"];\n\nfunction isExternalLink(url) {\n\turl = url.trim().toLowerCase();\n\treturn startsWithAnyOf(url, externalLinks);\n}\n\nexport function detectChoiceOption(line) {\n\tconst match = line.match(regexOrderedList);\n\tlet isChoice = false;\n\tlet text = \"\";\n\tlet url = \"\";\n\n\tif (match) {\n\t\ttext = match[1];\n\t\turl = match[2];\n\t\tisChoice = !isExternalLink(url);\n\t}\n\n\treturn {\n\t\tisChoice: isChoice,\n\t\ttext: text,\n\t\turl: url,\n\t\tisRandom: isChoice && regexOrderedListRandom.test(line),\n\t};\n}\n","import { startsWithAnyOf } from \"../../../../utils/strings.mjs\";\n\nexport function detectedResponseTitle(line, yaml) {\n\treturn yaml ? startsWithAnyOf(line, yaml.responsesTitles) : \"\";\n}\n\n// Retourne les titres de structure (titres avant le niveau des titres de réponses)\nexport function getStructureTitles(yaml) {\n\tconst responseTitlesLevels =\n\t\tyaml && Array.isArray(yaml.responsesTitles) && yaml.responsesTitles\n\t\t\t? yaml.responsesTitles.map((title) => title.lastIndexOf(\"#\") + 1)\n\t\t\t: [];\n\n\tif (responseTitlesLevels.length === 0) {\n\t\treturn [];\n\t}\n\n\tconst minResponseTitlesLevel = Math.min(...responseTitlesLevels);\n\n\tconst structureTitles = [];\n\tfor (let i = 1; i < minResponseTitlesLevel; i++) {\n\t\tstructureTitles.push(\"#\".repeat(i) + \" \");\n\t}\n\n\treturn structureTitles;\n}\n\n// Vérifie si une ligne est un titre de structure\nexport function isStructureTitle(line, yaml) {\n\tconst structuredTitles = getStructureTitles(yaml);\n\tif (!Array.isArray(structuredTitles) || structuredTitles.length == 0)\n\t\treturn false;\n\treturn startsWithAnyOf(line, structuredTitles) &&\n\t\tstartsWithAnyOf(line, structuredTitles).length > 0\n\t\t? true\n\t\t: false;\n}\n","import { config } from \"../../../../config.mjs\";\nimport { obfuscateString } from \"../../../../utils/strings.mjs\";\nimport {\n\tdetectedResponseTitle,\n\tisStructureTitle,\n} from \"./detectResponseTitle.mjs\";\n\nconst regexDynamicContentIfBlock = /`if (.*?)`/;\n\n// Gestion des titres de réponse\nexport function handleNewResponseTitle(line, yaml, currentData, chatbotData) {\n\tif (currentData.responseTitle) {\n\t\tchatbotData.push({\n\t\t\ttitle: currentData.responseTitle,\n\t\t\tkeywords: currentData.keywords,\n\t\t\tchoiceOptions: currentData.choiceOptions,\n\t\t\tcontent: currentData.content,\n\t\t});\n\t}\n\tcurrentData.responseTitle = line\n\t\t.replace(detectedResponseTitle(line, yaml), \"\")\n\t\t.trim();\n\tcurrentData.keywords = [];\n\tcurrentData.choiceOptions = null;\n\tcurrentData.content = [];\n\tcurrentData.listParsed = false;\n}\n\n// Gestion des mots clés\nexport function handleKeywords(line, currentData) {\n\tcurrentData.keywords.push(line.replace(\"- \", \"\").trim());\n}\n\n// Gestion des blocs conditionnels, éventuellement imbriqués\nexport function handleDynamicContent(line, currentData, yaml) {\n\tif (!yaml || !yaml.dynamicContent) return false;\n\n\t// On initialise la pile si elle n'existe pas\n\tif (!currentData.conditionStack) {\n\t\tcurrentData.conditionStack = [];\n\t}\n\n\t// Bloc d'ouverture `if`\n\tif (regexDynamicContentIfBlock.test(line)) {\n\t\tconst condition =\n\t\t\t(line.match(regexDynamicContentIfBlock) &&\n\t\t\t\tline.match(regexDynamicContentIfBlock)[1]) ||\n\t\t\t\"\";\n\n\t\tcurrentData.conditionStack.push(condition);\n\n\t\t// Combine toutes les conditions avec &&\n\t\tcurrentData.condition = currentData.conditionStack.join(\" && \");\n\t\tcurrentData.content.push(line + \"\\n\");\n\t\tcurrentData.listParsed = true;\n\t\treturn true;\n\t}\n\n\t// Bloc de fermeture `endif`\n\tif (line.includes(\"`endif`\")) {\n\t\t// Retire la condition du niveau d'imbrication actuel\n\t\tif (currentData.conditionStack.length > 0) {\n\t\t\tcurrentData.conditionStack.pop();\n\t\t}\n\n\t\tcurrentData.condition = currentData.conditionStack.join(\" && \") || \"\";\n\t\tcurrentData.content.push(line + \"\\n\");\n\t\tcurrentData.listParsed = true;\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n// Gestion des éventuelles options de choix proposées en fin de réponse\nexport function handleChoiceOptions(choiceInformations, yaml, currentData) {\n\tcurrentData.listParsed = false;\n\tif (!currentData.choiceOptions) {\n\t\tcurrentData.choiceOptions = [];\n\t}\n\tlet link = choiceInformations.url;\n\t// Compatibilité avec les liens de type ancre\n\tif (link.startsWith(\"#\")) {\n\t\tlink = link.slice(1).replaceAll(\"-\", \" \");\n\t}\n\tlink = yaml.obfuscate ? obfuscateString(link) : link;\n\tlet text = choiceInformations.text;\n\tcurrentData.choiceOptions.push({\n\t\ttext: text ? text : config.defaultChoiceOptionText,\n\t\tlink: link,\n\t\tisRandom: choiceInformations.isRandom,\n\t\tcondition: currentData.condition,\n\t});\n}\n\n// Gestion du reste du contenu de la réponse\nexport function handleRegularContent(line, yaml, currentData) {\n\tif (line.length > 0 && !isStructureTitle(line, yaml)) {\n\t\t// Gestion des liens à l'intérieur du contenu, vers une réponse\n\t\tline = line.replaceAll(/\\[(.*?)\\]\\((#.*?)\\)/g, '<a href=\"$2\">$1</a>');\n\t\tcurrentData.content.push(line);\n\t\tcurrentData.listParsed = true;\n\t}\n}\n","// Pour tirer au hasard un élément dans un tableau\nexport function getRandomElement(array) {\n\treturn array[Math.floor(Math.random() * array.length)];\n}\n\n// Pour ne garder que les éléments avec la valeur la plus grande dans un tableau\nexport function topElements(array, maxElements) {\n\tlet topElements;\n\tif (array.length < maxElements) {\n\t\t// Si le tableau contient moins que maxElements : on garde tout le tableau\n\t\ttopElements = array.map((element, index) => [element, index]);\n\t} else {\n\t\t// Sinon, on garde seulement les éléments qui ont la valeur la plus grande\n\t\ttopElements = array.reduce((acc, val, index) => {\n\t\t\tif (acc.length < maxElements) {\n\t\t\t\tacc.push([val, index]);\n\t\t\t\tacc.sort((a, b) => a[0] - b[0]);\n\t\t\t} else if (val > acc[0][0]) {\n\t\t\t\tacc[0] = [val, index];\n\t\t\t\tacc.sort((a, b) => a[0] - b[0]);\n\t\t\t}\n\t\t\treturn acc;\n\t\t}, []);\n\t}\n\t// Trier par ordre décroissant\n\ttopElements.sort((a, b) => b[0] - a[0]);\n\n\treturn topElements;\n}\n\n// Pour réordonner de manière aléatoire un tableau\nexport function shuffleArray(array) {\n\treturn array.sort(function () {\n\t\treturn Math.random() - 0.5;\n\t});\n}\n\n// Pour mettre de l'aléatoire dans un tableau, en conservant cependant la position de certains éléments\nexport function randomizeArrayWithFixedElements(array) {\n\tlet fixedElements = [];\n\tlet randomizableElements = [];\n\n\t// On distingue les éléments fixes et les éléments à ordonner de manière aléatoire\n\tarray.forEach(function (element) {\n\t\tif (!element.isRandom) {\n\t\t\tfixedElements.push(element);\n\t\t} else {\n\t\t\trandomizableElements.push(element);\n\t\t}\n\t});\n\n\t// On ordonne de manière aléatoire les éléments qui doivent l'être\n\trandomizableElements = shuffleArray(randomizableElements);\n\n\t// On reconstruit le tableau en réinsérant les éléments fixes au bon endroit\n\tvar finalArray = [];\n\tarray.forEach(function (element) {\n\t\tif (!element.isRandom) {\n\t\t\tfinalArray.push(element);\n\t\t} else {\n\t\t\tfinalArray.push(randomizableElements.shift());\n\t\t}\n\t});\n\n\treturn finalArray;\n}\n\n// Pour tester si le tableau des options doit être réordonné avec de l'aléatoire\nexport function shouldBeRandomized(array) {\n\tif (Array.isArray(array)) {\n\t\tconst arrayLength = array.length;\n\t\tfor (let i = 0; i < arrayLength; i++) {\n\t\t\tif (array[i].isRandom === true) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\treturn false;\n}\n\n// Pour récupérer le i-ème élément d'un tableau en partant de la fin\nexport function getElementFromEnd(array, index = 1) {\n\treturn !Array.isArray(array) || array.length === 0\n\t\t? undefined\n\t\t: array[array.length - index];\n}\n","import { getRandomElement } from \"../../utils/arrays.mjs\";\n\n// Gestion des variables fixes : soit avant de parser le markdown, soit après\nexport function processFixedVariables(content, yaml, options) {\n\t// Les variables fixes qui commencent par _ sont traitées avant de parser le contenu du Markdown\n\tconst preprocess = options && options.preprocess;\n\tconst regex = preprocess ? /@{(_\\S+)}/g : /@{(\\S+)}/g;\n\treturn content.replaceAll(\n\t\tregex,\n\t\tfunction (match, variableName, positionMatch) {\n\t\t\tconst positionLastMatch = content.lastIndexOf(match);\n\t\t\tif (yaml && yaml.variables && yaml.variables[variableName]) {\n\t\t\t\tconst variableValue = yaml.variables[variableName];\n\t\t\t\tconst variableValueSplit = Array.isArray(variableValue)\n\t\t\t\t\t? variableValue\n\t\t\t\t\t: variableValue.split(\"///\");\n\t\t\t\tconst variableValueChoice = getRandomElement(variableValueSplit);\n\t\t\t\tif (preprocess && positionMatch == positionLastMatch) {\n\t\t\t\t\t// Les variables fixes qui ont été traitées au tout début, avant de parser le contenu du Markdown, sont ensuite supprimés.\n\t\t\t\t\tdelete yaml.variables[variableName];\n\t\t\t\t}\n\t\t\t\treturn variableValueChoice;\n\t\t\t} else {\n\t\t\t\treturn \"@{\" + variableName + \"}\";\n\t\t\t}\n\t\t},\n\t);\n}\n","import { removeYaml } from \"./parsers/helpers/removeYaml.mjs\";\nimport { extractIntroduction } from \"./parsers/extractIntroduction.mjs\";\nimport { getChatbotInformations } from \"./parsers/getChatbotInformations.mjs\";\nimport { processFixedVariables } from \"../../markdown/custom/variablesFixed.mjs\";\n\nexport function parseMarkdown(md, yaml) {\n\t// Fix pour l'utilisation de \\\\ dans le Latex\n\tmd = md.replaceAll(\"\\\\\\\\\", \"&#92;&#92;\");\n\t// Fix pour les textes avec des fins de ligne CRLF\n\tmd = md.replaceAll(\"\\r\\n\", \"\\n\");\n\n\t// On récupère le contenu principal sans l'en-tête YAML s'il existe\n\tmd = removeYaml(md);\n\n\t// On traite les variables fixes s'il y en a\n\tif (yaml && yaml.variables) {\n\t\tmd = processFixedVariables(md, yaml, { preprocess: true });\n\t}\n\n\t// On extrait dans le Mardown le contenu de l'introduction\n\tconst introductionContent = extractIntroduction(md);\n\tconst chatbotTitle = introductionContent.chatbotTitle;\n\tconst initialMessage = introductionContent.chatbotInitialMessage;\n\tconst indexEndIntroduction = introductionContent.indexEnd;\n\n\tconst introduction = {\n\t\tindexEnd: indexEndIntroduction,\n\t\tchatbotTitle: chatbotTitle,\n\t\tinitialMessage: initialMessage,\n\t};\n\n\t// On extrait les informations du chatbot dans la source en Markdown\n\tlet chatbotInformations = getChatbotInformations(md, introduction, yaml);\n\n\t// On récupère les informations contenues dans l'introduction du chatbot\n\tconst initialMessageContent = chatbotInformations[0].content;\n\tconst initialMessageChoiceOptions = chatbotInformations[0].choiceOptions;\n\n\t// On supprime les informations de l'introduction du chatbot dans la liste des réponses possibles\n\tchatbotInformations.shift();\n\n\t// On crée la structure de données du chatbot\n\tlet chatbotData = {\n\t\tresponses: chatbotInformations,\n\t\tinitialMessage: {\n\t\t\tcontent: initialMessageContent,\n\t\t\tchoiceOptions: initialMessageChoiceOptions,\n\t\t},\n\t\ttitle: chatbotTitle,\n\t};\n\n\treturn chatbotData;\n}\n","export function removeYaml(md) {\n\tmd = \"\\n\" + md;\n\t// On cherche le premier titre H1\n\tconst indexH1 = md.indexOf(\"\\n# \");\n\n\tif (indexH1 > -1) {\n\t\t// Si on trouve un titre H1, on retourne tout à partir de ce titre\n\t\treturn md.substring(indexH1).trimStart();\n\t}\n\n\t// S'il n'y a pas de premier titre H1, on cherche un bloc YAML au début\n\tconst trimmed = md.trimStart();\n\tif (trimmed.startsWith(\"---\\n\")) {\n\t\t// On cherche la marque de fin du YAML dans le contenu qui se trouve après la marque de début du YAML\n\t\tconst endIndex = trimmed.indexOf(\"\\n---\\n\", 4);\n\t\tif (endIndex > -1) {\n\t\t\t// On retourne tout ce qui se trouve après la marque de fin du YAML\n\t\t\treturn trimmed.substring(endIndex + 5).trimStart();\n\t\t}\n\t}\n\n\t// Aucun H1 ni YAML détecté : on retourne le contenu original\n\treturn trimmed;\n}\n","export function extractIntroduction(mdWithoutYaml) {\n\t// On récupère la séparation entre la première partie des données (titre + message principal) et la suite avec les réponses possibles\n\tmdWithoutYaml = mdWithoutYaml.trim();\n\tconst mdWithoutYamlAndWithoutH1 = mdWithoutYaml.substring(1);\n\tconst possibleTitles = [\"# \", \"## \", \"### \", \"#### \", \"##### \"];\n\tconst indexOfFirstTitles = possibleTitles\n\t\t.map((title) => mdWithoutYamlAndWithoutH1.indexOf(title))\n\t\t.filter((index) => index > 0);\n\tconst indexEndIntroduction =\n\t\tindexOfFirstTitles.length > 0\n\t\t\t? Math.min(...indexOfFirstTitles) + 1\n\t\t\t: mdWithoutYaml.length;\n\tconst chatbotIntroduction = mdWithoutYaml.substring(0, indexEndIntroduction);\n\t// Gestion du titre\n\tconst chatbotTitleMatch = chatbotIntroduction.match(/# .*/);\n\tconst chatbotTitle = chatbotTitleMatch ? chatbotTitleMatch[0] : \"Chatbot\";\n\tconst indexStartTitle = chatbotIntroduction.indexOf(chatbotTitle);\n\t// Gestion du message initial\n\tconst initialMessageContent = chatbotTitleMatch\n\t\t? chatbotIntroduction.substring(indexStartTitle + chatbotTitle.length)\n\t\t: chatbotIntroduction.substring(indexStartTitle);\n\treturn {\n\t\tindexEnd: indexEndIntroduction,\n\t\tchatbotInitialMessage: initialMessageContent,\n\t\tchatbotTitle: chatbotTitle ? chatbotTitle.replace(\"# \", \"\").trim() : \"\",\n\t};\n}\n","import { detectChoiceOption } from \"./helpers/detectChoiceOption.mjs\";\nimport { detectedResponseTitle } from \"./helpers/detectResponseTitle.mjs\";\nimport {\n\thandleNewResponseTitle,\n\thandleKeywords,\n\thandleDynamicContent,\n\thandleChoiceOptions,\n\thandleRegularContent,\n} from \"./helpers/processorsChatbotContent.mjs\";\n\nexport function getChatbotInformations(mdWithoutYaml, introduction, yaml) {\n\tconst indexEndIntroduction = introduction.indexEnd;\n\tconst chatbotTitle = introduction.chatbotTitle;\n\tconst initialMessage = introduction.initialMessage.replace(/^>\\s?/gm, \"\");\n\tconst titleLine = chatbotTitle ? \"## \" + chatbotTitle : \"## Chatbot\";\n\tconst introductionContent = titleLine + \"\\n\" + initialMessage + \"\\n\";\n\tconst chatbotContent =\n\t\tintroductionContent + mdWithoutYaml.trim().substring(indexEndIntroduction);\n\tconst chatbotContentLines = chatbotContent.split(\"\\n\");\n\tconst chatbotData = [];\n\n\tconst currentData = {\n\t\tresponseTitle: null,\n\t\tkeywords: [],\n\t\tcontent: [],\n\t\tchoiceOptions: null,\n\t\tlistParsed: false,\n\t\tcondition: \"\",\n\t};\n\n\tlet searchForKeywords = true;\n\n\tfor (let line of chatbotContentLines) {\n\t\t// Gestion des titres de réponse\n\t\tif (detectedResponseTitle(line, yaml) || (titleLine && line == titleLine)) {\n\t\t\tif (titleLine && line == titleLine) {\n\t\t\t\tline = line.replace(\"## \", \"\");\n\t\t\t}\n\t\t\thandleNewResponseTitle(line, yaml, currentData, chatbotData);\n\t\t\tsearchForKeywords = true;\n\t\t\tcontinue;\n\t\t}\n\t\tif (!line.trim()) {\n\t\t\t// Les keywords doivent être mis juste après le titre, sans ligne vide après le titre\n\t\t\t// Si on a sauté de ligne, c'est qu'on est passé à la suite du message\n\t\t\tsearchForKeywords = false;\n\t\t}\n\n\t\t// Gestion des mots clés\n\t\tif (searchForKeywords && line.startsWith(\"- \") && !currentData.listParsed) {\n\t\t\thandleKeywords(line, currentData);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Gestion des blocs conditionnels si on a du contenu dynamique\n\t\tif (handleDynamicContent(line, currentData, yaml)) {\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Gestion des éventuelles options de choix proposées en fin de réponse\n\t\tconst choiceInformations = detectChoiceOption(line);\n\t\tif (choiceInformations.isChoice) {\n\t\t\thandleChoiceOptions(choiceInformations, yaml, currentData);\n\t\t\tcontinue;\n\t\t}\n\n\t\t// Gestion du reste du contenu de la réponse\n\t\thandleRegularContent(line, yaml, currentData);\n\t}\n\tchatbotData.push({\n\t\ttitle: currentData.responseTitle,\n\t\tkeywords: currentData.keywords,\n\t\tchoiceOptions: currentData.choiceOptions,\n\t\tcontent: currentData.content,\n\t});\n\n\treturn chatbotData;\n}\n","/*! showdown v 2.0.0-alpha1 - 08-03-2019 */\n/* https://github.com/showdownjs/showdown/blob/8f1aaa079be5efe7de1e7a5035fd05bd4679831a/dist/showdown.esm.js */\n\nvar Showdown = function () {\n\t/**\n\t * Created by Tivie on 13-07-2015.\n\t */\n\n\tfunction getDefaultOpts(simple) {\n\t\t\"use strict\";\n\n\t\tvar defaultOptions = {\n\t\t\tomitExtraWLInCodeBlocks: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Omit the default extra whiteline added to code blocks\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tnoHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off generated header id\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tprefixHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe:\n\t\t\t\t\t\"Add a prefix to the generated header ids. Passing a string will prefix that string to the header id. Setting to true will add a generic 'section-' prefix\",\n\t\t\t\ttype: \"string\",\n\t\t\t},\n\t\t\trawPrefixHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe:\n\t\t\t\t\t'Setting this option to true will prevent showdown from modifying the prefix. This might result in malformed IDs (if, for instance, the \" char is used in the prefix)',\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tghCompatibleHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe:\n\t\t\t\t\t\"Generate header ids compatible with github style (spaces are replaced with dashes, a bunch of non alphanumeric chars are removed)\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\trawHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe:\n\t\t\t\t\t\"Remove only spaces, ' and \\\" from generated header ids (including prefixes), replacing them with dashes (-). WARNING: This might result in malformed ids\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\theaderLevelStart: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"The header blocks level start\",\n\t\t\t\ttype: \"integer\",\n\t\t\t},\n\t\t\tparseImgDimensions: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off image dimension parsing\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tsimplifiedAutoLink: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off GFM autolink style\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tliteralMidWordUnderscores: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Parse midword underscores as literal underscores\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tliteralMidWordAsterisks: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Parse midword asterisks as literal asterisks\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tstrikethrough: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off strikethrough support\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\ttables: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off tables support\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\ttablesHeaderId: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Add an id to table headers\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tghCodeBlocks: {\n\t\t\t\tdefaultValue: true,\n\t\t\t\tdescribe: \"Turn on/off GFM fenced code blocks support\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\ttasklists: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe: \"Turn on/off GFM tasklist support\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tsmoothLivePreview: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescribe:\n\t\t\t\t\t\"Prevents weird effects in live previews due to incomplete input\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tsmartIndentationFix: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Tries to smartly fix indentation in es6 strings\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tdisableForced4SpacesIndentedSublists: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Disables the requirement of indenting nested sublists by 4 spaces\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tsimpleLineBreaks: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Parses simple line breaks as <br> (GFM Style)\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\trequireSpaceBeforeHeadingText: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Makes adding a space between `#` and the header text mandatory (GFM Style)\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tghMentions: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Enables github @mentions\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tghMentionsLink: {\n\t\t\t\tdefaultValue: \"https://github.com/{u}\",\n\t\t\t\tdescription:\n\t\t\t\t\t\"Changes the link generated by @mentions. Only applies if ghMentions option is enabled.\",\n\t\t\t\ttype: \"string\",\n\t\t\t},\n\t\t\tencodeEmails: {\n\t\t\t\tdefaultValue: true,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Encode e-mail addresses through the use of Character Entities, transforming ASCII e-mail addresses into its equivalent decimal entities\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\topenLinksInNewWindow: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Open all links in new windows\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tbackslashEscapesHTMLTags: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Support for HTML Tag escaping. ex: <div>foo</div>\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\temoji: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Enable emoji support. Ex: `this is a :smile: emoji`\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tunderline: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Enable support for underline. Syntax is double or triple underscores: `__underline word__`. With this option enabled, underscores no longer parses into `<em>` and `<strong>`\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tcompleteHTMLDocument: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Outputs a complete html document, including `<html>`, `<head>` and `<body>` tags\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tmetadata: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription:\n\t\t\t\t\t\"Enable support for document metadata (defined at the top of the document between `«««` and `»»»` or between `---` and `---`).\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t\tsplitAdjacentBlockquotes: {\n\t\t\t\tdefaultValue: false,\n\t\t\t\tdescription: \"Split adjacent blockquote blocks\",\n\t\t\t\ttype: \"boolean\",\n\t\t\t},\n\t\t};\n\t\tif (simple === false) {\n\t\t\treturn JSON.parse(JSON.stringify(defaultOptions));\n\t\t}\n\t\tvar ret = {};\n\t\tfor (var opt in defaultOptions) {\n\t\t\tif (defaultOptions.hasOwnProperty(opt)) {\n\t\t\t\tret[opt] = defaultOptions[opt].defaultValue;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tfunction allOptionsOn() {\n\t\t\"use strict\";\n\t\tvar options = getDefaultOpts(true),\n\t\t\tret = {};\n\t\tfor (var opt in options) {\n\t\t\tif (options.hasOwnProperty(opt)) {\n\t\t\t\tret[opt] = true;\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\t/**\n\t * Created by Tivie on 06-01-2015.\n\t */\n\t// Private properties\n\tvar showdown = {},\n\t\tparsers = {},\n\t\textensions = {},\n\t\tglobalOptions = getDefaultOpts(true),\n\t\tsetFlavor = \"vanilla\",\n\t\tflavor = {\n\t\t\tgithub: {\n\t\t\t\tomitExtraWLInCodeBlocks: true,\n\t\t\t\tsimplifiedAutoLink: true,\n\t\t\t\tliteralMidWordUnderscores: true,\n\t\t\t\tstrikethrough: true,\n\t\t\t\ttables: true,\n\t\t\t\ttablesHeaderId: true,\n\t\t\t\tghCodeBlocks: true,\n\t\t\t\ttasklists: true,\n\t\t\t\tdisableForced4SpacesIndentedSublists: true,\n\t\t\t\tsimpleLineBreaks: true,\n\t\t\t\trequireSpaceBeforeHeadingText: true,\n\t\t\t\tghCompatibleHeaderId: true,\n\t\t\t\tghMentions: true,\n\t\t\t\tbackslashEscapesHTMLTags: true,\n\t\t\t\temoji: true,\n\t\t\t\tsplitAdjacentBlockquotes: true,\n\t\t\t},\n\t\t\toriginal: {\n\t\t\t\tnoHeaderId: true,\n\t\t\t\tghCodeBlocks: false,\n\t\t\t},\n\t\t\tghost: {\n\t\t\t\tomitExtraWLInCodeBlocks: true,\n\t\t\t\tparseImgDimensions: true,\n\t\t\t\tsimplifiedAutoLink: true,\n\t\t\t\tliteralMidWordUnderscores: true,\n\t\t\t\tstrikethrough: true,\n\t\t\t\ttables: true,\n\t\t\t\ttablesHeaderId: true,\n\t\t\t\tghCodeBlocks: true,\n\t\t\t\ttasklists: true,\n\t\t\t\tsmoothLivePreview: true,\n\t\t\t\tsimpleLineBreaks: true,\n\t\t\t\trequireSpaceBeforeHeadingText: true,\n\t\t\t\tghMentions: false,\n\t\t\t\tencodeEmails: true,\n\t\t\t},\n\t\t\tvanilla: getDefaultOpts(true),\n\t\t\tallOn: allOptionsOn(),\n\t\t};\n\n\t/**\n\t * helper namespace\n\t * @type {{}}\n\t */\n\tshowdown.helper = {};\n\n\t/**\n\t * TODO LEGACY SUPPORT CODE\n\t * @type {{}}\n\t */\n\tshowdown.extensions = {};\n\n\t/**\n\t * Set a global option\n\t * @static\n\t * @param {string} key\n\t * @param {*} value\n\t * @returns {showdown}\n\t */\n\tshowdown.setOption = function (key, value) {\n\t\t\"use strict\";\n\t\tglobalOptions[key] = value;\n\t\treturn this;\n\t};\n\n\t/**\n\t * Get a global option\n\t * @static\n\t * @param {string} key\n\t * @returns {*}\n\t */\n\tshowdown.getOption = function (key) {\n\t\t\"use strict\";\n\t\treturn globalOptions[key];\n\t};\n\n\t/**\n\t * Get the global options\n\t * @static\n\t * @returns {{}}\n\t */\n\tshowdown.getOptions = function () {\n\t\t\"use strict\";\n\t\treturn globalOptions;\n\t};\n\n\t/**\n\t * Reset global options to the default values\n\t * @static\n\t */\n\tshowdown.resetOptions = function () {\n\t\t\"use strict\";\n\t\tglobalOptions = getDefaultOpts(true);\n\t};\n\n\t/**\n\t * Set the flavor showdown should use as default\n\t * @param {string} name\n\t */\n\tshowdown.setFlavor = function (name) {\n\t\t\"use strict\";\n\t\tif (!flavor.hasOwnProperty(name)) {\n\t\t\tthrow Error(name + \" flavor was not found\");\n\t\t}\n\t\tshowdown.resetOptions();\n\t\tvar preset = flavor[name];\n\t\tsetFlavor = name;\n\t\tfor (var option in preset) {\n\t\t\tif (preset.hasOwnProperty(option)) {\n\t\t\t\tglobalOptions[option] = preset[option];\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Get the currently set flavor\n\t * @returns {string}\n\t */\n\tshowdown.getFlavor = function () {\n\t\t\"use strict\";\n\t\treturn setFlavor;\n\t};\n\n\t/**\n\t * Get the options of a specified flavor. Returns undefined if the flavor was not found\n\t * @param {string} name Name of the flavor\n\t * @returns {{}|undefined}\n\t */\n\tshowdown.getFlavorOptions = function (name) {\n\t\t\"use strict\";\n\t\tif (flavor.hasOwnProperty(name)) {\n\t\t\treturn flavor[name];\n\t\t}\n\t};\n\n\t/**\n\t * Get the default options\n\t * @static\n\t * @param {boolean} [simple=true]\n\t * @returns {{}}\n\t */\n\tshowdown.getDefaultOptions = function (simple) {\n\t\t\"use strict\";\n\t\treturn getDefaultOpts(simple);\n\t};\n\n\t/**\n\t * Get or set a subParser\n\t *\n\t * subParser(name)       - Get a registered subParser\n\t * subParser(name, func) - Register a subParser\n\t * @static\n\t * @param {string} name\n\t * @param {function} [func]\n\t * @returns {*}\n\t */\n\tshowdown.subParser = function (name, func) {\n\t\t\"use strict\";\n\t\tif (showdown.helper.isString(name)) {\n\t\t\tif (typeof func !== \"undefined\") {\n\t\t\t\tparsers[name] = func;\n\t\t\t} else {\n\t\t\t\tif (parsers.hasOwnProperty(name)) {\n\t\t\t\t\treturn parsers[name];\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(\"SubParser named \" + name + \" not registered!\");\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow Error(\n\t\t\t\t\"showdown.subParser function first argument must be a string (the name of the subparser)\",\n\t\t\t);\n\t\t}\n\t};\n\n\t/**\n\t * Gets or registers an extension\n\t * @static\n\t * @param {string} name\n\t * @param {object|function=} ext\n\t * @returns {*}\n\t */\n\tshowdown.extension = function (name, ext) {\n\t\t\"use strict\";\n\n\t\tif (!showdown.helper.isString(name)) {\n\t\t\tthrow Error(\"Extension 'name' must be a string\");\n\t\t}\n\n\t\tname = showdown.helper.stdExtName(name);\n\n\t\t// Getter\n\t\tif (showdown.helper.isUndefined(ext)) {\n\t\t\tif (!extensions.hasOwnProperty(name)) {\n\t\t\t\tthrow Error(\"Extension named \" + name + \" is not registered!\");\n\t\t\t}\n\t\t\treturn extensions[name];\n\n\t\t\t// Setter\n\t\t} else {\n\t\t\t// Expand extension if it's wrapped in a function\n\t\t\tif (typeof ext === \"function\") {\n\t\t\t\text = ext();\n\t\t\t}\n\n\t\t\t// Ensure extension is an array\n\t\t\tif (!showdown.helper.isArray(ext)) {\n\t\t\t\text = [ext];\n\t\t\t}\n\n\t\t\tvar validExtension = validate(ext, name);\n\n\t\t\tif (validExtension.valid) {\n\t\t\t\textensions[name] = ext;\n\t\t\t} else {\n\t\t\t\tthrow Error(validExtension.error);\n\t\t\t}\n\t\t}\n\t};\n\n\t/**\n\t * Gets all extensions registered\n\t * @returns {{}}\n\t */\n\tshowdown.getAllExtensions = function () {\n\t\t\"use strict\";\n\t\treturn extensions;\n\t};\n\n\t/**\n\t * Remove an extension\n\t * @param {string} name\n\t */\n\tshowdown.removeExtension = function (name) {\n\t\t\"use strict\";\n\t\tdelete extensions[name];\n\t};\n\n\t/**\n\t * Removes all extensions\n\t */\n\tshowdown.resetExtensions = function () {\n\t\t\"use strict\";\n\t\textensions = {};\n\t};\n\n\t/**\n\t * Validate extension\n\t * @param {array} extension\n\t * @param {string} name\n\t * @returns {{valid: boolean, error: string}}\n\t */\n\tfunction validate(extension, name) {\n\t\t\"use strict\";\n\n\t\tvar errMsg = name\n\t\t\t\t? \"Error in \" + name + \" extension->\"\n\t\t\t\t: \"Error in unnamed extension\",\n\t\t\tret = {\n\t\t\t\tvalid: true,\n\t\t\t\terror: \"\",\n\t\t\t};\n\n\t\tif (!showdown.helper.isArray(extension)) {\n\t\t\textension = [extension];\n\t\t}\n\n\t\tfor (var i = 0; i < extension.length; ++i) {\n\t\t\tvar baseMsg = errMsg + \" sub-extension \" + i + \": \",\n\t\t\t\text = extension[i];\n\t\t\tif (typeof ext !== \"object\") {\n\t\t\t\tret.valid = false;\n\t\t\t\tret.error = baseMsg + \"must be an object, but \" + typeof ext + \" given\";\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\tif (!showdown.helper.isString(ext.type)) {\n\t\t\t\tret.valid = false;\n\t\t\t\tret.error =\n\t\t\t\t\tbaseMsg +\n\t\t\t\t\t'property \"type\" must be a string, but ' +\n\t\t\t\t\ttypeof ext.type +\n\t\t\t\t\t\" given\";\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\tvar type = (ext.type = ext.type.toLowerCase());\n\n\t\t\t// normalize extension type\n\t\t\tif (type === \"language\") {\n\t\t\t\ttype = ext.type = \"lang\";\n\t\t\t}\n\n\t\t\tif (type === \"html\") {\n\t\t\t\ttype = ext.type = \"output\";\n\t\t\t}\n\n\t\t\tif (type !== \"lang\" && type !== \"output\" && type !== \"listener\") {\n\t\t\t\tret.valid = false;\n\t\t\t\tret.error =\n\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\"type \" +\n\t\t\t\t\ttype +\n\t\t\t\t\t' is not recognized. Valid values: \"lang/language\", \"output/html\" or \"listener\"';\n\t\t\t\treturn ret;\n\t\t\t}\n\n\t\t\tif (type === \"listener\") {\n\t\t\t\tif (showdown.helper.isUndefined(ext.listeners)) {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t'. Extensions of type \"listener\" must have a property called \"listeners\"';\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif (\n\t\t\t\t\tshowdown.helper.isUndefined(ext.filter) &&\n\t\t\t\t\tshowdown.helper.isUndefined(ext.regex)\n\t\t\t\t) {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\ttype +\n\t\t\t\t\t\t' extensions must define either a \"regex\" property or a \"filter\" method';\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (ext.listeners) {\n\t\t\t\tif (typeof ext.listeners !== \"object\") {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t'\"listeners\" property must be an object but ' +\n\t\t\t\t\t\ttypeof ext.listeners +\n\t\t\t\t\t\t\" given\";\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t\tfor (var ln in ext.listeners) {\n\t\t\t\t\tif (ext.listeners.hasOwnProperty(ln)) {\n\t\t\t\t\t\tif (typeof ext.listeners[ln] !== \"function\") {\n\t\t\t\t\t\t\tret.valid = false;\n\t\t\t\t\t\t\tret.error =\n\t\t\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t\t\t'\"listeners\" property must be an hash of [event name]: [callback]. listeners.' +\n\t\t\t\t\t\t\t\tln +\n\t\t\t\t\t\t\t\t\" must be a function but \" +\n\t\t\t\t\t\t\t\ttypeof ext.listeners[ln] +\n\t\t\t\t\t\t\t\t\" given\";\n\t\t\t\t\t\t\treturn ret;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (ext.filter) {\n\t\t\t\tif (typeof ext.filter !== \"function\") {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t'\"filter\" must be a function, but ' +\n\t\t\t\t\t\ttypeof ext.filter +\n\t\t\t\t\t\t\" given\";\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t} else if (ext.regex) {\n\t\t\t\tif (showdown.helper.isString(ext.regex)) {\n\t\t\t\t\text.regex = new RegExp(ext.regex, \"g\");\n\t\t\t\t}\n\t\t\t\tif (!(ext.regex instanceof RegExp)) {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t'\"regex\" property must either be a string or a RegExp object, but ' +\n\t\t\t\t\t\ttypeof ext.regex +\n\t\t\t\t\t\t\" given\";\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t\tif (showdown.helper.isUndefined(ext.replace)) {\n\t\t\t\t\tret.valid = false;\n\t\t\t\t\tret.error =\n\t\t\t\t\t\tbaseMsg +\n\t\t\t\t\t\t'\"regex\" extensions must implement a replace string or function';\n\t\t\t\t\treturn ret;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\t/**\n\t * Validate extension\n\t * @param {object} ext\n\t * @returns {boolean}\n\t */\n\tshowdown.validateExtension = function (ext) {\n\t\t\"use strict\";\n\n\t\tvar validateExtension = validate(ext, null);\n\t\tif (!validateExtension.valid) {\n\t\t\tconsole.warn(validateExtension.error);\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t};\n\n\t/**\n\t * showdownjs helper functions\n\t */\n\n\tif (!showdown.hasOwnProperty(\"helper\")) {\n\t\tshowdown.helper = {};\n\t}\n\n\tif (typeof document === \"undefined\" && typeof window === \"undefined\") {\n\t\tvar jsdom = require(\"jsdom\");\n\t\twindow = new jsdom.JSDOM(\"\", {}).window; // jshint ignore:line\n\t}\n\tshowdown.helper.document = window.document;\n\n\t/**\n\t * Check if var is string\n\t * @static\n\t * @param {string} a\n\t * @returns {boolean}\n\t */\n\tshowdown.helper.isString = function (a) {\n\t\t\"use strict\";\n\t\treturn typeof a === \"string\" || a instanceof String;\n\t};\n\n\t/**\n\t * Check if var is a function\n\t * @static\n\t * @param {*} a\n\t * @returns {boolean}\n\t */\n\tshowdown.helper.isFunction = function (a) {\n\t\t\"use strict\";\n\t\tvar getType = {};\n\t\treturn a && getType.toString.call(a) === \"[object Function]\";\n\t};\n\n\t/**\n\t * isArray helper function\n\t * @static\n\t * @param {*} a\n\t * @returns {boolean}\n\t */\n\tshowdown.helper.isArray = function (a) {\n\t\t\"use strict\";\n\t\treturn Array.isArray(a);\n\t};\n\n\t/**\n\t * Check if value is undefined\n\t * @static\n\t * @param {*} value The value to check.\n\t * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n\t */\n\tshowdown.helper.isUndefined = function (value) {\n\t\t\"use strict\";\n\t\treturn typeof value === \"undefined\";\n\t};\n\n\t/**\n\t * ForEach helper function\n\t * Iterates over Arrays and Objects (own properties only)\n\t * @static\n\t * @param {*} obj\n\t * @param {function} callback Accepts 3 params: 1. value, 2. key, 3. the original array/object\n\t */\n\tshowdown.helper.forEach = function (obj, callback) {\n\t\t\"use strict\";\n\t\t// check if obj is defined\n\t\tif (showdown.helper.isUndefined(obj)) {\n\t\t\tthrow new Error(\"obj param is required\");\n\t\t}\n\n\t\tif (showdown.helper.isUndefined(callback)) {\n\t\t\tthrow new Error(\"callback param is required\");\n\t\t}\n\n\t\tif (!showdown.helper.isFunction(callback)) {\n\t\t\tthrow new Error(\"callback param must be a function/closure\");\n\t\t}\n\n\t\tif (typeof obj.forEach === \"function\") {\n\t\t\tobj.forEach(callback);\n\t\t} else if (showdown.helper.isArray(obj)) {\n\t\t\tfor (var i = 0; i < obj.length; i++) {\n\t\t\t\tcallback(obj[i], i, obj);\n\t\t\t}\n\t\t} else if (typeof obj === \"object\") {\n\t\t\tfor (var prop in obj) {\n\t\t\t\tif (obj.hasOwnProperty(prop)) {\n\t\t\t\t\tcallback(obj[prop], prop, obj);\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthrow new Error(\"obj does not seem to be an array or an iterable object\");\n\t\t}\n\t};\n\n\t/**\n\t * Standardidize extension name\n\t * @static\n\t * @param {string} s extension name\n\t * @returns {string}\n\t */\n\tshowdown.helper.stdExtName = function (s) {\n\t\t\"use strict\";\n\t\treturn s\n\t\t\t.replace(/[_?*+\\/\\\\.^-]/g, \"\")\n\t\t\t.replace(/\\s/g, \"\")\n\t\t\t.toLowerCase();\n\t};\n\n\tfunction escapeCharactersCallback(wholeMatch, m1) {\n\t\t\"use strict\";\n\t\tvar charCodeToEscape = m1.charCodeAt(0);\n\t\treturn \"¨E\" + charCodeToEscape + \"E\";\n\t}\n\n\t/**\n\t * Callback used to escape characters when passing through String.replace\n\t * @static\n\t * @param {string} wholeMatch\n\t * @param {string} m1\n\t * @returns {string}\n\t */\n\tshowdown.helper.escapeCharactersCallback = escapeCharactersCallback;\n\n\t/**\n\t * Escape characters in a string\n\t * @static\n\t * @param {string} text\n\t * @param {string} charsToEscape\n\t * @param {boolean} afterBackslash\n\t * @returns {XML|string|void|*}\n\t */\n\tshowdown.helper.escapeCharacters = function (\n\t\ttext,\n\t\tcharsToEscape,\n\t\tafterBackslash,\n\t) {\n\t\t\"use strict\";\n\t\t// First we have to escape the escape characters so that\n\t\t// we can build a character class out of them\n\t\tvar regexString =\n\t\t\t\"([\" + charsToEscape.replace(/([\\[\\]\\\\])/g, \"\\\\$1\") + \"])\";\n\n\t\tif (afterBackslash) {\n\t\t\tregexString = \"\\\\\\\\\" + regexString;\n\t\t}\n\n\t\tvar regex = new RegExp(regexString, \"g\");\n\t\ttext = text.replace(regex, escapeCharactersCallback);\n\n\t\treturn text;\n\t};\n\n\tvar rgxFindMatchPos = function (str, left, right, flags) {\n\t\t\"use strict\";\n\t\tvar f = flags || \"\",\n\t\t\tg = f.indexOf(\"g\") > -1,\n\t\t\tx = new RegExp(left + \"|\" + right, \"g\" + f.replace(/g/g, \"\")),\n\t\t\tl = new RegExp(left, f.replace(/g/g, \"\")),\n\t\t\tpos = [],\n\t\t\tt,\n\t\t\ts,\n\t\t\tm,\n\t\t\tstart,\n\t\t\tend;\n\n\t\tdo {\n\t\t\tt = 0;\n\t\t\twhile ((m = x.exec(str))) {\n\t\t\t\tif (l.test(m[0])) {\n\t\t\t\t\tif (!t++) {\n\t\t\t\t\t\ts = x.lastIndex;\n\t\t\t\t\t\tstart = s - m[0].length;\n\t\t\t\t\t}\n\t\t\t\t} else if (t) {\n\t\t\t\t\tif (!--t) {\n\t\t\t\t\t\tend = m.index + m[0].length;\n\t\t\t\t\t\tvar obj = {\n\t\t\t\t\t\t\tleft: { start: start, end: s },\n\t\t\t\t\t\t\tmatch: { start: s, end: m.index },\n\t\t\t\t\t\t\tright: { start: m.index, end: end },\n\t\t\t\t\t\t\twholeMatch: { start: start, end: end },\n\t\t\t\t\t\t};\n\t\t\t\t\t\tpos.push(obj);\n\t\t\t\t\t\tif (!g) {\n\t\t\t\t\t\t\treturn pos;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} while (t && (x.lastIndex = s));\n\n\t\treturn pos;\n\t};\n\n\t/**\n\t * matchRecursiveRegExp\n\t *\n\t * (c) 2007 Steven Levithan <stevenlevithan.com>\n\t * MIT License\n\t *\n\t * Accepts a string to search, a left and right format delimiter\n\t * as regex patterns, and optional regex flags. Returns an array\n\t * of matches, allowing nested instances of left/right delimiters.\n\t * Use the \"g\" flag to return all matches, otherwise only the\n\t * first is returned. Be careful to ensure that the left and\n\t * right format delimiters produce mutually exclusive matches.\n\t * Backreferences are not supported within the right delimiter\n\t * due to how it is internally combined with the left delimiter.\n\t * When matching strings whose format delimiters are unbalanced\n\t * to the left or right, the output is intentionally as a\n\t * conventional regex library with recursion support would\n\t * produce, e.g. \"<<x>\" and \"<x>>\" both produce [\"x\"] when using\n\t * \"<\" and \">\" as the delimiters (both strings contain a single,\n\t * balanced instance of \"<x>\").\n\t *\n\t * examples:\n\t * matchRecursiveRegExp(\"test\", \"\\\\(\", \"\\\\)\")\n\t * returns: []\n\t * matchRecursiveRegExp(\"<t<<e>><s>>t<>\", \"<\", \">\", \"g\")\n\t * returns: [\"t<<e>><s>\", \"\"]\n\t * matchRecursiveRegExp(\"<div id=\\\"x\\\">test</div>\", \"<div\\\\b[^>]*>\", \"</div>\", \"gi\")\n\t * returns: [\"test\"]\n\t */\n\tshowdown.helper.matchRecursiveRegExp = function (str, left, right, flags) {\n\t\t\"use strict\";\n\n\t\tvar matchPos = rgxFindMatchPos(str, left, right, flags),\n\t\t\tresults = [];\n\n\t\tfor (var i = 0; i < matchPos.length; ++i) {\n\t\t\tresults.push([\n\t\t\t\tstr.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\n\t\t\t\tstr.slice(matchPos[i].match.start, matchPos[i].match.end),\n\t\t\t\tstr.slice(matchPos[i].left.start, matchPos[i].left.end),\n\t\t\t\tstr.slice(matchPos[i].right.start, matchPos[i].right.end),\n\t\t\t]);\n\t\t}\n\t\treturn results;\n\t};\n\n\t/**\n\t *\n\t * @param {string} str\n\t * @param {string|function} replacement\n\t * @param {string} left\n\t * @param {string} right\n\t * @param {string} flags\n\t * @returns {string}\n\t */\n\tshowdown.helper.replaceRecursiveRegExp = function (\n\t\tstr,\n\t\treplacement,\n\t\tleft,\n\t\tright,\n\t\tflags,\n\t) {\n\t\t\"use strict\";\n\n\t\tif (!showdown.helper.isFunction(replacement)) {\n\t\t\tvar repStr = replacement;\n\t\t\treplacement = function () {\n\t\t\t\treturn repStr;\n\t\t\t};\n\t\t}\n\n\t\tvar matchPos = rgxFindMatchPos(str, left, right, flags),\n\t\t\tfinalStr = str,\n\t\t\tlng = matchPos.length;\n\n\t\tif (lng > 0) {\n\t\t\tvar bits = [];\n\t\t\tif (matchPos[0].wholeMatch.start !== 0) {\n\t\t\t\tbits.push(str.slice(0, matchPos[0].wholeMatch.start));\n\t\t\t}\n\t\t\tfor (var i = 0; i < lng; ++i) {\n\t\t\t\tbits.push(\n\t\t\t\t\treplacement(\n\t\t\t\t\t\tstr.slice(matchPos[i].wholeMatch.start, matchPos[i].wholeMatch.end),\n\t\t\t\t\t\tstr.slice(matchPos[i].match.start, matchPos[i].match.end),\n\t\t\t\t\t\tstr.slice(matchPos[i].left.start, matchPos[i].left.end),\n\t\t\t\t\t\tstr.slice(matchPos[i].right.start, matchPos[i].right.end),\n\t\t\t\t\t),\n\t\t\t\t);\n\t\t\t\tif (i < lng - 1) {\n\t\t\t\t\tbits.push(\n\t\t\t\t\t\tstr.slice(\n\t\t\t\t\t\t\tmatchPos[i].wholeMatch.end,\n\t\t\t\t\t\t\tmatchPos[i + 1].wholeMatch.start,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (matchPos[lng - 1].wholeMatch.end < str.length) {\n\t\t\t\tbits.push(str.slice(matchPos[lng - 1].wholeMatch.end));\n\t\t\t}\n\t\t\tfinalStr = bits.join(\"\");\n\t\t}\n\t\treturn finalStr;\n\t};\n\n\t/**\n\t * Returns the index within the passed String object of the first occurrence of the specified regex,\n\t * starting the search at fromIndex. Returns -1 if the value is not found.\n\t *\n\t * @param {string} str string to search\n\t * @param {RegExp} regex Regular expression to search\n\t * @param {int} [fromIndex = 0] Index to start the search\n\t * @returns {Number}\n\t * @throws InvalidArgumentError\n\t */\n\tshowdown.helper.regexIndexOf = function (str, regex, fromIndex) {\n\t\t\"use strict\";\n\t\tif (!showdown.helper.isString(str)) {\n\t\t\tthrow \"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string\";\n\t\t}\n\t\tif (regex instanceof RegExp === false) {\n\t\t\tthrow \"InvalidArgumentError: second parameter of showdown.helper.regexIndexOf function must be an instance of RegExp\";\n\t\t}\n\t\tvar indexOf = str.substring(fromIndex || 0).search(regex);\n\t\treturn indexOf >= 0 ? indexOf + (fromIndex || 0) : indexOf;\n\t};\n\n\t/**\n\t * Splits the passed string object at the defined index, and returns an array composed of the two substrings\n\t * @param {string} str string to split\n\t * @param {int} index index to split string at\n\t * @returns {[string,string]}\n\t * @throws InvalidArgumentError\n\t */\n\tshowdown.helper.splitAtIndex = function (str, index) {\n\t\t\"use strict\";\n\t\tif (!showdown.helper.isString(str)) {\n\t\t\tthrow \"InvalidArgumentError: first parameter of showdown.helper.regexIndexOf function must be a string\";\n\t\t}\n\t\treturn [str.substring(0, index), str.substring(index)];\n\t};\n\n\t/**\n\t * Obfuscate an e-mail address through the use of Character Entities,\n\t * transforming ASCII characters into their equivalent decimal or hex entities.\n\t *\n\t * Since it has a random component, subsequent calls to this function produce different results\n\t *\n\t * @param {string} mail\n\t * @returns {string}\n\t */\n\tshowdown.helper.encodeEmailAddress = function (mail) {\n\t\t\"use strict\";\n\t\tvar encode = [\n\t\t\tfunction (ch) {\n\t\t\t\treturn \"&#\" + ch.charCodeAt(0) + \";\";\n\t\t\t},\n\t\t\tfunction (ch) {\n\t\t\t\treturn \"&#x\" + ch.charCodeAt(0).toString(16) + \";\";\n\t\t\t},\n\t\t\tfunction (ch) {\n\t\t\t\treturn ch;\n\t\t\t},\n\t\t];\n\n\t\tmail = mail.replace(/./g, function (ch) {\n\t\t\tif (ch === \"@\") {\n\t\t\t\t// this *must* be encoded. I insist.\n\t\t\t\tch = encode[Math.floor(Math.random() * 2)](ch);\n\t\t\t} else {\n\t\t\t\tvar r = Math.random();\n\t\t\t\t// roughly 10% raw, 45% hex, 45% dec\n\t\t\t\tch = r > 0.9 ? encode[2](ch) : r > 0.45 ? encode[1](ch) : encode[0](ch);\n\t\t\t}\n\t\t\treturn ch;\n\t\t});\n\n\t\treturn mail;\n\t};\n\n\t/**\n\t *\n\t * @param str\n\t * @param targetLength\n\t * @param padString\n\t * @returns {string}\n\t */\n\tshowdown.helper.padEnd = function padEnd(str, targetLength, padString) {\n\t\t\"use strict\";\n\t\t/*jshint bitwise: false*/\n\t\t// eslint-disable-next-line space-infix-ops\n\t\ttargetLength = targetLength >> 0; //floor if number or convert non-number to 0;\n\t\t/*jshint bitwise: true*/\n\t\tpadString = String(padString || \" \");\n\t\tif (str.length > targetLength) {\n\t\t\treturn String(str);\n\t\t} else {\n\t\t\ttargetLength = targetLength - str.length;\n\t\t\tif (targetLength > padString.length) {\n\t\t\t\tpadString += padString.repeat(targetLength / padString.length); //append to original to ensure we are longer than needed\n\t\t\t}\n\t\t\treturn String(str) + padString.slice(0, targetLength);\n\t\t}\n\t};\n\n\t/**\n\t * Unescape HTML entities\n\t * @param txt\n\t * @returns {string}\n\t */\n\tshowdown.helper.unescapeHTMLEntities = function (txt) {\n\t\t\"use strict\";\n\n\t\treturn txt\n\t\t\t.replace(/&quot;/g, '\"')\n\t\t\t.replace(/&lt;/g, \"<\")\n\t\t\t.replace(/&gt;/g, \">\")\n\t\t\t.replace(/&amp;/g, \"&\");\n\t};\n\n\tshowdown.helper._hashHTMLSpan = function (html, globals) {\n\t\treturn \"¨C\" + (globals.gHtmlSpans.push(html) - 1) + \"C\";\n\t};\n\n\t/**\n\t * Showdown's Event Object\n\t * @param {string} name Name of the event\n\t * @param {string} text Text\n\t * @param {{}} params optional. params of the event\n\t * @constructor\n\t */\n\tshowdown.helper.Event = function (name, text, params) {\n\t\t\"use strict\";\n\n\t\tvar regexp = params.regexp || null;\n\t\tvar matches = params.matches || {};\n\t\tvar options = params.options || {};\n\t\tvar converter = params.converter || null;\n\t\tvar globals = params.globals || {};\n\n\t\t/**\n\t\t * Get the name of the event\n\t\t * @returns {string}\n\t\t */\n\t\tthis.getName = function () {\n\t\t\treturn name;\n\t\t};\n\n\t\tthis.getEventName = function () {\n\t\t\treturn name;\n\t\t};\n\n\t\tthis._stopExecution = false;\n\n\t\tthis.parsedText = params.parsedText || null;\n\n\t\tthis.getRegexp = function () {\n\t\t\treturn regexp;\n\t\t};\n\n\t\tthis.getOptions = function () {\n\t\t\treturn options;\n\t\t};\n\n\t\tthis.getConverter = function () {\n\t\t\treturn converter;\n\t\t};\n\n\t\tthis.getGlobals = function () {\n\t\t\treturn globals;\n\t\t};\n\n\t\tthis.getCapturedText = function () {\n\t\t\treturn text;\n\t\t};\n\n\t\tthis.getText = function () {\n\t\t\treturn text;\n\t\t};\n\n\t\tthis.setText = function (newText) {\n\t\t\ttext = newText;\n\t\t};\n\n\t\tthis.getMatches = function () {\n\t\t\treturn matches;\n\t\t};\n\n\t\tthis.setMatches = function (newMatches) {\n\t\t\tmatches = newMatches;\n\t\t};\n\n\t\tthis.preventDefault = function (bool) {\n\t\t\tthis._stopExecution = !bool;\n\t\t};\n\t};\n\n\t/**\n\t * POLYFILLS\n\t */\n\t// use this instead of builtin is undefined for IE8 compatibility\n\tif (typeof console === \"undefined\") {\n\t\tconsole = {\n\t\t\twarn: function (msg) {\n\t\t\t\t\"use strict\";\n\t\t\t\talert(msg);\n\t\t\t},\n\t\t\tlog: function (msg) {\n\t\t\t\t\"use strict\";\n\t\t\t\talert(msg);\n\t\t\t},\n\t\t\terror: function (msg) {\n\t\t\t\t\"use strict\";\n\t\t\t\tthrow msg;\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Common regexes.\n\t * We declare some common regexes to improve performance\n\t */\n\tshowdown.helper.regexes = {\n\t\tasteriskDashTildeAndColon: /([*_:~])/g,\n\t\tasteriskDashAndTilde: /([*_~])/g,\n\t};\n\n\t/**\n\t * EMOJIS LIST\n\t */\n\tshowdown.helper.emojis = {\n\t\t100: \"\\ud83d\\udcaf\",\n\t\t1234: \"\\ud83d\\udd22\",\n\t\t\"+1\": \"\\ud83d\\udc4d\",\n\t\t\"-1\": \"\\ud83d\\udc4e\",\n\t\t\"1st_place_medal\": \"\\ud83e\\udd47\",\n\t\t\"2nd_place_medal\": \"\\ud83e\\udd48\",\n\t\t\"3rd_place_medal\": \"\\ud83e\\udd49\",\n\t\t\"8ball\": \"\\ud83c\\udfb1\",\n\t\ta: \"\\ud83c\\udd70\\ufe0f\",\n\t\tab: \"\\ud83c\\udd8e\",\n\t\tabacus: \"\\ud83e\\uddee\",\n\t\tabc: \"\\ud83d\\udd24\",\n\t\tabcd: \"\\ud83d\\udd21\",\n\t\taccept: \"\\ud83c\\ude51\",\n\t\tadhesive_bandage: \"\\ud83e\\ude79\",\n\t\tadult: \"\\ud83e\\uddd1\",\n\t\taerial_tramway: \"\\ud83d\\udea1\",\n\t\tafghanistan: \"\\ud83c\\udde6\\ud83c\\uddeb\",\n\t\tairplane: \"\\u2708\\ufe0f\",\n\t\taland_islands: \"\\ud83c\\udde6\\ud83c\\uddfd\",\n\t\talarm_clock: \"\\u23f0\",\n\t\talbania: \"\\ud83c\\udde6\\ud83c\\uddf1\",\n\t\talembic: \"\\u2697\\ufe0f\",\n\t\talgeria: \"\\ud83c\\udde9\\ud83c\\uddff\",\n\t\talien: \"\\ud83d\\udc7d\",\n\t\tambulance: \"\\ud83d\\ude91\",\n\t\tamerican_samoa: \"\\ud83c\\udde6\\ud83c\\uddf8\",\n\t\tamphora: \"\\ud83c\\udffa\",\n\t\tanchor: \"\\u2693\",\n\t\tandorra: \"\\ud83c\\udde6\\ud83c\\udde9\",\n\t\tangel: \"\\ud83d\\udc7c\",\n\t\tanger: \"\\ud83d\\udca2\",\n\t\tangola: \"\\ud83c\\udde6\\ud83c\\uddf4\",\n\t\tangry: \"\\ud83d\\ude20\",\n\t\tanguilla: \"\\ud83c\\udde6\\ud83c\\uddee\",\n\t\tanguished: \"\\ud83d\\ude27\",\n\t\tant: \"\\ud83d\\udc1c\",\n\t\tantarctica: \"\\ud83c\\udde6\\ud83c\\uddf6\",\n\t\tantigua_barbuda: \"\\ud83c\\udde6\\ud83c\\uddec\",\n\t\tapple: \"\\ud83c\\udf4e\",\n\t\taquarius: \"\\u2652\",\n\t\targentina: \"\\ud83c\\udde6\\ud83c\\uddf7\",\n\t\taries: \"\\u2648\",\n\t\tarmenia: \"\\ud83c\\udde6\\ud83c\\uddf2\",\n\t\tarrow_backward: \"\\u25c0\\ufe0f\",\n\t\tarrow_double_down: \"\\u23ec\",\n\t\tarrow_double_up: \"\\u23eb\",\n\t\tarrow_down: \"\\u2b07\\ufe0f\",\n\t\tarrow_down_small: \"\\ud83d\\udd3d\",\n\t\tarrow_forward: \"\\u25b6\\ufe0f\",\n\t\tarrow_heading_down: \"\\u2935\\ufe0f\",\n\t\tarrow_heading_up: \"\\u2934\\ufe0f\",\n\t\tarrow_left: \"\\u2b05\\ufe0f\",\n\t\tarrow_lower_left: \"\\u2199\\ufe0f\",\n\t\tarrow_lower_right: \"\\u2198\\ufe0f\",\n\t\tarrow_right: \"\\u27a1\\ufe0f\",\n\t\tarrow_right_hook: \"\\u21aa\\ufe0f\",\n\t\tarrow_up: \"\\u2b06\\ufe0f\",\n\t\tarrow_up_down: \"\\u2195\\ufe0f\",\n\t\tarrow_up_small: \"\\ud83d\\udd3c\",\n\t\tarrow_upper_left: \"\\u2196\\ufe0f\",\n\t\tarrow_upper_right: \"\\u2197\\ufe0f\",\n\t\tarrows_clockwise: \"\\ud83d\\udd03\",\n\t\tarrows_counterclockwise: \"\\ud83d\\udd04\",\n\t\tart: \"\\ud83c\\udfa8\",\n\t\tarticulated_lorry: \"\\ud83d\\ude9b\",\n\t\tartificial_satellite: \"\\ud83d\\udef0\\ufe0f\",\n\t\tartist: \"\\ud83e\\uddd1\\u200d\\ud83c\\udfa8\",\n\t\taruba: \"\\ud83c\\udde6\\ud83c\\uddfc\",\n\t\tascension_island: \"\\ud83c\\udde6\\ud83c\\udde8\",\n\t\tasterisk: \"*\\ufe0f\\u20e3\",\n\t\tastonished: \"\\ud83d\\ude32\",\n\t\tastronaut: \"\\ud83e\\uddd1\\u200d\\ud83d\\ude80\",\n\t\tathletic_shoe: \"\\ud83d\\udc5f\",\n\t\tatm: \"\\ud83c\\udfe7\",\n\t\tatom_symbol: \"\\u269b\\ufe0f\",\n\t\taustralia: \"\\ud83c\\udde6\\ud83c\\uddfa\",\n\t\taustria: \"\\ud83c\\udde6\\ud83c\\uddf9\",\n\t\tauto_rickshaw: \"\\ud83d\\udefa\",\n\t\tavocado: \"\\ud83e\\udd51\",\n\t\taxe: \"\\ud83e\\ude93\",\n\t\tazerbaijan: \"\\ud83c\\udde6\\ud83c\\uddff\",\n\t\tb: \"\\ud83c\\udd71\\ufe0f\",\n\t\tbaby: \"\\ud83d\\udc76\",\n\t\tbaby_bottle: \"\\ud83c\\udf7c\",\n\t\tbaby_chick: \"\\ud83d\\udc24\",\n\t\tbaby_symbol: \"\\ud83d\\udebc\",\n\t\tback: \"\\ud83d\\udd19\",\n\t\tbacon: \"\\ud83e\\udd53\",\n\t\tbadger: \"\\ud83e\\udda1\",\n\t\tbadminton: \"\\ud83c\\udff8\",\n\t\tbagel: \"\\ud83e\\udd6f\",\n\t\tbaggage_claim: \"\\ud83d\\udec4\",\n\t\tbaguette_bread: \"\\ud83e\\udd56\",\n\t\tbahamas: \"\\ud83c\\udde7\\ud83c\\uddf8\",\n\t\tbahrain: \"\\ud83c\\udde7\\ud83c\\udded\",\n\t\tbalance_scale: \"\\u2696\\ufe0f\",\n\t\tbald_man: \"\\ud83d\\udc68\\u200d\\ud83e\\uddb2\",\n\t\tbald_woman: \"\\ud83d\\udc69\\u200d\\ud83e\\uddb2\",\n\t\tballet_shoes: \"\\ud83e\\ude70\",\n\t\tballoon: \"\\ud83c\\udf88\",\n\t\tballot_box: \"\\ud83d\\uddf3\\ufe0f\",\n\t\tballot_box_with_check: \"\\u2611\\ufe0f\",\n\t\tbamboo: \"\\ud83c\\udf8d\",\n\t\tbanana: \"\\ud83c\\udf4c\",\n\t\tbangbang: \"\\u203c\\ufe0f\",\n\t\tbangladesh: \"\\ud83c\\udde7\\ud83c\\udde9\",\n\t\tbanjo: \"\\ud83e\\ude95\",\n\t\tbank: \"\\ud83c\\udfe6\",\n\t\tbar_chart: \"\\ud83d\\udcca\",\n\t\tbarbados: \"\\ud83c\\udde7\\ud83c\\udde7\",\n\t\tbarber: \"\\ud83d\\udc88\",\n\t\tbaseball: \"\\u26be\",\n\t\tbasket: \"\\ud83e\\uddfa\",\n\t\tbasketball: \"\\ud83c\\udfc0\",\n\t\tbasketball_man: \"\\u26f9\\ufe0f\\u200d\\u2642\\ufe0f\",\n\t\tbasketball_woman: \"\\u26f9\\ufe0f\\u200d\\u2640\\ufe0f\",\n\t\tbat: \"\\ud83e\\udd87\",\n\t\tbath: \"\\ud83d\\udec0\",\n\t\tbathtub: \"\\ud83d\\udec1\",\n\t\tbattery: \"\\ud83d\\udd0b\",\n\t\tbeach_umbrella: \"\\ud83c\\udfd6\\ufe0f\",\n\t\tbear: \"\\ud83d\\udc3b\",\n\t\tbearded_person: \"\\ud83e\\uddd4\",\n\t\tbed: \"\\ud83d\\udecf\\ufe0f\",\n\t\tbee: \"\\ud83d\\udc1d\",\n\t\tbeer: \"\\ud83c\\udf7a\",\n\t\tbeers: \"\\ud83c\\udf7b\",\n\t\tbeetle: \"\\ud83d\\udc1e\",\n\t\tbeginner: \"\\ud83d\\udd30\",\n\t\tbelarus: \"\\ud83c\\udde7\\ud83c\\uddfe\",\n\t\tbelgium: \"\\ud83c\\udde7\\ud83c\\uddea\",\n\t\tbelize: \"\\ud83c\\udde7\\ud83c\\uddff\",\n\t\tbell: \"\\ud83d\\udd14\",\n\t\tbellhop_bell: \"\\ud83d\\udece\\ufe0f\",\n\t\tbenin: \"\\ud83c\\udde7\\ud83c\\uddef\",\n\t\tbento: \"\\ud83c\\udf71\",\n\t\tbermuda: \"\\ud83c\\udde7\\ud83c\\uddf2\",\n\t\tbeverage_box: \"\\ud83e\\uddc3\",\n\t\tbhutan: \"\\ud83c\\udde7\\ud83c\\uddf9\",\n\t\tbicyclist: \"\\ud83d\\udeb4\",\n\t\tbike: \"\\ud83d\\udeb2\",\n\t\tbiking_man: \"\\ud83d\\udeb4\\u200d\\u2642\\ufe0f\",\n\t\tbiking_woman: \"\\ud83d\\udeb4\\u200d\\u2640\\ufe0f\",\n\t\tbikini: \"\\ud83d\\udc59\",\n\t\tbilled_cap: \"\\ud83e\\udde2\",\n\t\tbiohazard: \"\\u2623\\ufe0f\",\n\t\tbird: \"\\ud83d\\udc26\",\n\t\tbirthday: \"\\ud83c\\udf82\",\n\t\tblack_circle: \"\\u26ab\",\n\t\tblack_flag: \"\\ud83c\\udff4\",\n\t\tblack_heart: \"\\ud83d\\udda4\",\n\t\tblack_joker: \"\\ud83c\\udccf\",\n\t\tblack_large_square: \"\\u2b1b\",\n\t\tblack_medium_small_square: \"\\u25fe\",\n\t\tblack_medium_square: \"\\u25fc\\ufe0f\",\n\t\tblack_nib: \"\\u2712\\ufe0f\",\n\t\tblack_small_square: \"\\u25aa\\ufe0f\",\n\t\tblack_square_button: \"\\ud83d\\udd32\",\n\t\tblond_haired_man: \"\\ud83d\\udc71\\u200d\\u2642\\ufe0f\",\n\t\tblond_haired_person: \"\\ud83d\\udc71\",\n\t\tblond_haired_woman: \"\\ud83d\\udc71\\u200d\\u2640\\ufe0f\",\n\t\tblonde_woman: \"\\ud83d\\udc71\\u200d\\u2640\\ufe0f\",\n\t\tblossom: \"\\ud83c\\udf3c\",\n\t\tblowfish: \"\\ud83d\\udc21\",\n\t\tblue_book: \"\\ud83d\\udcd8\",\n\t\tblue_car: \"\\ud83d\\ude99\",\n\t\tblue_heart: \"\\ud83d\\udc99\",\n\t\tblue_square: \"\\ud83d\\udfe6\",\n\t\tblush: \"\\ud83d\\ude0a\",\n\t\tboar: \"\\ud83d\\udc17\",\n\t\tboat: \"\\u26f5\",\n\t\tbolivia: \"\\ud83c\\udde7\\ud83c\\uddf4\",\n\t\tbomb: \"\\ud83d\\udca3\",\n\t\tbone: \"\\ud83e\\uddb4\",\n\t\tbook: \"\\ud83d\\udcd6\",\n\t\tbookmark: \"\\ud83d\\udd16\",\n\t\tbookmark_tabs: \"\\ud83d\\udcd1\",\n\t\tbooks: \"\\ud83d\\udcda\",\n\t\tboom: \"\\ud83d\\udca5\",\n\t\tboot: \"\\ud83d\\udc62\",\n\t\tbosnia_herzegovina: \"\\ud83c\\udde7\\ud83c\\udde6\",\n\t\tbotswana: \"\\ud83c\\udde7\\ud83c\\uddfc\",\n\t\tbouncing_ball_man: \"\\u26f9\\ufe0f\\u200d\\u2642\\ufe0f\",\n\t\tbouncing_ball_person: \"\\u26f9\\ufe0f\",\n\t\tbouncing_ball_woman: \"\\u26f9\\ufe0f\\u200d\\u2640\\ufe0f\",\n\t\tbouquet: \"\\ud83d\\udc90\",\n\t\tbouvet_island: \"\\ud83c\\udde7\\ud83c\\uddfb\",\n\t\tbow: \"\\ud83d\\ude47\",\n\t\tbow_and_arrow: \"\\ud83c\\udff9\",\n\t\tbowing_man: \"\\ud83d\\ude47\\u200d\\u2642\\ufe0f\",\n\t\tbowing_woman: \"\\ud83d\\ude47\\u200d\\u2640\\ufe0f\",\n\t\tbowl_with_spoon: \"\\ud83e\\udd63\",\n\t\tbowling: \"\\ud83c\\udfb3\",\n\t\tboxing_glove: \"\\ud83e\\udd4a\",\n\t\tboy: \"\\ud83d\\udc66\",\n\t\tbrain: \"\\ud83e\\udde0\",\n\t\tbrazil: \"\\ud83c\\udde7\\ud83c\\uddf7\",\n\t\tbread: \"\\ud83c\\udf5e\",\n\t\tbreast_feeding: \"\\ud83e\\udd31\",\n\t\tbricks: \"\\ud83e\\uddf1\",\n\t\tbride_with_veil: \"\\ud83d\\udc70\",\n\t\tbridge_at_night: \"\\ud83c\\udf09\",\n\t\tbriefcase: \"\\ud83d\\udcbc\",\n\t\tbritish_indian_ocean_territory: \"\\ud83c\\uddee\\ud83c\\uddf4\",\n\t\tbritish_virgin_islands: \"\\ud83c\\uddfb\\ud83c\\uddec\",\n\t\tbroccoli: \"\\ud83e\\udd66\",\n\t\tbroken_heart: \"\\ud83d\\udc94\",\n\t\tbroom: \"\\ud83e\\uddf9\",\n\t\tbrown_circle: \"\\ud83d\\udfe4\",\n\t\tbrown_heart: \"\\ud83e\\udd0e\",\n\t\tbrown_square: \"\\ud83d\\udfeb\",\n\t\tbrunei: \"\\ud83c\\udde7\\ud83c\\uddf3\",\n\t\tbug: \"\\ud83d\\udc1b\",\n\t\tbuilding_construction: \"\\ud83c\\udfd7\\ufe0f\",\n\t\tbulb: \"\\ud83d\\udca1\",\n\t\tbulgaria: \"\\ud83c\\udde7\\ud83c\\uddec\",\n\t\tbullettrain_front: \"\\ud83d\\ude85\",\n\t\tbullettrain_side: \"\\ud83d\\ude84\",\n\t\tburkina_faso: \"\\ud83c\\udde7\\ud83c\\uddeb\",\n\t\tburrito: \"\\ud83c\\udf2f\",\n\t\tburundi: \"\\ud83c\\udde7\\ud83c\\uddee\",\n\t\tbus: \"\\ud83d\\ude8c\",\n\t\tbusiness_suit_levitating: \"\\ud83d\\udd74\\ufe0f\",\n\t\tbusstop: \"\\ud83d\\ude8f\",\n\t\tbust_in_silhouette: \"\\ud83d\\udc64\",\n\t\tbusts_in_silhouette: \"\\ud83d\\udc65\",\n\t\tbutter: \"\\ud83e\\uddc8\",\n\t\tbutterfly: \"\\ud83e\\udd8b\",\n\t\tcactus: \"\\ud83c\\udf35\",\n\t\tcake: \"\\ud83c\\udf70\",\n\t\tcalendar: \"\\ud83d\\udcc6\",\n\t\tcall_me_hand: \"\\ud83e\\udd19\",\n\t\tcalling: \"\\ud83d\\udcf2\",\n\t\tcambodia: \"\\ud83c\\uddf0\\ud83c\\udded\",\n\t\tcamel: \"\\ud83d\\udc2b\",\n\t\tcamera: \"\\ud83d\\udcf7\",\n\t\tcamera_flash: \"\\ud83d\\udcf8\",\n\t\tcameroon: \"\\ud83c\\udde8\\ud83c\\uddf2\",\n\t\tcamping: \"\\ud83c\\udfd5\\ufe0f\",\n\t\tcanada: \"\\ud83c\\udde8\\ud83c\\udde6\",\n\t\tcanary_islands: \"\\ud83c\\uddee\\ud83c\\udde8\",\n\t\tcancer: \"\\u264b\",\n\t\tcandle: \"\\ud83d\\udd6f\\ufe0f\",\n\t\tcandy: \"\\ud83c\\udf6c\",\n\t\tcanned_food: \"\\ud83e\\udd6b\",\n\t\tcanoe: \"\\ud83d\\udef6\",\n\t\tcape_verde: \"\\ud83c\\udde8\\ud83c\\uddfb\",\n\t\tcapital_abcd: \"\\ud83d\\udd20\",\n\t\tcapricorn: \"\\u2651\",\n\t\tcar: \"\\ud83d\\ude97\",\n\t\tcard_file_box: \"\\ud83d\\uddc3\\ufe0f\",\n\t\tcard_index: \"\\ud83d\\udcc7\",\n\t\tcard_index_dividers: \"\\ud83d\\uddc2\\ufe0f\",\n\t\tcaribbean_netherlands: \"\\ud83c\\udde7\\ud83c\\uddf6\",\n\t\tcarousel_horse: \"\\ud83c\\udfa0\",\n\t\tcarrot: \"\\ud83e\\udd55\",\n\t\tcartwheeling: \"\\ud83e\\udd38\",\n\t\tcat: \"\\ud83d\\udc31\",\n\t\tcat2: \"\\ud83d\\udc08\",\n\t\tcayman_islands: \"\\ud83c\\uddf0\\ud83c\\uddfe\",\n\t\tcd: \"\\ud83d\\udcbf\",\n\t\tcentral_african_republic: \"\\ud83c\\udde8\\ud83c\\uddeb\",\n\t\tceuta_melilla: \"\\ud83c\\uddea\\ud83c\\udde6\",\n\t\tchad: \"\\ud83c\\uddf9\\ud83c\\udde9\",\n\t\tchains: \"\\u26d3\\ufe0f\",\n\t\tchair: \"\\ud83e\\ude91\",\n\t\tchampagne: \"\\ud83c\\udf7e\",\n\t\tchart: \"\\ud83d\\udcb9\",\n\t\tchart_with_downwards_trend: \"\\ud83d\\udcc9\",\n\t\tchart_with_upwards_trend: \"\\ud83d\\udcc8\",\n\t\tcheckered_flag: \"\\ud83c\\udfc1\",\n\t\tcheese: \"\\ud83e\\uddc0\",\n\t\tcherries: \"\\ud83c\\udf52\",\n\t\tcherry_blossom: \"\\ud83c\\udf38\",\n\t\tchess_pawn: \"\\u265f\\ufe0f\",\n\t\tchestnut: \"\\ud83c\\udf30\",\n\t\tchicken: \"\\ud83d\\udc14\",\n\t\tchild: \"\\ud83e\\uddd2\",\n\t\tchildren_crossing: \"\\ud83d\\udeb8\",\n\t\tchile: \"\\ud83c\\udde8\\ud83c\\uddf1\",\n\t\tchipmunk: \"\\ud83d\\udc3f\\ufe0f\",\n\t\tchocolate_bar: \"\\ud83c\\udf6b\",\n\t\tchopsticks: \"\\ud83e\\udd62\",\n\t\tchristmas_island: \"\\ud83c\\udde8\\ud83c\\uddfd\",\n\t\tchristmas_tree: \"\\ud83c\\udf84\",\n\t\tchurch: \"\\u26ea\",\n\t\tcinema: \"\\ud83c\\udfa6\",\n\t\tcircus_tent: \"\\ud83c\\udfaa\",\n\t\tcity_sunrise: \"\\ud83c\\udf07\",\n\t\tcity_sunset: \"\\ud83c\\udf06\",\n\t\tcityscape: \"\\ud83c\\udfd9\\ufe0f\",\n\t\tcl: \"\\ud83c\\udd91\",\n\t\tclamp: \"\\ud83d\\udddc\\ufe0f\",\n\t\tclap: \"\\ud83d\\udc4f\",\n\t\tclapper: \"\\ud83c\\udfac\",\n\t\tclassical_building: \"\\ud83c\\udfdb\\ufe0f\",\n\t\tclimbing: \"\\ud83e\\uddd7\",\n\t\tclimbing_man: \"\\ud83e\\uddd7\\u200d\\u2642\\ufe0f\",\n\t\tclimbing_woman: \"\\ud83e\\uddd7\\u200d\\u2640\\ufe0f\",\n\t\tclinking_glasses: \"\\ud83e\\udd42\",\n\t\tclipboard: \"\\ud83d\\udccb\",\n\t\tclipperton_island: \"\\ud83c\\udde8\\ud83c\\uddf5\",\n\t\tclock1: \"\\ud83d\\udd50\",\n\t\tclock10: \"\\ud83d\\udd59\",\n\t\tclock1030: \"\\ud83d\\udd65\",\n\t\tclock11: \"\\ud83d\\udd5a\",\n\t\tclock1130: \"\\ud83d\\udd66\",\n\t\tclock12: \"\\ud83d\\udd5b\",\n\t\tclock1230: \"\\ud83d\\udd67\",\n\t\tclock130: \"\\ud83d\\udd5c\",\n\t\tclock2: \"\\ud83d\\udd51\",\n\t\tclock230: \"\\ud83d\\udd5d\",\n\t\tclock3: \"\\ud83d\\udd52\",\n\t\tclock330: \"\\ud83d\\udd5e\",\n\t\tclock4: \"\\ud83d\\udd53\",\n\t\tclock430: \"\\ud83d\\udd5f\",\n\t\tclock5: \"\\ud83d\\udd54\",\n\t\tclock530: \"\\ud83d\\udd60\",\n\t\tclock6: \"\\ud83d\\udd55\",\n\t\tclock630: \"\\ud83d\\udd61\",\n\t\tclock7: \"\\ud83d\\udd56\",\n\t\tclock730: \"\\ud83d\\udd62\",\n\t\tclock8: \"\\ud83d\\udd57\",\n\t\tclock830: \"\\ud83d\\udd63\",\n\t\tclock9: \"\\ud83d\\udd58\",\n\t\tclock930: \"\\ud83d\\udd64\",\n\t\tclosed_book: \"\\ud83d\\udcd5\",\n\t\tclosed_lock_with_key: \"\\ud83d\\udd10\",\n\t\tclosed_umbrella: \"\\ud83c\\udf02\",\n\t\tcloud: \"\\u2601\\ufe0f\",\n\t\tcloud_with_lightning: \"\\ud83c\\udf29\\ufe0f\",\n\t\tcloud_with_lightning_and_rain: \"\\u26c8\\ufe0f\",\n\t\tcloud_with_rain: \"\\ud83c\\udf27\\ufe0f\",\n\t\tcloud_with_snow: \"\\ud83c\\udf28\\ufe0f\",\n\t\tclown_face: \"\\ud83e\\udd21\",\n\t\tclubs: \"\\u2663\\ufe0f\",\n\t\tcn: \"\\ud83c\\udde8\\ud83c\\uddf3\",\n\t\tcoat: \"\\ud83e\\udde5\",\n\t\tcocktail: \"\\ud83c\\udf78\",\n\t\tcoconut: \"\\ud83e\\udd65\",\n\t\tcocos_islands: \"\\ud83c\\udde8\\ud83c\\udde8\",\n\t\tcoffee: \"\\u2615\",\n\t\tcoffin: \"\\u26b0\\ufe0f\",\n\t\tcold_face: \"\\ud83e\\udd76\",\n\t\tcold_sweat: \"\\ud83d\\ude30\",\n\t\tcollision: \"\\ud83d\\udca5\",\n\t\tcolombia: \"\\ud83c\\udde8\\ud83c\\uddf4\",\n\t\tcomet: \"\\u2604\\ufe0f\",\n\t\tcomoros: \"\\ud83c\\uddf0\\ud83c\\uddf2\",\n\t\tcompass: \"\\ud83e\\udded\",\n\t\tcomputer: \"\\ud83d\\udcbb\",\n\t\tcomputer_mouse: \"\\ud83d\\uddb1\\ufe0f\",\n\t\tconfetti_ball: \"\\ud83c\\udf8a\",\n\t\tconfounded: \"\\ud83d\\ude16\",\n\t\tconfused: \"\\ud83d\\ude15\",\n\t\tcongo_brazzaville: \"\\ud83c\\udde8\\ud83c\\uddec\",\n\t\tcongo_kinshasa: \"\\ud83c\\udde8\\ud83c\\udde9\",\n\t\tcongratulations: \"\\u3297\\ufe0f\",\n\t\tconstruction: \"\\ud83d\\udea7\",\n\t\tconstruction_worker: \"\\ud83d\\udc77\",\n\t\tconstruction_worker_man: \"\\ud83d\\udc77\\u200d\\u2642\\ufe0f\",\n\t\tconstruction_worker_woman: \"\\ud83d\\udc77\\u200d\\u2640\\ufe0f\",\n\t\tcontrol_knobs: \"\\ud83c\\udf9b\\ufe0f\",\n\t\tconvenience_store: \"\\ud83c\\udfea\",\n\t\tcook: \"\\ud83e\\uddd1\\u200d\\ud83c\\udf73\",\n\t\tcook_islands: \"\\ud83c\\udde8\\ud83c\\uddf0\",\n\t\tcookie: \"\\ud83c\\udf6a\",\n\t\tcool: \"\\ud83c\\udd92\",\n\t\tcop: \"\\ud83d\\udc6e\",\n\t\tcopyright: \"\\u00a9\\ufe0f\",\n\t\tcorn: \"\\ud83c\\udf3d\",\n\t\tcosta_rica: \"\\ud83c\\udde8\\ud83c\\uddf7\",\n\t\tcote_divoire: \"\\ud83c\\udde8\\ud83c\\uddee\",\n\t\tcouch_and_lamp: \"\\ud83d\\udecb\\ufe0f\",\n\t\tcouple: \"\\ud83d\\udc6b\",\n\t\tcouple_with_heart: \"\\ud83d\\udc91\",\n\t\tcouple_with_heart_man_man:\n\t\t\t\"\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\",\n\t\tcouple_with_heart_woman_man:\n\t\t\t\"\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc68\",\n\t\tcouple_with_heart_woman_woman:\n\t\t\t\"\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc69\",\n\t\tcouplekiss: \"\\ud83d\\udc8f\",\n\t\tcouplekiss_man_man:\n\t\t\t\"\\ud83d\\udc68\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\",\n\t\tcouplekiss_man_woman:\n\t\t\t\"\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc68\",\n\t\tcouplekiss_woman_woman:\n\t\t\t\"\\ud83d\\udc69\\u200d\\u2764\\ufe0f\\u200d\\ud83d\\udc8b\\u200d\\ud83d\\udc69\",\n\t\tcow: \"\\ud83d\\udc2e\",\n\t\tcow2: \"\\ud83d\\udc04\",\n\t\tcowboy_hat_face: \"\\ud83e\\udd20\",\n\t\tcrab: \"\\ud83e\\udd80\",\n\t\tcrayon: \"\\ud83d\\udd8d\\ufe0f\",\n\t\tcredit_card: \"\\ud83d\\udcb3\",\n\t\tcrescent_moon: \"\\ud83c\\udf19\",\n\t\tcricket: \"\\ud83e\\udd97\",\n\t\tcricket_game: \"\\ud83c\\udfcf\",\n\t\tcroatia: \"\\ud83c\\udded\\ud83c\\uddf7\",\n\t\tcrocodile: \"\\ud83d\\udc0a\",\n\t\tcroissant: \"\\ud83e\\udd50\",\n\t\tcrossed_fingers: \"\\ud83e\\udd1e\",\n\t\tcrossed_flags: \"\\ud83c\\udf8c\",\n\t\tcrossed_swords: \"\\u2694\\ufe0f\",\n\t\tcrown: \"\\ud83d\\udc51\",\n\t\tcry: \"\\ud83d\\ude22\",\n\t\tcrying_cat_face: \"\\ud83d\\ude3f\",\n\t\tcrystal_ball: \"\\ud83d\\udd2e\",\n\t\tcuba: \"\\ud83c\\udde8\\ud83c\\uddfa\",\n\t\tcucumber: \"\\ud83e\\udd52\",\n\t\tcup_with_straw: \"\\ud83e\\udd64\",\n\t\tcupcake: \"\\ud83e\\uddc1\",\n\t\tcupid: \"\\ud83d\\udc98\",\n\t\tcuracao: \"\\ud83c\\udde8\\ud83c\\uddfc\",\n\t\tcurling_stone: \"\\ud83e\\udd4c\",\n\t\tcurly_haired_man: \"\\ud83d\\udc68\\u200d\\ud83e\\uddb1\",\n\t\tcurly_haired_woman: \"\\ud83d\\udc69\\u200d\\ud83e\\uddb1\",\n\t\tcurly_loop: \"\\u27b0\",\n\t\tcurrency_exchange: \"\\ud83d\\udcb1\",\n\t\tcurry: \"\\ud83c\\udf5b\",\n\t\tcursing_face: \"\\ud83e\\udd2c\",\n\t\tcustard: \"\\ud83c\\udf6e\",\n\t\tcustoms: \"\\ud83d\\udec3\",\n\t\tcut_of_meat: \"\\ud83e\\udd69\",\n\t\tcyclone: \"\\ud83c\\udf00\",\n\t\tcyprus: \"\\ud83c\\udde8\\ud83c\\uddfe\",\n\t\tczech_republic: \"\\ud83c\\udde8\\ud83c\\uddff\",\n\t\tdagger: \"\\ud83d\\udde1\\ufe0f\",\n\t\tdancer: \"\\ud83d\\udc83\",\n\t\tdancers: \"\\ud83d\\udc6f\",\n\t\tdancing_men: \"\\ud83d\\udc6f\\u200d\\u2642\\ufe0f\",\n\t\tdancing_women: \"\\ud83d\\udc6f\\u200d\\u2640\\ufe0f\",\n\t\tdango: \"\\ud83c\\udf61\",\n\t\tdark_sunglasses: \"\\ud83d\\udd76\\ufe0f\",\n\t\tdart: \"\\ud83c\\udfaf\",\n\t\tdash: \"\\ud83d\\udca8\",\n\t\tdate: \"\\ud83d\\udcc5\",\n\t\tde: \"\\ud83c\\udde9\\ud83c\\uddea\",\n\t\tdeaf_man: \"\\ud83e\\uddcf\\u200d\\u2642\\ufe0f\",\n\t\tdeaf_person: \"\\ud83e\\uddcf\",\n\t\tdeaf_woman: \"\\ud83e\\uddcf\\u200d\\u2640\\ufe0f\",\n\t\tdeciduous_tree: \"\\ud83c\\udf33\",\n\t\tdeer: \"\\ud83e\\udd8c\",\n\t\tdenmark: \"\\ud83c\\udde9\\ud83c\\uddf0\",\n\t\tdepartment_store: \"\\ud83c\\udfec\",\n\t\tderelict_house: \"\\ud83c\\udfda\\ufe0f\",\n\t\tdesert: \"\\ud83c\\udfdc\\ufe0f\",\n\t\tdesert_island: \"\\ud83c\\udfdd\\ufe0f\",\n\t\tdesktop_computer: \"\\ud83d\\udda5\\ufe0f\",\n\t\tdetective: \"\\ud83d\\udd75\\ufe0f\",\n\t\tdiamond_shape_with_a_dot_inside: \"\\ud83d\\udca0\",\n\t\tdiamonds: \"\\u2666\\ufe0f\",\n\t\tdiego_garcia: \"\\ud83c\\udde9\\ud83c\\uddec\",\n\t\tdisappointed: \"\\ud83d\\ude1e\",\n\t\tdisappointed_relieved: \"\\ud83d\\ude25\",\n\t\tdiving_mask: \"\\ud83e\\udd3f\",\n\t\tdiya_lamp: \"\\ud83e\\ude94\",\n\t\tdizzy: \"\\ud83d\\udcab\",\n\t\tdizzy_face: \"\\ud83d\\ude35\",\n\t\tdjibouti: \"\\ud83c\\udde9\\ud83c\\uddef\",\n\t\tdna: \"\\ud83e\\uddec\",\n\t\tdo_not_litter: \"\\ud83d\\udeaf\",\n\t\tdog: \"\\ud83d\\udc36\",\n\t\tdog2: \"\\ud83d\\udc15\",\n\t\tdollar: \"\\ud83d\\udcb5\",\n\t\tdolls: \"\\ud83c\\udf8e\",\n\t\tdolphin: \"\\ud83d\\udc2c\",\n\t\tdominica: \"\\ud83c\\udde9\\ud83c\\uddf2\",\n\t\tdominican_republic: \"\\ud83c\\udde9\\ud83c\\uddf4\",\n\t\tdoor: \"\\ud83d\\udeaa\",\n\t\tdoughnut: \"\\ud83c\\udf69\",\n\t\tdove: \"\\ud83d\\udd4a\\ufe0f\",\n\t\tdragon: \"\\ud83d\\udc09\",\n\t\tdragon_face: \"\\ud83d\\udc32\",\n\t\tdress: \"\\ud83d\\udc57\",\n\t\tdromedary_camel: \"\\ud83d\\udc2a\",\n\t\tdrooling_face: \"\\ud83e\\udd24\",\n\t\tdrop_of_blood: \"\\ud83e\\ude78\",\n\t\tdroplet: \"\\ud83d\\udca7\",\n\t\tdrum: \"\\ud83e\\udd41\",\n\t\tduck: \"\\ud83e\\udd86\",\n\t\tdumpling: \"\\ud83e\\udd5f\",\n\t\tdvd: \"\\ud83d\\udcc0\",\n\t\t\"e-mail\": \"\\ud83d\\udce7\",\n\t\teagle: \"\\ud83e\\udd85\",\n\t\tear: \"\\ud83d\\udc42\",\n\t\tear_of_rice: \"\\ud83c\\udf3e\",\n\t\tear_with_hearing_aid: \"\\ud83e\\uddbb\",\n\t\tearth_africa: \"\\ud83c\\udf0d\",\n\t\tearth_americas: \"\\ud83c\\udf0e\",\n\t\tearth_asia: \"\\ud83c\\udf0f\",\n\t\tecuador: \"\\ud83c\\uddea\\ud83c\\udde8\",\n\t\tegg: \"\\ud83e\\udd5a\",\n\t\teggplant: \"\\ud83c\\udf46\",\n\t\tegypt: \"\\ud83c\\uddea\\ud83c\\uddec\",\n\t\teight: \"8\\ufe0f\\u20e3\",\n\t\teight_pointed_black_star: \"\\u2734\\ufe0f\",\n\t\teight_spoked_asterisk: \"\\u2733\\ufe0f\",\n\t\teject_button: \"\\u23cf\\ufe0f\",\n\t\tel_salvador: \"\\ud83c\\uddf8\\ud83c\\uddfb\",\n\t\telectric_plug: \"\\ud83d\\udd0c\",\n\t\telephant: \"\\ud83d\\udc18\",\n\t\telf: \"\\ud83e\\udddd\",\n\t\telf_man: \"\\ud83e\\udddd\\u200d\\u2642\\ufe0f\",\n\t\telf_woman: \"\\ud83e\\udddd\\u200d\\u2640\\ufe0f\",\n\t\temail: \"\\u2709\\ufe0f\",\n\t\tend: \"\\ud83d\\udd1a\",\n\t\tengland:\n\t\t\t\"\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc65\\udb40\\udc6e\\udb40\\udc67\\udb40\\udc7f\",\n\t\tenvelope: \"\\u2709\\ufe0f\",\n\t\tenvelope_with_arrow: \"\\ud83d\\udce9\",\n\t\tequatorial_guinea: \"\\ud83c\\uddec\\ud83c\\uddf6\",\n\t\teritrea: \"\\ud83c\\uddea\\ud83c\\uddf7\",\n\t\tes: \"\\ud83c\\uddea\\ud83c\\uddf8\",\n\t\testonia: \"\\ud83c\\uddea\\ud83c\\uddea\",\n\t\tethiopia: \"\\ud83c\\uddea\\ud83c\\uddf9\",\n\t\teu: \"\\ud83c\\uddea\\ud83c\\uddfa\",\n\t\teuro: \"\\ud83d\\udcb6\",\n\t\teuropean_castle: \"\\ud83c\\udff0\",\n\t\teuropean_post_office: \"\\ud83c\\udfe4\",\n\t\teuropean_union: \"\\ud83c\\uddea\\ud83c\\uddfa\",\n\t\tevergreen_tree: \"\\ud83c\\udf32\",\n\t\texclamation: \"\\u2757\",\n\t\texploding_head: \"\\ud83e\\udd2f\",\n\t\texpressionless: \"\\ud83d\\ude11\",\n\t\teye: \"\\ud83d\\udc41\\ufe0f\",\n\t\teye_speech_bubble: \"\\ud83d\\udc41\\ufe0f\\u200d\\ud83d\\udde8\\ufe0f\",\n\t\teyeglasses: \"\\ud83d\\udc53\",\n\t\teyes: \"\\ud83d\\udc40\",\n\t\tface_with_head_bandage: \"\\ud83e\\udd15\",\n\t\tface_with_thermometer: \"\\ud83e\\udd12\",\n\t\tfacepalm: \"\\ud83e\\udd26\",\n\t\tfacepunch: \"\\ud83d\\udc4a\",\n\t\tfactory: \"\\ud83c\\udfed\",\n\t\tfactory_worker: \"\\ud83e\\uddd1\\u200d\\ud83c\\udfed\",\n\t\tfairy: \"\\ud83e\\uddda\",\n\t\tfairy_man: \"\\ud83e\\uddda\\u200d\\u2642\\ufe0f\",\n\t\tfairy_woman: \"\\ud83e\\uddda\\u200d\\u2640\\ufe0f\",\n\t\tfalafel: \"\\ud83e\\uddc6\",\n\t\tfalkland_islands: \"\\ud83c\\uddeb\\ud83c\\uddf0\",\n\t\tfallen_leaf: \"\\ud83c\\udf42\",\n\t\tfamily: \"\\ud83d\\udc6a\",\n\t\tfamily_man_boy: \"\\ud83d\\udc68\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_boy_boy: \"\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_girl: \"\\ud83d\\udc68\\u200d\\ud83d\\udc67\",\n\t\tfamily_man_girl_boy: \"\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_girl_girl: \"\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc67\",\n\t\tfamily_man_man_boy: \"\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_man_boy_boy:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_man_girl: \"\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc67\",\n\t\tfamily_man_man_girl_boy:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_man_girl_girl:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc68\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc67\",\n\t\tfamily_man_woman_boy: \"\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_woman_boy_boy:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_woman_girl: \"\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\",\n\t\tfamily_man_woman_girl_boy:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc66\",\n\t\tfamily_man_woman_girl_girl:\n\t\t\t\"\\ud83d\\udc68\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc67\",\n\t\tfamily_woman_boy: \"\\ud83d\\udc69\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_boy_boy: \"\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_girl: \"\\ud83d\\udc69\\u200d\\ud83d\\udc67\",\n\t\tfamily_woman_girl_boy: \"\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_girl_girl: \"\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc67\",\n\t\tfamily_woman_woman_boy: \"\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_woman_boy_boy:\n\t\t\t\"\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc66\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_woman_girl: \"\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\",\n\t\tfamily_woman_woman_girl_boy:\n\t\t\t\"\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc66\",\n\t\tfamily_woman_woman_girl_girl:\n\t\t\t\"\\ud83d\\udc69\\u200d\\ud83d\\udc69\\u200d\\ud83d\\udc67\\u200d\\ud83d\\udc67\",\n\t\tfarmer: \"\\ud83e\\uddd1\\u200d\\ud83c\\udf3e\",\n\t\tfaroe_islands: \"\\ud83c\\uddeb\\ud83c\\uddf4\",\n\t\tfast_forward: \"\\u23e9\",\n\t\tfax: \"\\ud83d\\udce0\",\n\t\tfearful: \"\\ud83d\\ude28\",\n\t\tfeet: \"\\ud83d\\udc3e\",\n\t\tfemale_detective: \"\\ud83d\\udd75\\ufe0f\\u200d\\u2640\\ufe0f\",\n\t\tfemale_sign: \"\\u2640\\ufe0f\",\n\t\tferris_wheel: \"\\ud83c\\udfa1\",\n\t\tferry: \"\\u26f4\\ufe0f\",\n\t\tfield_hockey: \"\\ud83c\\udfd1\",\n\t\tfiji: \"\\ud83c\\uddeb\\ud83c\\uddef\",\n\t\tfile_cabinet: \"\\ud83d\\uddc4\\ufe0f\",\n\t\tfile_folder: \"\\ud83d\\udcc1\",\n\t\tfilm_projector: \"\\ud83d\\udcfd\\ufe0f\",\n\t\tfilm_strip: \"\\ud83c\\udf9e\\ufe0f\",\n\t\tfinland: \"\\ud83c\\uddeb\\ud83c\\uddee\",\n\t\tfire: \"\\ud83d\\udd25\",\n\t\tfire_engine: \"\\ud83d\\ude92\",\n\t\tfire_extinguisher: \"\\ud83e\\uddef\",\n\t\tfirecracker: \"\\ud83e\\udde8\",\n\t\tfirefighter: \"\\ud83e\\uddd1\\u200d\\ud83d\\ude92\",\n\t\tfireworks: \"\\ud83c\\udf86\",\n\t\tfirst_quarter_moon: \"\\ud83c\\udf13\",\n\t\tfirst_quarter_moon_with_face: \"\\ud83c\\udf1b\",\n\t\tfish: \"\\ud83d\\udc1f\",\n\t\tfish_cake: \"\\ud83c\\udf65\",\n\t\tfishing_pole_and_fish: \"\\ud83c\\udfa3\",\n\t\tfist: \"\\u270a\",\n\t\tfist_left: \"\\ud83e\\udd1b\",\n\t\tfist_oncoming: \"\\ud83d\\udc4a\",\n\t\tfist_raised: \"\\u270a\",\n\t\tfist_right: \"\\ud83e\\udd1c\",\n\t\tfive: \"5\\ufe0f\\u20e3\",\n\t\tflags: \"\\ud83c\\udf8f\",\n\t\tflamingo: \"\\ud83e\\udda9\",\n\t\tflashlight: \"\\ud83d\\udd26\",\n\t\tflat_shoe: \"\\ud83e\\udd7f\",\n\t\tfleur_de_lis: \"\\u269c\\ufe0f\",\n\t\tflight_arrival: \"\\ud83d\\udeec\",\n\t\tflight_departure: \"\\ud83d\\udeeb\",\n\t\tflipper: \"\\ud83d\\udc2c\",\n\t\tfloppy_disk: \"\\ud83d\\udcbe\",\n\t\tflower_playing_cards: \"\\ud83c\\udfb4\",\n\t\tflushed: \"\\ud83d\\ude33\",\n\t\tflying_disc: \"\\ud83e\\udd4f\",\n\t\tflying_saucer: \"\\ud83d\\udef8\",\n\t\tfog: \"\\ud83c\\udf2b\\ufe0f\",\n\t\tfoggy: \"\\ud83c\\udf01\",\n\t\tfoot: \"\\ud83e\\uddb6\",\n\t\tfootball: \"\\ud83c\\udfc8\",\n\t\tfootprints: \"\\ud83d\\udc63\",\n\t\tfork_and_knife: \"\\ud83c\\udf74\",\n\t\tfortune_cookie: \"\\ud83e\\udd60\",\n\t\tfountain: \"\\u26f2\",\n\t\tfountain_pen: \"\\ud83d\\udd8b\\ufe0f\",\n\t\tfour: \"4\\ufe0f\\u20e3\",\n\t\tfour_leaf_clover: \"\\ud83c\\udf40\",\n\t\tfox_face: \"\\ud83e\\udd8a\",\n\t\tfr: \"\\ud83c\\uddeb\\ud83c\\uddf7\",\n\t\tframed_picture: \"\\ud83d\\uddbc\\ufe0f\",\n\t\tfree: \"\\ud83c\\udd93\",\n\t\tfrench_guiana: \"\\ud83c\\uddec\\ud83c\\uddeb\",\n\t\tfrench_polynesia: \"\\ud83c\\uddf5\\ud83c\\uddeb\",\n\t\tfrench_southern_territories: \"\\ud83c\\uddf9\\ud83c\\uddeb\",\n\t\tfried_egg: \"\\ud83c\\udf73\",\n\t\tfried_shrimp: \"\\ud83c\\udf64\",\n\t\tfries: \"\\ud83c\\udf5f\",\n\t\tfrog: \"\\ud83d\\udc38\",\n\t\tfrowning: \"\\ud83d\\ude26\",\n\t\tfrowning_face: \"\\u2639\\ufe0f\",\n\t\tfrowning_man: \"\\ud83d\\ude4d\\u200d\\u2642\\ufe0f\",\n\t\tfrowning_person: \"\\ud83d\\ude4d\",\n\t\tfrowning_woman: \"\\ud83d\\ude4d\\u200d\\u2640\\ufe0f\",\n\t\tfu: \"\\ud83d\\udd95\",\n\t\tfuelpump: \"\\u26fd\",\n\t\tfull_moon: \"\\ud83c\\udf15\",\n\t\tfull_moon_with_face: \"\\ud83c\\udf1d\",\n\t\tfuneral_urn: \"\\u26b1\\ufe0f\",\n\t\tgabon: \"\\ud83c\\uddec\\ud83c\\udde6\",\n\t\tgambia: \"\\ud83c\\uddec\\ud83c\\uddf2\",\n\t\tgame_die: \"\\ud83c\\udfb2\",\n\t\tgarlic: \"\\ud83e\\uddc4\",\n\t\tgb: \"\\ud83c\\uddec\\ud83c\\udde7\",\n\t\tgear: \"\\u2699\\ufe0f\",\n\t\tgem: \"\\ud83d\\udc8e\",\n\t\tgemini: \"\\u264a\",\n\t\tgenie: \"\\ud83e\\uddde\",\n\t\tgenie_man: \"\\ud83e\\uddde\\u200d\\u2642\\ufe0f\",\n\t\tgenie_woman: \"\\ud83e\\uddde\\u200d\\u2640\\ufe0f\",\n\t\tgeorgia: \"\\ud83c\\uddec\\ud83c\\uddea\",\n\t\tghana: \"\\ud83c\\uddec\\ud83c\\udded\",\n\t\tghost: \"\\ud83d\\udc7b\",\n\t\tgibraltar: \"\\ud83c\\uddec\\ud83c\\uddee\",\n\t\tgift: \"\\ud83c\\udf81\",\n\t\tgift_heart: \"\\ud83d\\udc9d\",\n\t\tgiraffe: \"\\ud83e\\udd92\",\n\t\tgirl: \"\\ud83d\\udc67\",\n\t\tglobe_with_meridians: \"\\ud83c\\udf10\",\n\t\tgloves: \"\\ud83e\\udde4\",\n\t\tgoal_net: \"\\ud83e\\udd45\",\n\t\tgoat: \"\\ud83d\\udc10\",\n\t\tgoggles: \"\\ud83e\\udd7d\",\n\t\tgolf: \"\\u26f3\",\n\t\tgolfing: \"\\ud83c\\udfcc\\ufe0f\",\n\t\tgolfing_man: \"\\ud83c\\udfcc\\ufe0f\\u200d\\u2642\\ufe0f\",\n\t\tgolfing_woman: \"\\ud83c\\udfcc\\ufe0f\\u200d\\u2640\\ufe0f\",\n\t\tgorilla: \"\\ud83e\\udd8d\",\n\t\tgrapes: \"\\ud83c\\udf47\",\n\t\tgreece: \"\\ud83c\\uddec\\ud83c\\uddf7\",\n\t\tgreen_apple: \"\\ud83c\\udf4f\",\n\t\tgreen_book: \"\\ud83d\\udcd7\",\n\t\tgreen_circle: \"\\ud83d\\udfe2\",\n\t\tgreen_heart: \"\\ud83d\\udc9a\",\n\t\tgreen_salad: \"\\ud83e\\udd57\",\n\t\tgreen_square: \"\\ud83d\\udfe9\",\n\t\tgreenland: \"\\ud83c\\uddec\\ud83c\\uddf1\",\n\t\tgrenada: \"\\ud83c\\uddec\\ud83c\\udde9\",\n\t\tgrey_exclamation: \"\\u2755\",\n\t\tgrey_question: \"\\u2754\",\n\t\tgrimacing: \"\\ud83d\\ude2c\",\n\t\tgrin: \"\\ud83d\\ude01\",\n\t\tgrinning: \"\\ud83d\\ude00\",\n\t\tguadeloupe: \"\\ud83c\\uddec\\ud83c\\uddf5\",\n\t\tguam: \"\\ud83c\\uddec\\ud83c\\uddfa\",\n\t\tguard: \"\\ud83d\\udc82\",\n\t\tguardsman: \"\\ud83d\\udc82\\u200d\\u2642\\ufe0f\",\n\t\tguardswoman: \"\\ud83d\\udc82\\u200d\\u2640\\ufe0f\",\n\t\tguatemala: \"\\ud83c\\uddec\\ud83c\\uddf9\",\n\t\tguernsey: \"\\ud83c\\uddec\\ud83c\\uddec\",\n\t\tguide_dog: \"\\ud83e\\uddae\",\n\t\tguinea: \"\\ud83c\\uddec\\ud83c\\uddf3\",\n\t\tguinea_bissau: \"\\ud83c\\uddec\\ud83c\\uddfc\",\n\t\tguitar: \"\\ud83c\\udfb8\",\n\t\tgun: \"\\ud83d\\udd2b\",\n\t\tguyana: \"\\ud83c\\uddec\\ud83c\\uddfe\",\n\t\thaircut: \"\\ud83d\\udc87\",\n\t\thaircut_man: \"\\ud83d\\udc87\\u200d\\u2642\\ufe0f\",\n\t\thaircut_woman: \"\\ud83d\\udc87\\u200d\\u2640\\ufe0f\",\n\t\thaiti: \"\\ud83c\\udded\\ud83c\\uddf9\",\n\t\thamburger: \"\\ud83c\\udf54\",\n\t\thammer: \"\\ud83d\\udd28\",\n\t\thammer_and_pick: \"\\u2692\\ufe0f\",\n\t\thammer_and_wrench: \"\\ud83d\\udee0\\ufe0f\",\n\t\thamster: \"\\ud83d\\udc39\",\n\t\thand: \"\\u270b\",\n\t\thand_over_mouth: \"\\ud83e\\udd2d\",\n\t\thandbag: \"\\ud83d\\udc5c\",\n\t\thandball_person: \"\\ud83e\\udd3e\",\n\t\thandshake: \"\\ud83e\\udd1d\",\n\t\thankey: \"\\ud83d\\udca9\",\n\t\thash: \"#\\ufe0f\\u20e3\",\n\t\thatched_chick: \"\\ud83d\\udc25\",\n\t\thatching_chick: \"\\ud83d\\udc23\",\n\t\theadphones: \"\\ud83c\\udfa7\",\n\t\thealth_worker: \"\\ud83e\\uddd1\\u200d\\u2695\\ufe0f\",\n\t\thear_no_evil: \"\\ud83d\\ude49\",\n\t\theard_mcdonald_islands: \"\\ud83c\\udded\\ud83c\\uddf2\",\n\t\theart: \"\\u2764\\ufe0f\",\n\t\theart_decoration: \"\\ud83d\\udc9f\",\n\t\theart_eyes: \"\\ud83d\\ude0d\",\n\t\theart_eyes_cat: \"\\ud83d\\ude3b\",\n\t\theartbeat: \"\\ud83d\\udc93\",\n\t\theartpulse: \"\\ud83d\\udc97\",\n\t\thearts: \"\\u2665\\ufe0f\",\n\t\theavy_check_mark: \"\\u2714\\ufe0f\",\n\t\theavy_division_sign: \"\\u2797\",\n\t\theavy_dollar_sign: \"\\ud83d\\udcb2\",\n\t\theavy_exclamation_mark: \"\\u2757\",\n\t\theavy_heart_exclamation: \"\\u2763\\ufe0f\",\n\t\theavy_minus_sign: \"\\u2796\",\n\t\theavy_multiplication_x: \"\\u2716\\ufe0f\",\n\t\theavy_plus_sign: \"\\u2795\",\n\t\thedgehog: \"\\ud83e\\udd94\",\n\t\thelicopter: \"\\ud83d\\ude81\",\n\t\therb: \"\\ud83c\\udf3f\",\n\t\thibiscus: \"\\ud83c\\udf3a\",\n\t\thigh_brightness: \"\\ud83d\\udd06\",\n\t\thigh_heel: \"\\ud83d\\udc60\",\n\t\thiking_boot: \"\\ud83e\\udd7e\",\n\t\thindu_temple: \"\\ud83d\\uded5\",\n\t\thippopotamus: \"\\ud83e\\udd9b\",\n\t\thocho: \"\\ud83d\\udd2a\",\n\t\thole: \"\\ud83d\\udd73\\ufe0f\",\n\t\thonduras: \"\\ud83c\\udded\\ud83c\\uddf3\",\n\t\thoney_pot: \"\\ud83c\\udf6f\",\n\t\thoneybee: \"\\ud83d\\udc1d\",\n\t\thong_kong: \"\\ud83c\\udded\\ud83c\\uddf0\",\n\t\thorse: \"\\ud83d\\udc34\",\n\t\thorse_racing: \"\\ud83c\\udfc7\",\n\t\thospital: \"\\ud83c\\udfe5\",\n\t\thot_face: \"\\ud83e\\udd75\",\n\t\thot_pepper: \"\\ud83c\\udf36\\ufe0f\",\n\t\thotdog: \"\\ud83c\\udf2d\",\n\t\thotel: \"\\ud83c\\udfe8\",\n\t\thotsprings: \"\\u2668\\ufe0f\",\n\t\thourglass: \"\\u231b\",\n\t\thourglass_flowing_sand: \"\\u23f3\",\n\t\thouse: \"\\ud83c\\udfe0\",\n\t\thouse_with_garden: \"\\ud83c\\udfe1\",\n\t\thouses: \"\\ud83c\\udfd8\\ufe0f\",\n\t\thugs: \"\\ud83e\\udd17\",\n\t\thungary: \"\\ud83c\\udded\\ud83c\\uddfa\",\n\t\thushed: \"\\ud83d\\ude2f\",\n\t\tice_cream: \"\\ud83c\\udf68\",\n\t\tice_cube: \"\\ud83e\\uddca\",\n\t\tice_hockey: \"\\ud83c\\udfd2\",\n\t\tice_skate: \"\\u26f8\\ufe0f\",\n\t\ticecream: \"\\ud83c\\udf66\",\n\t\ticeland: \"\\ud83c\\uddee\\ud83c\\uddf8\",\n\t\tid: \"\\ud83c\\udd94\",\n\t\tideograph_advantage: \"\\ud83c\\ude50\",\n\t\timp: \"\\ud83d\\udc7f\",\n\t\tinbox_tray: \"\\ud83d\\udce5\",\n\t\tincoming_envelope: \"\\ud83d\\udce8\",\n\t\tindia: \"\\ud83c\\uddee\\ud83c\\uddf3\",\n\t\tindonesia: \"\\ud83c\\uddee\\ud83c\\udde9\",\n\t\tinfinity: \"\\u267e\\ufe0f\",\n\t\tinformation_desk_person: \"\\ud83d\\udc81\",\n\t\tinformation_source: \"\\u2139\\ufe0f\",\n\t\tinnocent: \"\\ud83d\\ude07\",\n\t\tinterrobang: \"\\u2049\\ufe0f\",\n\t\tiphone: \"\\ud83d\\udcf1\",\n\t\tiran: \"\\ud83c\\uddee\\ud83c\\uddf7\",\n\t\tiraq: \"\\ud83c\\uddee\\ud83c\\uddf6\",\n\t\tireland: \"\\ud83c\\uddee\\ud83c\\uddea\",\n\t\tisle_of_man: \"\\ud83c\\uddee\\ud83c\\uddf2\",\n\t\tisrael: \"\\ud83c\\uddee\\ud83c\\uddf1\",\n\t\tit: \"\\ud83c\\uddee\\ud83c\\uddf9\",\n\t\tizakaya_lantern: \"\\ud83c\\udfee\",\n\t\tjack_o_lantern: \"\\ud83c\\udf83\",\n\t\tjamaica: \"\\ud83c\\uddef\\ud83c\\uddf2\",\n\t\tjapan: \"\\ud83d\\uddfe\",\n\t\tjapanese_castle: \"\\ud83c\\udfef\",\n\t\tjapanese_goblin: \"\\ud83d\\udc7a\",\n\t\tjapanese_ogre: \"\\ud83d\\udc79\",\n\t\tjeans: \"\\ud83d\\udc56\",\n\t\tjersey: \"\\ud83c\\uddef\\ud83c\\uddea\",\n\t\tjigsaw: \"\\ud83e\\udde9\",\n\t\tjordan: \"\\ud83c\\uddef\\ud83c\\uddf4\",\n\t\tjoy: \"\\ud83d\\ude02\",\n\t\tjoy_cat: \"\\ud83d\\ude39\",\n\t\tjoystick: \"\\ud83d\\udd79\\ufe0f\",\n\t\tjp: \"\\ud83c\\uddef\\ud83c\\uddf5\",\n\t\tjudge: \"\\ud83e\\uddd1\\u200d\\u2696\\ufe0f\",\n\t\tjuggling_person: \"\\ud83e\\udd39\",\n\t\tkaaba: \"\\ud83d\\udd4b\",\n\t\tkangaroo: \"\\ud83e\\udd98\",\n\t\tkazakhstan: \"\\ud83c\\uddf0\\ud83c\\uddff\",\n\t\tkenya: \"\\ud83c\\uddf0\\ud83c\\uddea\",\n\t\tkey: \"\\ud83d\\udd11\",\n\t\tkeyboard: \"\\u2328\\ufe0f\",\n\t\tkeycap_ten: \"\\ud83d\\udd1f\",\n\t\tkick_scooter: \"\\ud83d\\udef4\",\n\t\tkimono: \"\\ud83d\\udc58\",\n\t\tkiribati: \"\\ud83c\\uddf0\\ud83c\\uddee\",\n\t\tkiss: \"\\ud83d\\udc8b\",\n\t\tkissing: \"\\ud83d\\ude17\",\n\t\tkissing_cat: \"\\ud83d\\ude3d\",\n\t\tkissing_closed_eyes: \"\\ud83d\\ude1a\",\n\t\tkissing_heart: \"\\ud83d\\ude18\",\n\t\tkissing_smiling_eyes: \"\\ud83d\\ude19\",\n\t\tkite: \"\\ud83e\\ude81\",\n\t\tkiwi_fruit: \"\\ud83e\\udd5d\",\n\t\tkneeling_man: \"\\ud83e\\uddce\\u200d\\u2642\\ufe0f\",\n\t\tkneeling_person: \"\\ud83e\\uddce\",\n\t\tkneeling_woman: \"\\ud83e\\uddce\\u200d\\u2640\\ufe0f\",\n\t\tknife: \"\\ud83d\\udd2a\",\n\t\tkoala: \"\\ud83d\\udc28\",\n\t\tkoko: \"\\ud83c\\ude01\",\n\t\tkosovo: \"\\ud83c\\uddfd\\ud83c\\uddf0\",\n\t\tkr: \"\\ud83c\\uddf0\\ud83c\\uddf7\",\n\t\tkuwait: \"\\ud83c\\uddf0\\ud83c\\uddfc\",\n\t\tkyrgyzstan: \"\\ud83c\\uddf0\\ud83c\\uddec\",\n\t\tlab_coat: \"\\ud83e\\udd7c\",\n\t\tlabel: \"\\ud83c\\udff7\\ufe0f\",\n\t\tlacrosse: \"\\ud83e\\udd4d\",\n\t\tlantern: \"\\ud83c\\udfee\",\n\t\tlaos: \"\\ud83c\\uddf1\\ud83c\\udde6\",\n\t\tlarge_blue_circle: \"\\ud83d\\udd35\",\n\t\tlarge_blue_diamond: \"\\ud83d\\udd37\",\n\t\tlarge_orange_diamond: \"\\ud83d\\udd36\",\n\t\tlast_quarter_moon: \"\\ud83c\\udf17\",\n\t\tlast_quarter_moon_with_face: \"\\ud83c\\udf1c\",\n\t\tlatin_cross: \"\\u271d\\ufe0f\",\n\t\tlatvia: \"\\ud83c\\uddf1\\ud83c\\uddfb\",\n\t\tlaughing: \"\\ud83d\\ude06\",\n\t\tleafy_green: \"\\ud83e\\udd6c\",\n\t\tleaves: \"\\ud83c\\udf43\",\n\t\tlebanon: \"\\ud83c\\uddf1\\ud83c\\udde7\",\n\t\tledger: \"\\ud83d\\udcd2\",\n\t\tleft_luggage: \"\\ud83d\\udec5\",\n\t\tleft_right_arrow: \"\\u2194\\ufe0f\",\n\t\tleft_speech_bubble: \"\\ud83d\\udde8\\ufe0f\",\n\t\tleftwards_arrow_with_hook: \"\\u21a9\\ufe0f\",\n\t\tleg: \"\\ud83e\\uddb5\",\n\t\tlemon: \"\\ud83c\\udf4b\",\n\t\tleo: \"\\u264c\",\n\t\tleopard: \"\\ud83d\\udc06\",\n\t\tlesotho: \"\\ud83c\\uddf1\\ud83c\\uddf8\",\n\t\tlevel_slider: \"\\ud83c\\udf9a\\ufe0f\",\n\t\tliberia: \"\\ud83c\\uddf1\\ud83c\\uddf7\",\n\t\tlibra: \"\\u264e\",\n\t\tlibya: \"\\ud83c\\uddf1\\ud83c\\uddfe\",\n\t\tliechtenstein: \"\\ud83c\\uddf1\\ud83c\\uddee\",\n\t\tlight_rail: \"\\ud83d\\ude88\",\n\t\tlink: \"\\ud83d\\udd17\",\n\t\tlion: \"\\ud83e\\udd81\",\n\t\tlips: \"\\ud83d\\udc44\",\n\t\tlipstick: \"\\ud83d\\udc84\",\n\t\tlithuania: \"\\ud83c\\uddf1\\ud83c\\uddf9\",\n\t\tlizard: \"\\ud83e\\udd8e\",\n\t\tllama: \"\\ud83e\\udd99\",\n\t\tlobster: \"\\ud83e\\udd9e\",\n\t\tlock: \"\\ud83d\\udd12\",\n\t\tlock_with_ink_pen: \"\\ud83d\\udd0f\",\n\t\tlollipop: \"\\ud83c\\udf6d\",\n\t\tloop: \"\\u27bf\",\n\t\tlotion_bottle: \"\\ud83e\\uddf4\",\n\t\tlotus_position: \"\\ud83e\\uddd8\",\n\t\tlotus_position_man: \"\\ud83e\\uddd8\\u200d\\u2642\\ufe0f\",\n\t\tlotus_position_woman: \"\\ud83e\\uddd8\\u200d\\u2640\\ufe0f\",\n\t\tloud_sound: \"\\ud83d\\udd0a\",\n\t\tloudspeaker: \"\\ud83d\\udce2\",\n\t\tlove_hotel: \"\\ud83c\\udfe9\",\n\t\tlove_letter: \"\\ud83d\\udc8c\",\n\t\tlove_you_gesture: \"\\ud83e\\udd1f\",\n\t\tlow_brightness: \"\\ud83d\\udd05\",\n\t\tluggage: \"\\ud83e\\uddf3\",\n\t\tluxembourg: \"\\ud83c\\uddf1\\ud83c\\uddfa\",\n\t\tlying_face: \"\\ud83e\\udd25\",\n\t\tm: \"\\u24c2\\ufe0f\",\n\t\tmacau: \"\\ud83c\\uddf2\\ud83c\\uddf4\",\n\t\tmacedonia: \"\\ud83c\\uddf2\\ud83c\\uddf0\",\n\t\tmadagascar: \"\\ud83c\\uddf2\\ud83c\\uddec\",\n\t\tmag: \"\\ud83d\\udd0d\",\n\t\tmag_right: \"\\ud83d\\udd0e\",\n\t\tmage: \"\\ud83e\\uddd9\",\n\t\tmage_man: \"\\ud83e\\uddd9\\u200d\\u2642\\ufe0f\",\n\t\tmage_woman: \"\\ud83e\\uddd9\\u200d\\u2640\\ufe0f\",\n\t\tmagnet: \"\\ud83e\\uddf2\",\n\t\tmahjong: \"\\ud83c\\udc04\",\n\t\tmailbox: \"\\ud83d\\udceb\",\n\t\tmailbox_closed: \"\\ud83d\\udcea\",\n\t\tmailbox_with_mail: \"\\ud83d\\udcec\",\n\t\tmailbox_with_no_mail: \"\\ud83d\\udced\",\n\t\tmalawi: \"\\ud83c\\uddf2\\ud83c\\uddfc\",\n\t\tmalaysia: \"\\ud83c\\uddf2\\ud83c\\uddfe\",\n\t\tmaldives: \"\\ud83c\\uddf2\\ud83c\\uddfb\",\n\t\tmale_detective: \"\\ud83d\\udd75\\ufe0f\\u200d\\u2642\\ufe0f\",\n\t\tmale_sign: \"\\u2642\\ufe0f\",\n\t\tmali: \"\\ud83c\\uddf2\\ud83c\\uddf1\",\n\t\tmalta: \"\\ud83c\\uddf2\\ud83c\\uddf9\",\n\t\tman: \"\\ud83d\\udc68\",\n\t\tman_artist: \"\\ud83d\\udc68\\u200d\\ud83c\\udfa8\",\n\t\tman_astronaut: \"\\ud83d\\udc68\\u200d\\ud83d\\ude80\",\n\t\tman_cartwheeling: \"\\ud83e\\udd38\\u200d\\u2642\\ufe0f\",\n\t\tman_cook: \"\\ud83d\\udc68\\u200d\\ud83c\\udf73\",\n\t\tman_dancing: \"\\ud83d\\udd7a\",\n\t\tman_facepalming: \"\\ud83e\\udd26\\u200d\\u2642\\ufe0f\",\n\t\tman_factory_worker: \"\\ud83d\\udc68\\u200d\\ud83c\\udfed\",\n\t\tman_farmer: \"\\ud83d\\udc68\\u200d\\ud83c\\udf3e\",\n\t\tman_firefighter: \"\\ud83d\\udc68\\u200d\\ud83d\\ude92\",\n\t\tman_health_worker: \"\\ud83d\\udc68\\u200d\\u2695\\ufe0f\",\n\t\tman_in_manual_wheelchair: \"\\ud83d\\udc68\\u200d\\ud83e\\uddbd\",\n\t\tman_in_motorized_wheelchair: \"\\ud83d\\udc68\\u200d\\ud83e\\uddbc\",\n\t\tman_in_tuxedo: \"\\ud83e\\udd35\",\n\t\tman_judge: \"\\ud83d\\udc68\\u200d\\u2696\\ufe0f\",\n\t\tman_juggling: \"\\ud83e\\udd39\\u200d\\u2642\\ufe0f\",\n\t\tman_mechanic: \"\\ud83d\\udc68\\u200d\\ud83d\\udd27\",\n\t\tman_office_worker: \"\\ud83d\\udc68\\u200d\\ud83d\\udcbc\",\n\t\tman_pilot: \"\\ud83d\\udc68\\u200d\\u2708\\ufe0f\",\n\t\tman_playing_handball: \"\\ud83e\\udd3e\\u200d\\u2642\\ufe0f\",\n\t\tman_playing_water_polo: \"\\ud83e\\udd3d\\u200d\\u2642\\ufe0f\",\n\t\tman_scientist: \"\\ud83d\\udc68\\u200d\\ud83d\\udd2c\",\n\t\tman_shrugging: \"\\ud83e\\udd37\\u200d\\u2642\\ufe0f\",\n\t\tman_singer: \"\\ud83d\\udc68\\u200d\\ud83c\\udfa4\",\n\t\tman_student: \"\\ud83d\\udc68\\u200d\\ud83c\\udf93\",\n\t\tman_teacher: \"\\ud83d\\udc68\\u200d\\ud83c\\udfeb\",\n\t\tman_technologist: \"\\ud83d\\udc68\\u200d\\ud83d\\udcbb\",\n\t\tman_with_gua_pi_mao: \"\\ud83d\\udc72\",\n\t\tman_with_probing_cane: \"\\ud83d\\udc68\\u200d\\ud83e\\uddaf\",\n\t\tman_with_turban: \"\\ud83d\\udc73\\u200d\\u2642\\ufe0f\",\n\t\tmandarin: \"\\ud83c\\udf4a\",\n\t\tmango: \"\\ud83e\\udd6d\",\n\t\tmans_shoe: \"\\ud83d\\udc5e\",\n\t\tmantelpiece_clock: \"\\ud83d\\udd70\\ufe0f\",\n\t\tmanual_wheelchair: \"\\ud83e\\uddbd\",\n\t\tmaple_leaf: \"\\ud83c\\udf41\",\n\t\tmarshall_islands: \"\\ud83c\\uddf2\\ud83c\\udded\",\n\t\tmartial_arts_uniform: \"\\ud83e\\udd4b\",\n\t\tmartinique: \"\\ud83c\\uddf2\\ud83c\\uddf6\",\n\t\tmask: \"\\ud83d\\ude37\",\n\t\tmassage: \"\\ud83d\\udc86\",\n\t\tmassage_man: \"\\ud83d\\udc86\\u200d\\u2642\\ufe0f\",\n\t\tmassage_woman: \"\\ud83d\\udc86\\u200d\\u2640\\ufe0f\",\n\t\tmate: \"\\ud83e\\uddc9\",\n\t\tmauritania: \"\\ud83c\\uddf2\\ud83c\\uddf7\",\n\t\tmauritius: \"\\ud83c\\uddf2\\ud83c\\uddfa\",\n\t\tmayotte: \"\\ud83c\\uddfe\\ud83c\\uddf9\",\n\t\tmeat_on_bone: \"\\ud83c\\udf56\",\n\t\tmechanic: \"\\ud83e\\uddd1\\u200d\\ud83d\\udd27\",\n\t\tmechanical_arm: \"\\ud83e\\uddbe\",\n\t\tmechanical_leg: \"\\ud83e\\uddbf\",\n\t\tmedal_military: \"\\ud83c\\udf96\\ufe0f\",\n\t\tmedal_sports: \"\\ud83c\\udfc5\",\n\t\tmedical_symbol: \"\\u2695\\ufe0f\",\n\t\tmega: \"\\ud83d\\udce3\",\n\t\tmelon: \"\\ud83c\\udf48\",\n\t\tmemo: \"\\ud83d\\udcdd\",\n\t\tmen_wrestling: \"\\ud83e\\udd3c\\u200d\\u2642\\ufe0f\",\n\t\tmenorah: \"\\ud83d\\udd4e\",\n\t\tmens: \"\\ud83d\\udeb9\",\n\t\tmermaid: \"\\ud83e\\udddc\\u200d\\u2640\\ufe0f\",\n\t\tmerman: \"\\ud83e\\udddc\\u200d\\u2642\\ufe0f\",\n\t\tmerperson: \"\\ud83e\\udddc\",\n\t\tmetal: \"\\ud83e\\udd18\",\n\t\tmetro: \"\\ud83d\\ude87\",\n\t\tmexico: \"\\ud83c\\uddf2\\ud83c\\uddfd\",\n\t\tmicrobe: \"\\ud83e\\udda0\",\n\t\tmicronesia: \"\\ud83c\\uddeb\\ud83c\\uddf2\",\n\t\tmicrophone: \"\\ud83c\\udfa4\",\n\t\tmicroscope: \"\\ud83d\\udd2c\",\n\t\tmiddle_finger: \"\\ud83d\\udd95\",\n\t\tmilk_glass: \"\\ud83e\\udd5b\",\n\t\tmilky_way: \"\\ud83c\\udf0c\",\n\t\tminibus: \"\\ud83d\\ude90\",\n\t\tminidisc: \"\\ud83d\\udcbd\",\n\t\tmobile_phone_off: \"\\ud83d\\udcf4\",\n\t\tmoldova: \"\\ud83c\\uddf2\\ud83c\\udde9\",\n\t\tmonaco: \"\\ud83c\\uddf2\\ud83c\\udde8\",\n\t\tmoney_mouth_face: \"\\ud83e\\udd11\",\n\t\tmoney_with_wings: \"\\ud83d\\udcb8\",\n\t\tmoneybag: \"\\ud83d\\udcb0\",\n\t\tmongolia: \"\\ud83c\\uddf2\\ud83c\\uddf3\",\n\t\tmonkey: \"\\ud83d\\udc12\",\n\t\tmonkey_face: \"\\ud83d\\udc35\",\n\t\tmonocle_face: \"\\ud83e\\uddd0\",\n\t\tmonorail: \"\\ud83d\\ude9d\",\n\t\tmontenegro: \"\\ud83c\\uddf2\\ud83c\\uddea\",\n\t\tmontserrat: \"\\ud83c\\uddf2\\ud83c\\uddf8\",\n\t\tmoon: \"\\ud83c\\udf14\",\n\t\tmoon_cake: \"\\ud83e\\udd6e\",\n\t\tmorocco: \"\\ud83c\\uddf2\\ud83c\\udde6\",\n\t\tmortar_board: \"\\ud83c\\udf93\",\n\t\tmosque: \"\\ud83d\\udd4c\",\n\t\tmosquito: \"\\ud83e\\udd9f\",\n\t\tmotor_boat: \"\\ud83d\\udee5\\ufe0f\",\n\t\tmotor_scooter: \"\\ud83d\\udef5\",\n\t\tmotorcycle: \"\\ud83c\\udfcd\\ufe0f\",\n\t\tmotorized_wheelchair: \"\\ud83e\\uddbc\",\n\t\tmotorway: \"\\ud83d\\udee3\\ufe0f\",\n\t\tmount_fuji: \"\\ud83d\\uddfb\",\n\t\tmountain: \"\\u26f0\\ufe0f\",\n\t\tmountain_bicyclist: \"\\ud83d\\udeb5\",\n\t\tmountain_biking_man: \"\\ud83d\\udeb5\\u200d\\u2642\\ufe0f\",\n\t\tmountain_biking_woman: \"\\ud83d\\udeb5\\u200d\\u2640\\ufe0f\",\n\t\tmountain_cableway: \"\\ud83d\\udea0\",\n\t\tmountain_railway: \"\\ud83d\\ude9e\",\n\t\tmountain_snow: \"\\ud83c\\udfd4\\ufe0f\",\n\t\tmouse: \"\\ud83d\\udc2d\",\n\t\tmouse2: \"\\ud83d\\udc01\",\n\t\tmovie_camera: \"\\ud83c\\udfa5\",\n\t\tmoyai: \"\\ud83d\\uddff\",\n\t\tmozambique: \"\\ud83c\\uddf2\\ud83c\\uddff\",\n\t\tmrs_claus: \"\\ud83e\\udd36\",\n\t\tmuscle: \"\\ud83d\\udcaa\",\n\t\tmushroom: \"\\ud83c\\udf44\",\n\t\tmusical_keyboard: \"\\ud83c\\udfb9\",\n\t\tmusical_note: \"\\ud83c\\udfb5\",\n\t\tmusical_score: \"\\ud83c\\udfbc\",\n\t\tmute: \"\\ud83d\\udd07\",\n\t\tmyanmar: \"\\ud83c\\uddf2\\ud83c\\uddf2\",\n\t\tnail_care: \"\\ud83d\\udc85\",\n\t\tname_badge: \"\\ud83d\\udcdb\",\n\t\tnamibia: \"\\ud83c\\uddf3\\ud83c\\udde6\",\n\t\tnational_park: \"\\ud83c\\udfde\\ufe0f\",\n\t\tnauru: \"\\ud83c\\uddf3\\ud83c\\uddf7\",\n\t\tnauseated_face: \"\\ud83e\\udd22\",\n\t\tnazar_amulet: \"\\ud83e\\uddff\",\n\t\tnecktie: \"\\ud83d\\udc54\",\n\t\tnegative_squared_cross_mark: \"\\u274e\",\n\t\tnepal: \"\\ud83c\\uddf3\\ud83c\\uddf5\",\n\t\tnerd_face: \"\\ud83e\\udd13\",\n\t\tnetherlands: \"\\ud83c\\uddf3\\ud83c\\uddf1\",\n\t\tneutral_face: \"\\ud83d\\ude10\",\n\t\tnew: \"\\ud83c\\udd95\",\n\t\tnew_caledonia: \"\\ud83c\\uddf3\\ud83c\\udde8\",\n\t\tnew_moon: \"\\ud83c\\udf11\",\n\t\tnew_moon_with_face: \"\\ud83c\\udf1a\",\n\t\tnew_zealand: \"\\ud83c\\uddf3\\ud83c\\uddff\",\n\t\tnewspaper: \"\\ud83d\\udcf0\",\n\t\tnewspaper_roll: \"\\ud83d\\uddde\\ufe0f\",\n\t\tnext_track_button: \"\\u23ed\\ufe0f\",\n\t\tng: \"\\ud83c\\udd96\",\n\t\tng_man: \"\\ud83d\\ude45\\u200d\\u2642\\ufe0f\",\n\t\tng_woman: \"\\ud83d\\ude45\\u200d\\u2640\\ufe0f\",\n\t\tnicaragua: \"\\ud83c\\uddf3\\ud83c\\uddee\",\n\t\tniger: \"\\ud83c\\uddf3\\ud83c\\uddea\",\n\t\tnigeria: \"\\ud83c\\uddf3\\ud83c\\uddec\",\n\t\tnight_with_stars: \"\\ud83c\\udf03\",\n\t\tnine: \"9\\ufe0f\\u20e3\",\n\t\tniue: \"\\ud83c\\uddf3\\ud83c\\uddfa\",\n\t\tno_bell: \"\\ud83d\\udd15\",\n\t\tno_bicycles: \"\\ud83d\\udeb3\",\n\t\tno_entry: \"\\u26d4\",\n\t\tno_entry_sign: \"\\ud83d\\udeab\",\n\t\tno_good: \"\\ud83d\\ude45\",\n\t\tno_good_man: \"\\ud83d\\ude45\\u200d\\u2642\\ufe0f\",\n\t\tno_good_woman: \"\\ud83d\\ude45\\u200d\\u2640\\ufe0f\",\n\t\tno_mobile_phones: \"\\ud83d\\udcf5\",\n\t\tno_mouth: \"\\ud83d\\ude36\",\n\t\tno_pedestrians: \"\\ud83d\\udeb7\",\n\t\tno_smoking: \"\\ud83d\\udead\",\n\t\t\"non-potable_water\": \"\\ud83d\\udeb1\",\n\t\tnorfolk_island: \"\\ud83c\\uddf3\\ud83c\\uddeb\",\n\t\tnorth_korea: \"\\ud83c\\uddf0\\ud83c\\uddf5\",\n\t\tnorthern_mariana_islands: \"\\ud83c\\uddf2\\ud83c\\uddf5\",\n\t\tnorway: \"\\ud83c\\uddf3\\ud83c\\uddf4\",\n\t\tnose: \"\\ud83d\\udc43\",\n\t\tnotebook: \"\\ud83d\\udcd3\",\n\t\tnotebook_with_decorative_cover: \"\\ud83d\\udcd4\",\n\t\tnotes: \"\\ud83c\\udfb6\",\n\t\tnut_and_bolt: \"\\ud83d\\udd29\",\n\t\to: \"\\u2b55\",\n\t\to2: \"\\ud83c\\udd7e\\ufe0f\",\n\t\tocean: \"\\ud83c\\udf0a\",\n\t\toctopus: \"\\ud83d\\udc19\",\n\t\toden: \"\\ud83c\\udf62\",\n\t\toffice: \"\\ud83c\\udfe2\",\n\t\toffice_worker: \"\\ud83e\\uddd1\\u200d\\ud83d\\udcbc\",\n\t\toil_drum: \"\\ud83d\\udee2\\ufe0f\",\n\t\tok: \"\\ud83c\\udd97\",\n\t\tok_hand: \"\\ud83d\\udc4c\",\n\t\tok_man: \"\\ud83d\\ude46\\u200d\\u2642\\ufe0f\",\n\t\tok_person: \"\\ud83d\\ude46\",\n\t\tok_woman: \"\\ud83d\\ude46\\u200d\\u2640\\ufe0f\",\n\t\told_key: \"\\ud83d\\udddd\\ufe0f\",\n\t\tolder_adult: \"\\ud83e\\uddd3\",\n\t\tolder_man: \"\\ud83d\\udc74\",\n\t\tolder_woman: \"\\ud83d\\udc75\",\n\t\tom: \"\\ud83d\\udd49\\ufe0f\",\n\t\toman: \"\\ud83c\\uddf4\\ud83c\\uddf2\",\n\t\ton: \"\\ud83d\\udd1b\",\n\t\toncoming_automobile: \"\\ud83d\\ude98\",\n\t\toncoming_bus: \"\\ud83d\\ude8d\",\n\t\toncoming_police_car: \"\\ud83d\\ude94\",\n\t\toncoming_taxi: \"\\ud83d\\ude96\",\n\t\tone: \"1\\ufe0f\\u20e3\",\n\t\tone_piece_swimsuit: \"\\ud83e\\ude71\",\n\t\tonion: \"\\ud83e\\uddc5\",\n\t\topen_book: \"\\ud83d\\udcd6\",\n\t\topen_file_folder: \"\\ud83d\\udcc2\",\n\t\topen_hands: \"\\ud83d\\udc50\",\n\t\topen_mouth: \"\\ud83d\\ude2e\",\n\t\topen_umbrella: \"\\u2602\\ufe0f\",\n\t\tophiuchus: \"\\u26ce\",\n\t\torange: \"\\ud83c\\udf4a\",\n\t\torange_book: \"\\ud83d\\udcd9\",\n\t\torange_circle: \"\\ud83d\\udfe0\",\n\t\torange_heart: \"\\ud83e\\udde1\",\n\t\torange_square: \"\\ud83d\\udfe7\",\n\t\torangutan: \"\\ud83e\\udda7\",\n\t\torthodox_cross: \"\\u2626\\ufe0f\",\n\t\totter: \"\\ud83e\\udda6\",\n\t\toutbox_tray: \"\\ud83d\\udce4\",\n\t\towl: \"\\ud83e\\udd89\",\n\t\tox: \"\\ud83d\\udc02\",\n\t\toyster: \"\\ud83e\\uddaa\",\n\t\tpackage: \"\\ud83d\\udce6\",\n\t\tpage_facing_up: \"\\ud83d\\udcc4\",\n\t\tpage_with_curl: \"\\ud83d\\udcc3\",\n\t\tpager: \"\\ud83d\\udcdf\",\n\t\tpaintbrush: \"\\ud83d\\udd8c\\ufe0f\",\n\t\tpakistan: \"\\ud83c\\uddf5\\ud83c\\uddf0\",\n\t\tpalau: \"\\ud83c\\uddf5\\ud83c\\uddfc\",\n\t\tpalestinian_territories: \"\\ud83c\\uddf5\\ud83c\\uddf8\",\n\t\tpalm_tree: \"\\ud83c\\udf34\",\n\t\tpalms_up_together: \"\\ud83e\\udd32\",\n\t\tpanama: \"\\ud83c\\uddf5\\ud83c\\udde6\",\n\t\tpancakes: \"\\ud83e\\udd5e\",\n\t\tpanda_face: \"\\ud83d\\udc3c\",\n\t\tpaperclip: \"\\ud83d\\udcce\",\n\t\tpaperclips: \"\\ud83d\\udd87\\ufe0f\",\n\t\tpapua_new_guinea: \"\\ud83c\\uddf5\\ud83c\\uddec\",\n\t\tparachute: \"\\ud83e\\ude82\",\n\t\tparaguay: \"\\ud83c\\uddf5\\ud83c\\uddfe\",\n\t\tparasol_on_ground: \"\\u26f1\\ufe0f\",\n\t\tparking: \"\\ud83c\\udd7f\\ufe0f\",\n\t\tparrot: \"\\ud83e\\udd9c\",\n\t\tpart_alternation_mark: \"\\u303d\\ufe0f\",\n\t\tpartly_sunny: \"\\u26c5\",\n\t\tpartying_face: \"\\ud83e\\udd73\",\n\t\tpassenger_ship: \"\\ud83d\\udef3\\ufe0f\",\n\t\tpassport_control: \"\\ud83d\\udec2\",\n\t\tpause_button: \"\\u23f8\\ufe0f\",\n\t\tpaw_prints: \"\\ud83d\\udc3e\",\n\t\tpeace_symbol: \"\\u262e\\ufe0f\",\n\t\tpeach: \"\\ud83c\\udf51\",\n\t\tpeacock: \"\\ud83e\\udd9a\",\n\t\tpeanuts: \"\\ud83e\\udd5c\",\n\t\tpear: \"\\ud83c\\udf50\",\n\t\tpen: \"\\ud83d\\udd8a\\ufe0f\",\n\t\tpencil: \"\\ud83d\\udcdd\",\n\t\tpencil2: \"\\u270f\\ufe0f\",\n\t\tpenguin: \"\\ud83d\\udc27\",\n\t\tpensive: \"\\ud83d\\ude14\",\n\t\tpeople_holding_hands: \"\\ud83e\\uddd1\\u200d\\ud83e\\udd1d\\u200d\\ud83e\\uddd1\",\n\t\tperforming_arts: \"\\ud83c\\udfad\",\n\t\tpersevere: \"\\ud83d\\ude23\",\n\t\tperson_bald: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddb2\",\n\t\tperson_curly_hair: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddb1\",\n\t\tperson_fencing: \"\\ud83e\\udd3a\",\n\t\tperson_in_manual_wheelchair: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddbd\",\n\t\tperson_in_motorized_wheelchair: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddbc\",\n\t\tperson_red_hair: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddb0\",\n\t\tperson_white_hair: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddb3\",\n\t\tperson_with_probing_cane: \"\\ud83e\\uddd1\\u200d\\ud83e\\uddaf\",\n\t\tperson_with_turban: \"\\ud83d\\udc73\",\n\t\tperu: \"\\ud83c\\uddf5\\ud83c\\uddea\",\n\t\tpetri_dish: \"\\ud83e\\uddeb\",\n\t\tphilippines: \"\\ud83c\\uddf5\\ud83c\\udded\",\n\t\tphone: \"\\u260e\\ufe0f\",\n\t\tpick: \"\\u26cf\\ufe0f\",\n\t\tpie: \"\\ud83e\\udd67\",\n\t\tpig: \"\\ud83d\\udc37\",\n\t\tpig2: \"\\ud83d\\udc16\",\n\t\tpig_nose: \"\\ud83d\\udc3d\",\n\t\tpill: \"\\ud83d\\udc8a\",\n\t\tpilot: \"\\ud83e\\uddd1\\u200d\\u2708\\ufe0f\",\n\t\tpinching_hand: \"\\ud83e\\udd0f\",\n\t\tpineapple: \"\\ud83c\\udf4d\",\n\t\tping_pong: \"\\ud83c\\udfd3\",\n\t\tpirate_flag: \"\\ud83c\\udff4\\u200d\\u2620\\ufe0f\",\n\t\tpisces: \"\\u2653\",\n\t\tpitcairn_islands: \"\\ud83c\\uddf5\\ud83c\\uddf3\",\n\t\tpizza: \"\\ud83c\\udf55\",\n\t\tplace_of_worship: \"\\ud83d\\uded0\",\n\t\tplate_with_cutlery: \"\\ud83c\\udf7d\\ufe0f\",\n\t\tplay_or_pause_button: \"\\u23ef\\ufe0f\",\n\t\tpleading_face: \"\\ud83e\\udd7a\",\n\t\tpoint_down: \"\\ud83d\\udc47\",\n\t\tpoint_left: \"\\ud83d\\udc48\",\n\t\tpoint_right: \"\\ud83d\\udc49\",\n\t\tpoint_up: \"\\u261d\\ufe0f\",\n\t\tpoint_up_2: \"\\ud83d\\udc46\",\n\t\tpoland: \"\\ud83c\\uddf5\\ud83c\\uddf1\",\n\t\tpolice_car: \"\\ud83d\\ude93\",\n\t\tpolice_officer: \"\\ud83d\\udc6e\",\n\t\tpoliceman: \"\\ud83d\\udc6e\\u200d\\u2642\\ufe0f\",\n\t\tpolicewoman: \"\\ud83d\\udc6e\\u200d\\u2640\\ufe0f\",\n\t\tpoodle: \"\\ud83d\\udc29\",\n\t\tpoop: \"\\ud83d\\udca9\",\n\t\tpopcorn: \"\\ud83c\\udf7f\",\n\t\tportugal: \"\\ud83c\\uddf5\\ud83c\\uddf9\",\n\t\tpost_office: \"\\ud83c\\udfe3\",\n\t\tpostal_horn: \"\\ud83d\\udcef\",\n\t\tpostbox: \"\\ud83d\\udcee\",\n\t\tpotable_water: \"\\ud83d\\udeb0\",\n\t\tpotato: \"\\ud83e\\udd54\",\n\t\tpouch: \"\\ud83d\\udc5d\",\n\t\tpoultry_leg: \"\\ud83c\\udf57\",\n\t\tpound: \"\\ud83d\\udcb7\",\n\t\tpout: \"\\ud83d\\ude21\",\n\t\tpouting_cat: \"\\ud83d\\ude3e\",\n\t\tpouting_face: \"\\ud83d\\ude4e\",\n\t\tpouting_man: \"\\ud83d\\ude4e\\u200d\\u2642\\ufe0f\",\n\t\tpouting_woman: \"\\ud83d\\ude4e\\u200d\\u2640\\ufe0f\",\n\t\tpray: \"\\ud83d\\ude4f\",\n\t\tprayer_beads: \"\\ud83d\\udcff\",\n\t\tpregnant_woman: \"\\ud83e\\udd30\",\n\t\tpretzel: \"\\ud83e\\udd68\",\n\t\tprevious_track_button: \"\\u23ee\\ufe0f\",\n\t\tprince: \"\\ud83e\\udd34\",\n\t\tprincess: \"\\ud83d\\udc78\",\n\t\tprinter: \"\\ud83d\\udda8\\ufe0f\",\n\t\tprobing_cane: \"\\ud83e\\uddaf\",\n\t\tpuerto_rico: \"\\ud83c\\uddf5\\ud83c\\uddf7\",\n\t\tpunch: \"\\ud83d\\udc4a\",\n\t\tpurple_circle: \"\\ud83d\\udfe3\",\n\t\tpurple_heart: \"\\ud83d\\udc9c\",\n\t\tpurple_square: \"\\ud83d\\udfea\",\n\t\tpurse: \"\\ud83d\\udc5b\",\n\t\tpushpin: \"\\ud83d\\udccc\",\n\t\tput_litter_in_its_place: \"\\ud83d\\udeae\",\n\t\tqatar: \"\\ud83c\\uddf6\\ud83c\\udde6\",\n\t\tquestion: \"\\u2753\",\n\t\trabbit: \"\\ud83d\\udc30\",\n\t\trabbit2: \"\\ud83d\\udc07\",\n\t\traccoon: \"\\ud83e\\udd9d\",\n\t\tracehorse: \"\\ud83d\\udc0e\",\n\t\tracing_car: \"\\ud83c\\udfce\\ufe0f\",\n\t\tradio: \"\\ud83d\\udcfb\",\n\t\tradio_button: \"\\ud83d\\udd18\",\n\t\tradioactive: \"\\u2622\\ufe0f\",\n\t\trage: \"\\ud83d\\ude21\",\n\t\trailway_car: \"\\ud83d\\ude83\",\n\t\trailway_track: \"\\ud83d\\udee4\\ufe0f\",\n\t\trainbow: \"\\ud83c\\udf08\",\n\t\trainbow_flag: \"\\ud83c\\udff3\\ufe0f\\u200d\\ud83c\\udf08\",\n\t\traised_back_of_hand: \"\\ud83e\\udd1a\",\n\t\traised_eyebrow: \"\\ud83e\\udd28\",\n\t\traised_hand: \"\\u270b\",\n\t\traised_hand_with_fingers_splayed: \"\\ud83d\\udd90\\ufe0f\",\n\t\traised_hands: \"\\ud83d\\ude4c\",\n\t\traising_hand: \"\\ud83d\\ude4b\",\n\t\traising_hand_man: \"\\ud83d\\ude4b\\u200d\\u2642\\ufe0f\",\n\t\traising_hand_woman: \"\\ud83d\\ude4b\\u200d\\u2640\\ufe0f\",\n\t\tram: \"\\ud83d\\udc0f\",\n\t\tramen: \"\\ud83c\\udf5c\",\n\t\trat: \"\\ud83d\\udc00\",\n\t\trazor: \"\\ud83e\\ude92\",\n\t\treceipt: \"\\ud83e\\uddfe\",\n\t\trecord_button: \"\\u23fa\\ufe0f\",\n\t\trecycle: \"\\u267b\\ufe0f\",\n\t\tred_car: \"\\ud83d\\ude97\",\n\t\tred_circle: \"\\ud83d\\udd34\",\n\t\tred_envelope: \"\\ud83e\\udde7\",\n\t\tred_haired_man: \"\\ud83d\\udc68\\u200d\\ud83e\\uddb0\",\n\t\tred_haired_woman: \"\\ud83d\\udc69\\u200d\\ud83e\\uddb0\",\n\t\tred_square: \"\\ud83d\\udfe5\",\n\t\tregistered: \"\\u00ae\\ufe0f\",\n\t\trelaxed: \"\\u263a\\ufe0f\",\n\t\trelieved: \"\\ud83d\\ude0c\",\n\t\treminder_ribbon: \"\\ud83c\\udf97\\ufe0f\",\n\t\trepeat: \"\\ud83d\\udd01\",\n\t\trepeat_one: \"\\ud83d\\udd02\",\n\t\trescue_worker_helmet: \"\\u26d1\\ufe0f\",\n\t\trestroom: \"\\ud83d\\udebb\",\n\t\treunion: \"\\ud83c\\uddf7\\ud83c\\uddea\",\n\t\trevolving_hearts: \"\\ud83d\\udc9e\",\n\t\trewind: \"\\u23ea\",\n\t\trhinoceros: \"\\ud83e\\udd8f\",\n\t\tribbon: \"\\ud83c\\udf80\",\n\t\trice: \"\\ud83c\\udf5a\",\n\t\trice_ball: \"\\ud83c\\udf59\",\n\t\trice_cracker: \"\\ud83c\\udf58\",\n\t\trice_scene: \"\\ud83c\\udf91\",\n\t\tright_anger_bubble: \"\\ud83d\\uddef\\ufe0f\",\n\t\tring: \"\\ud83d\\udc8d\",\n\t\tringed_planet: \"\\ud83e\\ude90\",\n\t\trobot: \"\\ud83e\\udd16\",\n\t\trocket: \"\\ud83d\\ude80\",\n\t\trofl: \"\\ud83e\\udd23\",\n\t\troll_eyes: \"\\ud83d\\ude44\",\n\t\troll_of_paper: \"\\ud83e\\uddfb\",\n\t\troller_coaster: \"\\ud83c\\udfa2\",\n\t\tromania: \"\\ud83c\\uddf7\\ud83c\\uddf4\",\n\t\trooster: \"\\ud83d\\udc13\",\n\t\trose: \"\\ud83c\\udf39\",\n\t\trosette: \"\\ud83c\\udff5\\ufe0f\",\n\t\trotating_light: \"\\ud83d\\udea8\",\n\t\tround_pushpin: \"\\ud83d\\udccd\",\n\t\trowboat: \"\\ud83d\\udea3\",\n\t\trowing_man: \"\\ud83d\\udea3\\u200d\\u2642\\ufe0f\",\n\t\trowing_woman: \"\\ud83d\\udea3\\u200d\\u2640\\ufe0f\",\n\t\tru: \"\\ud83c\\uddf7\\ud83c\\uddfa\",\n\t\trugby_football: \"\\ud83c\\udfc9\",\n\t\trunner: \"\\ud83c\\udfc3\",\n\t\trunning: \"\\ud83c\\udfc3\",\n\t\trunning_man: \"\\ud83c\\udfc3\\u200d\\u2642\\ufe0f\",\n\t\trunning_shirt_with_sash: \"\\ud83c\\udfbd\",\n\t\trunning_woman: \"\\ud83c\\udfc3\\u200d\\u2640\\ufe0f\",\n\t\trwanda: \"\\ud83c\\uddf7\\ud83c\\uddfc\",\n\t\tsa: \"\\ud83c\\ude02\\ufe0f\",\n\t\tsafety_pin: \"\\ud83e\\uddf7\",\n\t\tsafety_vest: \"\\ud83e\\uddba\",\n\t\tsagittarius: \"\\u2650\",\n\t\tsailboat: \"\\u26f5\",\n\t\tsake: \"\\ud83c\\udf76\",\n\t\tsalt: \"\\ud83e\\uddc2\",\n\t\tsamoa: \"\\ud83c\\uddfc\\ud83c\\uddf8\",\n\t\tsan_marino: \"\\ud83c\\uddf8\\ud83c\\uddf2\",\n\t\tsandal: \"\\ud83d\\udc61\",\n\t\tsandwich: \"\\ud83e\\udd6a\",\n\t\tsanta: \"\\ud83c\\udf85\",\n\t\tsao_tome_principe: \"\\ud83c\\uddf8\\ud83c\\uddf9\",\n\t\tsari: \"\\ud83e\\udd7b\",\n\t\tsassy_man: \"\\ud83d\\udc81\\u200d\\u2642\\ufe0f\",\n\t\tsassy_woman: \"\\ud83d\\udc81\\u200d\\u2640\\ufe0f\",\n\t\tsatellite: \"\\ud83d\\udce1\",\n\t\tsatisfied: \"\\ud83d\\ude06\",\n\t\tsaudi_arabia: \"\\ud83c\\uddf8\\ud83c\\udde6\",\n\t\tsauna_man: \"\\ud83e\\uddd6\\u200d\\u2642\\ufe0f\",\n\t\tsauna_person: \"\\ud83e\\uddd6\",\n\t\tsauna_woman: \"\\ud83e\\uddd6\\u200d\\u2640\\ufe0f\",\n\t\tsauropod: \"\\ud83e\\udd95\",\n\t\tsaxophone: \"\\ud83c\\udfb7\",\n\t\tscarf: \"\\ud83e\\udde3\",\n\t\tschool: \"\\ud83c\\udfeb\",\n\t\tschool_satchel: \"\\ud83c\\udf92\",\n\t\tscientist: \"\\ud83e\\uddd1\\u200d\\ud83d\\udd2c\",\n\t\tscissors: \"\\u2702\\ufe0f\",\n\t\tscorpion: \"\\ud83e\\udd82\",\n\t\tscorpius: \"\\u264f\",\n\t\tscotland:\n\t\t\t\"\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc73\\udb40\\udc63\\udb40\\udc74\\udb40\\udc7f\",\n\t\tscream: \"\\ud83d\\ude31\",\n\t\tscream_cat: \"\\ud83d\\ude40\",\n\t\tscroll: \"\\ud83d\\udcdc\",\n\t\tseat: \"\\ud83d\\udcba\",\n\t\tsecret: \"\\u3299\\ufe0f\",\n\t\tsee_no_evil: \"\\ud83d\\ude48\",\n\t\tseedling: \"\\ud83c\\udf31\",\n\t\tselfie: \"\\ud83e\\udd33\",\n\t\tsenegal: \"\\ud83c\\uddf8\\ud83c\\uddf3\",\n\t\tserbia: \"\\ud83c\\uddf7\\ud83c\\uddf8\",\n\t\tservice_dog: \"\\ud83d\\udc15\\u200d\\ud83e\\uddba\",\n\t\tseven: \"7\\ufe0f\\u20e3\",\n\t\tseychelles: \"\\ud83c\\uddf8\\ud83c\\udde8\",\n\t\tshallow_pan_of_food: \"\\ud83e\\udd58\",\n\t\tshamrock: \"\\u2618\\ufe0f\",\n\t\tshark: \"\\ud83e\\udd88\",\n\t\tshaved_ice: \"\\ud83c\\udf67\",\n\t\tsheep: \"\\ud83d\\udc11\",\n\t\tshell: \"\\ud83d\\udc1a\",\n\t\tshield: \"\\ud83d\\udee1\\ufe0f\",\n\t\tshinto_shrine: \"\\u26e9\\ufe0f\",\n\t\tship: \"\\ud83d\\udea2\",\n\t\tshirt: \"\\ud83d\\udc55\",\n\t\tshit: \"\\ud83d\\udca9\",\n\t\tshoe: \"\\ud83d\\udc5e\",\n\t\tshopping: \"\\ud83d\\udecd\\ufe0f\",\n\t\tshopping_cart: \"\\ud83d\\uded2\",\n\t\tshorts: \"\\ud83e\\ude73\",\n\t\tshower: \"\\ud83d\\udebf\",\n\t\tshrimp: \"\\ud83e\\udd90\",\n\t\tshrug: \"\\ud83e\\udd37\",\n\t\tshushing_face: \"\\ud83e\\udd2b\",\n\t\tsierra_leone: \"\\ud83c\\uddf8\\ud83c\\uddf1\",\n\t\tsignal_strength: \"\\ud83d\\udcf6\",\n\t\tsingapore: \"\\ud83c\\uddf8\\ud83c\\uddec\",\n\t\tsinger: \"\\ud83e\\uddd1\\u200d\\ud83c\\udfa4\",\n\t\tsint_maarten: \"\\ud83c\\uddf8\\ud83c\\uddfd\",\n\t\tsix: \"6\\ufe0f\\u20e3\",\n\t\tsix_pointed_star: \"\\ud83d\\udd2f\",\n\t\tskateboard: \"\\ud83d\\udef9\",\n\t\tski: \"\\ud83c\\udfbf\",\n\t\tskier: \"\\u26f7\\ufe0f\",\n\t\tskull: \"\\ud83d\\udc80\",\n\t\tskull_and_crossbones: \"\\u2620\\ufe0f\",\n\t\tskunk: \"\\ud83e\\udda8\",\n\t\tsled: \"\\ud83d\\udef7\",\n\t\tsleeping: \"\\ud83d\\ude34\",\n\t\tsleeping_bed: \"\\ud83d\\udecc\",\n\t\tsleepy: \"\\ud83d\\ude2a\",\n\t\tslightly_frowning_face: \"\\ud83d\\ude41\",\n\t\tslightly_smiling_face: \"\\ud83d\\ude42\",\n\t\tslot_machine: \"\\ud83c\\udfb0\",\n\t\tsloth: \"\\ud83e\\udda5\",\n\t\tslovakia: \"\\ud83c\\uddf8\\ud83c\\uddf0\",\n\t\tslovenia: \"\\ud83c\\uddf8\\ud83c\\uddee\",\n\t\tsmall_airplane: \"\\ud83d\\udee9\\ufe0f\",\n\t\tsmall_blue_diamond: \"\\ud83d\\udd39\",\n\t\tsmall_orange_diamond: \"\\ud83d\\udd38\",\n\t\tsmall_red_triangle: \"\\ud83d\\udd3a\",\n\t\tsmall_red_triangle_down: \"\\ud83d\\udd3b\",\n\t\tsmile: \"\\ud83d\\ude04\",\n\t\tsmile_cat: \"\\ud83d\\ude38\",\n\t\tsmiley: \"\\ud83d\\ude03\",\n\t\tsmiley_cat: \"\\ud83d\\ude3a\",\n\t\tsmiling_face_with_three_hearts: \"\\ud83e\\udd70\",\n\t\tsmiling_imp: \"\\ud83d\\ude08\",\n\t\tsmirk: \"\\ud83d\\ude0f\",\n\t\tsmirk_cat: \"\\ud83d\\ude3c\",\n\t\tsmoking: \"\\ud83d\\udeac\",\n\t\tsnail: \"\\ud83d\\udc0c\",\n\t\tsnake: \"\\ud83d\\udc0d\",\n\t\tsneezing_face: \"\\ud83e\\udd27\",\n\t\tsnowboarder: \"\\ud83c\\udfc2\",\n\t\tsnowflake: \"\\u2744\\ufe0f\",\n\t\tsnowman: \"\\u26c4\",\n\t\tsnowman_with_snow: \"\\u2603\\ufe0f\",\n\t\tsoap: \"\\ud83e\\uddfc\",\n\t\tsob: \"\\ud83d\\ude2d\",\n\t\tsoccer: \"\\u26bd\",\n\t\tsocks: \"\\ud83e\\udde6\",\n\t\tsoftball: \"\\ud83e\\udd4e\",\n\t\tsolomon_islands: \"\\ud83c\\uddf8\\ud83c\\udde7\",\n\t\tsomalia: \"\\ud83c\\uddf8\\ud83c\\uddf4\",\n\t\tsoon: \"\\ud83d\\udd1c\",\n\t\tsos: \"\\ud83c\\udd98\",\n\t\tsound: \"\\ud83d\\udd09\",\n\t\tsouth_africa: \"\\ud83c\\uddff\\ud83c\\udde6\",\n\t\tsouth_georgia_south_sandwich_islands: \"\\ud83c\\uddec\\ud83c\\uddf8\",\n\t\tsouth_sudan: \"\\ud83c\\uddf8\\ud83c\\uddf8\",\n\t\tspace_invader: \"\\ud83d\\udc7e\",\n\t\tspades: \"\\u2660\\ufe0f\",\n\t\tspaghetti: \"\\ud83c\\udf5d\",\n\t\tsparkle: \"\\u2747\\ufe0f\",\n\t\tsparkler: \"\\ud83c\\udf87\",\n\t\tsparkles: \"\\u2728\",\n\t\tsparkling_heart: \"\\ud83d\\udc96\",\n\t\tspeak_no_evil: \"\\ud83d\\ude4a\",\n\t\tspeaker: \"\\ud83d\\udd08\",\n\t\tspeaking_head: \"\\ud83d\\udde3\\ufe0f\",\n\t\tspeech_balloon: \"\\ud83d\\udcac\",\n\t\tspeedboat: \"\\ud83d\\udea4\",\n\t\tspider: \"\\ud83d\\udd77\\ufe0f\",\n\t\tspider_web: \"\\ud83d\\udd78\\ufe0f\",\n\t\tspiral_calendar: \"\\ud83d\\uddd3\\ufe0f\",\n\t\tspiral_notepad: \"\\ud83d\\uddd2\\ufe0f\",\n\t\tsponge: \"\\ud83e\\uddfd\",\n\t\tspoon: \"\\ud83e\\udd44\",\n\t\tsquid: \"\\ud83e\\udd91\",\n\t\tsri_lanka: \"\\ud83c\\uddf1\\ud83c\\uddf0\",\n\t\tst_barthelemy: \"\\ud83c\\udde7\\ud83c\\uddf1\",\n\t\tst_helena: \"\\ud83c\\uddf8\\ud83c\\udded\",\n\t\tst_kitts_nevis: \"\\ud83c\\uddf0\\ud83c\\uddf3\",\n\t\tst_lucia: \"\\ud83c\\uddf1\\ud83c\\udde8\",\n\t\tst_martin: \"\\ud83c\\uddf2\\ud83c\\uddeb\",\n\t\tst_pierre_miquelon: \"\\ud83c\\uddf5\\ud83c\\uddf2\",\n\t\tst_vincent_grenadines: \"\\ud83c\\uddfb\\ud83c\\udde8\",\n\t\tstadium: \"\\ud83c\\udfdf\\ufe0f\",\n\t\tstanding_man: \"\\ud83e\\uddcd\\u200d\\u2642\\ufe0f\",\n\t\tstanding_person: \"\\ud83e\\uddcd\",\n\t\tstanding_woman: \"\\ud83e\\uddcd\\u200d\\u2640\\ufe0f\",\n\t\tstar: \"\\u2b50\",\n\t\tstar2: \"\\ud83c\\udf1f\",\n\t\tstar_and_crescent: \"\\u262a\\ufe0f\",\n\t\tstar_of_david: \"\\u2721\\ufe0f\",\n\t\tstar_struck: \"\\ud83e\\udd29\",\n\t\tstars: \"\\ud83c\\udf20\",\n\t\tstation: \"\\ud83d\\ude89\",\n\t\tstatue_of_liberty: \"\\ud83d\\uddfd\",\n\t\tsteam_locomotive: \"\\ud83d\\ude82\",\n\t\tstethoscope: \"\\ud83e\\ude7a\",\n\t\tstew: \"\\ud83c\\udf72\",\n\t\tstop_button: \"\\u23f9\\ufe0f\",\n\t\tstop_sign: \"\\ud83d\\uded1\",\n\t\tstopwatch: \"\\u23f1\\ufe0f\",\n\t\tstraight_ruler: \"\\ud83d\\udccf\",\n\t\tstrawberry: \"\\ud83c\\udf53\",\n\t\tstuck_out_tongue: \"\\ud83d\\ude1b\",\n\t\tstuck_out_tongue_closed_eyes: \"\\ud83d\\ude1d\",\n\t\tstuck_out_tongue_winking_eye: \"\\ud83d\\ude1c\",\n\t\tstudent: \"\\ud83e\\uddd1\\u200d\\ud83c\\udf93\",\n\t\tstudio_microphone: \"\\ud83c\\udf99\\ufe0f\",\n\t\tstuffed_flatbread: \"\\ud83e\\udd59\",\n\t\tsudan: \"\\ud83c\\uddf8\\ud83c\\udde9\",\n\t\tsun_behind_large_cloud: \"\\ud83c\\udf25\\ufe0f\",\n\t\tsun_behind_rain_cloud: \"\\ud83c\\udf26\\ufe0f\",\n\t\tsun_behind_small_cloud: \"\\ud83c\\udf24\\ufe0f\",\n\t\tsun_with_face: \"\\ud83c\\udf1e\",\n\t\tsunflower: \"\\ud83c\\udf3b\",\n\t\tsunglasses: \"\\ud83d\\ude0e\",\n\t\tsunny: \"\\u2600\\ufe0f\",\n\t\tsunrise: \"\\ud83c\\udf05\",\n\t\tsunrise_over_mountains: \"\\ud83c\\udf04\",\n\t\tsuperhero: \"\\ud83e\\uddb8\",\n\t\tsuperhero_man: \"\\ud83e\\uddb8\\u200d\\u2642\\ufe0f\",\n\t\tsuperhero_woman: \"\\ud83e\\uddb8\\u200d\\u2640\\ufe0f\",\n\t\tsupervillain: \"\\ud83e\\uddb9\",\n\t\tsupervillain_man: \"\\ud83e\\uddb9\\u200d\\u2642\\ufe0f\",\n\t\tsupervillain_woman: \"\\ud83e\\uddb9\\u200d\\u2640\\ufe0f\",\n\t\tsurfer: \"\\ud83c\\udfc4\",\n\t\tsurfing_man: \"\\ud83c\\udfc4\\u200d\\u2642\\ufe0f\",\n\t\tsurfing_woman: \"\\ud83c\\udfc4\\u200d\\u2640\\ufe0f\",\n\t\tsuriname: \"\\ud83c\\uddf8\\ud83c\\uddf7\",\n\t\tsushi: \"\\ud83c\\udf63\",\n\t\tsuspension_railway: \"\\ud83d\\ude9f\",\n\t\tsvalbard_jan_mayen: \"\\ud83c\\uddf8\\ud83c\\uddef\",\n\t\tswan: \"\\ud83e\\udda2\",\n\t\tswaziland: \"\\ud83c\\uddf8\\ud83c\\uddff\",\n\t\tsweat: \"\\ud83d\\ude13\",\n\t\tsweat_drops: \"\\ud83d\\udca6\",\n\t\tsweat_smile: \"\\ud83d\\ude05\",\n\t\tsweden: \"\\ud83c\\uddf8\\ud83c\\uddea\",\n\t\tsweet_potato: \"\\ud83c\\udf60\",\n\t\tswim_brief: \"\\ud83e\\ude72\",\n\t\tswimmer: \"\\ud83c\\udfca\",\n\t\tswimming_man: \"\\ud83c\\udfca\\u200d\\u2642\\ufe0f\",\n\t\tswimming_woman: \"\\ud83c\\udfca\\u200d\\u2640\\ufe0f\",\n\t\tswitzerland: \"\\ud83c\\udde8\\ud83c\\udded\",\n\t\tsymbols: \"\\ud83d\\udd23\",\n\t\tsynagogue: \"\\ud83d\\udd4d\",\n\t\tsyria: \"\\ud83c\\uddf8\\ud83c\\uddfe\",\n\t\tsyringe: \"\\ud83d\\udc89\",\n\t\t\"t-rex\": \"\\ud83e\\udd96\",\n\t\ttaco: \"\\ud83c\\udf2e\",\n\t\ttada: \"\\ud83c\\udf89\",\n\t\ttaiwan: \"\\ud83c\\uddf9\\ud83c\\uddfc\",\n\t\ttajikistan: \"\\ud83c\\uddf9\\ud83c\\uddef\",\n\t\ttakeout_box: \"\\ud83e\\udd61\",\n\t\ttanabata_tree: \"\\ud83c\\udf8b\",\n\t\ttangerine: \"\\ud83c\\udf4a\",\n\t\ttanzania: \"\\ud83c\\uddf9\\ud83c\\uddff\",\n\t\ttaurus: \"\\u2649\",\n\t\ttaxi: \"\\ud83d\\ude95\",\n\t\ttea: \"\\ud83c\\udf75\",\n\t\tteacher: \"\\ud83e\\uddd1\\u200d\\ud83c\\udfeb\",\n\t\ttechnologist: \"\\ud83e\\uddd1\\u200d\\ud83d\\udcbb\",\n\t\tteddy_bear: \"\\ud83e\\uddf8\",\n\t\ttelephone: \"\\u260e\\ufe0f\",\n\t\ttelephone_receiver: \"\\ud83d\\udcde\",\n\t\ttelescope: \"\\ud83d\\udd2d\",\n\t\ttennis: \"\\ud83c\\udfbe\",\n\t\ttent: \"\\u26fa\",\n\t\ttest_tube: \"\\ud83e\\uddea\",\n\t\tthailand: \"\\ud83c\\uddf9\\ud83c\\udded\",\n\t\tthermometer: \"\\ud83c\\udf21\\ufe0f\",\n\t\tthinking: \"\\ud83e\\udd14\",\n\t\tthought_balloon: \"\\ud83d\\udcad\",\n\t\tthread: \"\\ud83e\\uddf5\",\n\t\tthree: \"3\\ufe0f\\u20e3\",\n\t\tthumbsdown: \"\\ud83d\\udc4e\",\n\t\tthumbsup: \"\\ud83d\\udc4d\",\n\t\tticket: \"\\ud83c\\udfab\",\n\t\ttickets: \"\\ud83c\\udf9f\\ufe0f\",\n\t\ttiger: \"\\ud83d\\udc2f\",\n\t\ttiger2: \"\\ud83d\\udc05\",\n\t\ttimer_clock: \"\\u23f2\\ufe0f\",\n\t\ttimor_leste: \"\\ud83c\\uddf9\\ud83c\\uddf1\",\n\t\ttipping_hand_man: \"\\ud83d\\udc81\\u200d\\u2642\\ufe0f\",\n\t\ttipping_hand_person: \"\\ud83d\\udc81\",\n\t\ttipping_hand_woman: \"\\ud83d\\udc81\\u200d\\u2640\\ufe0f\",\n\t\ttired_face: \"\\ud83d\\ude2b\",\n\t\ttm: \"\\u2122\\ufe0f\",\n\t\ttogo: \"\\ud83c\\uddf9\\ud83c\\uddec\",\n\t\ttoilet: \"\\ud83d\\udebd\",\n\t\ttokelau: \"\\ud83c\\uddf9\\ud83c\\uddf0\",\n\t\ttokyo_tower: \"\\ud83d\\uddfc\",\n\t\ttomato: \"\\ud83c\\udf45\",\n\t\ttonga: \"\\ud83c\\uddf9\\ud83c\\uddf4\",\n\t\ttongue: \"\\ud83d\\udc45\",\n\t\ttoolbox: \"\\ud83e\\uddf0\",\n\t\ttooth: \"\\ud83e\\uddb7\",\n\t\ttop: \"\\ud83d\\udd1d\",\n\t\ttophat: \"\\ud83c\\udfa9\",\n\t\ttornado: \"\\ud83c\\udf2a\\ufe0f\",\n\t\ttr: \"\\ud83c\\uddf9\\ud83c\\uddf7\",\n\t\ttrackball: \"\\ud83d\\uddb2\\ufe0f\",\n\t\ttractor: \"\\ud83d\\ude9c\",\n\t\ttraffic_light: \"\\ud83d\\udea5\",\n\t\ttrain: \"\\ud83d\\ude8b\",\n\t\ttrain2: \"\\ud83d\\ude86\",\n\t\ttram: \"\\ud83d\\ude8a\",\n\t\ttriangular_flag_on_post: \"\\ud83d\\udea9\",\n\t\ttriangular_ruler: \"\\ud83d\\udcd0\",\n\t\ttrident: \"\\ud83d\\udd31\",\n\t\ttrinidad_tobago: \"\\ud83c\\uddf9\\ud83c\\uddf9\",\n\t\ttristan_da_cunha: \"\\ud83c\\uddf9\\ud83c\\udde6\",\n\t\ttriumph: \"\\ud83d\\ude24\",\n\t\ttrolleybus: \"\\ud83d\\ude8e\",\n\t\ttrophy: \"\\ud83c\\udfc6\",\n\t\ttropical_drink: \"\\ud83c\\udf79\",\n\t\ttropical_fish: \"\\ud83d\\udc20\",\n\t\ttruck: \"\\ud83d\\ude9a\",\n\t\ttrumpet: \"\\ud83c\\udfba\",\n\t\ttshirt: \"\\ud83d\\udc55\",\n\t\ttulip: \"\\ud83c\\udf37\",\n\t\ttumbler_glass: \"\\ud83e\\udd43\",\n\t\ttunisia: \"\\ud83c\\uddf9\\ud83c\\uddf3\",\n\t\tturkey: \"\\ud83e\\udd83\",\n\t\tturkmenistan: \"\\ud83c\\uddf9\\ud83c\\uddf2\",\n\t\tturks_caicos_islands: \"\\ud83c\\uddf9\\ud83c\\udde8\",\n\t\tturtle: \"\\ud83d\\udc22\",\n\t\ttuvalu: \"\\ud83c\\uddf9\\ud83c\\uddfb\",\n\t\ttv: \"\\ud83d\\udcfa\",\n\t\ttwisted_rightwards_arrows: \"\\ud83d\\udd00\",\n\t\ttwo: \"2\\ufe0f\\u20e3\",\n\t\ttwo_hearts: \"\\ud83d\\udc95\",\n\t\ttwo_men_holding_hands: \"\\ud83d\\udc6c\",\n\t\ttwo_women_holding_hands: \"\\ud83d\\udc6d\",\n\t\tu5272: \"\\ud83c\\ude39\",\n\t\tu5408: \"\\ud83c\\ude34\",\n\t\tu55b6: \"\\ud83c\\ude3a\",\n\t\tu6307: \"\\ud83c\\ude2f\",\n\t\tu6708: \"\\ud83c\\ude37\\ufe0f\",\n\t\tu6709: \"\\ud83c\\ude36\",\n\t\tu6e80: \"\\ud83c\\ude35\",\n\t\tu7121: \"\\ud83c\\ude1a\",\n\t\tu7533: \"\\ud83c\\ude38\",\n\t\tu7981: \"\\ud83c\\ude32\",\n\t\tu7a7a: \"\\ud83c\\ude33\",\n\t\tuganda: \"\\ud83c\\uddfa\\ud83c\\uddec\",\n\t\tuk: \"\\ud83c\\uddec\\ud83c\\udde7\",\n\t\tukraine: \"\\ud83c\\uddfa\\ud83c\\udde6\",\n\t\tumbrella: \"\\u2614\",\n\t\tunamused: \"\\ud83d\\ude12\",\n\t\tunderage: \"\\ud83d\\udd1e\",\n\t\tunicorn: \"\\ud83e\\udd84\",\n\t\tunited_arab_emirates: \"\\ud83c\\udde6\\ud83c\\uddea\",\n\t\tunited_nations: \"\\ud83c\\uddfa\\ud83c\\uddf3\",\n\t\tunlock: \"\\ud83d\\udd13\",\n\t\tup: \"\\ud83c\\udd99\",\n\t\tupside_down_face: \"\\ud83d\\ude43\",\n\t\turuguay: \"\\ud83c\\uddfa\\ud83c\\uddfe\",\n\t\tus: \"\\ud83c\\uddfa\\ud83c\\uddf8\",\n\t\tus_outlying_islands: \"\\ud83c\\uddfa\\ud83c\\uddf2\",\n\t\tus_virgin_islands: \"\\ud83c\\uddfb\\ud83c\\uddee\",\n\t\tuzbekistan: \"\\ud83c\\uddfa\\ud83c\\uddff\",\n\t\tv: \"\\u270c\\ufe0f\",\n\t\tvampire: \"\\ud83e\\udddb\",\n\t\tvampire_man: \"\\ud83e\\udddb\\u200d\\u2642\\ufe0f\",\n\t\tvampire_woman: \"\\ud83e\\udddb\\u200d\\u2640\\ufe0f\",\n\t\tvanuatu: \"\\ud83c\\uddfb\\ud83c\\uddfa\",\n\t\tvatican_city: \"\\ud83c\\uddfb\\ud83c\\udde6\",\n\t\tvenezuela: \"\\ud83c\\uddfb\\ud83c\\uddea\",\n\t\tvertical_traffic_light: \"\\ud83d\\udea6\",\n\t\tvhs: \"\\ud83d\\udcfc\",\n\t\tvibration_mode: \"\\ud83d\\udcf3\",\n\t\tvideo_camera: \"\\ud83d\\udcf9\",\n\t\tvideo_game: \"\\ud83c\\udfae\",\n\t\tvietnam: \"\\ud83c\\uddfb\\ud83c\\uddf3\",\n\t\tviolin: \"\\ud83c\\udfbb\",\n\t\tvirgo: \"\\u264d\",\n\t\tvolcano: \"\\ud83c\\udf0b\",\n\t\tvolleyball: \"\\ud83c\\udfd0\",\n\t\tvomiting_face: \"\\ud83e\\udd2e\",\n\t\tvs: \"\\ud83c\\udd9a\",\n\t\tvulcan_salute: \"\\ud83d\\udd96\",\n\t\twaffle: \"\\ud83e\\uddc7\",\n\t\twales:\n\t\t\t\"\\ud83c\\udff4\\udb40\\udc67\\udb40\\udc62\\udb40\\udc77\\udb40\\udc6c\\udb40\\udc73\\udb40\\udc7f\",\n\t\twalking: \"\\ud83d\\udeb6\",\n\t\twalking_man: \"\\ud83d\\udeb6\\u200d\\u2642\\ufe0f\",\n\t\twalking_woman: \"\\ud83d\\udeb6\\u200d\\u2640\\ufe0f\",\n\t\twallis_futuna: \"\\ud83c\\uddfc\\ud83c\\uddeb\",\n\t\twaning_crescent_moon: \"\\ud83c\\udf18\",\n\t\twaning_gibbous_moon: \"\\ud83c\\udf16\",\n\t\twarning: \"\\u26a0\\ufe0f\",\n\t\twastebasket: \"\\ud83d\\uddd1\\ufe0f\",\n\t\twatch: \"\\u231a\",\n\t\twater_buffalo: \"\\ud83d\\udc03\",\n\t\twater_polo: \"\\ud83e\\udd3d\",\n\t\twatermelon: \"\\ud83c\\udf49\",\n\t\twave: \"\\ud83d\\udc4b\",\n\t\twavy_dash: \"\\u3030\\ufe0f\",\n\t\twaxing_crescent_moon: \"\\ud83c\\udf12\",\n\t\twaxing_gibbous_moon: \"\\ud83c\\udf14\",\n\t\twc: \"\\ud83d\\udebe\",\n\t\tweary: \"\\ud83d\\ude29\",\n\t\twedding: \"\\ud83d\\udc92\",\n\t\tweight_lifting: \"\\ud83c\\udfcb\\ufe0f\",\n\t\tweight_lifting_man: \"\\ud83c\\udfcb\\ufe0f\\u200d\\u2642\\ufe0f\",\n\t\tweight_lifting_woman: \"\\ud83c\\udfcb\\ufe0f\\u200d\\u2640\\ufe0f\",\n\t\twestern_sahara: \"\\ud83c\\uddea\\ud83c\\udded\",\n\t\twhale: \"\\ud83d\\udc33\",\n\t\twhale2: \"\\ud83d\\udc0b\",\n\t\twheel_of_dharma: \"\\u2638\\ufe0f\",\n\t\twheelchair: \"\\u267f\",\n\t\twhite_check_mark: \"\\u2705\",\n\t\twhite_circle: \"\\u26aa\",\n\t\twhite_flag: \"\\ud83c\\udff3\\ufe0f\",\n\t\twhite_flower: \"\\ud83d\\udcae\",\n\t\twhite_haired_man: \"\\ud83d\\udc68\\u200d\\ud83e\\uddb3\",\n\t\twhite_haired_woman: \"\\ud83d\\udc69\\u200d\\ud83e\\uddb3\",\n\t\twhite_heart: \"\\ud83e\\udd0d\",\n\t\twhite_large_square: \"\\u2b1c\",\n\t\twhite_medium_small_square: \"\\u25fd\",\n\t\twhite_medium_square: \"\\u25fb\\ufe0f\",\n\t\twhite_small_square: \"\\u25ab\\ufe0f\",\n\t\twhite_square_button: \"\\ud83d\\udd33\",\n\t\twilted_flower: \"\\ud83e\\udd40\",\n\t\twind_chime: \"\\ud83c\\udf90\",\n\t\twind_face: \"\\ud83c\\udf2c\\ufe0f\",\n\t\twine_glass: \"\\ud83c\\udf77\",\n\t\twink: \"\\ud83d\\ude09\",\n\t\twolf: \"\\ud83d\\udc3a\",\n\t\twoman: \"\\ud83d\\udc69\",\n\t\twoman_artist: \"\\ud83d\\udc69\\u200d\\ud83c\\udfa8\",\n\t\twoman_astronaut: \"\\ud83d\\udc69\\u200d\\ud83d\\ude80\",\n\t\twoman_cartwheeling: \"\\ud83e\\udd38\\u200d\\u2640\\ufe0f\",\n\t\twoman_cook: \"\\ud83d\\udc69\\u200d\\ud83c\\udf73\",\n\t\twoman_dancing: \"\\ud83d\\udc83\",\n\t\twoman_facepalming: \"\\ud83e\\udd26\\u200d\\u2640\\ufe0f\",\n\t\twoman_factory_worker: \"\\ud83d\\udc69\\u200d\\ud83c\\udfed\",\n\t\twoman_farmer: \"\\ud83d\\udc69\\u200d\\ud83c\\udf3e\",\n\t\twoman_firefighter: \"\\ud83d\\udc69\\u200d\\ud83d\\ude92\",\n\t\twoman_health_worker: \"\\ud83d\\udc69\\u200d\\u2695\\ufe0f\",\n\t\twoman_in_manual_wheelchair: \"\\ud83d\\udc69\\u200d\\ud83e\\uddbd\",\n\t\twoman_in_motorized_wheelchair: \"\\ud83d\\udc69\\u200d\\ud83e\\uddbc\",\n\t\twoman_judge: \"\\ud83d\\udc69\\u200d\\u2696\\ufe0f\",\n\t\twoman_juggling: \"\\ud83e\\udd39\\u200d\\u2640\\ufe0f\",\n\t\twoman_mechanic: \"\\ud83d\\udc69\\u200d\\ud83d\\udd27\",\n\t\twoman_office_worker: \"\\ud83d\\udc69\\u200d\\ud83d\\udcbc\",\n\t\twoman_pilot: \"\\ud83d\\udc69\\u200d\\u2708\\ufe0f\",\n\t\twoman_playing_handball: \"\\ud83e\\udd3e\\u200d\\u2640\\ufe0f\",\n\t\twoman_playing_water_polo: \"\\ud83e\\udd3d\\u200d\\u2640\\ufe0f\",\n\t\twoman_scientist: \"\\ud83d\\udc69\\u200d\\ud83d\\udd2c\",\n\t\twoman_shrugging: \"\\ud83e\\udd37\\u200d\\u2640\\ufe0f\",\n\t\twoman_singer: \"\\ud83d\\udc69\\u200d\\ud83c\\udfa4\",\n\t\twoman_student: \"\\ud83d\\udc69\\u200d\\ud83c\\udf93\",\n\t\twoman_teacher: \"\\ud83d\\udc69\\u200d\\ud83c\\udfeb\",\n\t\twoman_technologist: \"\\ud83d\\udc69\\u200d\\ud83d\\udcbb\",\n\t\twoman_with_headscarf: \"\\ud83e\\uddd5\",\n\t\twoman_with_probing_cane: \"\\ud83d\\udc69\\u200d\\ud83e\\uddaf\",\n\t\twoman_with_turban: \"\\ud83d\\udc73\\u200d\\u2640\\ufe0f\",\n\t\twomans_clothes: \"\\ud83d\\udc5a\",\n\t\twomans_hat: \"\\ud83d\\udc52\",\n\t\twomen_wrestling: \"\\ud83e\\udd3c\\u200d\\u2640\\ufe0f\",\n\t\twomens: \"\\ud83d\\udeba\",\n\t\twoozy_face: \"\\ud83e\\udd74\",\n\t\tworld_map: \"\\ud83d\\uddfa\\ufe0f\",\n\t\tworried: \"\\ud83d\\ude1f\",\n\t\twrench: \"\\ud83d\\udd27\",\n\t\twrestling: \"\\ud83e\\udd3c\",\n\t\twriting_hand: \"\\u270d\\ufe0f\",\n\t\tx: \"\\u274c\",\n\t\tyarn: \"\\ud83e\\uddf6\",\n\t\tyawning_face: \"\\ud83e\\udd71\",\n\t\tyellow_circle: \"\\ud83d\\udfe1\",\n\t\tyellow_heart: \"\\ud83d\\udc9b\",\n\t\tyellow_square: \"\\ud83d\\udfe8\",\n\t\tyemen: \"\\ud83c\\uddfe\\ud83c\\uddea\",\n\t\tyen: \"\\ud83d\\udcb4\",\n\t\tyin_yang: \"\\u262f\\ufe0f\",\n\t\tyo_yo: \"\\ud83e\\ude80\",\n\t\tyum: \"\\ud83d\\ude0b\",\n\t\tzambia: \"\\ud83c\\uddff\\ud83c\\uddf2\",\n\t\tzany_face: \"\\ud83e\\udd2a\",\n\t\tzap: \"\\u26a1\",\n\t\tzebra: \"\\ud83e\\udd93\",\n\t\tzero: \"0\\ufe0f\\u20e3\",\n\t\tzimbabwe: \"\\ud83c\\uddff\\ud83c\\uddfc\",\n\t\tzipper_mouth_face: \"\\ud83e\\udd10\",\n\t\tzombie: \"\\ud83e\\udddf\",\n\t\tzombie_man: \"\\ud83e\\udddf\\u200d\\u2642\\ufe0f\",\n\t\tzombie_woman: \"\\ud83e\\udddf\\u200d\\u2640\\ufe0f\",\n\t\tzzz: \"\\ud83d\\udca4\",\n\n\t\t/* special emojis :P */\n\t\toctocat:\n\t\t\t'<img width=\"20\" height=\"20\" align=\"absmiddle\" src=\"https://assets-cdn.github.com/images/icons/emoji/octocat.png\">',\n\t\tshowdown:\n\t\t\t'<img width=\"20\" height=\"20\" align=\"absmiddle\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAMAAACdt4HsAAAAS1BMVEX///8jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS0jJS3b1q3b1q3b1q3b1q3b1q3b1q3b1q3b1q0565CIAAAAGXRSTlMAQHCAYCCw/+DQwPCQUBAwoHCAEP+wwFBgS2fvBgAAAUZJREFUeAHs1cGy7BAUheFFsEDw/k97VTq3T6ge2EmdM+pvrP6Iwd74XV9Kb52xuMU4/uc1YNgZLFOeV8FGdhGrNk5SEgUyPxAEdj4LlMRDyhVAMVEa2M7TBSeVZAFPdqHgzSZJwPKgcLFLAooHDJo4EDCw4gAtBoJA5UFj4Ng5LOGLwVXZuoIlji/jeQHFk7+baHxrCjeUwB9+s88KndvlhcyBN5BSkYNQIVVb4pV+Npm7hhuKDs/uMP5KxT3WzSNNLIuuoDpMmuAVMruMSeDyQBi24DTr43LAY7ILA1QYaWkgfHzFthYYzg67SQsCbB8GhJUEGCtO9n0rSaCLxgJQjS/JSgMTg2eBDEHAJ+H350AsjYNYscrErgI2e/l+mdR967TCX/v6N0EhPECYCP0i+IAoYQOE8BogNhQMEMdrgAQWHaMAAGi5I5euoY9NAAAAAElFTkSuQmCC\">',\n\t};\n\n\t/**\n\t * These are all the transformations that form block-level\n\t * tags like paragraphs, headers, and list items.\n\t */\n\tshowdown.subParser(\"makehtml.blockGamut\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.blockGamut.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// we parse blockquotes first so that we can have headings and hrs\n\t\t// inside blockquotes\n\t\ttext = showdown.subParser(\"makehtml.blockQuotes\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.headers\")(text, options, globals);\n\n\t\t// Do Horizontal Rules:\n\t\ttext = showdown.subParser(\"makehtml.horizontalRule\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\n\t\ttext = showdown.subParser(\"makehtml.lists\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.codeBlocks\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.tables\")(text, options, globals);\n\n\t\t// We already ran _HashHTMLBlocks() before, in Markdown(), but that\n\t\t// was to escape raw HTML in the original Markdown source. This time,\n\t\t// we're escaping the markup we've just created, so that we don't wrap\n\t\t// <p> tags around block-level tags.\n\t\ttext = showdown.subParser(\"makehtml.hashHTMLBlocks\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\t\ttext = showdown.subParser(\"makehtml.paragraphs\")(text, options, globals);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.blockGamut.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\treturn text;\n\t});\n\n\tshowdown.subParser(\"makehtml.blockQuotes\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.blockQuotes.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// add a couple extra lines after the text and endtext mark\n\t\ttext = text + \"\\n\\n\";\n\n\t\tvar rgx = /(^ {0,3}>[ \\t]?.+\\n(.+\\n)*\\n*)+/gm;\n\n\t\tif (options.splitAdjacentBlockquotes) {\n\t\t\trgx = /^ {0,3}>[\\s\\S]*?(?:\\n\\n)/gm;\n\t\t}\n\n\t\ttext = text.replace(rgx, function (bq) {\n\t\t\t// attacklab: hack around Konqueror 3.5.4 bug:\n\t\t\t// \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\t\t\tbq = bq.replace(/^[ \\t]*>[ \\t]?/gm, \"\"); // trim one level of quoting\n\n\t\t\t// attacklab: clean up hack\n\t\t\tbq = bq.replace(/¨0/g, \"\");\n\n\t\t\tbq = bq.replace(/^[ \\t]+$/gm, \"\"); // trim whitespace-only lines\n\t\t\tbq = showdown.subParser(\"makehtml.githubCodeBlocks\")(\n\t\t\t\tbq,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\tbq = showdown.subParser(\"makehtml.blockGamut\")(bq, options, globals); // recurse\n\n\t\t\tbq = bq.replace(/(^|\\n)/g, \"$1  \");\n\t\t\t// These leading spaces screw with <pre> content, so we need to fix that:\n\t\t\tbq = bq.replace(/(\\s*<pre>[^\\r]+?<\\/pre>)/gm, function (wholeMatch, m1) {\n\t\t\t\tvar pre = m1;\n\t\t\t\t// attacklab: hack around Konqueror 3.5.4 bug:\n\t\t\t\tpre = pre.replace(/^  /gm, \"¨0\");\n\t\t\t\tpre = pre.replace(/¨0/g, \"\");\n\t\t\t\treturn pre;\n\t\t\t});\n\n\t\t\treturn showdown.subParser(\"makehtml.hashBlock\")(\n\t\t\t\t\"<blockquote>\\n\" + bq + \"\\n</blockquote>\",\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t});\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.blockQuotes.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Process Markdown `<pre><code>` blocks.\n\t */\n\tshowdown.subParser(\"makehtml.codeBlocks\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.codeBlocks.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n\t\ttext += \"¨0\";\n\n\t\tvar pattern =\n\t\t\t/(?:\\n\\n|^)((?:(?:[ ]{4}|\\t).*\\n+)+)(\\n*[ ]{0,3}[^ \\t\\n]|(?=¨0))/g;\n\t\ttext = text.replace(pattern, function (wholeMatch, m1, m2) {\n\t\t\tvar codeblock = m1,\n\t\t\t\tnextChar = m2,\n\t\t\t\tend = \"\\n\";\n\n\t\t\tcodeblock = showdown.subParser(\"makehtml.outdent\")(\n\t\t\t\tcodeblock,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\tcodeblock = showdown.subParser(\"makehtml.encodeCode\")(\n\t\t\t\tcodeblock,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\tcodeblock = showdown.subParser(\"makehtml.detab\")(\n\t\t\t\tcodeblock,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\tcodeblock = codeblock.replace(/^\\n+/g, \"\"); // trim leading newlines\n\t\t\tcodeblock = codeblock.replace(/\\n+$/g, \"\"); // trim trailing newlines\n\n\t\t\tif (options.omitExtraWLInCodeBlocks) {\n\t\t\t\tend = \"\";\n\t\t\t}\n\n\t\t\tcodeblock = \"<pre><code>\" + codeblock + end + \"</code></pre>\";\n\n\t\t\treturn (\n\t\t\t\tshowdown.subParser(\"makehtml.hashBlock\")(codeblock, options, globals) +\n\t\t\t\tnextChar\n\t\t\t);\n\t\t});\n\n\t\t// strip sentinel\n\t\ttext = text.replace(/¨0/, \"\");\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.codeBlocks.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t *\n\t *   *  Backtick quotes are used for <code></code> spans.\n\t *\n\t *   *  You can use multiple backticks as the delimiters if you want to\n\t *     include literal backticks in the code span. So, this input:\n\t *\n\t *         Just type ``foo `bar` baz`` at the prompt.\n\t *\n\t *       Will translate to:\n\t *\n\t *         <p>Just type <code>foo `bar` baz</code> at the prompt.</p>\n\t *\n\t *    There's no arbitrary limit to the number of backticks you\n\t *    can use as delimters. If you need three consecutive backticks\n\t *    in your code, use four for delimiters, etc.\n\t *\n\t *  *  You can use spaces to get literal backticks at the edges:\n\t *\n\t *         ... type `` `bar` `` ...\n\t *\n\t *       Turns to:\n\t *\n\t *         ... type <code>`bar`</code> ...\n\t */\n\tshowdown.subParser(\"makehtml.codeSpans\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.codeSpans.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tif (typeof text === \"undefined\") {\n\t\t\ttext = \"\";\n\t\t}\n\t\ttext = text.replace(\n\t\t\t/(^|[^\\\\])(`+)([^\\r]*?[^`])\\2(?!`)/gm,\n\t\t\tfunction (wholeMatch, m1, m2, m3) {\n\t\t\t\tvar c = m3;\n\t\t\t\tc = c.replace(/^([ \\t]*)/g, \"\"); // leading whitespace\n\t\t\t\tc = c.replace(/[ \\t]*$/g, \"\"); // trailing whitespace\n\t\t\t\tc = showdown.subParser(\"makehtml.encodeCode\")(c, options, globals);\n\t\t\t\tc = m1 + \"<code>\" + c + \"</code>\";\n\t\t\t\tc = showdown.subParser(\"makehtml.hashHTMLSpans\")(c, options, globals);\n\t\t\t\treturn c;\n\t\t\t},\n\t\t);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.codeSpans.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Create a full HTML document from the processed markdown\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.completeHTMLDocument\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\tif (!options.completeHTMLDocument) {\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.completeHTMLDocument.before\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\n\t\t\tvar doctype = \"html\",\n\t\t\t\tdoctypeParsed = \"<!DOCTYPE HTML>\\n\",\n\t\t\t\ttitle = \"\",\n\t\t\t\tcharset = '<meta charset=\"utf-8\">\\n',\n\t\t\t\tlang = \"\",\n\t\t\t\tmetadata = \"\";\n\n\t\t\tif (typeof globals.metadata.parsed.doctype !== \"undefined\") {\n\t\t\t\tdoctypeParsed = \"<!DOCTYPE \" + globals.metadata.parsed.doctype + \">\\n\";\n\t\t\t\tdoctype = globals.metadata.parsed.doctype.toString().toLowerCase();\n\t\t\t\tif (doctype === \"html\" || doctype === \"html5\") {\n\t\t\t\t\tcharset = '<meta charset=\"utf-8\">';\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var meta in globals.metadata.parsed) {\n\t\t\t\tif (globals.metadata.parsed.hasOwnProperty(meta)) {\n\t\t\t\t\tswitch (meta.toLowerCase()) {\n\t\t\t\t\t\tcase \"doctype\":\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"title\":\n\t\t\t\t\t\t\ttitle = \"<title>\" + globals.metadata.parsed.title + \"</title>\\n\";\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"charset\":\n\t\t\t\t\t\t\tif (doctype === \"html\" || doctype === \"html5\") {\n\t\t\t\t\t\t\t\tcharset =\n\t\t\t\t\t\t\t\t\t'<meta charset=\"' + globals.metadata.parsed.charset + '\">\\n';\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tcharset =\n\t\t\t\t\t\t\t\t\t'<meta name=\"charset\" content=\"' +\n\t\t\t\t\t\t\t\t\tglobals.metadata.parsed.charset +\n\t\t\t\t\t\t\t\t\t'\">\\n';\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase \"language\":\n\t\t\t\t\t\tcase \"lang\":\n\t\t\t\t\t\t\tlang = ' lang=\"' + globals.metadata.parsed[meta] + '\"';\n\t\t\t\t\t\t\tmetadata +=\n\t\t\t\t\t\t\t\t'<meta name=\"' +\n\t\t\t\t\t\t\t\tmeta +\n\t\t\t\t\t\t\t\t'\" content=\"' +\n\t\t\t\t\t\t\t\tglobals.metadata.parsed[meta] +\n\t\t\t\t\t\t\t\t'\">\\n';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tmetadata +=\n\t\t\t\t\t\t\t\t'<meta name=\"' +\n\t\t\t\t\t\t\t\tmeta +\n\t\t\t\t\t\t\t\t'\" content=\"' +\n\t\t\t\t\t\t\t\tglobals.metadata.parsed[meta] +\n\t\t\t\t\t\t\t\t'\">\\n';\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttext =\n\t\t\t\tdoctypeParsed +\n\t\t\t\t\"<html\" +\n\t\t\t\tlang +\n\t\t\t\t\">\\n<head>\\n\" +\n\t\t\t\ttitle +\n\t\t\t\tcharset +\n\t\t\t\tmetadata +\n\t\t\t\t\"</head>\\n<body>\\n\" +\n\t\t\t\ttext.trim() +\n\t\t\t\t\"\\n</body>\\n</html>\";\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.completeHTMLDocument.after\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Convert all tabs to spaces\n\t */\n\tshowdown.subParser(\"makehtml.detab\", function (text, options, globals) {\n\t\t\"use strict\";\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.detab.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// expand first n-1 tabs\n\t\ttext = text.replace(/\\t(?=\\t)/g, \"    \"); // g_tab_width\n\n\t\t// replace the nth with two sentinels\n\t\ttext = text.replace(/\\t/g, \"¨A¨B\");\n\n\t\t// use the sentinel to anchor our regex so it doesn't explode\n\t\ttext = text.replace(/¨B(.+?)¨A/g, function (wholeMatch, m1) {\n\t\t\tvar leadingText = m1,\n\t\t\t\tnumSpaces = 4 - (leadingText.length % 4); // g_tab_width\n\n\t\t\t// there *must* be a better way to do this:\n\t\t\tfor (var i = 0; i < numSpaces; i++) {\n\t\t\t\tleadingText += \" \";\n\t\t\t}\n\n\t\t\treturn leadingText;\n\t\t});\n\n\t\t// clean up sentinels\n\t\ttext = text.replace(/¨A/g, \"    \"); // g_tab_width\n\t\ttext = text.replace(/¨B/g, \"\");\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.detab.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\tshowdown.subParser(\"makehtml.ellipsis\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.ellipsis.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\ttext = text.replace(/\\.\\.\\./g, \"…\");\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.ellipsis.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\treturn text;\n\t});\n\n\t/**\n\t * Turn emoji codes into emojis\n\t *\n\t * List of supported emojis: https://github.com/showdownjs/showdown/wiki/Emojis\n\t */\n\tshowdown.subParser(\"makehtml.emoji\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\tif (!options.emoji) {\n\t\t\treturn text;\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.emoji.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tvar emojiRgx = /:([\\S]+?):/g;\n\n\t\ttext = text.replace(emojiRgx, function (wm, emojiCode) {\n\t\t\tif (showdown.helper.emojis.hasOwnProperty(emojiCode)) {\n\t\t\t\treturn showdown.helper.emojis[emojiCode];\n\t\t\t}\n\t\t\treturn wm;\n\t\t});\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.emoji.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\treturn text;\n\t});\n\n\t/**\n\t * Smart processing for ampersands and angle brackets that need to be encoded.\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.encodeAmpsAndAngles\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.encodeAmpsAndAngles.before\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\n\t\t\t// Ampersand-encoding based entirely on Nat Irons's Amputator MT plugin:\n\t\t\t// http://bumppo.net/projects/amputator/\n\t\t\ttext = text.replace(/&(?!#?[xX]?(?:[0-9a-fA-F]+|\\w+);)/g, \"&amp;\");\n\n\t\t\t// Encode naked <'s\n\t\t\ttext = text.replace(/<(?![a-z\\/?$!])/gi, \"&lt;\");\n\n\t\t\t// Encode <\n\t\t\ttext = text.replace(/</g, \"&lt;\");\n\n\t\t\t// Encode >\n\t\t\ttext = text.replace(/>/g, \"&gt;\");\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.encodeAmpsAndAngles.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Returns the string, with after processing the following backslash escape sequences.\n\t *\n\t * attacklab: The polite way to do this is with the new escapeCharacters() function:\n\t *\n\t *    text = escapeCharacters(text,\"\\\\\",true);\n\t *    text = escapeCharacters(text,\"`*_{}[]()>#+-.!\",true);\n\t *\n\t * ...but we're sidestepping its use of the (slow) RegExp constructor\n\t * as an optimization for Firefox.  This function gets called a LOT.\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.encodeBackslashEscapes\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.encodeBackslashEscapes.before\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\n\t\t\ttext = text.replace(/\\\\(\\\\)/g, showdown.helper.escapeCharactersCallback);\n\t\t\ttext = text.replace(\n\t\t\t\t/\\\\([`*_{}\\[\\]()>#+.!~=|:-])/g,\n\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.encodeBackslashEscapes.after\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Encode/escape certain characters inside Markdown code runs.\n\t * The point is that in code, these characters are literals,\n\t * and lose their special Markdown meanings.\n\t */\n\tshowdown.subParser(\"makehtml.encodeCode\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.encodeCode.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// Encode all ampersands; HTML entities are not\n\t\t// entities within a Markdown code span.\n\t\ttext = text\n\t\t\t.replace(/&/g, \"&amp;\")\n\t\t\t// Do the angle bracket song and dance:\n\t\t\t.replace(/</g, \"&lt;\")\n\t\t\t.replace(/>/g, \"&gt;\")\n\t\t\t// Now, escape characters that are magic in Markdown:\n\t\t\t.replace(/([*_{}\\[\\]\\\\=~-])/g, showdown.helper.escapeCharactersCallback);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.encodeCode.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Within tags -- meaning between < and > -- encode [\\ ` * _ ~ =] so they\n\t * don't conflict with their use in Markdown for code, italics and strong.\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.escapeSpecialCharsWithinTagAttributes\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.escapeSpecialCharsWithinTagAttributes.before\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\n\t\t\t// Build a regex to find HTML tags.\n\t\t\tvar tags = /<\\/?[a-z\\d_:-]+(?:[\\s]+[\\s\\S]+?)?>/gi,\n\t\t\t\tcomments = /<!(--(?:(?:[^>-]|-[^>])(?:[^-]|-[^-])*)--)>/gi;\n\n\t\t\ttext = text.replace(tags, function (wholeMatch) {\n\t\t\t\treturn wholeMatch\n\t\t\t\t\t.replace(/(.)<\\/?code>(?=.)/g, \"$1`\")\n\t\t\t\t\t.replace(/([\\\\`*_~=|])/g, showdown.helper.escapeCharactersCallback);\n\t\t\t});\n\n\t\t\ttext = text.replace(comments, function (wholeMatch) {\n\t\t\t\treturn wholeMatch.replace(\n\t\t\t\t\t/([\\\\`*_~=|])/g,\n\t\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t\t);\n\t\t\t});\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.escapeSpecialCharsWithinTagAttributes.after\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Handle github codeblocks prior to running HashHTML so that\n\t * HTML contained within the codeblock gets escaped properly\n\t * Example:\n\t * ```ruby\n\t *     def hello_world(x)\n\t *       puts \"Hello, #{x}\"\n\t *     end\n\t * ```\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.githubCodeBlocks\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\t// early exit if option is not enabled\n\t\t\tif (!options.ghCodeBlocks) {\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.githubCodeBlocks.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\ttext += \"¨0\";\n\n\t\t\ttext = text.replace(\n\t\t\t\t/(?:^|\\n)(?: {0,3})(```+|~~~+)(?: *)([^\\s`~]*)\\n([\\s\\S]*?)\\n(?: {0,3})\\1/g,\n\t\t\t\tfunction (wholeMatch, delim, language, codeblock) {\n\t\t\t\t\tvar end = options.omitExtraWLInCodeBlocks ? \"\" : \"\\n\";\n\n\t\t\t\t\t// First parse the github code block\n\t\t\t\t\tcodeblock = showdown.subParser(\"makehtml.encodeCode\")(\n\t\t\t\t\t\tcodeblock,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\tcodeblock = showdown.subParser(\"makehtml.detab\")(\n\t\t\t\t\t\tcodeblock,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\tcodeblock = codeblock.replace(/^\\n+/g, \"\"); // trim leading newlines\n\t\t\t\t\tcodeblock = codeblock.replace(/\\n+$/g, \"\"); // trim trailing whitespace\n\n\t\t\t\t\tcodeblock =\n\t\t\t\t\t\t\"<pre><code\" +\n\t\t\t\t\t\t(language\n\t\t\t\t\t\t\t? ' class=\"' + language + \" language-\" + language + '\"'\n\t\t\t\t\t\t\t: \"\") +\n\t\t\t\t\t\t\">\" +\n\t\t\t\t\t\tcodeblock +\n\t\t\t\t\t\tend +\n\t\t\t\t\t\t\"</code></pre>\";\n\n\t\t\t\t\tcodeblock = showdown.subParser(\"makehtml.hashBlock\")(\n\t\t\t\t\t\tcodeblock,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\n\t\t\t\t\t// Since GHCodeblocks can be false positives, we need to\n\t\t\t\t\t// store the primitive text and the parsed text in a global var,\n\t\t\t\t\t// and then return a token\n\t\t\t\t\treturn (\n\t\t\t\t\t\t\"\\n\\n¨G\" +\n\t\t\t\t\t\t(globals.ghCodeBlocks.push({\n\t\t\t\t\t\t\ttext: wholeMatch,\n\t\t\t\t\t\t\tcodeblock: codeblock,\n\t\t\t\t\t\t}) -\n\t\t\t\t\t\t\t1) +\n\t\t\t\t\t\t\"G\\n\\n\"\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t);\n\n\t\t\t// attacklab: strip sentinel\n\t\t\ttext = text.replace(/¨0/, \"\");\n\n\t\t\treturn globals.converter\n\t\t\t\t._dispatch(\"makehtml.githubCodeBlocks.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makehtml.hashBlock\", function (text, options, globals) {\n\t\t\"use strict\";\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.hashBlock.before\", text, options, globals)\n\t\t\t.getText();\n\t\ttext = text.replace(/(^\\n+|\\n+$)/g, \"\");\n\t\ttext = \"\\n\\n¨K\" + (globals.gHtmlBlocks.push(text) - 1) + \"K\\n\\n\";\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.hashBlock.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Hash and escape <code> elements that should not be parsed as markdown\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.hashCodeTags\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashCodeTags.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\tvar repFunc = function (wholeMatch, match, left, right) {\n\t\t\t\tvar codeblock =\n\t\t\t\t\tleft +\n\t\t\t\t\tshowdown.subParser(\"makehtml.encodeCode\")(match, options, globals) +\n\t\t\t\t\tright;\n\t\t\t\treturn \"¨C\" + (globals.gHtmlSpans.push(codeblock) - 1) + \"C\";\n\t\t\t};\n\n\t\t\t// Hash naked <code>\n\t\t\ttext = showdown.helper.replaceRecursiveRegExp(\n\t\t\t\ttext,\n\t\t\t\trepFunc,\n\t\t\t\t\"<code\\\\b[^>]*>\",\n\t\t\t\t\"</code>\",\n\t\t\t\t\"gim\",\n\t\t\t);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashCodeTags.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makehtml.hashElement\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\treturn function (wholeMatch, m1) {\n\t\t\tvar blockText = m1;\n\n\t\t\t// Undo double lines\n\t\t\tblockText = blockText.replace(/\\n\\n/g, \"\\n\");\n\t\t\tblockText = blockText.replace(/^\\n/, \"\");\n\n\t\t\t// strip trailing blank lines\n\t\t\tblockText = blockText.replace(/\\n+$/g, \"\");\n\n\t\t\t// Replace the element text with a marker (\"¨KxK\" where x is its key)\n\t\t\tblockText =\n\t\t\t\t\"\\n\\n¨K\" + (globals.gHtmlBlocks.push(blockText) - 1) + \"K\\n\\n\";\n\n\t\t\treturn blockText;\n\t\t};\n\t});\n\n\tshowdown.subParser(\n\t\t\"makehtml.hashHTMLBlocks\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashHTMLBlocks.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\tvar blockTags = [\n\t\t\t\t\t\"pre\",\n\t\t\t\t\t\"div\",\n\t\t\t\t\t\"h1\",\n\t\t\t\t\t\"h2\",\n\t\t\t\t\t\"h3\",\n\t\t\t\t\t\"h4\",\n\t\t\t\t\t\"h5\",\n\t\t\t\t\t\"h6\",\n\t\t\t\t\t\"blockquote\",\n\t\t\t\t\t\"table\",\n\t\t\t\t\t\"dl\",\n\t\t\t\t\t\"ol\",\n\t\t\t\t\t\"ul\",\n\t\t\t\t\t\"script\",\n\t\t\t\t\t\"noscript\",\n\t\t\t\t\t\"form\",\n\t\t\t\t\t\"fieldset\",\n\t\t\t\t\t\"iframe\",\n\t\t\t\t\t\"math\",\n\t\t\t\t\t\"style\",\n\t\t\t\t\t\"section\",\n\t\t\t\t\t\"header\",\n\t\t\t\t\t\"footer\",\n\t\t\t\t\t\"nav\",\n\t\t\t\t\t\"article\",\n\t\t\t\t\t\"aside\",\n\t\t\t\t\t\"address\",\n\t\t\t\t\t\"audio\",\n\t\t\t\t\t\"canvas\",\n\t\t\t\t\t\"figure\",\n\t\t\t\t\t\"hgroup\",\n\t\t\t\t\t\"output\",\n\t\t\t\t\t\"video\",\n\t\t\t\t\t\"p\",\n\t\t\t\t],\n\t\t\t\trepFunc = function (wholeMatch, match, left, right) {\n\t\t\t\t\tvar txt = wholeMatch;\n\t\t\t\t\t// check if this html element is marked as markdown\n\t\t\t\t\t// if so, it's contents should be parsed as markdown\n\t\t\t\t\tif (left.search(/\\bmarkdown\\b/) !== -1) {\n\t\t\t\t\t\ttxt = left + globals.converter.makeHtml(match) + right;\n\t\t\t\t\t}\n\t\t\t\t\treturn \"\\n\\n¨K\" + (globals.gHtmlBlocks.push(txt) - 1) + \"K\\n\\n\";\n\t\t\t\t};\n\n\t\t\tif (options.backslashEscapesHTMLTags) {\n\t\t\t\t// encode backslash escaped HTML tags\n\t\t\t\ttext = text.replace(/\\\\<(\\/?[^>]+?)>/g, function (wm, inside) {\n\t\t\t\t\treturn \"&lt;\" + inside + \"&gt;\";\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// hash HTML Blocks\n\t\t\tfor (var i = 0; i < blockTags.length; ++i) {\n\t\t\t\tvar opTagPos,\n\t\t\t\t\trgx1 = new RegExp(\"^ {0,3}(<\" + blockTags[i] + \"\\\\b[^>]*>)\", \"im\"),\n\t\t\t\t\tpatLeft = \"<\" + blockTags[i] + \"\\\\b[^>]*>\",\n\t\t\t\t\tpatRight = \"</\" + blockTags[i] + \">\";\n\t\t\t\t// 1. Look for the first position of the first opening HTML tag in the text\n\t\t\t\twhile ((opTagPos = showdown.helper.regexIndexOf(text, rgx1)) !== -1) {\n\t\t\t\t\t// if the HTML tag is \\ escaped, we need to escape it and break\n\n\t\t\t\t\t//2. Split the text in that position\n\t\t\t\t\tvar subTexts = showdown.helper.splitAtIndex(text, opTagPos),\n\t\t\t\t\t\t//3. Match recursively\n\t\t\t\t\t\tnewSubText1 = showdown.helper.replaceRecursiveRegExp(\n\t\t\t\t\t\t\tsubTexts[1],\n\t\t\t\t\t\t\trepFunc,\n\t\t\t\t\t\t\tpatLeft,\n\t\t\t\t\t\t\tpatRight,\n\t\t\t\t\t\t\t\"im\",\n\t\t\t\t\t\t);\n\n\t\t\t\t\t// prevent an infinite loop\n\t\t\t\t\tif (newSubText1 === subTexts[1]) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\ttext = subTexts[0].concat(newSubText1);\n\t\t\t\t}\n\t\t\t}\n\t\t\t// HR SPECIAL CASE\n\t\t\ttext = text.replace(\n\t\t\t\t/(\\n {0,3}(<(hr)\\b([^<>])*?\\/?>)[ \\t]*(?=\\n{2,}))/g,\n\t\t\t\tshowdown.subParser(\"makehtml.hashElement\")(text, options, globals),\n\t\t\t);\n\n\t\t\t// Special case for standalone HTML comments\n\t\t\ttext = showdown.helper.replaceRecursiveRegExp(\n\t\t\t\ttext,\n\t\t\t\tfunction (txt) {\n\t\t\t\t\treturn \"\\n\\n¨K\" + (globals.gHtmlBlocks.push(txt) - 1) + \"K\\n\\n\";\n\t\t\t\t},\n\t\t\t\t\"^ {0,3}<!--\",\n\t\t\t\t\"-->\",\n\t\t\t\t\"gm\",\n\t\t\t);\n\n\t\t\t// PHP and ASP-style processor instructions (<?...?> and <%...%>)\n\t\t\ttext = text.replace(\n\t\t\t\t/(?:\\n\\n)( {0,3}(?:<([?%])[^\\r]*?\\2>)[ \\t]*(?=\\n{2,}))/g,\n\t\t\t\tshowdown.subParser(\"makehtml.hashElement\")(text, options, globals),\n\t\t\t);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashHTMLBlocks.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Hash span elements that should not be parsed as markdown\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.hashHTMLSpans\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashHTMLSpans.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\t// Hash Self Closing tags\n\t\t\ttext = text.replace(/<[^>]+?\\/>/gi, function (wm) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wm, globals);\n\t\t\t});\n\n\t\t\t// Hash tags without properties\n\t\t\ttext = text.replace(/<([^>]+?)>[\\s\\S]*?<\\/\\1>/g, function (wm) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wm, globals);\n\t\t\t});\n\n\t\t\t// Hash tags with properties\n\t\t\ttext = text.replace(/<([^>]+?)\\s[^>]+?>[\\s\\S]*?<\\/\\1>/g, function (wm) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wm, globals);\n\t\t\t});\n\n\t\t\t// Hash self closing tags without />\n\t\t\ttext = text.replace(/<[^>]+?>/gi, function (wm) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wm, globals);\n\t\t\t});\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashHTMLSpans.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Unhash HTML spans\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.unhashHTMLSpans\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.unhashHTMLSpans.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\tfor (var i = 0; i < globals.gHtmlSpans.length; ++i) {\n\t\t\t\tvar repText = globals.gHtmlSpans[i],\n\t\t\t\t\t// limiter to prevent infinite loop (assume 10 as limit for recurse)\n\t\t\t\t\tlimit = 0;\n\n\t\t\t\twhile (/¨C(\\d+)C/.test(repText)) {\n\t\t\t\t\tvar num = RegExp.$1;\n\t\t\t\t\trepText = repText.replace(\"¨C\" + num + \"C\", globals.gHtmlSpans[num]);\n\t\t\t\t\tif (limit === 10) {\n\t\t\t\t\t\tconsole.error(\"maximum nesting of 10 spans reached!!!\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t++limit;\n\t\t\t\t}\n\t\t\t\ttext = text.replace(\"¨C\" + i + \"C\", repText);\n\t\t\t}\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.unhashHTMLSpans.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Hash and escape <pre><code> elements that should not be parsed as markdown\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.hashPreCodeTags\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashPreCodeTags.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\tvar repFunc = function (wholeMatch, match, left, right) {\n\t\t\t\t// encode html entities\n\t\t\t\tvar codeblock =\n\t\t\t\t\tleft +\n\t\t\t\t\tshowdown.subParser(\"makehtml.encodeCode\")(match, options, globals) +\n\t\t\t\t\tright;\n\t\t\t\treturn (\n\t\t\t\t\t\"\\n\\n¨G\" +\n\t\t\t\t\t(globals.ghCodeBlocks.push({\n\t\t\t\t\t\ttext: wholeMatch,\n\t\t\t\t\t\tcodeblock: codeblock,\n\t\t\t\t\t}) -\n\t\t\t\t\t\t1) +\n\t\t\t\t\t\"G\\n\\n\"\n\t\t\t\t);\n\t\t\t};\n\n\t\t\t// Hash <pre><code>\n\t\t\ttext = showdown.helper.replaceRecursiveRegExp(\n\t\t\t\ttext,\n\t\t\t\trepFunc,\n\t\t\t\t\"^ {0,3}<pre\\\\b[^>]*>\\\\s*<code\\\\b[^>]*>\",\n\t\t\t\t\"^ {0,3}</code>\\\\s*</pre>\",\n\t\t\t\t\"gim\",\n\t\t\t);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.hashPreCodeTags.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makehtml.headers\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.headers.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tvar headerLevelStart = isNaN(parseInt(options.headerLevelStart))\n\t\t\t\t? 1\n\t\t\t\t: parseInt(options.headerLevelStart),\n\t\t\t// Set text-style headers:\n\t\t\t//\tHeader 1\n\t\t\t//\t========\n\t\t\t//\n\t\t\t//\tHeader 2\n\t\t\t//\t--------\n\t\t\t//\n\t\t\tsetextRegexH1 = options.smoothLivePreview\n\t\t\t\t? /^(.+)[ \\t]*\\n={2,}[ \\t]*\\n+/gm\n\t\t\t\t: /^(.+)[ \\t]*\\n=+[ \\t]*\\n+/gm,\n\t\t\tsetextRegexH2 = options.smoothLivePreview\n\t\t\t\t? /^(.+)[ \\t]*\\n-{2,}[ \\t]*\\n+/gm\n\t\t\t\t: /^(.+)[ \\t]*\\n-+[ \\t]*\\n+/gm;\n\n\t\ttext = text.replace(setextRegexH1, function (wholeMatch, m1) {\n\t\t\tvar spanGamut = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\t\tm1,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t),\n\t\t\t\thID = options.noHeaderId ? \"\" : ' id=\"' + headerId(m1) + '\"',\n\t\t\t\thLevel = headerLevelStart,\n\t\t\t\thashBlock =\n\t\t\t\t\t\"<h\" + hLevel + hID + \">\" + spanGamut + \"</h\" + hLevel + \">\";\n\t\t\treturn showdown.subParser(\"makehtml.hashBlock\")(\n\t\t\t\thashBlock,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t});\n\n\t\ttext = text.replace(setextRegexH2, function (matchFound, m1) {\n\t\t\tvar spanGamut = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\t\tm1,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t),\n\t\t\t\thID = options.noHeaderId ? \"\" : ' id=\"' + headerId(m1) + '\"',\n\t\t\t\thLevel = headerLevelStart + 1,\n\t\t\t\thashBlock =\n\t\t\t\t\t\"<h\" + hLevel + hID + \">\" + spanGamut + \"</h\" + hLevel + \">\";\n\t\t\treturn showdown.subParser(\"makehtml.hashBlock\")(\n\t\t\t\thashBlock,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t});\n\n\t\t// atx-style headers:\n\t\t//  # Header 1\n\t\t//  ## Header 2\n\t\t//  ## Header 2 with closing hashes ##\n\t\t//  ...\n\t\t//  ###### Header 6\n\t\t//\n\t\tvar atxStyle = options.requireSpaceBeforeHeadingText\n\t\t\t? /^(#{1,6})[ \\t]+(.+?)[ \\t]*#*\\n+/gm\n\t\t\t: /^(#{1,6})[ \\t]*(.+?)[ \\t]*#*\\n+/gm;\n\n\t\ttext = text.replace(atxStyle, function (wholeMatch, m1, m2) {\n\t\t\tvar hText = m2;\n\t\t\tif (options.customizedHeaderId) {\n\t\t\t\thText = m2.replace(/\\s?\\{([^{]+?)}\\s*$/, \"\");\n\t\t\t}\n\n\t\t\tvar span = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\t\thText,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t),\n\t\t\t\thID = options.noHeaderId ? \"\" : ' id=\"' + headerId(m2) + '\"',\n\t\t\t\thLevel = headerLevelStart - 1 + m1.length,\n\t\t\t\theader = \"<h\" + hLevel + hID + \">\" + span + \"</h\" + hLevel + \">\";\n\n\t\t\treturn showdown.subParser(\"makehtml.hashBlock\")(header, options, globals);\n\t\t});\n\n\t\tfunction headerId(m) {\n\t\t\tvar title, prefix;\n\n\t\t\t// It is separate from other options to allow combining prefix and customized\n\t\t\tif (options.customizedHeaderId) {\n\t\t\t\tvar match = m.match(/\\{([^{]+?)}\\s*$/);\n\t\t\t\tif (match && match[1]) {\n\t\t\t\t\tm = match[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\ttitle = m;\n\n\t\t\t// Prefix id to prevent causing inadvertent pre-existing style matches.\n\t\t\tif (showdown.helper.isString(options.prefixHeaderId)) {\n\t\t\t\tprefix = options.prefixHeaderId;\n\t\t\t} else if (options.prefixHeaderId === true) {\n\t\t\t\tprefix = \"section-\";\n\t\t\t} else {\n\t\t\t\tprefix = \"\";\n\t\t\t}\n\n\t\t\tif (!options.rawPrefixHeaderId) {\n\t\t\t\ttitle = prefix + title;\n\t\t\t}\n\n\t\t\tif (options.ghCompatibleHeaderId) {\n\t\t\t\ttitle = title\n\t\t\t\t\t.replace(/ /g, \"-\")\n\t\t\t\t\t// replace previously escaped chars (&, ¨ and $)\n\t\t\t\t\t.replace(/&amp;/g, \"\")\n\t\t\t\t\t.replace(/¨T/g, \"\")\n\t\t\t\t\t.replace(/¨D/g, \"\")\n\t\t\t\t\t// replace rest of the chars (&~$ are repeated as they might have been escaped)\n\t\t\t\t\t// borrowed from github's redcarpet (some they should produce similar results)\n\t\t\t\t\t.replace(/[&+$,\\/:;=?@\"#{}|^¨~\\[\\]`\\\\*)(%.!'<>]/g, \"\")\n\t\t\t\t\t.toLowerCase();\n\t\t\t} else if (options.rawHeaderId) {\n\t\t\t\ttitle = title\n\t\t\t\t\t.replace(/ /g, \"-\")\n\t\t\t\t\t// replace previously escaped chars (&, ¨ and $)\n\t\t\t\t\t.replace(/&amp;/g, \"&\")\n\t\t\t\t\t.replace(/¨T/g, \"¨\")\n\t\t\t\t\t.replace(/¨D/g, \"$\")\n\t\t\t\t\t// replace \" and '\n\t\t\t\t\t.replace(/[\"']/g, \"-\")\n\t\t\t\t\t.toLowerCase();\n\t\t\t} else {\n\t\t\t\ttitle = title.replace(/[^\\w]/g, \"\").toLowerCase();\n\t\t\t}\n\n\t\t\tif (options.rawPrefixHeaderId) {\n\t\t\t\ttitle = prefix + title;\n\t\t\t}\n\n\t\t\tif (globals.hashLinkCounts[title]) {\n\t\t\t\ttitle = title + \"-\" + globals.hashLinkCounts[title]++;\n\t\t\t} else {\n\t\t\t\tglobals.hashLinkCounts[title] = 1;\n\t\t\t}\n\t\t\treturn title;\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.headers.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Turn Markdown horizontal rule shortcuts into <hr /> tags.\n\t *\n\t * Any 3 or more unindented consecutive hyphens, asterisks or underscores with or without a space beetween them\n\t * in a single line is considered a horizontal rule\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.horizontalRule\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.horizontalRule.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\tvar key = showdown.subParser(\"makehtml.hashBlock\")(\n\t\t\t\t\"<hr />\",\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = text.replace(/^ {0,2}( ?-){3,}[ \\t]*$/gm, key);\n\t\t\ttext = text.replace(/^ {0,2}( ?\\*){3,}[ \\t]*$/gm, key);\n\t\t\ttext = text.replace(/^ {0,2}( ?_){3,}[ \\t]*$/gm, key);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.horizontalRule.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Turn Markdown image shortcuts into <img> tags.\n\t */\n\tshowdown.subParser(\"makehtml.images\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.images.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tvar inlineRegExp =\n\t\t\t\t/!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<?([\\S]+?(?:\\([\\S]*?\\)[\\S]*?)?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:([\"'])([^\"]*?)\\6)?[ \\t]?\\)/g,\n\t\t\tcrazyRegExp =\n\t\t\t\t/!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<([^>]*)>(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:(?:([\"'])([^\"]*?)\\6))?[ \\t]?\\)/g,\n\t\t\tbase64RegExp =\n\t\t\t\t/!\\[([^\\]]*?)][ \\t]*()\\([ \\t]?<?(data:.+?\\/.+?;base64,[A-Za-z0-9+/=\\n]+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*(?:([\"'])([^\"]*?)\\6)?[ \\t]?\\)/g,\n\t\t\treferenceRegExp = /!\\[([^\\]]*?)] ?(?:\\n *)?\\[([\\s\\S]*?)]()()()()()/g,\n\t\t\trefShortcutRegExp = /!\\[([^\\[\\]]+)]()()()()()/g;\n\n\t\tfunction writeImageTagBase64(\n\t\t\twholeMatch,\n\t\t\taltText,\n\t\t\tlinkId,\n\t\t\turl,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tm5,\n\t\t\ttitle,\n\t\t) {\n\t\t\turl = url.replace(/\\s/g, \"\");\n\t\t\treturn writeImageTag(\n\t\t\t\twholeMatch,\n\t\t\t\taltText,\n\t\t\t\tlinkId,\n\t\t\t\turl,\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\tm5,\n\t\t\t\ttitle,\n\t\t\t);\n\t\t}\n\n\t\tfunction writeImageTag(\n\t\t\twholeMatch,\n\t\t\taltText,\n\t\t\tlinkId,\n\t\t\turl,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tm5,\n\t\t\ttitle,\n\t\t) {\n\t\t\tvar gUrls = globals.gUrls,\n\t\t\t\tgTitles = globals.gTitles,\n\t\t\t\tgDims = globals.gDimensions;\n\n\t\t\tlinkId = linkId.toLowerCase();\n\n\t\t\tif (!title) {\n\t\t\t\ttitle = \"\";\n\t\t\t}\n\t\t\t// Special case for explicit empty url\n\t\t\tif (wholeMatch.search(/\\(<?\\s*>? ?(['\"].*['\"])?\\)$/m) > -1) {\n\t\t\t\turl = \"\";\n\t\t\t} else if (url === \"\" || url === null) {\n\t\t\t\tif (linkId === \"\" || linkId === null) {\n\t\t\t\t\t// lower-case and turn embedded newlines into spaces\n\t\t\t\t\tlinkId = altText.toLowerCase().replace(/ ?\\n/g, \" \");\n\t\t\t\t}\n\t\t\t\turl = \"#\" + linkId;\n\n\t\t\t\tif (!showdown.helper.isUndefined(gUrls[linkId])) {\n\t\t\t\t\turl = gUrls[linkId];\n\t\t\t\t\tif (!showdown.helper.isUndefined(gTitles[linkId])) {\n\t\t\t\t\t\ttitle = gTitles[linkId];\n\t\t\t\t\t}\n\t\t\t\t\tif (!showdown.helper.isUndefined(gDims[linkId])) {\n\t\t\t\t\t\twidth = gDims[linkId].width;\n\t\t\t\t\t\theight = gDims[linkId].height;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn wholeMatch;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taltText = altText\n\t\t\t\t.replace(/\"/g, \"&quot;\")\n\t\t\t\t//altText = showdown.helper.escapeCharacters(altText, '*_', false);\n\t\t\t\t.replace(\n\t\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t\t);\n\t\t\t//url = showdown.helper.escapeCharacters(url, '*_', false);\n\t\t\turl = url.replace(\n\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t);\n\t\t\tvar result = '<img src=\"' + url + '\" alt=\"' + altText + '\"';\n\n\t\t\tif (title && showdown.helper.isString(title)) {\n\t\t\t\ttitle = title\n\t\t\t\t\t.replace(/\"/g, \"&quot;\")\n\t\t\t\t\t//title = showdown.helper.escapeCharacters(title, '*_', false);\n\t\t\t\t\t.replace(\n\t\t\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t\t\t);\n\t\t\t\tresult += ' title=\"' + title + '\"';\n\t\t\t}\n\n\t\t\tif (width && height) {\n\t\t\t\twidth = width === \"*\" ? \"auto\" : width;\n\t\t\t\theight = height === \"*\" ? \"auto\" : height;\n\n\t\t\t\tresult += ' width=\"' + width + '\"';\n\t\t\t\tresult += ' height=\"' + height + '\"';\n\t\t\t}\n\n\t\t\tresult += \" />\";\n\n\t\t\treturn result;\n\t\t}\n\n\t\t// First, handle reference-style labeled images: ![alt text][id]\n\t\ttext = text.replace(referenceRegExp, writeImageTag);\n\n\t\t// Next, handle inline images:  ![alt text](url =<width>x<height> \"optional title\")\n\n\t\t// base64 encoded images\n\t\ttext = text.replace(base64RegExp, writeImageTagBase64);\n\n\t\t// cases with crazy urls like ./image/cat1).png\n\t\ttext = text.replace(crazyRegExp, writeImageTag);\n\n\t\t// normal cases\n\t\ttext = text.replace(inlineRegExp, writeImageTag);\n\n\t\t// handle reference-style shortcuts: ![img text]\n\t\ttext = text.replace(refShortcutRegExp, writeImageTag);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.images.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\tshowdown.subParser(\n\t\t\"makehtml.italicsAndBold\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.italicsAndBold.before\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\t// it's faster to have 3 separate regexes for each case than have just one\n\t\t\t// because of backtracing, in some cases, it could lead to an exponential effect\n\t\t\t// called \"catastrophic backtrace\". Ominous!\n\n\t\t\tfunction parseInside(txt, left, right) {\n\t\t\t\treturn left + txt + right;\n\t\t\t}\n\n\t\t\t// Parse underscores\n\t\t\tif (options.literalMidWordUnderscores) {\n\t\t\t\ttext = text.replace(/\\b___(\\S[\\s\\S]*?)___\\b/g, function (wm, txt) {\n\t\t\t\t\treturn parseInside(txt, \"<strong><em>\", \"</em></strong>\");\n\t\t\t\t});\n\t\t\t\ttext = text.replace(/\\b__(\\S[\\s\\S]*?)__\\b/g, function (wm, txt) {\n\t\t\t\t\treturn parseInside(txt, \"<strong>\", \"</strong>\");\n\t\t\t\t});\n\t\t\t\ttext = text.replace(/\\b_(\\S[\\s\\S]*?)_\\b/g, function (wm, txt) {\n\t\t\t\t\treturn parseInside(txt, \"<em>\", \"</em>\");\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\ttext = text.replace(/___(\\S[\\s\\S]*?)___/g, function (wm, m) {\n\t\t\t\t\treturn /\\S$/.test(m)\n\t\t\t\t\t\t? parseInside(m, \"<strong><em>\", \"</em></strong>\")\n\t\t\t\t\t\t: wm;\n\t\t\t\t});\n\t\t\t\ttext = text.replace(/__(\\S[\\s\\S]*?)__/g, function (wm, m) {\n\t\t\t\t\treturn /\\S$/.test(m) ? parseInside(m, \"<strong>\", \"</strong>\") : wm;\n\t\t\t\t});\n\t\t\t\ttext = text.replace(/_([^\\s_][\\s\\S]*?)_/g, function (wm, m) {\n\t\t\t\t\t// !/^_[^_]/.test(m) - test if it doesn't start with __ (since it seems redundant, we removed it)\n\t\t\t\t\treturn /\\S$/.test(m) ? parseInside(m, \"<em>\", \"</em>\") : wm;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Now parse asterisks\n\t\t\t/*\n\t  if (options.literalMidWordAsterisks) {\n\t\t text = text.replace(/([^*]|^)\\B\\*\\*\\*(\\S[\\s\\S]+?)\\*\\*\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n\t\t\treturn parseInside (txt, lead + '<strong><em>', '</em></strong>');\n\t\t });\n\t\t text = text.replace(/([^*]|^)\\B\\*\\*(\\S[\\s\\S]+?)\\*\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n\t\t\treturn parseInside (txt, lead + '<strong>', '</strong>');\n\t\t });\n\t\t text = text.replace(/([^*]|^)\\B\\*(\\S[\\s\\S]+?)\\*\\B(?!\\*)/g, function (wm, lead, txt) {\n\t\t\treturn parseInside (txt, lead + '<em>', '</em>');\n\t\t });\n\t  } else {\n\t  */\n\t\t\ttext = text.replace(/\\*\\*\\*(\\S[\\s\\S]*?)\\*\\*\\*/g, function (wm, m) {\n\t\t\t\treturn /\\S$/.test(m)\n\t\t\t\t\t? parseInside(m, \"<strong><em>\", \"</em></strong>\")\n\t\t\t\t\t: wm;\n\t\t\t});\n\t\t\ttext = text.replace(/\\*\\*(\\S[\\s\\S]*?)\\*\\*/g, function (wm, m) {\n\t\t\t\treturn /\\S$/.test(m) ? parseInside(m, \"<strong>\", \"</strong>\") : wm;\n\t\t\t});\n\t\t\ttext = text.replace(/\\*([^\\s*][\\s\\S]*?)\\*/g, function (wm, m) {\n\t\t\t\t// !/^\\*[^*]/.test(m) - test if it doesn't start with ** (since it seems redundant, we removed it)\n\t\t\t\treturn /\\S$/.test(m) ? parseInside(m, \"<em>\", \"</em>\") : wm;\n\t\t\t});\n\t\t\t//}\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\"makehtml.italicsAndBold.after\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t////\n\t// makehtml/links.js\n\t// Copyright (c) 2018 ShowdownJS\n\t//\n\t// Transforms MD links into `<a>` html anchors\n\t//\n\t// A link contains link text (the visible text), a link destination (the URI that is the link destination), and\n\t// optionally a link title. There are two basic kinds of links in Markdown.\n\t// In inline links the destination and title are given immediately after the link text.\n\t// In reference links the destination and title are defined elsewhere in the document.\n\t//\n\t// ***Author:***\n\t// - Estevão Soares dos Santos (Tivie) <https://github.com/tivie>\n\t////\n\n\t(function () {\n\t\t/**\n\t\t * Helper function: Wrapper function to pass as second replace parameter\n\t\t *\n\t\t * @param {RegExp} rgx\n\t\t * @param {string} evtRootName\n\t\t * @param {{}} options\n\t\t * @param {{}} globals\n\t\t * @returns {Function}\n\t\t */\n\t\tfunction replaceAnchorTag(rgx, evtRootName, options, globals, emptyCase) {\n\t\t\temptyCase = !!emptyCase;\n\t\t\treturn function (wholeMatch, text, id, url, m5, m6, title) {\n\t\t\t\t// bail we we find 2 newlines somewhere\n\t\t\t\tif (/\\n\\n/.test(wholeMatch)) {\n\t\t\t\t\treturn wholeMatch;\n\t\t\t\t}\n\n\t\t\t\tvar evt = createEvent(\n\t\t\t\t\trgx,\n\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\twholeMatch,\n\t\t\t\t\ttext,\n\t\t\t\t\tid,\n\t\t\t\t\turl,\n\t\t\t\t\ttitle,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t);\n\t\t\t\treturn writeAnchorTag(evt, options, globals, emptyCase);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * TODO Normalize this\n\t\t * Helper function: Create a capture event\n\t\t * @param {RegExp} rgx\n\t\t * @param {String} evtName Event name\n\t\t * @param {String} wholeMatch\n\t\t * @param {String} text\n\t\t * @param {String} id\n\t\t * @param {String} url\n\t\t * @param {String} title\n\t\t * @param {{}} options\n\t\t * @param {{}} globals\n\t\t * @returns {showdown.helper.Event|*}\n\t\t */\n\t\tfunction createEvent(\n\t\t\trgx,\n\t\t\tevtName,\n\t\t\twholeMatch,\n\t\t\ttext,\n\t\t\tid,\n\t\t\turl,\n\t\t\ttitle,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t) {\n\t\t\treturn globals.converter._dispatch(\n\t\t\t\tevtName,\n\t\t\t\twholeMatch,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t\t{\n\t\t\t\t\tregexp: rgx,\n\t\t\t\t\tmatches: {\n\t\t\t\t\t\twholeMatch: wholeMatch,\n\t\t\t\t\t\ttext: text,\n\t\t\t\t\t\tid: id,\n\t\t\t\t\t\turl: url,\n\t\t\t\t\t\ttitle: title,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\t\t}\n\n\t\t/**\n\t\t * Helper Function: Normalize and write an anchor tag based on passed parameters\n\t\t * @param evt\n\t\t * @param options\n\t\t * @param globals\n\t\t * @param {boolean} emptyCase\n\t\t * @returns {string}\n\t\t */\n\t\tfunction writeAnchorTag(evt, options, globals, emptyCase) {\n\t\t\tvar wholeMatch = evt.getMatches().wholeMatch;\n\t\t\tvar text = evt.getMatches().text;\n\t\t\tvar id = evt.getMatches().id;\n\t\t\tvar url = evt.getMatches().url;\n\t\t\tvar title = evt.getMatches().title;\n\t\t\tvar target = \"\";\n\n\t\t\tif (!title) {\n\t\t\t\ttitle = \"\";\n\t\t\t}\n\t\t\tid = id ? id.toLowerCase() : \"\";\n\n\t\t\tif (emptyCase) {\n\t\t\t\turl = \"\";\n\t\t\t} else if (!url) {\n\t\t\t\tif (!id) {\n\t\t\t\t\t// lower-case and turn embedded newlines into spaces\n\t\t\t\t\tid = text.toLowerCase().replace(/ ?\\n/g, \" \");\n\t\t\t\t}\n\t\t\t\turl = \"#\" + id;\n\n\t\t\t\tif (!showdown.helper.isUndefined(globals.gUrls[id])) {\n\t\t\t\t\turl = globals.gUrls[id];\n\t\t\t\t\tif (!showdown.helper.isUndefined(globals.gTitles[id])) {\n\t\t\t\t\t\ttitle = globals.gTitles[id];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn wholeMatch;\n\t\t\t\t}\n\t\t\t}\n\t\t\t//url = showdown.helper.escapeCharacters(url, '*_:~', false); // replaced line to improve performance\n\t\t\turl = url.replace(\n\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t);\n\n\t\t\tif (title !== \"\" && title !== null) {\n\t\t\t\ttitle = title.replace(/\"/g, \"&quot;\");\n\t\t\t\t//title = showdown.helper.escapeCharacters(title, '*_', false); // replaced line to improve performance\n\t\t\t\ttitle = title.replace(\n\t\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t\t);\n\t\t\t\ttitle = ' title=\"' + title + '\"';\n\t\t\t}\n\n\t\t\t// optionLinksInNewWindow only applies\n\t\t\t// to external links. Hash links (#) open in same page\n\t\t\tif (options.openLinksInNewWindow && !/^#/.test(url)) {\n\t\t\t\t// escaped _\n\t\t\t\ttarget = ' target=\"¨E95Eblank\"';\n\t\t\t}\n\n\t\t\t// Text can be a markdown element, so we run through the appropriate parsers\n\t\t\ttext = showdown.subParser(\"makehtml.codeSpans\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.emoji\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.underline\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.italicsAndBold\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.strikethrough\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.ellipsis\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.hashHTMLSpans\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t//evt = createEvent(rgx, evtRootName + '.captureEnd', wholeMatch, text, id, url, title, options, globals);\n\n\t\t\tvar result =\n\t\t\t\t'<a href=\"' + url + '\"' + title + target + \">\" + text + \"</a>\";\n\n\t\t\t//evt = createEvent(rgx, evtRootName + '.beforeHash', wholeMatch, text, id, url, title, options, globals);\n\n\t\t\tresult = showdown.subParser(\"makehtml.hashHTMLSpans\")(\n\t\t\t\tresult,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\treturn result;\n\t\t}\n\n\t\tvar evtRootName = \"makehtml.links\";\n\n\t\t/**\n\t\t * Turn Markdown link shortcuts into XHTML <a> tags.\n\t\t */\n\t\tshowdown.subParser(\"makehtml.links\", function (text, options, globals) {\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t.getText();\n\n\t\t\t// 1. Handle reference-style links: [link text] [id]\n\t\t\ttext = showdown.subParser(\"makehtml.links.reference\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// 2. Handle inline-style links: [link text](url \"optional title\")\n\t\t\ttext = showdown.subParser(\"makehtml.links.inline\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// 3. Handle reference-style shortcuts: [link text]\n\t\t\t// These must come last in case there's a [link text][1] or [link text](/foo)\n\t\t\ttext = showdown.subParser(\"makehtml.links.referenceShortcut\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// 4. Handle angle brackets links -> `<http://example.com/>`\n\t\t\t// Must come after links, because you can use < and > delimiters in inline links like [this](<url>).\n\t\t\ttext = showdown.subParser(\"makehtml.links.angleBrackets\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// 5. Handle GithubMentions (if option is enabled)\n\t\t\ttext = showdown.subParser(\"makehtml.links.ghMentions\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// 6. Handle <a> tags and img tags\n\t\t\ttext = text.replace(/<a\\s[^>]*>[\\s\\S]*<\\/a>/g, function (wholeMatch) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wholeMatch, globals);\n\t\t\t});\n\n\t\t\ttext = text.replace(/<img\\s[^>]*\\/?>/g, function (wholeMatch) {\n\t\t\t\treturn showdown.helper._hashHTMLSpan(wholeMatch, globals);\n\t\t\t});\n\n\t\t\t// 7. Handle naked links (if option is enabled)\n\t\t\ttext = showdown.subParser(\"makehtml.links.naked\")(text, options, globals);\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t});\n\n\t\t/**\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.inline\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tvar evtRootName = evtRootName + \".inline\";\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\t// 1. Look for empty cases: []() and [empty]() and [](\"title\")\n\t\t\t\tvar rgxEmpty = /\\[(.*?)]()()()()\\(<? ?>? ?(?:[\"'](.*)[\"'])?\\)/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgxEmpty,\n\t\t\t\t\treplaceAnchorTag(rgxEmpty, evtRootName, options, globals, true),\n\t\t\t\t);\n\n\t\t\t\t// 2. Look for cases with crazy urls like ./image/cat1).png\n\t\t\t\tvar rgxCrazy =\n\t\t\t\t\t/\\[((?:\\[[^\\]]*]|[^\\[\\]])*)]()\\s?\\([ \\t]?<([^>]*)>(?:[ \\t]*(([\"'])([^\"]*?)\\5))?[ \\t]?\\)/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgxCrazy,\n\t\t\t\t\treplaceAnchorTag(rgxCrazy, evtRootName, options, globals),\n\t\t\t\t);\n\n\t\t\t\t// 3. inline links with no title or titles wrapped in ' or \":\n\t\t\t\t// [text](url.com) || [text](<url.com>) || [text](url.com \"title\") || [text](<url.com> \"title\")\n\t\t\t\t//var rgx2 = /\\[[ ]*[\\s]?[ ]*([^\\n\\[\\]]*?)[ ]*[\\s]?[ ]*] ?()\\(<?[ ]*[\\s]?[ ]*([^\\s'\"]*)>?(?:[ ]*[\\n]?[ ]*()(['\"])(.*?)\\5)?[ ]*[\\s]?[ ]*\\)/; // this regex is too slow!!!\n\t\t\t\tvar rgx2 =\n\t\t\t\t\t/\\[([\\S ]*?)]\\s?()\\( *<?([^\\s'\"]*?(?:\\([\\S]*?\\)[\\S]*?)?)>?\\s*(?:()(['\"])(.*?)\\5)? *\\)/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgx2,\n\t\t\t\t\treplaceAnchorTag(rgx2, evtRootName, options, globals),\n\t\t\t\t);\n\n\t\t\t\t// 4. inline links with titles wrapped in (): [foo](bar.com (title))\n\t\t\t\tvar rgx3 =\n\t\t\t\t\t/\\[([\\S ]*?)]\\s?()\\( *<?([^\\s'\"]*?(?:\\([\\S]*?\\)[\\S]*?)?)>?\\s+()()\\((.*?)\\) *\\)/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgx3,\n\t\t\t\t\treplaceAnchorTag(rgx3, evtRootName, options, globals),\n\t\t\t\t);\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\n\t\t/**\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.reference\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tvar evtRootName = evtRootName + \".reference\";\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\tvar rgx = /\\[((?:\\[[^\\]]*]|[^\\[\\]])*)] ?(?:\\n *)?\\[(.*?)]()()()()/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgx,\n\t\t\t\t\treplaceAnchorTag(rgx, evtRootName, options, globals),\n\t\t\t\t);\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\n\t\t/**\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.referenceShortcut\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tvar evtRootName = evtRootName + \".referenceShortcut\";\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\tvar rgx = /\\[([^\\[\\]]+)]()()()()()/g;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgx,\n\t\t\t\t\treplaceAnchorTag(rgx, evtRootName, options, globals),\n\t\t\t\t);\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\n\t\t/**\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.ghMentions\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tvar evtRootName = evtRootName + \"ghMentions\";\n\n\t\t\t\tif (!options.ghMentions) {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\tvar rgx = /(^|\\s)(\\\\)?(@([a-z\\d]+(?:[a-z\\d._-]+?[a-z\\d]+)*))/gi;\n\n\t\t\t\ttext = text.replace(\n\t\t\t\t\trgx,\n\t\t\t\t\tfunction (wholeMatch, st, escape, mentions, username) {\n\t\t\t\t\t\t// bail if the mentions was escaped\n\t\t\t\t\t\tif (escape === \"\\\\\") {\n\t\t\t\t\t\t\treturn st + mentions;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// check if options.ghMentionsLink is a string\n\t\t\t\t\t\t// TODO Validation should be done at initialization not at runtime\n\t\t\t\t\t\tif (!showdown.helper.isString(options.ghMentionsLink)) {\n\t\t\t\t\t\t\tthrow new Error(\"ghMentionsLink option must be a string\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar url = options.ghMentionsLink.replace(/{u}/g, username);\n\t\t\t\t\t\tvar evt = createEvent(\n\t\t\t\t\t\t\trgx,\n\t\t\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\t\t\twholeMatch,\n\t\t\t\t\t\t\tmentions,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\t\t\t\t\t\t// captureEnd Event is triggered inside writeAnchorTag function\n\t\t\t\t\t\treturn st + writeAnchorTag(evt, options, globals);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\n\t\t/**\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.angleBrackets\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tvar evtRootName = \"makehtml.links.angleBrackets\";\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\t// 1. Parse links first\n\t\t\t\tvar urlRgx = /<(((?:https?|ftp):\\/\\/|www\\.)[^'\">\\s]+)>/gi;\n\t\t\t\ttext = text.replace(urlRgx, function (wholeMatch, url, urlStart) {\n\t\t\t\t\tvar text = url;\n\t\t\t\t\turl = urlStart === \"www.\" ? \"http://\" + url : url;\n\t\t\t\t\tvar evt = createEvent(\n\t\t\t\t\t\turlRgx,\n\t\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\t\twholeMatch,\n\t\t\t\t\t\ttext,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\turl,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\treturn writeAnchorTag(evt, options, globals);\n\t\t\t\t});\n\n\t\t\t\t// 2. Then Mail Addresses\n\t\t\t\tvar mailRgx =\n\t\t\t\t\t/<(?:mailto:)?([-.\\w]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)>/gi;\n\t\t\t\ttext = text.replace(mailRgx, function (wholeMatch, mail) {\n\t\t\t\t\tvar url = \"mailto:\";\n\t\t\t\t\tmail = showdown.subParser(\"makehtml.unescapeSpecialChars\")(\n\t\t\t\t\t\tmail,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\tif (options.encodeEmails) {\n\t\t\t\t\t\turl = showdown.helper.encodeEmailAddress(url + mail);\n\t\t\t\t\t\tmail = showdown.helper.encodeEmailAddress(mail);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl = url + mail;\n\t\t\t\t\t}\n\t\t\t\t\tvar evt = createEvent(\n\t\t\t\t\t\tmailRgx,\n\t\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\t\twholeMatch,\n\t\t\t\t\t\tmail,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\turl,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\treturn writeAnchorTag(evt, options, globals);\n\t\t\t\t});\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\n\t\t/**\n\t\t * TODO MAKE THIS WORK (IT'S NOT ACTIVATED)\n\t\t * TODO WRITE THIS DOCUMENTATION\n\t\t */\n\t\tshowdown.subParser(\n\t\t\t\"makehtml.links.naked\",\n\t\t\tfunction (text, options, globals) {\n\t\t\t\tif (!options.simplifiedAutoLink) {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\n\t\t\t\tvar evtRootName = \"makehtml.links.naked\";\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".start\", text, options, globals)\n\t\t\t\t\t.getText();\n\n\t\t\t\t// 2. Now we check for\n\t\t\t\t// we also include leading markdown magic chars [_*~] for cases like __https://www.google.com/foobar__\n\t\t\t\tvar urlRgx =\n\t\t\t\t\t/([_*~]*?)(((?:https?|ftp):\\/\\/|www\\.)[^\\s<>\"'`´.-][^\\s<>\"'`´]*?\\.[a-z\\d.]+[^\\s<>\"']*)\\1/gi;\n\t\t\t\ttext = text.replace(\n\t\t\t\t\turlRgx,\n\t\t\t\t\tfunction (wholeMatch, leadingMDChars, url, urlPrefix) {\n\t\t\t\t\t\t// we now will start traversing the url from the front to back, looking for punctuation chars [_*~,;:.!?\\)\\]]\n\t\t\t\t\t\tvar len = url.length;\n\t\t\t\t\t\tvar suffix = \"\";\n\t\t\t\t\t\tfor (var i = len - 1; i >= 0; --i) {\n\t\t\t\t\t\t\tvar char = url.charAt(i);\n\n\t\t\t\t\t\t\tif (/[_*~,;:.!?]/.test(char)) {\n\t\t\t\t\t\t\t\t// it's a punctuation char\n\t\t\t\t\t\t\t\t// we remove it from the url\n\t\t\t\t\t\t\t\turl = url.slice(0, -1);\n\t\t\t\t\t\t\t\t// and prepend it to the suffix\n\t\t\t\t\t\t\t\tsuffix = char + suffix;\n\t\t\t\t\t\t\t} else if (/\\)/.test(char)) {\n\t\t\t\t\t\t\t\tvar opPar = url.match(/\\(/g) || [];\n\t\t\t\t\t\t\t\tvar clPar = url.match(/\\)/g);\n\n\t\t\t\t\t\t\t\t// it's a curved parenthesis so we need to check for \"balance\" (kinda)\n\t\t\t\t\t\t\t\tif (opPar.length < clPar.length) {\n\t\t\t\t\t\t\t\t\t// there are more closing Parenthesis than opening so chop it!!!!!\n\t\t\t\t\t\t\t\t\turl = url.slice(0, -1);\n\t\t\t\t\t\t\t\t\t// and prepend it to the suffix\n\t\t\t\t\t\t\t\t\tsuffix = char + suffix;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// it's (kinda) balanced so our work is done\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if (/]/.test(char)) {\n\t\t\t\t\t\t\t\tvar opPar2 = url.match(/\\[/g) || [];\n\t\t\t\t\t\t\t\tvar clPar2 = url.match(/\\]/g);\n\t\t\t\t\t\t\t\t// it's a squared parenthesis so we need to check for \"balance\" (kinda)\n\t\t\t\t\t\t\t\tif (opPar2.length < clPar2.length) {\n\t\t\t\t\t\t\t\t\t// there are more closing Parenthesis than opening so chop it!!!!!\n\t\t\t\t\t\t\t\t\turl = url.slice(0, -1);\n\t\t\t\t\t\t\t\t\t// and prepend it to the suffix\n\t\t\t\t\t\t\t\t\tsuffix = char + suffix;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// it's (kinda) balanced so our work is done\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// it's not a punctuation or a parenthesis so our work is done\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// we copy the treated url to the text variable\n\t\t\t\t\t\tvar text = url;\n\t\t\t\t\t\t// finally, if it's a www shortcut, we prepend http\n\t\t\t\t\t\turl = urlPrefix === \"www.\" ? \"http://\" + url : url;\n\n\t\t\t\t\t\t// url part is done so let's take care of text now\n\t\t\t\t\t\t// we need to escape the text (because of links such as www.example.com/foo__bar__baz)\n\t\t\t\t\t\ttext = text.replace(\n\t\t\t\t\t\t\tshowdown.helper.regexes.asteriskDashTildeAndColon,\n\t\t\t\t\t\t\tshowdown.helper.escapeCharactersCallback,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// finally we dispatch the event\n\t\t\t\t\t\tvar evt = createEvent(\n\t\t\t\t\t\t\turlRgx,\n\t\t\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\t\t\twholeMatch,\n\t\t\t\t\t\t\ttext,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\turl,\n\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// and return the link tag, with the leadingMDChars and  suffix. The leadingMDChars are added at the end too because\n\t\t\t\t\t\t// we consumed those characters in the regexp\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\tleadingMDChars +\n\t\t\t\t\t\t\twriteAnchorTag(evt, options, globals) +\n\t\t\t\t\t\t\tsuffix +\n\t\t\t\t\t\t\tleadingMDChars\n\t\t\t\t\t\t);\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\t// 2. Then mails\n\t\t\t\tvar mailRgx =\n\t\t\t\t\t/(^|\\s)(?:mailto:)?([A-Za-z0-9!#$%&'*+-/=?^_`{|}~.]+@[-a-z0-9]+(\\.[-a-z0-9]+)*\\.[a-z]+)(?=$|\\s)/gim;\n\t\t\t\ttext = text.replace(mailRgx, function (wholeMatch, leadingChar, mail) {\n\t\t\t\t\tvar url = \"mailto:\";\n\t\t\t\t\tmail = showdown.subParser(\"makehtml.unescapeSpecialChars\")(\n\t\t\t\t\t\tmail,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\tif (options.encodeEmails) {\n\t\t\t\t\t\turl = showdown.helper.encodeEmailAddress(url + mail);\n\t\t\t\t\t\tmail = showdown.helper.encodeEmailAddress(mail);\n\t\t\t\t\t} else {\n\t\t\t\t\t\turl = url + mail;\n\t\t\t\t\t}\n\t\t\t\t\tvar evt = createEvent(\n\t\t\t\t\t\tmailRgx,\n\t\t\t\t\t\tevtRootName + \".captureStart\",\n\t\t\t\t\t\twholeMatch,\n\t\t\t\t\t\tmail,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\turl,\n\t\t\t\t\t\tnull,\n\t\t\t\t\t\toptions,\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t\treturn leadingChar + writeAnchorTag(evt, options, globals);\n\t\t\t\t});\n\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(evtRootName + \".end\", text, options, globals)\n\t\t\t\t\t.getText();\n\t\t\t\treturn text;\n\t\t\t},\n\t\t);\n\t})();\n\n\t/**\n\t * Form HTML ordered (numbered) and unordered (bulleted) lists.\n\t */\n\tshowdown.subParser(\"makehtml.lists\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\t/**\n\t\t * Process the contents of a single ordered or unordered list, splitting it\n\t\t * into individual list items.\n\t\t * @param {string} listStr\n\t\t * @param {boolean} trimTrailing\n\t\t * @returns {string}\n\t\t */\n\t\tfunction processListItems(listStr, trimTrailing) {\n\t\t\t// The $g_list_level global keeps track of when we're inside a list.\n\t\t\t// Each time we enter a list, we increment it; when we leave a list,\n\t\t\t// we decrement. If it's zero, we're not in a list anymore.\n\t\t\t//\n\t\t\t// We do this because when we're not inside a list, we want to treat\n\t\t\t// something like this:\n\t\t\t//\n\t\t\t//    I recommend upgrading to version\n\t\t\t//    8. Oops, now this line is treated\n\t\t\t//    as a sub-list.\n\t\t\t//\n\t\t\t// As a single paragraph, despite the fact that the second line starts\n\t\t\t// with a digit-period-space sequence.\n\t\t\t//\n\t\t\t// Whereas when we're inside a list (or sub-list), that line will be\n\t\t\t// treated as the start of a sub-list. What a kludge, huh? This is\n\t\t\t// an aspect of Markdown's syntax that's hard to parse perfectly\n\t\t\t// without resorting to mind-reading. Perhaps the solution is to\n\t\t\t// change the syntax rules such that sub-lists must start with a\n\t\t\t// starting cardinal number; e.g. \"1.\" or \"a.\".\n\t\t\tglobals.gListLevel++;\n\n\t\t\t// trim trailing blank lines:\n\t\t\tlistStr = listStr.replace(/\\n{2,}$/, \"\\n\");\n\n\t\t\t// attacklab: add sentinel to emulate \\z\n\t\t\tlistStr += \"¨0\";\n\n\t\t\tvar rgx =\n\t\t\t\t\t/(\\n)?(^ {0,3})([*+-]|\\d+[.])[ \\t]+((\\[(x|X| )?])?[ \\t]*[^\\r]+?(\\n{1,2}))(?=\\n*(¨0| {0,3}([*+-]|\\d+[.])[ \\t]+))/gm,\n\t\t\t\tisParagraphed = /\\n[ \\t]*\\n(?!¨0)/.test(listStr);\n\n\t\t\t// Since version 1.5, nesting sublists requires 4 spaces (or 1 tab) indentation,\n\t\t\t// which is a syntax breaking change\n\t\t\t// activating this option reverts to old behavior\n\t\t\t// This will be removed in version 2.0\n\t\t\tif (options.disableForced4SpacesIndentedSublists) {\n\t\t\t\trgx =\n\t\t\t\t\t/(\\n)?(^ {0,3})([*+-]|\\d+[.])[ \\t]+((\\[(x|X| )?])?[ \\t]*[^\\r]+?(\\n{1,2}))(?=\\n*(¨0|\\2([*+-]|\\d+[.])[ \\t]+))/gm;\n\t\t\t}\n\n\t\t\tlistStr = listStr.replace(\n\t\t\t\trgx,\n\t\t\t\tfunction (wholeMatch, m1, m2, m3, m4, taskbtn, checked) {\n\t\t\t\t\tchecked = checked && checked.trim() !== \"\";\n\n\t\t\t\t\tvar item = showdown.subParser(\"makehtml.outdent\")(\n\t\t\t\t\t\t\tm4,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t),\n\t\t\t\t\t\tbulletStyle = \"\";\n\n\t\t\t\t\t// Support for github tasklists\n\t\t\t\t\tif (taskbtn && options.tasklists) {\n\t\t\t\t\t\tbulletStyle =\n\t\t\t\t\t\t\t' class=\"task-list-item\" style=\"list-style-type: none;\"';\n\t\t\t\t\t\titem = item.replace(/^[ \\t]*\\[(x|X| )?]/m, function () {\n\t\t\t\t\t\t\tvar otp =\n\t\t\t\t\t\t\t\t'<input type=\"checkbox\" style=\"margin: 0px 0.35em 0.25em -1.6em; vertical-align: middle;\"';\n\t\t\t\t\t\t\tif (checked) {\n\t\t\t\t\t\t\t\totp += \" checked\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\totp += \">\";\n\t\t\t\t\t\t\treturn otp;\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\t// ISSUE #312\n\t\t\t\t\t// This input: - - - a\n\t\t\t\t\t// causes trouble to the parser, since it interprets it as:\n\t\t\t\t\t// <ul><li><li><li>a</li></li></li></ul>\n\t\t\t\t\t// instead of:\n\t\t\t\t\t// <ul><li>- - a</li></ul>\n\t\t\t\t\t// So, to prevent it, we will put a marker (¨A)in the beginning of the line\n\t\t\t\t\t// Kind of hackish/monkey patching, but seems more effective than overcomplicating the list parser\n\t\t\t\t\titem = item.replace(/^([-*+]|\\d\\.)[ \\t]+[\\S\\n ]*/g, function (wm2) {\n\t\t\t\t\t\treturn \"¨A\" + wm2;\n\t\t\t\t\t});\n\n\t\t\t\t\t// SPECIAL CASE: an heading followed by a paragraph of text that is not separated by a double newline\n\t\t\t\t\t// or/nor indented. ex:\n\t\t\t\t\t//\n\t\t\t\t\t// - # foo\n\t\t\t\t\t// bar is great\n\t\t\t\t\t//\n\t\t\t\t\t// While this does now follow the spec per se, not allowing for this might cause confusion since\n\t\t\t\t\t// header blocks don't need double newlines after\n\t\t\t\t\tif (/^#+.+\\n.+/.test(item)) {\n\t\t\t\t\t\titem = item.replace(/^(#+.+)$/m, \"$1\\n\");\n\t\t\t\t\t}\n\n\t\t\t\t\t// m1 - Leading line or\n\t\t\t\t\t// Has a double return (multi paragraph)\n\t\t\t\t\tif (m1 || item.search(/\\n{2,}/) > -1) {\n\t\t\t\t\t\titem = showdown.subParser(\"makehtml.githubCodeBlocks\")(\n\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\t\t\t\t\t\titem = showdown.subParser(\"makehtml.blockGamut\")(\n\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Recursion for sub-lists:\n\t\t\t\t\t\titem = showdown.subParser(\"makehtml.lists\")(item, options, globals);\n\t\t\t\t\t\titem = item.replace(/\\n$/, \"\"); // chomp(item)\n\t\t\t\t\t\titem = showdown.subParser(\"makehtml.hashHTMLBlocks\")(\n\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\t// Colapse double linebreaks\n\t\t\t\t\t\titem = item.replace(/\\n\\n+/g, \"\\n\\n\");\n\n\t\t\t\t\t\tif (isParagraphed) {\n\t\t\t\t\t\t\titem = showdown.subParser(\"makehtml.paragraphs\")(\n\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\titem = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\t\t\t\t\titem,\n\t\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// now we need to remove the marker (¨A)\n\t\t\t\t\titem = item.replace(\"¨A\", \"\");\n\t\t\t\t\t// we can finally wrap the line in list item tags\n\t\t\t\t\titem = \"<li\" + bulletStyle + \">\" + item + \"</li>\\n\";\n\n\t\t\t\t\treturn item;\n\t\t\t\t},\n\t\t\t);\n\n\t\t\t// attacklab: strip sentinel\n\t\t\tlistStr = listStr.replace(/¨0/g, \"\");\n\n\t\t\tglobals.gListLevel--;\n\n\t\t\tif (trimTrailing) {\n\t\t\t\tlistStr = listStr.replace(/\\s+$/, \"\");\n\t\t\t}\n\n\t\t\treturn listStr;\n\t\t}\n\n\t\tfunction styleStartNumber(list, listType) {\n\t\t\t// check if ol and starts by a number different than 1\n\t\t\tif (listType === \"ol\") {\n\t\t\t\tvar res = list.match(/^ *(\\d+)\\./);\n\t\t\t\tif (res && res[1] !== \"1\") {\n\t\t\t\t\treturn ' start=\"' + res[1] + '\"';\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn \"\";\n\t\t}\n\n\t\t/**\n\t\t * Check and parse consecutive lists (better fix for issue #142)\n\t\t * @param {string} list\n\t\t * @param {string} listType\n\t\t * @param {boolean} trimTrailing\n\t\t * @returns {string}\n\t\t */\n\t\tfunction parseConsecutiveLists(list, listType, trimTrailing) {\n\t\t\t// check if we caught 2 or more consecutive lists by mistake\n\t\t\t// we use the counterRgx, meaning if listType is UL we look for OL and vice versa\n\t\t\tvar olRgx = options.disableForced4SpacesIndentedSublists\n\t\t\t\t\t? /^ ?\\d+\\.[ \\t]/gm\n\t\t\t\t\t: /^ {0,3}\\d+\\.[ \\t]/gm,\n\t\t\t\tulRgx = options.disableForced4SpacesIndentedSublists\n\t\t\t\t\t? /^ ?[*+-][ \\t]/gm\n\t\t\t\t\t: /^ {0,3}[*+-][ \\t]/gm,\n\t\t\t\tcounterRxg = listType === \"ul\" ? olRgx : ulRgx,\n\t\t\t\tresult = \"\";\n\n\t\t\tif (list.search(counterRxg) !== -1) {\n\t\t\t\t(function parseCL(txt) {\n\t\t\t\t\tvar pos = txt.search(counterRxg),\n\t\t\t\t\t\tstyle = styleStartNumber(list, listType);\n\t\t\t\t\tif (pos !== -1) {\n\t\t\t\t\t\t// slice\n\t\t\t\t\t\tresult +=\n\t\t\t\t\t\t\t\"\\n\\n<\" +\n\t\t\t\t\t\t\tlistType +\n\t\t\t\t\t\t\tstyle +\n\t\t\t\t\t\t\t\">\\n\" +\n\t\t\t\t\t\t\tprocessListItems(txt.slice(0, pos), !!trimTrailing) +\n\t\t\t\t\t\t\t\"</\" +\n\t\t\t\t\t\t\tlistType +\n\t\t\t\t\t\t\t\">\\n\";\n\n\t\t\t\t\t\t// invert counterType and listType\n\t\t\t\t\t\tlistType = listType === \"ul\" ? \"ol\" : \"ul\";\n\t\t\t\t\t\tcounterRxg = listType === \"ul\" ? olRgx : ulRgx;\n\n\t\t\t\t\t\t//recurse\n\t\t\t\t\t\tparseCL(txt.slice(pos));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult +=\n\t\t\t\t\t\t\t\"\\n\\n<\" +\n\t\t\t\t\t\t\tlistType +\n\t\t\t\t\t\t\tstyle +\n\t\t\t\t\t\t\t\">\\n\" +\n\t\t\t\t\t\t\tprocessListItems(txt, !!trimTrailing) +\n\t\t\t\t\t\t\t\"</\" +\n\t\t\t\t\t\t\tlistType +\n\t\t\t\t\t\t\t\">\\n\";\n\t\t\t\t\t}\n\t\t\t\t})(list);\n\t\t\t} else {\n\t\t\t\tvar style = styleStartNumber(list, listType);\n\t\t\t\tresult =\n\t\t\t\t\t\"\\n\\n<\" +\n\t\t\t\t\tlistType +\n\t\t\t\t\tstyle +\n\t\t\t\t\t\">\\n\" +\n\t\t\t\t\tprocessListItems(list, !!trimTrailing) +\n\t\t\t\t\t\"</\" +\n\t\t\t\t\tlistType +\n\t\t\t\t\t\">\\n\";\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}\n\n\t\t// Start of list parsing\n\t\tvar subListRgx =\n\t\t\t/^(( {0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(¨0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\n\t\tvar mainListRgx =\n\t\t\t/(\\n\\n|^\\n?)(( {0,3}([*+-]|\\d+[.])[ \\t]+)[^\\r]+?(¨0|\\n{2,}(?=\\S)(?![ \\t]*(?:[*+-]|\\d+[.])[ \\t]+)))/gm;\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"lists.before\", text, options, globals)\n\t\t\t.getText();\n\t\t// add sentinel to hack around khtml/safari bug:\n\t\t// http://bugs.webkit.org/show_bug.cgi?id=11231\n\t\ttext += \"¨0\";\n\n\t\tif (globals.gListLevel) {\n\t\t\ttext = text.replace(subListRgx, function (wholeMatch, list, m2) {\n\t\t\t\tvar listType = m2.search(/[*+-]/g) > -1 ? \"ul\" : \"ol\";\n\t\t\t\treturn parseConsecutiveLists(list, listType, true);\n\t\t\t});\n\t\t} else {\n\t\t\ttext = text.replace(mainListRgx, function (wholeMatch, m1, list, m3) {\n\t\t\t\tvar listType = m3.search(/[*+-]/g) > -1 ? \"ul\" : \"ol\";\n\t\t\t\treturn parseConsecutiveLists(list, listType, false);\n\t\t\t});\n\t\t}\n\n\t\t// strip sentinel\n\t\ttext = text.replace(/¨0/, \"\");\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.lists.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Parse metadata at the top of the document\n\t */\n\tshowdown.subParser(\"makehtml.metadata\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\tif (!options.metadata) {\n\t\t\treturn text;\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.metadata.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tfunction parseMetadataContents(content) {\n\t\t\t// raw is raw so it's not changed in any way\n\t\t\tglobals.metadata.raw = content;\n\n\t\t\t// escape chars forbidden in html attributes\n\t\t\t// double quotes\n\t\t\tcontent = content\n\t\t\t\t// ampersand first\n\t\t\t\t.replace(/&/g, \"&amp;\")\n\t\t\t\t// double quotes\n\t\t\t\t.replace(/\"/g, \"&quot;\");\n\n\t\t\tcontent = content.replace(/\\n {4}/g, \" \");\n\t\t\tcontent.replace(/^([\\S ]+): +([\\s\\S]+?)$/gm, function (wm, key, value) {\n\t\t\t\tglobals.metadata.parsed[key] = value;\n\t\t\t\treturn \"\";\n\t\t\t});\n\t\t}\n\n\t\ttext = text.replace(\n\t\t\t/^\\s*«««+(\\S*?)\\n([\\s\\S]+?)\\n»»»+\\n/,\n\t\t\tfunction (wholematch, format, content) {\n\t\t\t\tparseMetadataContents(content);\n\t\t\t\treturn \"¨M\";\n\t\t\t},\n\t\t);\n\n\t\ttext = text.replace(\n\t\t\t/^\\s*---+(\\S*?)\\n([\\s\\S]+?)\\n---+\\n/,\n\t\t\tfunction (wholematch, format, content) {\n\t\t\t\tif (format) {\n\t\t\t\t\tglobals.metadata.format = format;\n\t\t\t\t}\n\t\t\t\tparseMetadataContents(content);\n\t\t\t\treturn \"¨M\";\n\t\t\t},\n\t\t);\n\n\t\ttext = text.replace(/¨M/g, \"\");\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.metadata.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t * Remove one level of line-leading tabs or spaces\n\t */\n\tshowdown.subParser(\"makehtml.outdent\", function (text, options, globals) {\n\t\t\"use strict\";\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.outdent.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// attacklab: hack around Konqueror 3.5.4 bug:\n\t\t// \"----------bug\".replace(/^-/g,\"\") == \"bug\"\n\t\ttext = text.replace(/^(\\t|[ ]{1,4})/gm, \"¨0\"); // attacklab: g_tab_width\n\n\t\t// attacklab: clean up hack\n\t\ttext = text.replace(/¨0/g, \"\");\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.outdent.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\t/**\n\t *\n\t */\n\tshowdown.subParser(\"makehtml.paragraphs\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.paragraphs.before\", text, options, globals)\n\t\t\t.getText();\n\t\t// Strip leading and trailing lines:\n\t\ttext = text.replace(/^\\n+/g, \"\");\n\t\ttext = text.replace(/\\n+$/g, \"\");\n\n\t\tvar grafs = text.split(/\\n{2,}/g),\n\t\t\tgrafsOut = [],\n\t\t\tend = grafs.length; // Wrap <p> tags\n\n\t\tfor (var i = 0; i < end; i++) {\n\t\t\tvar str = grafs[i];\n\t\t\t// if this is an HTML marker, copy it\n\t\t\tif (str.search(/¨(K|G)(\\d+)\\1/g) >= 0) {\n\t\t\t\tgrafsOut.push(str);\n\n\t\t\t\t// test for presence of characters to prevent empty lines being parsed\n\t\t\t\t// as paragraphs (resulting in undesired extra empty paragraphs)\n\t\t\t} else if (str.search(/\\S/) >= 0) {\n\t\t\t\tstr = showdown.subParser(\"makehtml.spanGamut\")(str, options, globals);\n\t\t\t\tstr = str.replace(/^([ \\t]*)/g, \"<p>\");\n\t\t\t\tstr += \"</p>\";\n\t\t\t\tgrafsOut.push(str);\n\t\t\t}\n\t\t}\n\n\t\t/** Unhashify HTML blocks */\n\t\tend = grafsOut.length;\n\t\tfor (i = 0; i < end; i++) {\n\t\t\tvar blockText = \"\",\n\t\t\t\tgrafsOutIt = grafsOut[i],\n\t\t\t\tcodeFlag = false;\n\t\t\t// if this is a marker for an html block...\n\t\t\t// use RegExp.test instead of string.search because of QML bug\n\t\t\twhile (/¨(K|G)(\\d+)\\1/.test(grafsOutIt)) {\n\t\t\t\tvar delim = RegExp.$1,\n\t\t\t\t\tnum = RegExp.$2;\n\n\t\t\t\tif (delim === \"K\") {\n\t\t\t\t\tblockText = globals.gHtmlBlocks[num];\n\t\t\t\t} else {\n\t\t\t\t\t// we need to check if ghBlock is a false positive\n\t\t\t\t\tif (codeFlag) {\n\t\t\t\t\t\t// use encoded version of all text\n\t\t\t\t\t\tblockText = showdown.subParser(\"makehtml.encodeCode\")(\n\t\t\t\t\t\t\tglobals.ghCodeBlocks[num].text,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t\tglobals,\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tblockText = globals.ghCodeBlocks[num].codeblock;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tblockText = blockText.replace(/\\$/g, \"$$$$\"); // Escape any dollar signs\n\n\t\t\t\tgrafsOutIt = grafsOutIt.replace(/(\\n\\n)?¨(K|G)\\d+\\2(\\n\\n)?/, blockText);\n\t\t\t\t// Check if grafsOutIt is a pre->code\n\t\t\t\tif (/^<pre\\b[^>]*>\\s*<code\\b[^>]*>/.test(grafsOutIt)) {\n\t\t\t\t\tcodeFlag = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tgrafsOut[i] = grafsOutIt;\n\t\t}\n\t\ttext = grafsOut.join(\"\\n\");\n\t\t// Strip leading and trailing lines:\n\t\ttext = text.replace(/^\\n+/g, \"\");\n\t\ttext = text.replace(/\\n+$/g, \"\");\n\t\treturn globals.converter\n\t\t\t._dispatch(\"makehtml.paragraphs.after\", text, options, globals)\n\t\t\t.getText();\n\t});\n\n\t/**\n\t * Run extension\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.runExtension\",\n\t\tfunction (ext, text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\tif (ext.filter) {\n\t\t\t\ttext = ext.filter(text, globals.converter, options);\n\t\t\t} else if (ext.regex) {\n\t\t\t\t// TODO remove this when old extension loading mechanism is deprecated\n\t\t\t\tvar re = ext.regex;\n\t\t\t\tif (!(re instanceof RegExp)) {\n\t\t\t\t\tre = new RegExp(re, \"g\");\n\t\t\t\t}\n\t\t\t\ttext = text.replace(re, ext.replace);\n\t\t\t}\n\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * These are all the transformations that occur *within* block-level\n\t * tags like paragraphs, headers, and list items.\n\t */\n\tshowdown.subParser(\"makehtml.spanGamut\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.span.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\ttext = showdown.subParser(\"makehtml.codeSpans\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.escapeSpecialCharsWithinTagAttributes\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\t\ttext = showdown.subParser(\"makehtml.encodeBackslashEscapes\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\n\t\t// Process link and image tags. Images must come first,\n\t\t// because ![foo][f] looks like a link.\n\t\ttext = showdown.subParser(\"makehtml.images\")(text, options, globals);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"smakehtml.links.before\", text, options, globals)\n\t\t\t.getText();\n\t\ttext = showdown.subParser(\"makehtml.links\")(text, options, globals);\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"smakehtml.links.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\t//text = showdown.subParser('makehtml.autoLinks')(text, options, globals);\n\t\t//text = showdown.subParser('makehtml.simplifiedAutoLinks')(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.emoji\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.underline\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.italicsAndBold\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\t\ttext = showdown.subParser(\"makehtml.strikethrough\")(text, options, globals);\n\t\ttext = showdown.subParser(\"makehtml.ellipsis\")(text, options, globals);\n\n\t\t// we need to hash HTML tags inside spans\n\t\ttext = showdown.subParser(\"makehtml.hashHTMLSpans\")(text, options, globals);\n\n\t\t// now we encode amps and angles\n\t\ttext = showdown.subParser(\"makehtml.encodeAmpsAndAngles\")(\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t);\n\n\t\t// Do hard breaks\n\t\tif (options.simpleLineBreaks) {\n\t\t\t// GFM style hard breaks\n\t\t\t// only add line breaks if the text does not contain a block (special case for lists)\n\t\t\tif (!/\\n\\n¨K/.test(text)) {\n\t\t\t\ttext = text.replace(/\\n+/g, \"<br />\\n\");\n\t\t\t}\n\t\t} else {\n\t\t\t// Vanilla hard breaks\n\t\t\ttext = text.replace(/  +\\n/g, \"<br />\\n\");\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.spanGamut.after\", text, options, globals)\n\t\t\t.getText();\n\t\treturn text;\n\t});\n\n\tshowdown.subParser(\n\t\t\"makehtml.strikethrough\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\tif (options.strikethrough) {\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(\"makehtml.strikethrough.before\", text, options, globals)\n\t\t\t\t\t.getText();\n\t\t\t\ttext = text.replace(/(?:~){2}([\\s\\S]+?)(?:~){2}/g, function (wm, txt) {\n\t\t\t\t\treturn \"<del>\" + txt + \"</del>\";\n\t\t\t\t});\n\t\t\t\ttext = globals.converter\n\t\t\t\t\t._dispatch(\"makehtml.strikethrough.after\", text, options, globals)\n\t\t\t\t\t.getText();\n\t\t\t}\n\n\t\t\treturn text;\n\t\t},\n\t);\n\n\t/**\n\t * Strips link definitions from text, stores the URLs and titles in\n\t * hash references.\n\t * Link defs are in the form: ^[id]: url \"optional title\"\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.stripLinkDefinitions\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\n\t\t\tvar regex =\n\t\t\t\t\t/^ {0,3}\\[(.+)]:[ \\t]*\\n?[ \\t]*<?([^>\\s]+)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"|'(](.+?)[\"|')][ \\t]*)?(?:\\n+|(?=¨0))/gm,\n\t\t\t\tbase64Regex =\n\t\t\t\t\t/^ {0,3}\\[(.+)]:[ \\t]*\\n?[ \\t]*<?(data:.+?\\/.+?;base64,[A-Za-z0-9+/=\\n]+?)>?(?: =([*\\d]+[A-Za-z%]{0,4})x([*\\d]+[A-Za-z%]{0,4}))?[ \\t]*\\n?[ \\t]*(?:(\\n*)[\"|'(](.+?)[\"|')][ \\t]*)?(?:\\n\\n|(?=¨0)|(?=\\n\\[))/gm;\n\n\t\t\t// attacklab: sentinel workarounds for lack of \\A and \\Z, safari\\khtml bug\n\t\t\ttext += \"¨0\";\n\n\t\t\tvar replaceFunc = function (\n\t\t\t\twholeMatch,\n\t\t\t\tlinkId,\n\t\t\t\turl,\n\t\t\t\twidth,\n\t\t\t\theight,\n\t\t\t\tblankLines,\n\t\t\t\ttitle,\n\t\t\t) {\n\t\t\t\tlinkId = linkId.toLowerCase();\n\t\t\t\tif (url.match(/^data:.+?\\/.+?;base64,/)) {\n\t\t\t\t\t// remove newlines\n\t\t\t\t\tglobals.gUrls[linkId] = url.replace(/\\s/g, \"\");\n\t\t\t\t} else {\n\t\t\t\t\tglobals.gUrls[linkId] = showdown.subParser(\n\t\t\t\t\t\t\"makehtml.encodeAmpsAndAngles\",\n\t\t\t\t\t)(url, options, globals); // Link IDs are case-insensitive\n\t\t\t\t}\n\n\t\t\t\tif (blankLines) {\n\t\t\t\t\t// Oops, found blank lines, so it's not a title.\n\t\t\t\t\t// Put back the parenthetical statement we stole.\n\t\t\t\t\treturn blankLines + title;\n\t\t\t\t} else {\n\t\t\t\t\tif (title) {\n\t\t\t\t\t\tglobals.gTitles[linkId] = title.replace(/\"|'/g, \"&quot;\");\n\t\t\t\t\t}\n\t\t\t\t\tif (options.parseImgDimensions && width && height) {\n\t\t\t\t\t\tglobals.gDimensions[linkId] = {\n\t\t\t\t\t\t\twidth: width,\n\t\t\t\t\t\t\theight: height,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Completely remove the definition from the text\n\t\t\t\treturn \"\";\n\t\t\t};\n\n\t\t\t// first we try to find base64 link references\n\t\t\ttext = text.replace(base64Regex, replaceFunc);\n\n\t\t\ttext = text.replace(regex, replaceFunc);\n\n\t\t\t// attacklab: strip sentinel\n\t\t\ttext = text.replace(/¨0/, \"\");\n\n\t\t\treturn text;\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makehtml.tables\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\tif (!options.tables) {\n\t\t\treturn text;\n\t\t}\n\n\t\tvar tableRgx =\n\t\t\t\t/^ {0,3}\\|?.+\\|.+\\n {0,3}\\|?[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[\\s\\S]+?(?:\\n\\n|¨0)/gm,\n\t\t\t//singeColTblRgx = /^ {0,3}\\|.+\\|\\n {0,3}\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*\\n(?: {0,3}\\|.+\\|\\n)+(?:\\n\\n|¨0)/gm;\n\t\t\tsingeColTblRgx =\n\t\t\t\t/^ {0,3}\\|.+\\|[ \\t]*\\n {0,3}\\|[ \\t]*:?[ \\t]*(?:[-=]){2,}[ \\t]*:?[ \\t]*\\|[ \\t]*\\n( {0,3}\\|.+\\|[ \\t]*\\n)*(?:\\n|¨0)/gm;\n\n\t\tfunction parseStyles(sLine) {\n\t\t\tif (/^:[ \\t]*--*$/.test(sLine)) {\n\t\t\t\treturn ' style=\"text-align:left;\"';\n\t\t\t} else if (/^--*[ \\t]*:[ \\t]*$/.test(sLine)) {\n\t\t\t\treturn ' style=\"text-align:right;\"';\n\t\t\t} else if (/^:[ \\t]*--*[ \\t]*:$/.test(sLine)) {\n\t\t\t\treturn ' style=\"text-align:center;\"';\n\t\t\t} else {\n\t\t\t\treturn \"\";\n\t\t\t}\n\t\t}\n\n\t\tfunction parseHeaders(header, style) {\n\t\t\tvar id = \"\";\n\t\t\theader = header.trim();\n\t\t\t// support both tablesHeaderId and tableHeaderId due to error in documentation so we don't break backwards compatibility\n\t\t\tif (options.tablesHeaderId || options.tableHeaderId) {\n\t\t\t\tid = ' id=\"' + header.replace(/ /g, \"_\").toLowerCase() + '\"';\n\t\t\t}\n\t\t\theader = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\theader,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\treturn \"<th\" + id + style + \">\" + header + \"</th>\\n\";\n\t\t}\n\n\t\tfunction parseCells(cell, style) {\n\t\t\tvar subText = showdown.subParser(\"makehtml.spanGamut\")(\n\t\t\t\tcell,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\treturn \"<td\" + style + \">\" + subText + \"</td>\\n\";\n\t\t}\n\n\t\tfunction buildTable(headers, cells) {\n\t\t\tvar tb = \"<table>\\n<thead>\\n<tr>\\n\",\n\t\t\t\ttblLgn = headers.length;\n\n\t\t\tfor (var i = 0; i < tblLgn; ++i) {\n\t\t\t\ttb += headers[i];\n\t\t\t}\n\t\t\ttb += \"</tr>\\n</thead>\\n<tbody>\\n\";\n\n\t\t\tfor (i = 0; i < cells.length; ++i) {\n\t\t\t\ttb += \"<tr>\\n\";\n\t\t\t\tfor (var ii = 0; ii < tblLgn; ++ii) {\n\t\t\t\t\ttb += cells[i][ii];\n\t\t\t\t}\n\t\t\t\ttb += \"</tr>\\n\";\n\t\t\t}\n\t\t\ttb += \"</tbody>\\n</table>\\n\";\n\t\t\treturn tb;\n\t\t}\n\n\t\tfunction parseTable(rawTable) {\n\t\t\tvar i,\n\t\t\t\ttableLines = rawTable.split(\"\\n\");\n\n\t\t\tfor (i = 0; i < tableLines.length; ++i) {\n\t\t\t\t// strip wrong first and last column if wrapped tables are used\n\t\t\t\tif (/^ {0,3}\\|/.test(tableLines[i])) {\n\t\t\t\t\ttableLines[i] = tableLines[i].replace(/^ {0,3}\\|/, \"\");\n\t\t\t\t}\n\t\t\t\tif (/\\|[ \\t]*$/.test(tableLines[i])) {\n\t\t\t\t\ttableLines[i] = tableLines[i].replace(/\\|[ \\t]*$/, \"\");\n\t\t\t\t}\n\t\t\t\t// parse code spans first, but we only support one line code spans\n\n\t\t\t\ttableLines[i] = showdown.subParser(\"makehtml.codeSpans\")(\n\t\t\t\t\ttableLines[i],\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tvar rawHeaders = tableLines[0].split(\"|\").map(function (s) {\n\t\t\t\t\treturn s.trim();\n\t\t\t\t}),\n\t\t\t\trawStyles = tableLines[1].split(\"|\").map(function (s) {\n\t\t\t\t\treturn s.trim();\n\t\t\t\t}),\n\t\t\t\trawCells = [],\n\t\t\t\theaders = [],\n\t\t\t\tstyles = [],\n\t\t\t\tcells = [];\n\n\t\t\ttableLines.shift();\n\t\t\ttableLines.shift();\n\n\t\t\tfor (i = 0; i < tableLines.length; ++i) {\n\t\t\t\tif (tableLines[i].trim() === \"\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\trawCells.push(\n\t\t\t\t\ttableLines[i].split(\"|\").map(function (s) {\n\t\t\t\t\t\treturn s.trim();\n\t\t\t\t\t}),\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (rawHeaders.length < rawStyles.length) {\n\t\t\t\treturn rawTable;\n\t\t\t}\n\n\t\t\tfor (i = 0; i < rawStyles.length; ++i) {\n\t\t\t\tstyles.push(parseStyles(rawStyles[i]));\n\t\t\t}\n\n\t\t\tfor (i = 0; i < rawHeaders.length; ++i) {\n\t\t\t\tif (showdown.helper.isUndefined(styles[i])) {\n\t\t\t\t\tstyles[i] = \"\";\n\t\t\t\t}\n\t\t\t\theaders.push(parseHeaders(rawHeaders[i], styles[i]));\n\t\t\t}\n\n\t\t\tfor (i = 0; i < rawCells.length; ++i) {\n\t\t\t\tvar row = [];\n\t\t\t\tfor (var ii = 0; ii < headers.length; ++ii) {\n\t\t\t\t\tif (showdown.helper.isUndefined(rawCells[i][ii])) {\n\t\t\t\t\t}\n\t\t\t\t\trow.push(parseCells(rawCells[i][ii], styles[ii]));\n\t\t\t\t}\n\t\t\t\tcells.push(row);\n\t\t\t}\n\n\t\t\treturn buildTable(headers, cells);\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.tables.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\t// find escaped pipe characters\n\t\ttext = text.replace(/\\\\(\\|)/g, showdown.helper.escapeCharactersCallback);\n\n\t\t// parse multi column tables\n\t\ttext = text.replace(tableRgx, parseTable);\n\n\t\t// parse one column tables\n\t\ttext = text.replace(singeColTblRgx, parseTable);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.tables.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\treturn text;\n\t});\n\n\tshowdown.subParser(\"makehtml.underline\", function (text, options, globals) {\n\t\t\"use strict\";\n\n\t\tif (!options.underline) {\n\t\t\treturn text;\n\t\t}\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.underline.before\", text, options, globals)\n\t\t\t.getText();\n\n\t\tif (options.literalMidWordUnderscores) {\n\t\t\ttext = text.replace(/\\b___(\\S[\\s\\S]*?)___\\b/g, function (wm, txt) {\n\t\t\t\treturn \"<u>\" + txt + \"</u>\";\n\t\t\t});\n\t\t\ttext = text.replace(/\\b__(\\S[\\s\\S]*?)__\\b/g, function (wm, txt) {\n\t\t\t\treturn \"<u>\" + txt + \"</u>\";\n\t\t\t});\n\t\t} else {\n\t\t\ttext = text.replace(/___(\\S[\\s\\S]*?)___/g, function (wm, m) {\n\t\t\t\treturn /\\S$/.test(m) ? \"<u>\" + m + \"</u>\" : wm;\n\t\t\t});\n\t\t\ttext = text.replace(/__(\\S[\\s\\S]*?)__/g, function (wm, m) {\n\t\t\t\treturn /\\S$/.test(m) ? \"<u>\" + m + \"</u>\" : wm;\n\t\t\t});\n\t\t}\n\n\t\t// escape remaining underscores to prevent them being parsed by italic and bold\n\t\ttext = text.replace(/(_)/g, showdown.helper.escapeCharactersCallback);\n\n\t\ttext = globals.converter\n\t\t\t._dispatch(\"makehtml.underline.after\", text, options, globals)\n\t\t\t.getText();\n\n\t\treturn text;\n\t});\n\n\t/**\n\t * Swap back in all the special characters we've hidden.\n\t */\n\tshowdown.subParser(\n\t\t\"makehtml.unescapeSpecialChars\",\n\t\tfunction (text, options, globals) {\n\t\t\t\"use strict\";\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.unescapeSpecialChars.before\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\n\t\t\ttext = text.replace(/¨E(\\d+)E/g, function (wholeMatch, m1) {\n\t\t\t\tvar charCodeToReplace = parseInt(m1);\n\t\t\t\treturn String.fromCharCode(charCodeToReplace);\n\t\t\t});\n\n\t\t\ttext = globals.converter\n\t\t\t\t._dispatch(\n\t\t\t\t\t\"makehtml.unescapeSpecialChars.after\",\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t)\n\t\t\t\t.getText();\n\t\t\treturn text;\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makeMarkdown.blockquote\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes()) {\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\tvar innerTxt = showdown.subParser(\"makeMarkdown.node\")(\n\t\t\t\t\tchildren[i],\n\t\t\t\t\tglobals,\n\t\t\t\t);\n\n\t\t\t\tif (innerTxt === \"\") {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\ttxt += innerTxt;\n\t\t\t}\n\t\t}\n\t\t// cleanup\n\t\ttxt = txt.trim();\n\t\ttxt = \"> \" + txt.split(\"\\n\").join(\"\\n> \");\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.codeBlock\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar lang = node.getAttribute(\"language\"),\n\t\t\tnum = node.getAttribute(\"precodenum\");\n\t\treturn \"```\" + lang + \"\\n\" + globals.preList[num] + \"\\n```\";\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.codeSpan\", function (node) {\n\t\t\"use strict\";\n\n\t\treturn \"`\" + node.innerHTML + \"`\";\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.emphasis\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes()) {\n\t\t\ttxt += \"*\";\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t}\n\t\t\ttxt += \"*\";\n\t\t}\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\n\t\t\"makeMarkdown.header\",\n\t\tfunction (node, globals, headerLevel) {\n\t\t\t\"use strict\";\n\n\t\t\tvar headerMark = new Array(headerLevel + 1).join(\"#\"),\n\t\t\t\ttxt = \"\";\n\n\t\t\tif (node.hasChildNodes()) {\n\t\t\t\ttxt = headerMark + \" \";\n\t\t\t\tvar children = node.childNodes,\n\t\t\t\t\tchildrenLength = children.length;\n\n\t\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn txt;\n\t\t},\n\t);\n\n\tshowdown.subParser(\"makeMarkdown.hr\", function () {\n\t\t\"use strict\";\n\n\t\treturn \"---\";\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.image\", function (node) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasAttribute(\"src\")) {\n\t\t\ttxt += \"![\" + node.getAttribute(\"alt\") + \"](\";\n\t\t\ttxt += \"<\" + node.getAttribute(\"src\") + \">\";\n\t\t\tif (node.hasAttribute(\"width\") && node.hasAttribute(\"height\")) {\n\t\t\t\ttxt +=\n\t\t\t\t\t\" =\" + node.getAttribute(\"width\") + \"x\" + node.getAttribute(\"height\");\n\t\t\t}\n\n\t\t\tif (node.hasAttribute(\"title\")) {\n\t\t\t\ttxt += ' \"' + node.getAttribute(\"title\") + '\"';\n\t\t\t}\n\t\t\ttxt += \")\";\n\t\t}\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.links\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes() && node.hasAttribute(\"href\")) {\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\t\t\ttxt = \"[\";\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t}\n\t\t\ttxt += \"](\";\n\t\t\ttxt += \"<\" + node.getAttribute(\"href\") + \">\";\n\t\t\tif (node.hasAttribute(\"title\")) {\n\t\t\t\ttxt += ' \"' + node.getAttribute(\"title\") + '\"';\n\t\t\t}\n\t\t\ttxt += \")\";\n\t\t}\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.list\", function (node, globals, type) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (!node.hasChildNodes()) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar listItems = node.childNodes,\n\t\t\tlistItemsLenght = listItems.length,\n\t\t\tlistNum = node.getAttribute(\"start\") || 1;\n\n\t\tfor (var i = 0; i < listItemsLenght; ++i) {\n\t\t\tif (\n\t\t\t\ttypeof listItems[i].tagName === \"undefined\" ||\n\t\t\t\tlistItems[i].tagName.toLowerCase() !== \"li\"\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// define the bullet to use in list\n\t\t\tvar bullet = \"\";\n\t\t\tif (type === \"ol\") {\n\t\t\t\tbullet = listNum.toString() + \". \";\n\t\t\t} else {\n\t\t\t\tbullet = \"- \";\n\t\t\t}\n\n\t\t\t// parse list item\n\t\t\ttxt +=\n\t\t\t\tbullet +\n\t\t\t\tshowdown.subParser(\"makeMarkdown.listItem\")(listItems[i], globals);\n\t\t\t++listNum;\n\t\t}\n\n\t\treturn txt.trim();\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.listItem\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar listItemTxt = \"\";\n\n\t\tvar children = node.childNodes,\n\t\t\tchildrenLenght = children.length;\n\n\t\tfor (var i = 0; i < childrenLenght; ++i) {\n\t\t\tlistItemTxt += showdown.subParser(\"makeMarkdown.node\")(\n\t\t\t\tchildren[i],\n\t\t\t\tglobals,\n\t\t\t);\n\t\t}\n\t\t// if it's only one liner, we need to add a newline at the end\n\t\tif (!/\\n$/.test(listItemTxt)) {\n\t\t\tlistItemTxt += \"\\n\";\n\t\t} else {\n\t\t\t// it's multiparagraph, so we need to indent\n\t\t\tlistItemTxt = listItemTxt\n\t\t\t\t.split(\"\\n\")\n\t\t\t\t.join(\"\\n    \")\n\t\t\t\t.replace(/^ {4}$/gm, \"\")\n\t\t\t\t.replace(/\\n\\n+/g, \"\\n\\n\");\n\t\t}\n\n\t\treturn listItemTxt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.node\", function (node, globals, spansOnly) {\n\t\t\"use strict\";\n\n\t\tspansOnly = spansOnly || false;\n\n\t\tvar txt = \"\";\n\n\t\t// edge case of text without wrapper paragraph\n\t\tif (node.nodeType === 3) {\n\t\t\treturn showdown.subParser(\"makeMarkdown.txt\")(node, globals);\n\t\t}\n\n\t\t// HTML comment\n\t\tif (node.nodeType === 8) {\n\t\t\treturn \"<!--\" + node.data + \"-->\\n\\n\";\n\t\t}\n\n\t\t// process only node elements\n\t\tif (node.nodeType !== 1) {\n\t\t\treturn \"\";\n\t\t}\n\n\t\tvar tagName = node.tagName.toLowerCase();\n\n\t\tswitch (tagName) {\n\t\t\t//\n\t\t\t// BLOCKS\n\t\t\t//\n\t\t\tcase \"h1\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 1) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"h2\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 2) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"h3\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 3) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"h4\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 4) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"h5\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 5) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase \"h6\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.header\")(node, globals, 6) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"p\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.paragraph\")(node, globals) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"blockquote\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.blockquote\")(node, globals) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"hr\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.hr\")(node, globals) + \"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"ol\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.list\")(node, globals, \"ol\") +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"ul\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.list\")(node, globals, \"ul\") +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"precode\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.codeBlock\")(node, globals) +\n\t\t\t\t\t\t\"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"pre\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.pre\")(node, globals) + \"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"table\":\n\t\t\t\tif (!spansOnly) {\n\t\t\t\t\ttxt =\n\t\t\t\t\t\tshowdown.subParser(\"makeMarkdown.table\")(node, globals) + \"\\n\\n\";\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t//\n\t\t\t// SPANS\n\t\t\t//\n\t\t\tcase \"code\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.codeSpan\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tcase \"em\":\n\t\t\tcase \"i\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.emphasis\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tcase \"strong\":\n\t\t\tcase \"b\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.strong\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tcase \"del\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.strikethrough\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tcase \"a\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.links\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tcase \"img\":\n\t\t\t\ttxt = showdown.subParser(\"makeMarkdown.image\")(node, globals);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\ttxt = node.outerHTML + \"\\n\\n\";\n\t\t}\n\n\t\t// common normalization\n\t\t// TODO eventually\n\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.paragraph\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes()) {\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t}\n\t\t}\n\n\t\t// some text normalization\n\t\ttxt = txt.trim();\n\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.pre\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar num = node.getAttribute(\"prenum\");\n\t\treturn \"<pre>\" + globals.preList[num] + \"</pre>\";\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.strikethrough\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes()) {\n\t\t\ttxt += \"~~\";\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t}\n\t\t\ttxt += \"~~\";\n\t\t}\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.strong\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (node.hasChildNodes()) {\n\t\t\ttxt += \"**\";\n\t\t\tvar children = node.childNodes,\n\t\t\t\tchildrenLength = children.length;\n\t\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(children[i], globals);\n\t\t\t}\n\t\t\ttxt += \"**\";\n\t\t}\n\t\treturn txt;\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.table\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\",\n\t\t\ttableArray = [[], []],\n\t\t\theadings = node.querySelectorAll(\"thead>tr>th\"),\n\t\t\trows = node.querySelectorAll(\"tbody>tr\"),\n\t\t\ti,\n\t\t\tii;\n\t\tfor (i = 0; i < headings.length; ++i) {\n\t\t\tvar headContent = showdown.subParser(\"makeMarkdown.tableCell\")(\n\t\t\t\t\theadings[i],\n\t\t\t\t\tglobals,\n\t\t\t\t),\n\t\t\t\tallign = \"---\";\n\n\t\t\tif (headings[i].hasAttribute(\"style\")) {\n\t\t\t\tvar style = headings[i]\n\t\t\t\t\t.getAttribute(\"style\")\n\t\t\t\t\t.toLowerCase()\n\t\t\t\t\t.replace(/\\s/g, \"\");\n\t\t\t\tswitch (style) {\n\t\t\t\t\tcase \"text-align:left;\":\n\t\t\t\t\t\tallign = \":---\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"text-align:right;\":\n\t\t\t\t\t\tallign = \"---:\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"text-align:center;\":\n\t\t\t\t\t\tallign = \":---:\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttableArray[0][i] = headContent.trim();\n\t\t\ttableArray[1][i] = allign;\n\t\t}\n\n\t\tfor (i = 0; i < rows.length; ++i) {\n\t\t\tvar r = tableArray.push([]) - 1,\n\t\t\t\tcols = rows[i].getElementsByTagName(\"td\");\n\n\t\t\tfor (ii = 0; ii < headings.length; ++ii) {\n\t\t\t\tvar cellContent = \" \";\n\t\t\t\tif (typeof cols[ii] !== \"undefined\") {\n\t\t\t\t\tcellContent = showdown.subParser(\"makeMarkdown.tableCell\")(\n\t\t\t\t\t\tcols[ii],\n\t\t\t\t\t\tglobals,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\ttableArray[r].push(cellContent);\n\t\t\t}\n\t\t}\n\n\t\tvar cellSpacesCount = 3;\n\t\tfor (i = 0; i < tableArray.length; ++i) {\n\t\t\tfor (ii = 0; ii < tableArray[i].length; ++ii) {\n\t\t\t\tvar strLen = tableArray[i][ii].length;\n\t\t\t\tif (strLen > cellSpacesCount) {\n\t\t\t\t\tcellSpacesCount = strLen;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor (i = 0; i < tableArray.length; ++i) {\n\t\t\tfor (ii = 0; ii < tableArray[i].length; ++ii) {\n\t\t\t\tif (i === 1) {\n\t\t\t\t\tif (tableArray[i][ii].slice(-1) === \":\") {\n\t\t\t\t\t\ttableArray[i][ii] =\n\t\t\t\t\t\t\tshowdown.helper.padEnd(\n\t\t\t\t\t\t\t\ttableArray[i][ii].slice(-1),\n\t\t\t\t\t\t\t\tcellSpacesCount - 1,\n\t\t\t\t\t\t\t\t\"-\",\n\t\t\t\t\t\t\t) + \":\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttableArray[i][ii] = showdown.helper.padEnd(\n\t\t\t\t\t\t\ttableArray[i][ii],\n\t\t\t\t\t\t\tcellSpacesCount,\n\t\t\t\t\t\t\t\"-\",\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttableArray[i][ii] = showdown.helper.padEnd(\n\t\t\t\t\t\ttableArray[i][ii],\n\t\t\t\t\t\tcellSpacesCount,\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\ttxt += \"| \" + tableArray[i].join(\" | \") + \" |\\n\";\n\t\t}\n\n\t\treturn txt.trim();\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.tableCell\", function (node, globals) {\n\t\t\"use strict\";\n\n\t\tvar txt = \"\";\n\t\tif (!node.hasChildNodes()) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar children = node.childNodes,\n\t\t\tchildrenLength = children.length;\n\n\t\tfor (var i = 0; i < childrenLength; ++i) {\n\t\t\ttxt += showdown.subParser(\"makeMarkdown.node\")(\n\t\t\t\tchildren[i],\n\t\t\t\tglobals,\n\t\t\t\ttrue,\n\t\t\t);\n\t\t}\n\t\treturn txt.trim();\n\t});\n\n\tshowdown.subParser(\"makeMarkdown.txt\", function (node) {\n\t\t\"use strict\";\n\n\t\tvar txt = node.nodeValue;\n\n\t\t// multiple spaces are collapsed\n\t\ttxt = txt.replace(/ +/g, \" \");\n\n\t\t// replace the custom ¨NBSP; with a space\n\t\ttxt = txt.replace(/¨NBSP;/g, \" \");\n\n\t\t// \", <, > and & should replace escaped html entities\n\t\ttxt = showdown.helper.unescapeHTMLEntities(txt);\n\n\t\t// escape markdown magic characters\n\t\t// emphasis, strong and strikethrough - can appear everywhere\n\t\t// we also escape pipe (|) because of tables\n\t\t// and escape ` because of code blocks and spans\n\t\ttxt = txt.replace(/([*_~|`])/g, \"\\\\$1\");\n\n\t\t// escape > because of blockquotes\n\t\ttxt = txt.replace(/^(\\s*)>/g, \"\\\\$1>\");\n\n\t\t// hash character, only troublesome at the beginning of a line because of headers\n\t\ttxt = txt.replace(/^#/gm, \"\\\\#\");\n\n\t\t// horizontal rules\n\t\ttxt = txt.replace(/^(\\s*)([-=]{3,})(\\s*)$/, \"$1\\\\$2$3\");\n\n\t\t// dot, because of ordered lists, only troublesome at the beginning of a line when preceded by an integer\n\t\ttxt = txt.replace(/^( {0,3}\\d+)\\./gm, \"$1\\\\.\");\n\n\t\t// +, * and -, at the beginning of a line becomes a list, so we need to escape them also (asterisk was already escaped)\n\t\ttxt = txt.replace(/^( {0,3})([+-])/gm, \"$1\\\\$2\");\n\n\t\t// images and links, ] followed by ( is problematic, so we escape it\n\t\ttxt = txt.replace(/]([\\s]*)\\(/g, \"\\\\]$1\\\\(\");\n\n\t\t// reference URIs must also be escaped\n\t\ttxt = txt.replace(/^ {0,3}\\[([\\S \\t]*?)]:/gm, \"\\\\[$1]:\");\n\n\t\treturn txt;\n\t});\n\n\t/**\n\t * Created by Estevao on 31-05-2015.\n\t */\n\n\t/**\n\t * Showdown Converter class\n\t * @class\n\t * @param {object} [converterOptions]\n\t * @returns {Converter}\n\t */\n\tshowdown.Converter = function (converterOptions) {\n\t\t\"use strict\";\n\n\t\tvar /**\n\t\t\t * Options used by this converter\n\t\t\t * @private\n\t\t\t * @type {{}}\n\t\t\t */\n\t\t\toptions = {},\n\t\t\t/**\n\t\t\t * Language extensions used by this converter\n\t\t\t * @private\n\t\t\t * @type {Array}\n\t\t\t */\n\t\t\tlangExtensions = [],\n\t\t\t/**\n\t\t\t * Output modifiers extensions used by this converter\n\t\t\t * @private\n\t\t\t * @type {Array}\n\t\t\t */\n\t\t\toutputModifiers = [],\n\t\t\t/**\n\t\t\t * Event listeners\n\t\t\t * @private\n\t\t\t * @type {{}}\n\t\t\t */\n\t\t\tlisteners = {},\n\t\t\t/**\n\t\t\t * The flavor set in this converter\n\t\t\t */\n\t\t\tsetConvFlavor = setFlavor,\n\t\t\t/**\n\t\t\t * Metadata of the document\n\t\t\t * @type {{parsed: {}, raw: string, format: string}}\n\t\t\t */\n\t\t\tmetadata = {\n\t\t\t\tparsed: {},\n\t\t\t\traw: \"\",\n\t\t\t\tformat: \"\",\n\t\t\t};\n\n\t\t_constructor();\n\n\t\t/**\n\t\t * Converter constructor\n\t\t * @private\n\t\t */\n\t\tfunction _constructor() {\n\t\t\tconverterOptions = converterOptions || {};\n\n\t\t\tfor (var gOpt in globalOptions) {\n\t\t\t\tif (globalOptions.hasOwnProperty(gOpt)) {\n\t\t\t\t\toptions[gOpt] = globalOptions[gOpt];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Merge options\n\t\t\tif (typeof converterOptions === \"object\") {\n\t\t\t\tfor (var opt in converterOptions) {\n\t\t\t\t\tif (converterOptions.hasOwnProperty(opt)) {\n\t\t\t\t\t\toptions[opt] = converterOptions[opt];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthrow Error(\n\t\t\t\t\t\"Converter expects the passed parameter to be an object, but \" +\n\t\t\t\t\t\ttypeof converterOptions +\n\t\t\t\t\t\t\" was passed instead.\",\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (options.extensions) {\n\t\t\t\tshowdown.helper.forEach(options.extensions, _parseExtension);\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Parse extension\n\t\t * @param {*} ext\n\t\t * @param {string} [name='']\n\t\t * @private\n\t\t */\n\t\tfunction _parseExtension(ext, name) {\n\t\t\tname = name || null;\n\t\t\t// If it's a string, the extension was previously loaded\n\t\t\tif (showdown.helper.isString(ext)) {\n\t\t\t\text = showdown.helper.stdExtName(ext);\n\t\t\t\tname = ext;\n\n\t\t\t\t// LEGACY_SUPPORT CODE\n\t\t\t\tif (showdown.extensions[ext]) {\n\t\t\t\t\tconsole.warn(\"DEPRECATION WARNING: \" + ext + \" = old extension\");\n\t\t\t\t\tlegacyExtensionLoading(showdown.extensions[ext], ext);\n\t\t\t\t\treturn;\n\t\t\t\t\t// END LEGACY SUPPORT CODE\n\t\t\t\t} else if (!showdown.helper.isUndefined(extensions[ext])) {\n\t\t\t\t\text = extensions[ext];\n\t\t\t\t} else {\n\t\t\t\t\tthrow Error(\n\t\t\t\t\t\t'Extension \"' + ext + '\" : not found or not a valid extension.',\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (typeof ext === \"function\") {\n\t\t\t\text = ext();\n\t\t\t}\n\n\t\t\tif (!showdown.helper.isArray(ext)) {\n\t\t\t\text = [ext];\n\t\t\t}\n\n\t\t\tvar validExt = validate(ext, name);\n\t\t\tif (!validExt.valid) {\n\t\t\t\tthrow Error(validExt.error);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < ext.length; ++i) {\n\t\t\t\tswitch (ext[i].type) {\n\t\t\t\t\tcase \"lang\":\n\t\t\t\t\t\tlangExtensions.push(ext[i]);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"output\":\n\t\t\t\t\t\toutputModifiers.push(ext[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif (ext[i].hasOwnProperty(\"listeners\")) {\n\t\t\t\t\tfor (var ln in ext[i].listeners) {\n\t\t\t\t\t\tif (ext[i].listeners.hasOwnProperty(ln)) {\n\t\t\t\t\t\t\tlisten(ln, ext[i].listeners[ln]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * LEGACY_SUPPORT\n\t\t * @param {*} ext\n\t\t * @param {string} name\n\t\t */\n\t\tfunction legacyExtensionLoading(ext, name) {\n\t\t\tif (typeof ext === \"function\") {\n\t\t\t\text = ext(new showdown.Converter());\n\t\t\t}\n\t\t\tif (!showdown.helper.isArray(ext)) {\n\t\t\t\text = [ext];\n\t\t\t}\n\t\t\tvar valid = validate(ext, name);\n\n\t\t\tif (!valid.valid) {\n\t\t\t\tthrow Error(valid.error);\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < ext.length; ++i) {\n\t\t\t\tswitch (ext[i].type) {\n\t\t\t\t\tcase \"lang\":\n\t\t\t\t\t\tlangExtensions.push(ext[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"output\":\n\t\t\t\t\t\toutputModifiers.push(ext[i]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault: // should never reach here\n\t\t\t\t\t\tthrow Error(\"Extension loader error: Type unrecognized!!!\");\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Listen to an event\n\t\t * @param {string} name\n\t\t * @param {function} callback\n\t\t */\n\t\tfunction listen(name, callback) {\n\t\t\tif (!showdown.helper.isString(name)) {\n\t\t\t\tthrow Error(\n\t\t\t\t\t\"Invalid argument in converter.listen() method: name must be a string, but \" +\n\t\t\t\t\t\ttypeof name +\n\t\t\t\t\t\t\" given\",\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (typeof callback !== \"function\") {\n\t\t\t\tthrow Error(\n\t\t\t\t\t\"Invalid argument in converter.listen() method: callback must be a function, but \" +\n\t\t\t\t\t\ttypeof callback +\n\t\t\t\t\t\t\" given\",\n\t\t\t\t);\n\t\t\t}\n\t\t\tname = name.toLowerCase();\n\t\t\tif (!listeners.hasOwnProperty(name)) {\n\t\t\t\tlisteners[name] = [];\n\t\t\t}\n\t\t\tlisteners[name].push(callback);\n\t\t}\n\n\t\tfunction rTrimInputText(text) {\n\t\t\tvar rsp = text.match(/^\\s*/)[0].length,\n\t\t\t\trgx = new RegExp(\"^\\\\s{0,\" + rsp + \"}\", \"gm\");\n\t\t\treturn text.replace(rgx, \"\");\n\t\t}\n\n\t\t/**\n\t\t *\n\t\t * @param {string} evtName Event name\n\t\t * @param {string} text Text\n\t\t * @param {{}} options Converter Options\n\t\t * @param {{}} globals Converter globals\n\t\t * @param {{}} pParams extra params for event\n\t\t * @returns showdown.helper.Event\n\t\t * @private\n\t\t */\n\t\tthis._dispatch = function dispatch(\n\t\t\tevtName,\n\t\t\ttext,\n\t\t\toptions,\n\t\t\tglobals,\n\t\t\tpParams,\n\t\t) {\n\t\t\tevtName = evtName.toLowerCase();\n\t\t\tvar params = pParams || {};\n\t\t\tparams.converter = this;\n\t\t\tparams.text = text;\n\t\t\tparams.options = options;\n\t\t\tparams.globals = globals;\n\t\t\tvar event = new showdown.helper.Event(evtName, text, params);\n\n\t\t\tif (listeners.hasOwnProperty(evtName)) {\n\t\t\t\tfor (var ei = 0; ei < listeners[evtName].length; ++ei) {\n\t\t\t\t\tvar nText = listeners[evtName][ei](event);\n\t\t\t\t\tif (nText && typeof nText !== \"undefined\") {\n\t\t\t\t\t\tevent.setText(nText);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn event;\n\t\t};\n\n\t\t/**\n\t\t * Listen to an event\n\t\t * @param {string} name\n\t\t * @param {function} callback\n\t\t * @returns {showdown.Converter}\n\t\t */\n\t\tthis.listen = function (name, callback) {\n\t\t\tlisten(name, callback);\n\t\t\treturn this;\n\t\t};\n\n\t\t/**\n\t\t * Converts a markdown string into HTML string\n\t\t * @param {string} text\n\t\t * @returns {*}\n\t\t */\n\t\tthis.makeHtml = function (text) {\n\t\t\t//check if text is not falsy\n\t\t\tif (!text) {\n\t\t\t\treturn text;\n\t\t\t}\n\n\t\t\tvar globals = {\n\t\t\t\tgHtmlBlocks: [],\n\t\t\t\tgHtmlMdBlocks: [],\n\t\t\t\tgHtmlSpans: [],\n\t\t\t\tgUrls: {},\n\t\t\t\tgTitles: {},\n\t\t\t\tgDimensions: {},\n\t\t\t\tgListLevel: 0,\n\t\t\t\thashLinkCounts: {},\n\t\t\t\tlangExtensions: langExtensions,\n\t\t\t\toutputModifiers: outputModifiers,\n\t\t\t\tconverter: this,\n\t\t\t\tghCodeBlocks: [],\n\t\t\t\tmetadata: {\n\t\t\t\t\tparsed: {},\n\t\t\t\t\traw: \"\",\n\t\t\t\t\tformat: \"\",\n\t\t\t\t},\n\t\t\t};\n\n\t\t\t// This lets us use ¨ trema as an escape char to avoid md5 hashes\n\t\t\t// The choice of character is arbitrary; anything that isn't\n\t\t\t// magic in Markdown will work.\n\t\t\ttext = text.replace(/¨/g, \"¨T\");\n\n\t\t\t// Replace $ with ¨D\n\t\t\t// RegExp interprets $ as a special character\n\t\t\t// when it's in a replacement string\n\t\t\ttext = text.replace(/\\$/g, \"¨D\");\n\n\t\t\t// Standardize line endings\n\t\t\ttext = text.replace(/\\r\\n/g, \"\\n\"); // DOS to Unix\n\t\t\ttext = text.replace(/\\r/g, \"\\n\"); // Mac to Unix\n\n\t\t\t// Stardardize line spaces\n\t\t\ttext = text.replace(/\\u00A0/g, \"&nbsp;\");\n\n\t\t\tif (options.smartIndentationFix) {\n\t\t\t\ttext = rTrimInputText(text);\n\t\t\t}\n\n\t\t\t// Make sure text begins and ends with a couple of newlines:\n\t\t\ttext = \"\\n\\n\" + text + \"\\n\\n\";\n\n\t\t\t// detab\n\t\t\ttext = showdown.subParser(\"makehtml.detab\")(text, options, globals);\n\n\t\t\t/**\n\t\t\t * Strip any lines consisting only of spaces and tabs.\n\t\t\t * This makes subsequent regexs easier to write, because we can\n\t\t\t * match consecutive blank lines with /\\n+/ instead of something\n\t\t\t * contorted like /[ \\t]*\\n+/\n\t\t\t */\n\t\t\ttext = text.replace(/^[ \\t]+$/gm, \"\");\n\n\t\t\t//run languageExtensions\n\t\t\tshowdown.helper.forEach(langExtensions, function (ext) {\n\t\t\t\ttext = showdown.subParser(\"makehtml.runExtension\")(\n\t\t\t\t\text,\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t// run the sub parsers\n\t\t\ttext = showdown.subParser(\"makehtml.metadata\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.hashPreCodeTags\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.githubCodeBlocks\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.hashHTMLBlocks\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.hashCodeTags\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.stripLinkDefinitions\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.blockGamut\")(text, options, globals);\n\t\t\ttext = showdown.subParser(\"makehtml.unhashHTMLSpans\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\t\t\ttext = showdown.subParser(\"makehtml.unescapeSpecialChars\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// attacklab: Restore dollar signs\n\t\t\ttext = text.replace(/¨D/g, \"$$\");\n\n\t\t\t// attacklab: Restore tremas\n\t\t\ttext = text.replace(/¨T/g, \"¨\");\n\n\t\t\t// render a complete html document instead of a partial if the option is enabled\n\t\t\ttext = showdown.subParser(\"makehtml.completeHTMLDocument\")(\n\t\t\t\ttext,\n\t\t\t\toptions,\n\t\t\t\tglobals,\n\t\t\t);\n\n\t\t\t// Run output modifiers\n\t\t\tshowdown.helper.forEach(outputModifiers, function (ext) {\n\t\t\t\ttext = showdown.subParser(\"makehtml.runExtension\")(\n\t\t\t\t\text,\n\t\t\t\t\ttext,\n\t\t\t\t\toptions,\n\t\t\t\t\tglobals,\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t// update metadata\n\t\t\tmetadata = globals.metadata;\n\t\t\treturn text;\n\t\t};\n\n\t\t/**\n\t\t * Converts an HTML string into a markdown string\n\t\t * @param src\n\t\t * @returns {string}\n\t\t */\n\t\tthis.makeMarkdown = function (src) {\n\t\t\t// replace \\r\\n with \\n\n\t\t\tsrc = src.replace(/\\r\\n/g, \"\\n\");\n\t\t\tsrc = src.replace(/\\r/g, \"\\n\"); // old macs\n\n\t\t\t// due to an edge case, we need to find this: > <\n\t\t\t// to prevent removing of non silent white spaces\n\t\t\t// ex: <em>this is</em> <strong>sparta</strong>\n\t\t\tsrc = src.replace(/>[ \\t]+</, \">¨NBSP;<\");\n\n\t\t\tvar doc = showdown.helper.document.createElement(\"div\");\n\t\t\tdoc.innerHTML = src;\n\n\t\t\tvar globals = {\n\t\t\t\tpreList: substitutePreCodeTags(doc),\n\t\t\t};\n\n\t\t\t// remove all newlines and collapse spaces\n\t\t\tclean(doc);\n\n\t\t\t// some stuff, like accidental reference links must now be escaped\n\t\t\t// TODO\n\t\t\t// doc.innerHTML = doc.innerHTML.replace(/\\[[\\S\\t ]]/);\n\n\t\t\tvar nodes = doc.childNodes,\n\t\t\t\tmdDoc = \"\";\n\n\t\t\tfor (var i = 0; i < nodes.length; i++) {\n\t\t\t\tmdDoc += showdown.subParser(\"makeMarkdown.node\")(nodes[i], globals);\n\t\t\t}\n\n\t\t\tfunction clean(node) {\n\t\t\t\tfor (var n = 0; n < node.childNodes.length; ++n) {\n\t\t\t\t\tvar child = node.childNodes[n];\n\t\t\t\t\tif (child.nodeType === 3) {\n\t\t\t\t\t\tif (!/\\S/.test(child.nodeValue)) {\n\t\t\t\t\t\t\tnode.removeChild(child);\n\t\t\t\t\t\t\t--n;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tchild.nodeValue = child.nodeValue.split(\"\\n\").join(\" \");\n\t\t\t\t\t\t\tchild.nodeValue = child.nodeValue.replace(/(\\s)+/g, \"$1\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (child.nodeType === 1) {\n\t\t\t\t\t\tclean(child);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// find all pre tags and replace contents with placeholder\n\t\t\t// we need this so that we can remove all indentation from html\n\t\t\t// to ease up parsing\n\t\t\tfunction substitutePreCodeTags(doc) {\n\t\t\t\tvar pres = doc.querySelectorAll(\"pre\"),\n\t\t\t\t\tpresPH = [];\n\n\t\t\t\tfor (var i = 0; i < pres.length; ++i) {\n\t\t\t\t\tif (\n\t\t\t\t\t\tpres[i].childElementCount === 1 &&\n\t\t\t\t\t\tpres[i].firstChild.tagName.toLowerCase() === \"code\"\n\t\t\t\t\t) {\n\t\t\t\t\t\tvar content = pres[i].firstChild.innerHTML.trim(),\n\t\t\t\t\t\t\tlanguage = pres[i].firstChild.getAttribute(\"data-language\") || \"\";\n\n\t\t\t\t\t\t// if data-language attribute is not defined, then we look for class language-*\n\t\t\t\t\t\tif (language === \"\") {\n\t\t\t\t\t\t\tvar classes = pres[i].firstChild.className.split(\" \");\n\t\t\t\t\t\t\tfor (var c = 0; c < classes.length; ++c) {\n\t\t\t\t\t\t\t\tvar matches = classes[c].match(/^language-(.+)$/);\n\t\t\t\t\t\t\t\tif (matches !== null) {\n\t\t\t\t\t\t\t\t\tlanguage = matches[1];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// unescape html entities in content\n\t\t\t\t\t\tcontent = showdown.helper.unescapeHTMLEntities(content);\n\n\t\t\t\t\t\tpresPH.push(content);\n\t\t\t\t\t\tpres[i].outerHTML =\n\t\t\t\t\t\t\t'<precode language=\"' +\n\t\t\t\t\t\t\tlanguage +\n\t\t\t\t\t\t\t'\" precodenum=\"' +\n\t\t\t\t\t\t\ti.toString() +\n\t\t\t\t\t\t\t'\"></precode>';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tpresPH.push(pres[i].innerHTML);\n\t\t\t\t\t\tpres[i].innerHTML = \"\";\n\t\t\t\t\t\tpres[i].setAttribute(\"prenum\", i.toString());\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn presPH;\n\t\t\t}\n\n\t\t\treturn mdDoc;\n\t\t};\n\n\t\t/**\n\t\t * Set an option of this Converter instance\n\t\t * @param {string} key\n\t\t * @param {*} value\n\t\t */\n\t\tthis.setOption = function (key, value) {\n\t\t\toptions[key] = value;\n\t\t};\n\n\t\t/**\n\t\t * Get the option of this Converter instance\n\t\t * @param {string} key\n\t\t * @returns {*}\n\t\t */\n\t\tthis.getOption = function (key) {\n\t\t\treturn options[key];\n\t\t};\n\n\t\t/**\n\t\t * Get the options of this Converter instance\n\t\t * @returns {{}}\n\t\t */\n\t\tthis.getOptions = function () {\n\t\t\treturn options;\n\t\t};\n\n\t\t/**\n\t\t * Add extension to THIS converter\n\t\t * @param {{}} extension\n\t\t * @param {string} [name=null]\n\t\t */\n\t\tthis.addExtension = function (extension, name) {\n\t\t\tname = name || null;\n\t\t\t_parseExtension(extension, name);\n\t\t};\n\n\t\t/**\n\t\t * Use a global registered extension with THIS converter\n\t\t * @param {string} extensionName Name of the previously registered extension\n\t\t */\n\t\tthis.useExtension = function (extensionName) {\n\t\t\t_parseExtension(extensionName);\n\t\t};\n\n\t\t/**\n\t\t * Set the flavor THIS converter should use\n\t\t * @param {string} name\n\t\t */\n\t\tthis.setFlavor = function (name) {\n\t\t\tif (!flavor.hasOwnProperty(name)) {\n\t\t\t\tthrow Error(name + \" flavor was not found\");\n\t\t\t}\n\t\t\tvar preset = flavor[name];\n\t\t\tsetConvFlavor = name;\n\t\t\tfor (var option in preset) {\n\t\t\t\tif (preset.hasOwnProperty(option)) {\n\t\t\t\t\toptions[option] = preset[option];\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Get the currently set flavor of this converter\n\t\t * @returns {string}\n\t\t */\n\t\tthis.getFlavor = function () {\n\t\t\treturn setConvFlavor;\n\t\t};\n\n\t\t/**\n\t\t * Remove an extension from THIS converter.\n\t\t * Note: This is a costly operation. It's better to initialize a new converter\n\t\t * and specify the extensions you wish to use\n\t\t * @param {Array} extension\n\t\t */\n\t\tthis.removeExtension = function (extension) {\n\t\t\tif (!showdown.helper.isArray(extension)) {\n\t\t\t\textension = [extension];\n\t\t\t}\n\t\t\tfor (var a = 0; a < extension.length; ++a) {\n\t\t\t\tvar ext = extension[a];\n\t\t\t\tfor (var i = 0; i < langExtensions.length; ++i) {\n\t\t\t\t\tif (langExtensions[i] === ext) {\n\t\t\t\t\t\tlangExtensions[i].splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (var ii = 0; ii < outputModifiers.length; ++i) {\n\t\t\t\t\tif (outputModifiers[ii] === ext) {\n\t\t\t\t\t\toutputModifiers[ii].splice(i, 1);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Get all extension of THIS converter\n\t\t * @returns {{language: Array, output: Array}}\n\t\t */\n\t\tthis.getAllExtensions = function () {\n\t\t\treturn {\n\t\t\t\tlanguage: langExtensions,\n\t\t\t\toutput: outputModifiers,\n\t\t\t};\n\t\t};\n\n\t\t/**\n\t\t * Get the metadata of the previously parsed document\n\t\t * @param raw\n\t\t * @returns {string|{}}\n\t\t */\n\t\tthis.getMetadata = function (raw) {\n\t\t\tif (raw) {\n\t\t\t\treturn metadata.raw;\n\t\t\t} else {\n\t\t\t\treturn metadata.parsed;\n\t\t\t}\n\t\t};\n\n\t\t/**\n\t\t * Get the metadata format of the previously parsed document\n\t\t * @returns {string}\n\t\t */\n\t\tthis.getMetadataFormat = function () {\n\t\t\treturn metadata.format;\n\t\t};\n\n\t\t/**\n\t\t * Private: set a single key, value metadata pair\n\t\t * @param {string} key\n\t\t * @param {string} value\n\t\t */\n\t\tthis._setMetadataPair = function (key, value) {\n\t\t\tmetadata.parsed[key] = value;\n\t\t};\n\n\t\t/**\n\t\t * Private: set metadata format\n\t\t * @param {string} format\n\t\t */\n\t\tthis._setMetadataFormat = function (format) {\n\t\t\tmetadata.format = format;\n\t\t};\n\n\t\t/**\n\t\t * Private: set metadata raw text\n\t\t * @param {string} raw\n\t\t */\n\t\tthis._setMetadataRaw = function (raw) {\n\t\t\tmetadata.raw = raw;\n\t\t};\n\t};\n\n\treturn showdown;\n}.call(this);\n\nexport default Showdown;\n","import Showdown from \"../lib/showdown.mjs\";\n\n// Extensions pour Showdown\n\nfunction fixSpoilerAdmonitionCodi(text) {\n\t// Dans CodiMD on peut définir le type de l'admonition spoiler en la mettant avant dans un autre admonition\n\tconst spoilerInAdmonitionRegex =\n\t\t/<div class=\"admonition \\w*?\"><div class=\"admonitionTitle\"><\\/div><div class=\"admonitionContent\">\\n(<div class=\"admonition spoiler\">`.*?`<\\/div>\\n<\\/div>)<\\/div>/s;\n\tconst spoilerMatch = text.match(spoilerInAdmonitionRegex);\n\tif (spoilerMatch) {\n\t\ttext = text.replace(spoilerMatch[0], spoilerMatch[1]);\n\t}\n\treturn text;\n}\n\n// Fonction pour remplacer les admonitions en Markdown par leur équivalent en HTML\nfunction processAdmonition(text, level) {\n\tconst colons = \":\".repeat(level);\n\t// Regex pour capturer les admonitions\n\tconst admonitionRegex = new RegExp(`${colons}(.+?)\\n${colons}(\\n|$)`, \"gms\");\n\tconst admonitions = text.match(admonitionRegex);\n\n\tif (admonitions) {\n\t\tlet lastAdmonitionPosition = 0;\n\t\tadmonitions.forEach((admonition) => {\n\t\t\t// On enregistre la position de l'admonition dans le texte pour pouvoir plus tard vérifier si l'admonition est dans un bloc code\n\t\t\tconst admonitionPosition = text.indexOf(admonition[0]);\n\t\t\t// On récupère les informations de l'admonition qui sont dans la première ligne\n\t\t\t// On récupère le type de l'admonition, l'effet collapsible s'il est utilisé, et le titre de l'admonition s'il est utilisé\n\t\t\tconst getAdmonitionInfosRegex = /:::(\\w+)( collapsible)?( .*)?/;\n\t\t\tconst admonitionFirstLine = admonition.slice(0, admonition.indexOf(\"\\n\"));\n\t\t\tconst admonitionInfos = admonitionFirstLine.match(\n\t\t\t\tgetAdmonitionInfosRegex,\n\t\t\t);\n\t\t\tif (admonitionInfos) {\n\t\t\t\t// Récupération du type de l'admonition\n\t\t\t\tconst typeAdmonition = admonitionInfos[1] ? admonitionInfos[1] : \"\";\n\t\t\t\t// Récupération de l'effet collapsible (optionnel)\n\t\t\t\tconst isCollapsible =\n\t\t\t\t\tadmonitionInfos[2] || typeAdmonition == \"spoiler\" ? true : false;\n\t\t\t\t// Récupération du titre (optionnel)\n\t\t\t\tconst titleAdmonition = admonitionInfos[3]\n\t\t\t\t\t? admonitionInfos[3].trim()\n\t\t\t\t\t: isCollapsible\n\t\t\t\t\t\t? \"Détails\"\n\t\t\t\t\t\t: \"\";\n\t\t\t\t// Vérifie si l'admonition est dans un bloc code en regardant autour\n\t\t\t\tconst before = text.substring(\n\t\t\t\t\tlastAdmonitionPosition,\n\t\t\t\t\tadmonitionPosition,\n\t\t\t\t);\n\t\t\t\tlastAdmonitionPosition = admonitionPosition;\n\t\t\t\tconst isInCode = /<code>|<pre>/.test(\n\t\t\t\t\tbefore.slice(before.lastIndexOf(\"<\")),\n\t\t\t\t);\n\t\t\t\t// Si l'admonition est dans un bloc de code, on ne fait rien\n\t\t\t\tif (isInCode) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// On construit le HTML de l'admonition\n\t\t\t\tlet admonitionHTML = \"\";\n\t\t\t\tlet contentAdmonition = admonition\n\t\t\t\t\t.replace(admonitionFirstLine, \"\")\n\t\t\t\t\t.trim();\n\t\t\t\t// On supprime dans le contenu la dernière ligne, qui correspond à la fermeture en Markdown de l'admonition\n\t\t\t\tcontentAdmonition = contentAdmonition.substring(\n\t\t\t\t\t0,\n\t\t\t\t\tcontentAdmonition.lastIndexOf(\"\\n\"),\n\t\t\t\t);\n\t\t\t\tif (isCollapsible) {\n\t\t\t\t\t// On affiche d'un coup, sans effet typewriter, le contenu interne de l'admonition si elle est collapsible\n\t\t\t\t\tadmonitionHTML = `<div class=\"admonition ${typeAdmonition}\">\\`<details><summary class=\"admonitionTitle\">${titleAdmonition}</summary><div class=\"admonitionContent\">\\n${contentAdmonition}\\n</div></details>\\`</div>\\n`;\n\t\t\t\t} else {\n\t\t\t\t\tadmonitionHTML = `<div class=\"admonition ${typeAdmonition}\"><div class=\"admonitionTitle\">${titleAdmonition}</div><div class=\"admonitionContent\">\\n${contentAdmonition}\\n</div></div>\\n`;\n\t\t\t\t}\n\t\t\t\ttext = text.replace(admonition, admonitionHTML);\n\t\t\t}\n\t\t});\n\t}\n\t// On applique le fix pour l'utilisation de spoiler avec CodiMD\n\ttext = fixSpoilerAdmonitionCodi(text);\n\treturn text;\n}\n\n// Gestion des admonitions (encadrés)\nfunction showdownExtensionAdmonitions() {\n\treturn [\n\t\t{\n\t\t\ttype: \"output\",\n\t\t\tfilter: (text) => {\n\t\t\t\t// Fix pour les admonitions qui finissent par une balise particulière\n\t\t\t\ttext = text.replace(/:::(<\\/li>)/g, \"$1\\n:::\");\n\t\t\t\t// Supprimer les balises <p> ou les balises <br /> autour ou à la fin des admonitions\n\t\t\t\ttext = text.replace(/(<p>)?(:::.*?)(<\\/p>|<br \\/>)/g, \"$2\");\n\t\t\t\tlet level = 3;\n\t\t\t\ttext = processAdmonition(text, level);\n\t\t\t\twhile (text.includes(\":\".repeat(level + 1))) {\n\t\t\t\t\tlevel = level + 1;\n\t\t\t\t\ttext = processAdmonition(text, level);\n\t\t\t\t}\n\t\t\t\treturn text;\n\t\t\t},\n\t\t},\n\t];\n}\n// Gestion des attributs génériques du type {.classe1 .classe2}\nfunction showdownExtensionGenericAttributes() {\n\treturn [\n\t\t{\n\t\t\ttype: \"output\",\n\t\t\tfilter: (text) => {\n\t\t\t\tconst regex = /<(\\w+)>(.*?){\\.(.*?)}/g;\n\t\t\t\tconst matches = text.match(regex);\n\t\t\t\tif (matches) {\n\t\t\t\t\tlet modifiedText = text;\n\t\t\t\t\tfor (const match of matches) {\n\t\t\t\t\t\tconst indexMatch = text.indexOf(match);\n\t\t\t\t\t\tconst endIndeMatch = indexMatch + match.length;\n\t\t\t\t\t\tconst isInCode =\n\t\t\t\t\t\t\ttext.substring(endIndeMatch, endIndeMatch + 7) == \"</code>\"\n\t\t\t\t\t\t\t\t? true\n\t\t\t\t\t\t\t\t: false;\n\t\t\t\t\t\tif (!isInCode) {\n\t\t\t\t\t\t\tconst matchInformations = regex.exec(match);\n\t\t\t\t\t\t\tconst classes = matchInformations[3].replaceAll(\".\", \"\");\n\t\t\t\t\t\t\tconst matchReplaced = match.replace(\n\t\t\t\t\t\t\t\tregex,\n\t\t\t\t\t\t\t\t`<$1 class=\"${classes}\">$2`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tmodifiedText = modifiedText.replaceAll(match, matchReplaced);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn modifiedText;\n\t\t\t\t} else {\n\t\t\t\t\treturn text;\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t];\n}\n\n// Extension Showdown pour autoriser les liens internes avec espaces\nfunction allowInternalLinksWithSpaces() {\n\treturn [\n\t\t{\n\t\t\ttype: \"output\",\n\t\t\tregex: /\\[([^\\]]+)\\]\\(#([^)]+)\\)/g, // Reconnaît les liens internes avec #\n\t\t\treplace: function (_, text, anchor) {\n\t\t\t\treturn `<a href=\"#${anchor}\">${text}</a>`;\n\t\t\t},\n\t\t},\n\t];\n}\n\n// Gestion du markdown dans les réponses du chatbot\nconst converter = new Showdown.Converter({\n\ttasklists: true,\n\temoji: true,\n\tparseImgDimensions: true,\n\tsimpleLineBreaks: true,\n\tsimplifiedAutoLink: true,\n\ttables: true,\n\topenLinksInNewWindow: true,\n\textensions: [\n\t\tshowdownExtensionAdmonitions,\n\t\tshowdownExtensionGenericAttributes,\n\t\tallowInternalLinksWithSpaces,\n\t],\n});\n\nfunction fixImageDimensionsCodiMD(md) {\n\tmd = md.replaceAll(/=x([0-9]*)\\)/g, \"=*x$1)\");\n\tmd = md.replaceAll(/=([0-9]*)x\\)/g, \"=$1x*)\");\n\treturn md;\n}\n\n// Conversion du Markdown en HTML\nexport function markdownToHTML(text) {\n\t// Fix pour les tableaux\n\ttext = text.replaceAll(\"\\n|\", \"|\");\n\t// gestion des dimensions des images avec la syntaxe CodiMD\n\ttext = fixImageDimensionsCodiMD(text);\n\t// Fix pour supprimer l'indentation avant les balises HTML afin d'éviter la transformation automatique en bloc code\n\ttext = text.replace(/^[ \\t]+(?=<[a-z])/gm, \"\");\n\tconst html = converter.makeHtml(text).replaceAll(\"&amp;#96\", \"`&#96`\");\n\treturn html;\n}\n","export function longestCommonSubstringWeightedLength(\n\tuserInput,\n\tkeyword,\n\twordLengthFactor = 0.1,\n) {\n\tlet longestCommonSubstring = \"\";\n\tlet longestCommonSubstringWeightedLength = 0;\n\tconst positionDecayFactor = 10; // Coefficient d'importance pour la position\n\n\tfor (let i = 0; i < userInput.length; i++) {\n\t\tfor (let j = 0; j < keyword.length; j++) {\n\t\t\tlet substringWeightedLength = 0;\n\t\t\tlet substring = \"\";\n\t\t\tlet substringLength = 0;\n\t\t\tlet x = i;\n\t\t\tlet y = j;\n\t\t\twhile (\n\t\t\t\tx < userInput.length &&\n\t\t\t\ty < keyword.length &&\n\t\t\t\tuserInput[x] === keyword[y]\n\t\t\t) {\n\t\t\t\tsubstring += userInput[x];\n\t\t\t\tx++;\n\t\t\t\ty++;\n\n\t\t\t\t// On calcule un poids en fonction de deux paramètres :\n\t\t\t\t// 1) Prise en compte de la position de la substring dans le keyword : plus la substring est au début du keyword, plus le poids est important\n\t\t\t\t// Idée = début d'un mot souvent plus important pour la signification que la fin\n\t\t\t\tconst positionDecay = j / keyword.length;\n\t\t\t\tsubstringLength = substring.length;\n\t\t\t\tconst positionFactor = 1 / (1 + positionDecay * positionDecayFactor);\n\t\t\t\t// 2) Prise en compte de la longueur de la substring : plus la substring est longue par rapport à la longueur initial du keyword, plus le poids est important\n\t\t\t\tconst lengthFactor = 1 / (1 + 1 * (keyword.length - substringLength));\n\t\t\t\t// Calcul du poids final\n\t\t\t\tconst positionWeight = positionFactor * lengthFactor;\n\n\t\t\t\t// Prise en compte d'une constante qui donne plus ou moins de poids à la longueur des keywords\n\t\t\t\tsubstringWeightedLength =\n\t\t\t\t\t(substringLength + substringLength * wordLengthFactor) *\n\t\t\t\t\tpositionWeight;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\tsubstringLength > 4 &&\n\t\t\t\tsubstringLength > longestCommonSubstring.length\n\t\t\t) {\n\t\t\t\tlongestCommonSubstring = substring;\n\t\t\t\tlongestCommonSubstringWeightedLength = substringWeightedLength;\n\t\t\t}\n\t\t}\n\t}\n\treturn longestCommonSubstringWeightedLength;\n}\n\nexport function levenshteinDistance(a, b) {\n\t/* Fonction pour calculer une similarité plutôt que d'en rester à une identité stricte */\n\tconst aLength = a.length;\n\tconst bLength = b.length;\n\tif (aLength === 0) return bLength;\n\tif (bLength === 0) return aLength;\n\n\tconst matrix = [];\n\tfor (let i = 0; i <= bLength; i++) {\n\t\tmatrix[i] = [i];\n\t}\n\n\tfor (let j = 0; j <= aLength; j++) {\n\t\tmatrix[0][j] = j;\n\t}\n\n\tfor (let i = 1; i <= bLength; i++) {\n\t\tfor (let j = 1; j <= aLength; j++) {\n\t\t\tconst cost = a[j - 1] === b[i - 1] ? 0 : 1;\n\t\t\tmatrix[i][j] = Math.min(\n\t\t\t\tmatrix[i - 1][j] + 1,\n\t\t\t\tmatrix[i][j - 1] + 1,\n\t\t\t\tmatrix[i - 1][j - 1] + cost,\n\t\t\t);\n\t\t}\n\t}\n\n\treturn matrix[bLength][aLength];\n}\n\nexport function hasLevenshteinDistanceLessThan(\n\tstring,\n\tkeyWord,\n\tdistance = 2,\n\twordLengthFactor = 0.1,\n\tngramLengthBoostCoefficient = 3,\n) {\n\tlet similarity = 0;\n\t// Divise keyWord en mots pour déterminer la longueur des n-grammes\n\tconst keyWordWords = keyWord.split(\" \");\n\tconst n = keyWordWords.length;\n\t// Divise la chaîne en un tableau de mots\n\tconst words = string.split(\" \");\n\n\t// Parcours les n-grammes de taille n dans la chaîne\n\tfor (let i = 0; i <= words.length - n; i++) {\n\t\t// Crée un n-gramme à partir de la sous-séquence des mots\n\t\tconst nGram = words.slice(i, i + n).join(\" \");\n\t\t// Calcule la distance de Levenshtein entre le n-gramme et keyWord\n\t\tconst distanceLevenshtein = levenshteinDistance(nGram, keyWord);\n\n\t\t// Si la distance est inférieure à la distance donnée, on augmente le score de similarité en fonction de la taille du n-gramme\n\t\tif (distanceLevenshtein < distance) {\n\t\t\tsimilarity =\n\t\t\t\tsimilarity +\n\t\t\t\tnGram.length * wordLengthFactor * ngramLengthBoostCoefficient;\n\t\t}\n\t}\n\treturn similarity;\n}\n\nexport function removeAccents(str) {\n\t// prettier-ignore\n\tconst accentMap = {\n\t\t\"à\": \"a\",\n\t\t\"â\": \"a\",\n\t\t\"é\": \"e\",\n\t\t\"è\": \"e\",\n\t\t\"ê\": \"e\",\n\t\t\"ë\": \"e\",\n\t\t\"î\": \"i\",\n\t\t\"ï\": \"i\",\n\t\t\"ô\": \"o\",\n\t\t\"ö\": \"o\",\n\t\t\"û\": \"u\",\n\t\t\"ù\": \"u\",\n\t\t\"ü\": \"u\",\n\t\t\"ÿ\": \"y\",\n\t\t\"ç\": \"c\",\n\t\t\"À\": \"A\",\n\t\t\"Â\": \"A\",\n\t\t\"É\": \"E\",\n\t\t\"È\": \"E\",\n\t\t\"Ê\": \"E\",\n\t\t\"Ë\": \"E\",\n\t\t\"Î\": \"I\",\n\t\t\"Ï\": \"I\",\n\t\t\"Ô\": \"O\",\n\t\t\"Ö\": \"O\",\n\t\t\"Û\": \"U\",\n\t\t\"Ù\": \"U\",\n\t\t\"Ü\": \"U\",\n\t\t\"Ÿ\": \"Y\",\n\t\t\"Ç\": \"C\",\n\t};\n\n\treturn str.replace(\n\t\t/[àâéèêëîïôöûùüÿçÀÂÉÈÊËÎÏÔÖÛÙÜŸÇ]/g,\n\t\t(match) => accentMap[match] || match,\n\t);\n}\n\n// Calcule le produit scalaire de deux vecteurs\nexport function dotProduct(vec1, vec2) {\n\tconst commonWords = new Set([...Object.keys(vec1), ...Object.keys(vec2)]);\n\tlet dot = 0;\n\tfor (const word of commonWords) {\n\t\tdot += (vec1[word] || 0) * (vec2[word] || 0);\n\t}\n\treturn dot;\n}\n\n// Calcule la magnitude d'un vecteur\nexport function magnitude(vec) {\n\tlet sum = 0;\n\tfor (const word in vec) {\n\t\tsum += vec[word] ** 2;\n\t}\n\treturn Math.sqrt(sum);\n}\n\n// Fonction pour diviser une chaîne de caractères en tokens, éventuellement en prenant en compte l'index de la réponse du Chatbot (pour prendre en compte différement les tokens présents dans le titre de la réponse)\nexport function tokenize(text, options) {\n\tconst prioritizeTokensInTitle = options && options.prioritizeTokensInTitle;\n\t// On garde d'abord seulement les mots d'au moins 5 caractères et on remplace les lettres accentuées par l'équivalent sans accent\n\tlet words = text ? text.toLowerCase() : \"\";\n\twords = words.replace(/,|\\.|:|\\?|!|\\(|\\)|\\[|\\||\\/\\]/g, \"\");\n\twords = words.replaceAll(\"/\", \" \");\n\twords = removeAccents(words);\n\twords =\n\t\twords\n\t\t\t.split(/\\s|'/)\n\t\t\t.map((word) => word.trim())\n\t\t\t.filter((word) => word.length >= 5) || [];\n\tconst tokens = [];\n\n\t// On va créer des tokens avec à chaque fois un poids associé\n\t// Plus le token est long, plus le poids du token est important\n\tconst weights = [0, 0, 0, 0, 0.4, 0.6, 0.8];\n\t// Si le token correspond au début du mot, le poids est plus important\n\tconst bonusStart = 0.2;\n\t// Si le token est présent dans le titre, le poids est très important, et encore plus si on a choisi l'option pour booster le poids dans le titre\n\tconst bonusInTitle = options && options.boostIfKeywordsInTitle ? 100 : 10;\n\t// Si le nombre de caractères du token est proche du nombre de caractères du mot de base, alors le poids est plus important\n\tconst bonusLengthSimilarity = 5;\n\n\tfunction weightedToken(index, tokenLength, word) {\n\t\tlet weight = tokenLength > weights.length ? 1 : weights[tokenLength - 1]; // Poids en fonction de la taille du token\n\t\tweight = index === 0 ? weight + bonusStart : weight; // Bonus si le token est en début du mot\n\t\t// Bonus si le token est proche en nombre de mots, du mot de base\n\t\tconst lengthDifference = word.length - tokenLength;\n\t\tweight =\n\t\t\tlengthDifference > 0\n\t\t\t\t? weight + bonusLengthSimilarity / lengthDifference\n\t\t\t\t: weight;\n\t\tlet token;\n\t\tif (lengthDifference == 0) {\n\t\t\tweight = weight + bonusLengthSimilarity;\n\t\t\ttoken = word;\n\t\t} else {\n\t\t\ttoken = word.substring(index, index + tokenLength);\n\t\t}\n\t\tif (prioritizeTokensInTitle) {\n\t\t\tconst titleResponse =\n\t\t\t\toptions && options.titleResponse\n\t\t\t\t\t? options.titleResponse.toLowerCase()\n\t\t\t\t\t: \"\";\n\t\t\t// Bonus si le token est dans le titre\n\t\t\tif (titleResponse.includes(token)) {\n\t\t\t\tweight = weight + bonusInTitle;\n\t\t\t}\n\t\t}\n\t\treturn { token, weight: weight };\n\t}\n\n\tconst wordsLength = words.length;\n\tfor (let wordIndex = 0; wordIndex < wordsLength; wordIndex++) {\n\t\tconst word = words[wordIndex];\n\t\t// Premier type de token : le mot en entier ; poids le plus important\n\t\tconst weightFullWord =\n\t\t\tMath.max(5, weightedToken(0, word.length, word).weight) || 5;\n\t\ttokens.push({\n\t\t\ttoken: word,\n\t\t\tweight: weightFullWord,\n\t\t});\n\t\t// Ensuite on intègre des tokens de 5, 6 et 7 caractères consécutifs pour détecter des racines communes\n\t\tconst wordLength = word.length;\n\t\tif (wordLength >= 5) {\n\t\t\tfor (let i = 0; i <= wordLength - 5; i++) {\n\t\t\t\ttokens.push(weightedToken(i, 5, word));\n\t\t\t}\n\t\t}\n\t\tif (wordLength >= 6) {\n\t\t\tfor (let i = 0; i <= wordLength - 6; i++) {\n\t\t\t\ttokens.push(weightedToken(i, 6, word));\n\t\t\t}\n\t\t}\n\t\tif (wordLength >= 7) {\n\t\t\tfor (let i = 0; i <= wordLength - 7; i++) {\n\t\t\t\ttokens.push(weightedToken(i, 7, word));\n\t\t\t}\n\t\t}\n\t}\n\treturn tokens;\n}\n\nexport function createVector(text, options) {\n\t// Fonction pour créer un vecteur pour chaque texte en prenant en compte le poids de chaque token et éventuellement l'index de la réponse du chatbot\n\tconst tokens = tokenize(text, options);\n\tconst vec = {};\n\tfor (const { token, weight } of tokens) {\n\t\tif (token) {\n\t\t\tvec[token] = (vec[token] || 0) + weight;\n\t\t}\n\t}\n\treturn vec;\n}\n\nexport function cosineSimilarity(str, vector, options) {\n\t// Calcul de similarité entre une chaîne de caractère (ce sera le message de l'utilisateur) et une autre chaîne de caractère déjà transformée en vecteur (c'est le vecteur de la réponse du chatbot)\n\n\t// Crée les vecteurs pour la chaîne de caractère (qui correspondra au message de l'utilisateur)\n\tconst vectorString = createVector(str, options);\n\n\t// Calcule la similarité cosinus\n\tconst dot = dotProduct(vectorString, vector);\n\tconst mag1 = magnitude(vectorString);\n\tconst mag2 = magnitude(vector);\n\n\tif (mag1 === 0 || mag2 === 0) {\n\t\treturn 0; // Évite la division par zéro\n\t} else {\n\t\treturn dot / (mag1 * mag2);\n\t}\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport {\n\tshouldBeRandomized,\n\trandomizeArrayWithFixedElements,\n} from \"../../../utils/arrays.mjs\";\nimport { processDirectiveSelect } from \"../../../markdown/custom/directives/select.mjs\";\nimport { obfuscateString } from \"../../../utils/strings.mjs\";\n\nexport function responseToSelectedChoiceOption(chatbot, choiceOptionLink) {\n\t// Gestion de la réponse à envoyer si on sélectionne une des options proposées\n\t// Si le lien est vide : on revient au message initial (permet un retour au menu initial)\n\tif (!choiceOptionLink) {\n\t\treturn chatbot.initialMessage;\n\t}\n\tconst chatbotResponses = chatbot.responses;\n\tconst chatbotResponsesLength = chatbotResponses.length;\n\tfor (let i = 0; i < chatbotResponsesLength; i++) {\n\t\tlet title = chatbotResponses[i].title;\n\t\ttitle = yaml.obfuscate ? obfuscateString(title) : title;\n\t\tif (choiceOptionLink == title) {\n\t\t\tlet response = chatbotResponses[i].content;\n\t\t\tconst choiceOptions = chatbotResponses[i].choiceOptions;\n\t\t\tresponse = Array.isArray(response) ? response.join(\"\\n\\n\") : response;\n\t\t\tchatbot.choiceOptionsLastResponse = choiceOptions;\n\t\t\tresponse = choiceOptions\n\t\t\t\t? processMessageWithChoiceOptions(chatbot, response, choiceOptions)\n\t\t\t\t: response;\n\t\t\treturn response;\n\t\t}\n\t}\n}\n\nexport function processMessageWithChoiceOptions(\n\tchatbot,\n\tresponse,\n\tchoiceOptions,\n) {\n\t// S'il y a la directive !Select: x on sélectionne aléatoirement seulement x options dans l'ensemble des options disponibles\n\t[response, choiceOptions] = processDirectiveSelect(response, choiceOptions);\n\n\t// On teste s'il faut mettre de l'aléatoire dans les options\n\tif (shouldBeRandomized(choiceOptions)) {\n\t\tchoiceOptions = randomizeArrayWithFixedElements(choiceOptions);\n\t}\n\tif (choiceOptions) {\n\t\tchatbot.choiceOptionsLastResponse = choiceOptions;\n\t\t// Gestion du cas où il y a un choix possible entre différentes options après la réponse du chatbot\n\t\tlet messageOptions = '\\n<ul class=\"messageOptions\">';\n\t\tconst choiceOptionsLength = choiceOptions.length;\n\t\tfor (let i = 0; i < choiceOptionsLength; i++) {\n\t\t\tconst choiceOption = choiceOptions[i];\n\t\t\t// Gestion des conditions d'affichage des options si le YAML dynamicContent est activé\n\t\t\tconst hasConditions =\n\t\t\t\tyaml && yaml.dynamicContent && choiceOption.condition;\n\t\t\t// On ajoute dans le message la syntaxe pour la condition d'affichage si elle existe\n\t\t\tmessageOptions =\n\t\t\t\tmessageOptions +\n\t\t\t\t(hasConditions ? \"\\n`if \" + choiceOption.condition + \"`\" : \"\") +\n\t\t\t\t'<li><a href=\"#' +\n\t\t\t\tchoiceOption.link +\n\t\t\t\t'\">' +\n\t\t\t\tchoiceOption.text +\n\t\t\t\t\"</a></li>\\n\" +\n\t\t\t\t(hasConditions ? \"\\n`endif`\" : \"\");\n\t\t}\n\t\tmessageOptions = messageOptions + \"</ul>\";\n\t\tresponse = response + messageOptions;\n\t} else {\n\t\tchatbot.choiceOptionsLastResponse = null;\n\t}\n\treturn response;\n}\n","import { shuffleArray } from \"../../../utils/arrays.mjs\";\n\n// Gestion de la directive \"!Select: x\" : on sélectionne aléatoirement seulement x options dans l'ensemble des options disponibles\nexport function processDirectiveSelect(response, choiceOptions) {\n\tresponse = response.replaceAll(/!Select ?: ?([0-9]*)/g, function (match, v1) {\n\t\tif (match && v1 <= choiceOptions.length) {\n\t\t\tchoiceOptions = shuffleArray(choiceOptions).slice(0, v1);\n\t\t\treturn \"<!--\" + match + \"-->\";\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t});\n\treturn [response, choiceOptions];\n}\n","function t(){return t=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var e=arguments[s];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])}return t},t.apply(this,arguments)}var s={strings:[\"These are the default values...\",\"You know what you should do?\",\"Use your own!\",\"Have a great day!\"],stringsElement:null,typeSpeed:0,startDelay:0,backSpeed:0,smartBackspace:!0,shuffle:!1,backDelay:700,fadeOut:!1,fadeOutClass:\"typed-fade-out\",fadeOutDelay:500,loop:!1,loopCount:Infinity,showCursor:!0,cursorChar:\"|\",autoInsertCss:!0,attr:null,bindInputFocusEvents:!1,contentType:\"html\",onBegin:function(t){},onComplete:function(t){},preStringTyped:function(t,s){},onStringTyped:function(t,s){},onLastStringBackspaced:function(t){},onTypingPaused:function(t,s){},onTypingResumed:function(t,s){},onReset:function(t){},onStop:function(t,s){},onStart:function(t,s){},onDestroy:function(t){}},e=new(/*#__PURE__*/function(){function e(){}var n=e.prototype;return n.load=function(e,n,i){if(e.el=\"string\"==typeof i?document.querySelector(i):i,e.options=t({},s,n),e.isInput=\"input\"===e.el.tagName.toLowerCase(),e.attr=e.options.attr,e.bindInputFocusEvents=e.options.bindInputFocusEvents,e.showCursor=!e.isInput&&e.options.showCursor,e.cursorChar=e.options.cursorChar,e.cursorBlinking=!0,e.elContent=e.attr?e.el.getAttribute(e.attr):e.el.textContent,e.contentType=e.options.contentType,e.typeSpeed=e.options.typeSpeed,e.startDelay=e.options.startDelay,e.backSpeed=e.options.backSpeed,e.smartBackspace=e.options.smartBackspace,e.backDelay=e.options.backDelay,e.fadeOut=e.options.fadeOut,e.fadeOutClass=e.options.fadeOutClass,e.fadeOutDelay=e.options.fadeOutDelay,e.isPaused=!1,e.strings=e.options.strings.map(function(t){return t.trim()}),e.stringsElement=\"string\"==typeof e.options.stringsElement?document.querySelector(e.options.stringsElement):e.options.stringsElement,e.stringsElement){e.strings=[],e.stringsElement.style.cssText=\"clip: rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px;\";var r=Array.prototype.slice.apply(e.stringsElement.children),o=r.length;if(o)for(var a=0;a<o;a+=1)e.strings.push(r[a].innerHTML.trim())}for(var u in e.strPos=0,e.currentElContent=this.getCurrentElContent(e),e.currentElContent&&e.currentElContent.length>0&&(e.strPos=e.currentElContent.length-1,e.strings.unshift(e.currentElContent)),e.sequence=[],e.strings)e.sequence[u]=u;e.arrayPos=0,e.stopNum=0,e.loop=e.options.loop,e.loopCount=e.options.loopCount,e.curLoop=0,e.shuffle=e.options.shuffle,e.pause={status:!1,typewrite:!0,curString:\"\",curStrPos:0},e.typingComplete=!1,e.autoInsertCss=e.options.autoInsertCss,e.autoInsertCss&&(this.appendCursorAnimationCss(e),this.appendFadeOutAnimationCss(e))},n.getCurrentElContent=function(t){return t.attr?t.el.getAttribute(t.attr):t.isInput?t.el.value:\"html\"===t.contentType?t.el.innerHTML:t.el.textContent},n.appendCursorAnimationCss=function(t){var s=\"data-typed-js-cursor-css\";if(t.showCursor&&!document.querySelector(\"[\"+s+\"]\")){var e=document.createElement(\"style\");e.setAttribute(s,\"true\"),e.innerHTML=\"\\n        .typed-cursor{\\n          opacity: 1;\\n        }\\n        .typed-cursor.typed-cursor--blink{\\n          animation: typedjsBlink 0.7s infinite;\\n          -webkit-animation: typedjsBlink 0.7s infinite;\\n                  animation: typedjsBlink 0.7s infinite;\\n        }\\n        @keyframes typedjsBlink{\\n          50% { opacity: 0.0; }\\n        }\\n        @-webkit-keyframes typedjsBlink{\\n          0% { opacity: 1; }\\n          50% { opacity: 0.0; }\\n          100% { opacity: 1; }\\n        }\\n      \",document.body.appendChild(e)}},n.appendFadeOutAnimationCss=function(t){var s=\"data-typed-fadeout-js-css\";if(t.fadeOut&&!document.querySelector(\"[\"+s+\"]\")){var e=document.createElement(\"style\");e.setAttribute(s,\"true\"),e.innerHTML=\"\\n        .typed-fade-out{\\n          opacity: 0;\\n          transition: opacity .25s;\\n        }\\n        .typed-cursor.typed-cursor--blink.typed-fade-out{\\n          -webkit-animation: 0;\\n          animation: 0;\\n        }\\n      \",document.body.appendChild(e)}},e}()),n=new(/*#__PURE__*/function(){function t(){}var s=t.prototype;return s.typeHtmlChars=function(t,s,e){if(\"html\"!==e.contentType)return s;var n=t.substring(s).charAt(0);if(\"<\"===n||\"&\"===n){var i;for(i=\"<\"===n?\">\":\";\";t.substring(s+1).charAt(0)!==i&&!(1+ ++s>t.length););s++}return s},s.backSpaceHtmlChars=function(t,s,e){if(\"html\"!==e.contentType)return s;var n=t.substring(s).charAt(0);if(\">\"===n||\";\"===n){var i;for(i=\">\"===n?\"<\":\"&\";t.substring(s-1).charAt(0)!==i&&!(--s<0););s--}return s},t}()),i=/*#__PURE__*/function(){function t(t,s){e.load(this,s,t),this.begin()}var s=t.prototype;return s.toggle=function(){this.pause.status?this.start():this.stop()},s.stop=function(){this.typingComplete||this.pause.status||(this.toggleBlinking(!0),this.pause.status=!0,this.options.onStop(this.arrayPos,this))},s.start=function(){this.typingComplete||this.pause.status&&(this.pause.status=!1,this.pause.typewrite?this.typewrite(this.pause.curString,this.pause.curStrPos):this.backspace(this.pause.curString,this.pause.curStrPos),this.options.onStart(this.arrayPos,this))},s.destroy=function(){this.reset(!1),this.options.onDestroy(this)},s.reset=function(t){void 0===t&&(t=!0),clearInterval(this.timeout),this.replaceText(\"\"),this.cursor&&this.cursor.parentNode&&(this.cursor.parentNode.removeChild(this.cursor),this.cursor=null),this.strPos=0,this.arrayPos=0,this.curLoop=0,t&&(this.insertCursor(),this.options.onReset(this),this.begin())},s.begin=function(){var t=this;this.options.onBegin(this),this.typingComplete=!1,this.shuffleStringsIfNeeded(this),this.insertCursor(),this.bindInputFocusEvents&&this.bindFocusEvents(),this.timeout=setTimeout(function(){0===t.strPos?t.typewrite(t.strings[t.sequence[t.arrayPos]],t.strPos):t.backspace(t.strings[t.sequence[t.arrayPos]],t.strPos)},this.startDelay)},s.typewrite=function(t,s){var e=this;this.fadeOut&&this.el.classList.contains(this.fadeOutClass)&&(this.el.classList.remove(this.fadeOutClass),this.cursor&&this.cursor.classList.remove(this.fadeOutClass));var i=this.humanizer(this.typeSpeed),r=1;!0!==this.pause.status?this.timeout=setTimeout(function(){s=n.typeHtmlChars(t,s,e);var i=0,o=t.substring(s);if(\"^\"===o.charAt(0)&&/^\\^\\d+/.test(o)){var a=1;a+=(o=/\\d+/.exec(o)[0]).length,i=parseInt(o),e.temporaryPause=!0,e.options.onTypingPaused(e.arrayPos,e),t=t.substring(0,s)+t.substring(s+a),e.toggleBlinking(!0)}if(\"`\"===o.charAt(0)){for(;\"`\"!==t.substring(s+r).charAt(0)&&(r++,!(s+r>t.length)););var u=t.substring(0,s),p=t.substring(u.length+1,s+r),c=t.substring(s+r+1);t=u+p+c,r--}e.timeout=setTimeout(function(){e.toggleBlinking(!1),s>=t.length?e.doneTyping(t,s):e.keepTyping(t,s,r),e.temporaryPause&&(e.temporaryPause=!1,e.options.onTypingResumed(e.arrayPos,e))},i)},i):this.setPauseStatus(t,s,!0)},s.keepTyping=function(t,s,e){0===s&&(this.toggleBlinking(!1),this.options.preStringTyped(this.arrayPos,this));var n=t.substring(0,s+=e);this.replaceText(n),this.typewrite(t,s)},s.doneTyping=function(t,s){var e=this;this.options.onStringTyped(this.arrayPos,this),this.toggleBlinking(!0),this.arrayPos===this.strings.length-1&&(this.complete(),!1===this.loop||this.curLoop===this.loopCount)||(this.timeout=setTimeout(function(){e.backspace(t,s)},this.backDelay))},s.backspace=function(t,s){var e=this;if(!0!==this.pause.status){if(this.fadeOut)return this.initFadeOut();this.toggleBlinking(!1);var i=this.humanizer(this.backSpeed);this.timeout=setTimeout(function(){s=n.backSpaceHtmlChars(t,s,e);var i=t.substring(0,s);if(e.replaceText(i),e.smartBackspace){var r=e.strings[e.arrayPos+1];e.stopNum=r&&i===r.substring(0,s)?s:0}s>e.stopNum?(s--,e.backspace(t,s)):s<=e.stopNum&&(e.arrayPos++,e.arrayPos===e.strings.length?(e.arrayPos=0,e.options.onLastStringBackspaced(),e.shuffleStringsIfNeeded(),e.begin()):e.typewrite(e.strings[e.sequence[e.arrayPos]],s))},i)}else this.setPauseStatus(t,s,!1)},s.complete=function(){this.options.onComplete(this),this.loop?this.curLoop++:this.typingComplete=!0},s.setPauseStatus=function(t,s,e){this.pause.typewrite=e,this.pause.curString=t,this.pause.curStrPos=s},s.toggleBlinking=function(t){this.cursor&&(this.pause.status||this.cursorBlinking!==t&&(this.cursorBlinking=t,t?this.cursor.classList.add(\"typed-cursor--blink\"):this.cursor.classList.remove(\"typed-cursor--blink\")))},s.humanizer=function(t){return Math.round(Math.random()*t/2)+t},s.shuffleStringsIfNeeded=function(){this.shuffle&&(this.sequence=this.sequence.sort(function(){return Math.random()-.5}))},s.initFadeOut=function(){var t=this;return this.el.className+=\" \"+this.fadeOutClass,this.cursor&&(this.cursor.className+=\" \"+this.fadeOutClass),setTimeout(function(){t.arrayPos++,t.replaceText(\"\"),t.strings.length>t.arrayPos?t.typewrite(t.strings[t.sequence[t.arrayPos]],0):(t.typewrite(t.strings[0],0),t.arrayPos=0)},this.fadeOutDelay)},s.replaceText=function(t){this.attr?this.el.setAttribute(this.attr,t):this.isInput?this.el.value=t:\"html\"===this.contentType?this.el.innerHTML=t:this.el.textContent=t},s.bindFocusEvents=function(){var t=this;this.isInput&&(this.el.addEventListener(\"focus\",function(s){t.stop()}),this.el.addEventListener(\"blur\",function(s){t.el.value&&0!==t.el.value.length||t.start()}))},s.insertCursor=function(){this.showCursor&&(this.cursor||(this.cursor=document.createElement(\"span\"),this.cursor.className=\"typed-cursor\",this.cursor.setAttribute(\"aria-hidden\",!0),this.cursor.innerHTML=this.cursorChar,this.el.parentNode&&this.el.parentNode.insertBefore(this.cursor,this.el.nextSibling)))},t}();export{i as default};\n//# sourceMappingURL=typed.module.js.map","import { chatContainer } from \"../../../shared/selectors.mjs\";\n\nconst thresholdMouseMovement = 10;\n\n// Active ou désactive la détection des mouvements pour l’auto-scroll\nexport function manageScrollDetection(enable, observer) {\n\tfunction scrollHandler(event) {\n\t\tif (\n\t\t\t// On désactive l'autoscroll dans 3 cas\n\t\t\t// 1er cas : si on a déplacé la souris (on évite les petits mouvements avec un treshold)\n\t\t\t(event.type === \"mousemove\" &&\n\t\t\t\t(Math.abs(event.movementX) > thresholdMouseMovement ||\n\t\t\t\t\tMath.abs(event.movementY) > thresholdMouseMovement)) ||\n\t\t\t// 2e cas : si on fait un mouvement vers le haut ou bien vers le bas, mais sans aller jusqu'au bas de la fenêtre\n\t\t\t(event.type === \"wheel\" &&\n\t\t\t\t(event.deltaY <= 0 ||\n\t\t\t\t\t(event.deltaY > 0 &&\n\t\t\t\t\t\twindow.scrollY + window.innerHeight <\n\t\t\t\t\t\t\tdocument.body.offsetHeight))) ||\n\t\t\t// 3e cas, sur un portable ou une tablette, si on touche l'écran\n\t\t\tevent.type === \"touchstart\"\n\t\t) {\n\t\t\tobserver.connected = false;\n\t\t\tobserver.mutationObserver.disconnect();\n\t\t\tremoveScrollListeners();\n\t\t\t// Sur un portable ou une tablette, on réactive le scroll si finalement on est revenu en bas de la page\n\t\t\tif (event.type === \"touchstart\") {\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (\n\t\t\t\t\t\twindow.scrollY + window.innerHeight + 200 >=\n\t\t\t\t\t\tdocument.documentElement.scrollHeight\n\t\t\t\t\t) {\n\t\t\t\t\t\tobserver.connected = true;\n\t\t\t\t\t\tobserver.mutationObserver.observe(chatContainer, observer.config);\n\t\t\t\t\t}\n\t\t\t\t}, 5000);\n\t\t\t}\n\t\t} else if (\n\t\t\t// On réactive l'autoscroll si on se déplace vers le bas jusqu'au bas de la fenêtre\n\t\t\tevent.type === \"wheel\" &&\n\t\t\tevent.deltaY > 0 &&\n\t\t\twindow.scrollY + window.innerHeight >= document.body.offsetHeight\n\t\t) {\n\t\t\tobserver.connected = true;\n\t\t\tobserver.mutationObserver.observe(chatContainer, observer.config);\n\t\t}\n\t}\n\n\tfunction addScrollListeners() {\n\t\tdocument.addEventListener(\"mousemove\", (event) => {\n\t\t\tscrollHandler(event);\n\t\t});\n\t\tdocument.addEventListener(\"wheel\", (event) => {\n\t\t\tscrollHandler(event);\n\t\t});\n\t\tdocument.addEventListener(\"touchstart\", (event) => {\n\t\t\tscrollHandler(event);\n\t\t});\n\t}\n\n\tfunction removeScrollListeners() {\n\t\tdocument.removeEventListener(\"mousemove\", scrollHandler);\n\t\tdocument.removeEventListener(\"wheel\", scrollHandler);\n\t\tdocument.removeEventListener(\"touchstart\", scrollHandler);\n\t}\n\n\tif (enable) {\n\t\taddScrollListeners();\n\t} else {\n\t\tremoveScrollListeners();\n\t}\n}\n","import { config } from \"../config.mjs\";\n\n// Constantes pour déterminer le type de navigateur utilisé et définir des comportements par défaut en fonction de ce paramètre\nexport const userAgent = window.navigator.userAgent;\nexport const isMobile =\n\t/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(\n\t\tuserAgent,\n\t);\n// Le focus automatique sur l'userInput est désactivé sur les téléphones mobiles\nexport const autoFocus = isMobile ? false : true;\nexport const isFirefoxOnWindows =\n\tuserAgent.includes(\"Firefox\") && userAgent.includes(\"Windows\");\n\n// Constantes pour l'effet de machine à écrire\nconst pauseTypeWriterValue = Math.max(config.defaultPauseTypeWriter, 100);\nexport const pauseTypeWriter = `^${pauseTypeWriterValue} `;\nexport const pauseTypeWriterMultipleBots = `^${pauseTypeWriterValue - 50} `; // Valeur qui doit être différente de pauseTypeWriter pour ne pas créer de conflit dans la fonction stopTypeWriter\n\nexport const regex = {\n\tpre: /(<pre(.|\\n)*<\\/pre>)/gm,\n\tmessageOptions: /(<ul class=\"messageOptions\">[\\s\\S]*<\\/ul>)/gm,\n\tiframe: /(<iframe(.|\\n)*<\\/iframe>)/gm,\n};\n","export function removeTypewriterPauses(html) {\n\treturn html.replace(/\\^\\d+/g, \"\");\n}\n\nexport function removeInstantDisplayDelimiters(html) {\n\treturn html.replaceAll(\"`\", \"\");\n}\n\nexport function cleanTypewriterSyntax(html) {\n\treturn removeTypewriterPauses(removeInstantDisplayDelimiters(html));\n}\n","import { scrollWindow } from \"../../../utils/ui.mjs\";\nimport { manageScrollDetection } from \"../helpers/scroll.mjs\";\nimport {\n\tpauseTypeWriter,\n\tpauseTypeWriterMultipleBots,\n\tregex,\n} from \"../../../shared/constants.mjs\";\nimport {\n\tremoveInstantDisplayDelimiters,\n\tremoveTypewriterPauses,\n} from \"./sanitize.mjs\";\n\n// Formate le contenu quand on veut utiliser la fonction stopwriter\nfunction formatContentStopTypeWriter(content) {\n\t// On enlève les marqueurs de texte à afficher immédiatement (car on va en ajouter pour chaque paragraphe), mais on les conserve pour les choix d'options en fin de réponse\n\tcontent = removeInstantDisplayDelimiters(content).replace(\n\t\tregex.messageOptions,\n\t\t\"`$1`\",\n\t);\n\t// On doit conserver les retours à la ligne dans les blocs \"pre\"\n\tconst contentKeepReturnInCode = content.replaceAll(\n\t\tregex.pre,\n\t\tfunction (match) {\n\t\t\treturn match.replaceAll(\"\\n\", \"RETURNCHARACTER\");\n\t\t},\n\t);\n\tconst contentArray = contentKeepReturnInCode.split(\"\\n\");\n\t// On découpe chaque paragraphe pour pouvoir ensuite l'afficher d'un coup\n\tconst contentArrayFiltered = contentArray.map((element) =>\n\t\telement.startsWith(pauseTypeWriter)\n\t\t\t? element\n\t\t\t\t\t.replace(pauseTypeWriter, \"\")\n\t\t\t\t\t.replaceAll(\"RETURNCHARACTER\", \"\\n\") + \"`\"\n\t\t\t: element.endsWith(\"`\")\n\t\t\t\t? \"`\" + element.replaceAll(\"RETURNCHARACTER\", \"\\n\")\n\t\t\t\t: \"`\" +\n\t\t\t\t\telement\n\t\t\t\t\t\t.replaceAll(\"RETURNCHARACTER\", \"\\n\")\n\t\t\t\t\t\t.replace(pauseTypeWriterMultipleBots, \"\") +\n\t\t\t\t\t\"`\",\n\t);\n\treturn removeTypewriterPauses(contentArrayFiltered.join(\" \"));\n}\n\n// Pour stopper l'effet machine à écrire (en appuyant sur “Enter”)\nexport function stopTypeWriter(content, typedElement, observer) {\n\tdocument.body.classList.remove(\"typewriter-active\");\n\ttypedElement.stop();\n\ttypedElement.reset();\n\tcontent = formatContentStopTypeWriter(content);\n\ttypedElement.strings = [content];\n\ttypedElement.start();\n\ttypedElement.destroy();\n\tscrollWindow({ scrollMode: \"instant\" });\n\tmanageScrollDetection(false, observer);\n}\n","import Typed from \"../../../lib/typed.mjs\";\nimport { manageScrollDetection } from \"../helpers/scroll.mjs\";\nimport { stopTypeWriter } from \"./stop.mjs\";\nimport { splitHtmlIntoChunks } from \"../../../utils/strings.mjs\";\nimport {\n\tchatContainer,\n\tsendButton,\n\tuserInput,\n} from \"../../../shared/selectors.mjs\";\nimport {\n\tpauseTypeWriter,\n\tautoFocus,\n\tisMobile,\n\tisFirefoxOnWindows,\n\tregex,\n} from \"../../../shared/constants.mjs\";\nimport { scrollWindow } from \"../../../utils/ui.mjs\";\nimport { yaml } from \"../../../markdown/custom/yaml.mjs\";\n\n// Configuration de l'observer\nlet observer = {\n\tconfig: {\n\t\tchildList: true,\n\t\tsubtree: true,\n\t},\n};\n\nconst messageTypeEnterToStopTypeWriter = isMobile\n\t? \"Clic sur “Envoyer” pour stopper l'effet “machine à écrire”\"\n\t: window.innerWidth > 880\n\t\t? \"Appuyez sur “Enter” pour stopper l'effet “machine à écrire” et afficher la réponse immédiatement\"\n\t\t: \"“Enter” pour stopper l'effet “machine à écrire”\";\n\nlet typed;\n\n// Effet machine à écrire\nexport function startTypeWriter(content, element, accelerateFactor) {\n\tdocument.body.classList.add(\"typewriter-active\");\n\treturn new Promise((resolve) => {\n\t\tfunction keypressHandler(event) {\n\t\t\tif (event.key === \"Enter\") {\n\t\t\t\tobserver.mutationObserver.disconnect();\n\t\t\t\tobserver.connected = false;\n\t\t\t\tstopTypeWriter(content, typed);\n\t\t\t}\n\t\t}\n\n\t\t// S'il y a des options en fin de message, on les fait apparaître d'un coup, sans effet typeWriter\n\t\tcontent = content.replace(regex.messageOptions, pauseTypeWriter + \"`$1`\");\n\n\t\t// On fait apparaître d'un coup les iframes\n\t\tcontent = content.replaceAll(regex.iframe, \"`$1`\");\n\n\t\t// Fix pour les URL avec des paramètres : il faut remplacer le caractère \"&\" dans le texte du lien, par \"&amp;\"\n\t\tcontent = content.replace(/>(http.*?)<\\/a>/gi, (match, url) =>\n\t\t\turl.includes(\"&\") ? \">\" + url.replaceAll(\"&\", \"&amp;\") + \"</a>\" : match,\n\t\t);\n\n\t\t// On peut accéler l'effet machine à écrire en regroupant les caractères : au lieu de les afficher un par, on les affiche N par N (N = le facteur d'accélération)\n\t\tif (accelerateFactor) {\n\t\t\tcontent = splitHtmlIntoChunks(content, accelerateFactor);\n\t\t} else {\n\t\t\t// Accélération par défaut pour Firefox sur Windows\n\t\t\tif (isFirefoxOnWindows) {\n\t\t\t\tcontent = splitHtmlIntoChunks(content, 5);\n\t\t\t}\n\t\t}\n\n\t\tconst start = Date.now();\n\t\tobserver.connected = true;\n\t\tlet watchExecutionTime = true;\n\t\tfunction handleMutation() {\n\t\t\t// On arrête l'effet “machine à écrire” si le temps d'exécution est trop important\n\t\t\tif (watchExecutionTime) {\n\t\t\t\tconst executionTime = Date.now() - start;\n\t\t\t\tconst checkpointTime = 1000;\n\t\t\t\tconst minCharLength = 80;\n\t\t\t\tif (executionTime > checkpointTime && observer.connected) {\n\t\t\t\t\tif (element.innerHTML.length < minCharLength) {\n\t\t\t\t\t\tstopTypeWriter(content, typed);\n\t\t\t\t\t\tobserver.connected = false;\n\t\t\t\t\t\tobserver.mutationObserver.disconnect();\n\t\t\t\t\t}\n\t\t\t\t\twatchExecutionTime = false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// On scrolle automatiquement la fenêtre pour suivre l'affichage du texte\n\t\t\tif (observer.connected) {\n\t\t\t\tscrollWindow({ scrollMode: \"smooth\" });\n\t\t\t}\n\t\t}\n\n\t\t// Effet machine à écrire\n\t\ttyped = new Typed(element, {\n\t\t\tstrings: [content],\n\t\t\ttypeSpeed: 0,\n\t\t\tstartDelay: 100,\n\t\t\tshowCursor: false,\n\t\t\tonBegin: () => {\n\t\t\t\t// Si on a désactivé le clavier, on remet l'opacité du bouton à 1 pour pouvoir voir le bouton \"Afficher tout\"\n\t\t\t\tif (yaml && yaml.userInput == false) {\n\t\t\t\t\tsendButton.style.opacity = \"1\";\n\t\t\t\t}\n\t\t\t\t// Quand l'effet démarre, on refocalise sur userInput (sauf sur les smartphones)\n\t\t\t\tif (autoFocus) {\n\t\t\t\t\tuserInput.focus();\n\t\t\t\t}\n\t\t\t\t// On détecte un appui sur Enter pour stopper l'effet machine à écrire\n\t\t\t\tuserInput.addEventListener(\"keypress\", keypressHandler);\n\t\t\t\tuserInput.setAttribute(\"placeholder\", messageTypeEnterToStopTypeWriter);\n\n\t\t\t\t// On détecte le remplissage petit à petit du DOM pour scroller automatiquement la fenêtre vers le bas\n\t\t\t\tobserver.mutationObserver = new MutationObserver(handleMutation);\n\t\t\t\tobserver.connected = true;\n\t\t\t\tobserver.mutationObserver.observe(chatContainer, observer.config);\n\t\t\t\tsetTimeout(() => manageScrollDetection(true, observer), 1000);\n\t\t\t},\n\t\t\tonComplete: () => {\n\t\t\t\tdocument.body.classList.remove(\"typewriter-active\");\n\t\t\t\t// Si on a désactivé le clavier, on remet l'opacité du bouton à 0.5 pour pouvoir voir en grisé le bouton \"Afficher tout\"\n\t\t\t\tif (\n\t\t\t\t\tyaml.userInput == false &&\n\t\t\t\t\tdocument.body.classList.contains(\"hideControls\")\n\t\t\t\t) {\n\t\t\t\t\tsendButton.style.opacity = \"0.5\";\n\t\t\t\t}\n\t\t\t\t// Quand l'effet s'arrête on supprime la détection du bouton Enter pour stopper l'effet\n\t\t\t\tuserInput.removeEventListener(\"keypress\", keypressHandler);\n\t\t\t\tif (\n\t\t\t\t\tuserInput.getAttribute(\"placeholder\") ==\n\t\t\t\t\tmessageTypeEnterToStopTypeWriter\n\t\t\t\t) {\n\t\t\t\t\tuserInput.setAttribute(\"placeholder\", \"Écrivez votre message\");\n\t\t\t\t}\n\t\t\t\tobserver.connected = false;\n\t\t\t\tobserver.mutationObserver.disconnect();\n\t\t\t\tmanageScrollDetection(false, observer);\n\t\t\t\tresolve();\n\t\t\t},\n\t\t});\n\t});\n}\n","import { chatContainer } from \"../../../shared/selectors.mjs\";\n\nconst defaultContainer = chatContainer;\n\n// Par défaut on affiche le message comme un nouveau message dans le chat, mais on peut définir un container (pour afficher le message comme un élément enfant d'un nouveau message en cas de génération de message à la fois via le markdown et un LLM : dans ce cas, il faut que le contenu des messages se suivent, dans un même message, au lieu d'ajouter un nouveau message à chaque fois)\nexport function appendMessageToContainer(htmlMessage, customContainer) {\n\tif (customContainer && customContainer != defaultContainer) {\n\t\tdefaultContainer.appendChild(customContainer);\n\t\tcustomContainer.appendChild(htmlMessage);\n\t} else {\n\t\tdefaultContainer.appendChild(htmlMessage);\n\t}\n}\n\nlet idMessage = 0;\n\nexport function createMessageElement(isUser) {\n\tconst el = document.createElement(\"div\");\n\tel.classList.add(\"message\", isUser ? \"user-message\" : \"bot-message\");\n\tel.id = \"message-\" + idMessage;\n\tidMessage++;\n\treturn el;\n}\n","import { yaml } from \"./custom/yaml.mjs\";\n\nexport function convertLatexExpressions(string, noBackticks) {\n\tstring = string\n\t\t.replace(/\\$\\$(.*?)\\$\\$/gs, function (_, latexContent) {\n\t\t\tlatexContent = latexContent\n\t\t\t\t.replace(/<\\/?p>/g, \"\")\n\t\t\t\t.replace(/<\\/?pre>/g, \"\")\n\t\t\t\t.replace(/<\\/?code>/g, \"\")\n\t\t\t\t.replace(/\\n/g, \" \");\n\t\t\treturn \"&#92;[\" + latexContent + \"&#92;]\";\n\t\t})\n\t\t.replace(/\\$(.*?)\\$/g, \"&#92;($1&#92;)\");\n\tlet expressionsLatex = string.match(\n\t\tnew RegExp(/&#92;\\[.*?&#92;\\]|&#92;\\(.*?&#92;\\)/g),\n\t);\n\tif (expressionsLatex) {\n\t\t// On n'utilise Katex que s'il y a des expressions en Latex dans le Markdown\n\t\tfor (let expressionLatex of expressionsLatex) {\n\t\t\t// On vérifie le mode d'affichage de l'expression (inline ou block)\n\t\t\tconst inlineMaths = expressionLatex.includes(\"&#92;[\") ? true : false;\n\t\t\t// On récupère la formule mathématique\n\t\t\tlet mathInExpressionLatex = expressionLatex\n\t\t\t\t.replace(\"&#92;[\", \"\")\n\t\t\t\t.replace(\"&#92;]\", \"\")\n\t\t\t\t.replace(\"&#92;(\", \"\")\n\t\t\t\t.replace(\"&#92;)\", \"\")\n\t\t\t\t.replaceAll(\"&lt;\", \"\\\\lt\")\n\t\t\t\t.replaceAll(\"&gt;\", \"\\\\gt\")\n\t\t\t\t.replaceAll(\"align<em>\", \"align*\")\n\t\t\t\t.replaceAll(\"align</em>\", \"align*\")\n\t\t\t\t.replaceAll(\"<em>\", \"_\")\n\t\t\t\t.replaceAll(\"</em>\", \"_\")\n\t\t\t\t.replaceAll(\"&amp;\", \"&\")\n\t\t\t\t.replaceAll(\"\\\\left{\", \"\\\\left\\\\{\")\n\t\t\t\t.replaceAll(\"\\\\right}\", \"\\\\right\\\\}\")\n\t\t\t\t.replaceAll(\" \", \"\\\\ \")\n\t\t\t\t.replaceAll(\"&#92;&#92;\", \"\\\\\\\\\")\n\t\t\t\t.replaceAll(\"<br>\", \"\")\n\t\t\t\t.replaceAll(\"equation_}\", \"equation}\");\n\n\t\t\t// On convertit la formule mathématique en HTML avec Katex\n\t\t\tif (window.katex) {\n\t\t\t\ttry {\n\t\t\t\t\tconst stringWithLatex = window.katex.renderToString(\n\t\t\t\t\t\tmathInExpressionLatex,\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdisplayMode: inlineMaths,\n\t\t\t\t\t\t},\n\t\t\t\t\t);\n\t\t\t\t\tstring = string.replace(expressionLatex, stringWithLatex);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tif (error instanceof window.katex.ParseError) {\n\t\t\t\t\t\tconst rendered =\n\t\t\t\t\t\t\t`Error in LaTeX '${mathInExpressionLatex}': ${error.message}`\n\t\t\t\t\t\t\t\t.replace(/&/g, \"&\")\n\t\t\t\t\t\t\t\t.replace(/</g, \"<\")\n\t\t\t\t\t\t\t\t.replace(/>/g, \">\");\n\t\t\t\t\t\tstring = string.replace(expressionLatex, rendered);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// Optimisation pour le Latex avec l'effet typeWriter\n\t// On peut empêcher l'utilisation des backticks en mettant noBackticks à \"true\"\n\tif (yaml && yaml.typeWriter === true && !noBackticks) {\n\t\tstring = string.replaceAll(\n\t\t\t/(<span class=\"katex-mathml\">(.|\\n)*?<\\/span>)/gm,\n\t\t\t\"`$1`\",\n\t\t);\n\t\tstring = string.replaceAll(/(<span class=\".?strut\">.*?<\\/span>)/g, \"`$1`\");\n\t}\n\treturn string;\n}\n","import { yaml } from \"../../../../markdown/custom/yaml.mjs\";\n\nexport function processLightbox() {\n\tif (yaml && yaml.plugins && yaml.plugins.includes(\"lightbox\")) {\n\t\tconst interval = setInterval(() => {\n\t\t\tif (window.lightbox) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\twindow.lightbox();\n\t\t\t}\n\t\t}, 500);\n\t}\n}\n","import { yaml } from \"../../../../markdown/custom/yaml.mjs\";\nimport { chatContainer } from \"../../../../shared/selectors.mjs\";\n\nexport function textFitForMathBlocks(messageElement) {\n\t// Gestion de textFit pour les éléments en Latex\n\tif (yaml && yaml.plugins && yaml.plugins.includes(\"textFit\")) {\n\t\tconst mathBlocks = Array.from(\n\t\t\tmessageElement.querySelectorAll(\".katex-display\"),\n\t\t);\n\t\tconst overflowingMathBlocks = mathBlocks.filter((el) => {\n\t\t\treturn el.scrollWidth > chatContainer.clientWidth;\n\t\t});\n\t\twindow.textFit(overflowingMathBlocks, {\n\t\t\twidthOnly: true,\n\t\t\tminFontSize: 11,\n\t\t});\n\t}\n}\n","import { yaml } from \"../../markdown/custom/yaml.mjs\";\nimport { markdownToHTML } from \"../../markdown/parser.mjs\";\nimport { processCopyCode } from \"./helpers/plugins/copyCode.mjs\";\nimport { startTypeWriter } from \"./typewriter/start.mjs\";\nimport { checkTypewriterPreferences } from \"./typewriter/checkPreferences.mjs\";\nimport { cleanTypewriterSyntax } from \"./typewriter/sanitize.mjs\";\nimport { appendMessageToContainer } from \"./helpers/dom.mjs\";\nimport { waitForKaTeX } from \"./helpers/plugins/waitForKatex.mjs\";\nimport { convertLatexExpressions } from \"../../markdown/latex.mjs\";\nimport { processMultipleBots } from \"../../markdown/custom/directives/bot.mjs\";\nimport { chatContainer } from \"../../shared/selectors.mjs\";\nimport { processLightbox } from \"./helpers/plugins/lighbox.mjs\";\nimport { textFitForMathBlocks } from \"./helpers/plugins/textFitForMathBlocks.mjs\";\nimport { scrollWindow, scrollToLastUserMessage } from \"../../utils/ui.mjs\";\n\nexport async function displayMessage(md, options) {\n\tconst isUser = options && options.isUser;\n\tconst messageHtmlElement = options && options.htmlElement;\n\tconst useCustomTarget = options && options.appendTo;\n\tconst appendTarget = useCustomTarget ? options.appendTo : chatContainer;\n\tconst changeExistingMessage = options && options.changeExistingMessage;\n\tconst disableTypewriter = options && options.disableTypewriter;\n\tconst checkTypeWriter = checkTypewriterPreferences(md);\n\tmd = checkTypeWriter.md;\n\tconst isMessageWithFormElement =\n\t\tmd.includes(\"<select \") || md.includes(`<input type=\"text\"`);\n\tconst noTypewriter =\n\t\tdisableTypewriter ||\n\t\tcheckTypeWriter.useTypewriter === false ||\n\t\tisMessageWithFormElement;\n\tlet html = markdownToHTML(md);\n\tif (yaml && yaml.bots && !isUser) {\n\t\thtml = processMultipleBots(html);\n\t}\n\tif (yaml && yaml.maths) {\n\t\tawait waitForKaTeX();\n\t\thtml = convertLatexExpressions(html);\n\t}\n\n\treturn new Promise((resolve) => {\n\t\tif (!html) return resolve();\n\n\t\t// On ajoute dans le DOM le message HTML dans le container spécifié\n\t\tif (!changeExistingMessage)\n\t\t\tappendMessageToContainer(messageHtmlElement, appendTarget);\n\n\t\thtml = isUser ? html : processCopyCode(html);\n\n\t\t// Effet machine à écrire : seulement quand c'est le chatbot qui répond, sinon affichage direct\n\t\t// Pas d'effet machine à écrire s'il a été désactivé par l'utilisateur ou le créateur du chatbot\n\t\tif (isUser || noTypewriter) {\n\t\t\t// Si on n'utilise pas l'effet typewriter, on supprime la syntaxe spécifique à cet effet dans le message\n\t\t\tmessageHtmlElement.innerHTML = cleanTypewriterSyntax(html);\n\t\t\tif (!isUser) {\n\t\t\t\tprocessLightbox();\n\t\t\t}\n\t\t\ttextFitForMathBlocks(messageHtmlElement);\n\t\t\tif (!isUser) {\n\t\t\t\t// On scrolle vers le bas de la page pour voir la nouvelle réponse, avec un petit délai pour être sûr que le message a été ajouté au DOM\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (noTypewriter && !useCustomTarget) {\n\t\t\t\t\t\t// Si l'effet typewriter a été désactivé et que ce n'est pas un message qui s'affiche à l'intérieur d'un message plus long (composé de prompts), on scrolle au début du dernier message de l'utilisateur\n\t\t\t\t\t\tscrollToLastUserMessage();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Sinon on scrolle au bas de la page\n\t\t\t\t\t\tscrollWindow({ scrollMode: \"instant\" });\n\t\t\t\t\t}\n\t\t\t\t}, 10);\n\t\t\t}\n\t\t\tresolve();\n\t\t} else {\n\t\t\tstartTypeWriter(html, messageHtmlElement).then(() => {\n\t\t\t\tprocessLightbox();\n\t\t\t\ttextFitForMathBlocks(messageHtmlElement);\n\t\t\t\tresolve();\n\t\t\t});\n\t\t}\n\t});\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { processDirectiveTypewriter } from \"../../../markdown/custom/directives/typewriter.mjs\";\n\nexport function checkTypewriterPreferences(md) {\n\tconst directiveTypewriter = processDirectiveTypewriter(md);\n\tmd = directiveTypewriter.md;\n\n\tconst noTypewriter =\n\t\t!window.matchMedia ||\n\t\twindow.matchMedia(\"(prefers-reduced-motion: reduce)\").matches ||\n\t\t(yaml.typeWriter === false && directiveTypewriter.useTypewriter !== true) ||\n\t\t(yaml.typeWriter === true && directiveTypewriter.useTypewriter === false);\n\n\treturn { md: md, useTypewriter: !noTypewriter };\n}\n","export function processDirectiveTypewriter(md) {\n\tconst match = md.match(/!Typewriter\\s*:\\s*(true|false)/i);\n\tif (match) {\n\t\treturn {\n\t\t\tmd: md.replace(match[0], \"\"),\n\t\t\tuseTypewriter: match[1].toLowerCase() === \"true\",\n\t\t};\n\t}\n\treturn { md: md, useTypewriter: undefined };\n}\n","import { pauseTypeWriterMultipleBots } from \"../../../shared/constants.mjs\";\n\n// Gestion de la directive !Bot: botName pour pouvoir avoir différents bots possibles\nexport function processDirectiveBot(message, chatMessage) {\n\tmessage = message.replace(/!Bot:(.*)/, function (match, botName) {\n\t\tif (match && botName) {\n\t\t\tbotName = botName.trim().replaceAll(\" \", \"\");\n\t\t\tchatMessage.classList.add(\"botName-\" + botName);\n\t\t}\n\t\treturn \"\";\n\t});\n\treturn message;\n}\n\n// Possibilité d'avoir plusieurs bots qui répondent dans un même message\nexport function processMultipleBots(html) {\n\tconst htmlSplitDirectiveBot = html.split(\"<p>!Bot:\");\n\tconst numberOfBots = htmlSplitDirectiveBot.length;\n\tif (numberOfBots > 1) {\n\t\tlet newHtml = htmlSplitDirectiveBot[0];\n\t\tfor (let index = 1; index < numberOfBots; index++) {\n\t\t\tconst botMessageContent = htmlSplitDirectiveBot[index].trim();\n\t\t\tconst botNameMatch = botMessageContent.match(/(.*?)<\\/p>((.|\\n)*)/);\n\t\t\tconst botName = botNameMatch[1].trim();\n\t\t\tconst botMessage = botNameMatch[2].trim();\n\t\t\tnewHtml =\n\t\t\t\tnewHtml +\n\t\t\t\tpauseTypeWriterMultipleBots +\n\t\t\t\t'<div class=\"message bot-message botName-' +\n\t\t\t\tbotName +\n\t\t\t\t'\">' +\n\t\t\t\tbotMessage +\n\t\t\t\t\"</div>\";\n\t\t}\n\t\thtml = newHtml;\n\t}\n\treturn html;\n}\n","// On attend que la librairie de gestion de Latex soit disponible (avec un maximum d'essais pour éviter une boucle infinie)\nexport function waitForKaTeX() {\n\treturn new Promise((resolve) => {\n\t\tif (window.katex) {\n\t\t\tresolve();\n\t\t\treturn;\n\t\t}\n\t\tlet attempts = 0;\n\t\tconst interval = setInterval(() => {\n\t\t\tif (window.katex || attempts > 10) {\n\t\t\t\tclearInterval(interval);\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\tattempts++;\n\t\t\t}\n\t\t}, 100);\n\t});\n}\n","// Ajoute un bouton \"copier\" pour les blocs code\n\nexport function processCopyCode(html) {\n\thtml = html.replaceAll(\n\t\t\"</pre>\",\n\t\t'<button class=\"copyCode\">Copier</button></pre>',\n\t);\n\treturn html;\n}\n","import { yaml } from \"../../yaml.mjs\";\n\nconst START_PROMPT_TAG = \"`!useLLM`\";\nconst END_PROMPT_TAG = \"`END !useLLM`\";\n\n// Pour distinguer dans un message les parties qui correspondent à du contenu en Markdown et les parties qui correspondent à des prompts pour un LLM\nexport function extractMarkdownAndPrompts(message) {\n\tif (!yaml || !yaml.useLLM.url) return { useLLM: false };\n\n\tconst result = [];\n\tlet currentIndex = 0;\n\n\twhile (true) {\n\t\t// Cherche le prochain bloc de prompt\n\t\tconst start = message.indexOf(START_PROMPT_TAG, currentIndex);\n\t\t// S'il n'y en a pas, on ajoute le reste en tant que contenu Markdown à la fin de la séquence (s'il y a encore du contenu), et on sort de la boucle\n\t\tif (start === -1) {\n\t\t\tconst remaining = message.slice(currentIndex).trim();\n\t\t\tif (remaining) result.push({ type: \"markdown\", content: remaining });\n\t\t\tbreak;\n\t\t}\n\n\t\t// S'il y a un message avant le premier prompt, on l'ajoute en tant que contenu Markdown\n\t\tconst before = message.slice(currentIndex, start).trim();\n\t\tif (before) result.push({ type: \"markdown\", content: before });\n\n\t\t// On cherche la fin du bloc de prompt\n\t\tconst end = message.indexOf(END_PROMPT_TAG, start);\n\t\tif (end === -1) {\n\t\t\t// S'il n'y a pas de fin de bloc explicite, on prend le contenu jusqu'à la fin du message comme contenu du prompt, et on sort de la boucle\n\t\t\tconst prompt = message.slice(start + START_PROMPT_TAG.length).trim();\n\t\t\tif (prompt) result.push({ type: \"prompt\", content: prompt });\n\t\t\tbreak;\n\t\t}\n\n\t\t// On ajoute le bloc de prompt trouvé entre le tag de début et le tag de fin qui marquent la présence d'un prompt\n\t\tconst prompt = message.slice(start + START_PROMPT_TAG.length, end).trim();\n\t\tif (prompt) result.push({ type: \"prompt\", content: prompt });\n\n\t\t// On met à jour l'index pour continuer à chercher s'il y a encore des blocs de prompts après celui qu'on vient de repérer.\n\t\tcurrentIndex = end + END_PROMPT_TAG.length;\n\t}\n\n\treturn {\n\t\tuseLLM: result.some((part) => part.type === \"prompt\"),\n\t\tsequence: result,\n\t};\n}\n","// Pour envoyer un message d'erreur si la connexion au LLM n'a pas été correctement configurée ou bien si cette connexion ne fonctionne pas\nexport function errorMessage(options) {\n\tconst error = options && options.error;\n\tconst container = options && options.container;\n\tconst inline = options && options.inline;\n\tconst errorMessageElement = document.createElement(\"div\");\n\tif (!inline) {\n\t\terrorMessageElement.classList.add(\"message\");\n\t\terrorMessageElement.classList.add(\"bot-message\");\n\t}\n\tcontainer.appendChild(errorMessageElement);\n\terrorMessageElement.innerHTML =\n\t\t\"<p>Pour répondre à cette question, je dois faire appel à une IA générative : la connexion à cette IA n'a pas été correctement configurée ou bien ne fonctionne pas</p>\";\n\tif (error) {\n\t\tconsole.error(\"Erreur:\", error.message);\n\t\tconsole.log(\"Une erreur s'est produite : \" + error);\n\t}\n}\n","// Fonction pour détecter le type d'API en fonction du contenu\nexport function detectApiType(chunkElement) {\n\ttry {\n\t\tconst chunkObject = JSON.parse(chunkElement);\n\t\tif (chunkObject.message) {\n\t\t\treturn \"ollama\";\n\t\t} else {\n\t\t\tif (\n\t\t\t\tchunkObject.choices &&\n\t\t\t\tchunkObject.choices[0] &&\n\t\t\t\tchunkObject.choices[0].delta &&\n\t\t\t\tchunkObject.choices[0].delta.content\n\t\t\t) {\n\t\t\t\treturn \"openai\";\n\t\t\t}\n\t\t\tif (chunkObject.delta && chunkObject.delta.message) {\n\t\t\t\treturn \"cohere_v2\";\n\t\t\t}\n\t\t}\n\t} catch (error) {\n\t\tconsole.warn(\"Erreur lors de la détection du type d'API :\", error);\n\t}\n\treturn null;\n}\n","export function extractCohereText(chunkObject, version) {\n\tswitch (version) {\n\t\tcase \"v1\":\n\t\t\treturn chunkObject.text ? chunkObject.text : \"\";\n\t\tcase \"v2\":\n\t\t\treturn chunkObject.delta &&\n\t\t\t\tchunkObject.delta.message &&\n\t\t\t\tchunkObject.delta.message.content &&\n\t\t\t\tchunkObject.delta.message.content\n\t\t\t\t? chunkObject.delta.message.content.text\n\t\t\t\t: \"\";\n\t\tdefault:\n\t\t\tthrow new Error(\"Version d'API Cohere non supportée : \" + version);\n\t}\n}\n","function isJSONComplete(str) {\n\ttry {\n\t\tJSON.parse(str);\n\t\treturn true;\n\t} catch (error) {\n\t\tconsole.log(error);\n\t\treturn false;\n\t}\n}\n\nexport function parseChunkSafely(chunkToParse, incompleteBuffer) {\n\tincompleteBuffer += chunkToParse;\n\tif (!isJSONComplete(incompleteBuffer)) {\n\t\treturn { parsed: null, incompleteChunkBuffer: incompleteBuffer };\n\t}\n\tconst parsed = JSON.parse(incompleteBuffer);\n\tincompleteBuffer = \"\";\n\treturn { parsed: parsed, incompleteChunkBuffer: incompleteBuffer };\n}\n","import { yaml } from \"../../markdown/custom/yaml.mjs\";\nimport { hasSentenceEndMark } from \"../../utils/strings.mjs\";\nimport { detectApiType } from \"./detectApiType.mjs\";\nimport { extractCohereText } from \"./cohere.mjs\";\nimport { convertLatexExpressions } from \"../../markdown/latex.mjs\";\nimport { markdownToHTML } from \"../../markdown/parser.mjs\";\nimport { parseChunkSafely } from \"./parseChunks.mjs\";\n\nlet LLMactive = false;\n\n// Pour simuler le streaming d'un texte complet si la réponse du LLM est envoyée d'un seul coup et non pas streamée.\nasync function simulateStreaming(fullText, chatMessage, delay = 15) {\n\tconst words = fullText.split(/(\\s+)/);\n\tlet accumulatedText = \"\";\n\n\tfor (const word of words) {\n\t\taccumulatedText += word;\n\t\tchatMessage.innerHTML = markdownToHTML(accumulatedText);\n\n\t\t// Conversion LaTeX si activée\n\t\tif (yaml && yaml.maths === true) {\n\t\t\ttry {\n\t\t\t\tchatMessage.innerHTML = convertLatexExpressions(\n\t\t\t\t\tchatMessage.innerHTML,\n\t\t\t\t\ttrue,\n\t\t\t\t);\n\t\t\t} catch (latexError) {\n\t\t\t\tconsole.warn(\"Erreur lors de la conversion LaTeX :\", latexError);\n\t\t\t}\n\t\t}\n\n\t\t// Scroll automatique en bas\n\t\twindow.scrollTo(0, document.body.scrollHeight);\n\n\t\t// Délai entre chaque mot pour simuler le streaming\n\t\tawait new Promise((resolve) => setTimeout(resolve, delay));\n\t}\n\treturn true;\n}\n\n// Pour extraire le texte complet d'une réponse d'un LLM non-streamée\nfunction extractFullResponseText(responseData, APItype) {\n\tif (APItype === \"cohere_v1\") {\n\t\treturn responseData.text || \"\";\n\t} else if (APItype === \"ollama\") {\n\t\treturn responseData.message && responseData.message.content\n\t\t\t? responseData.message.content\n\t\t\t: \"\";\n\t} else if (\n\t\tAPItype === \"openai\" ||\n\t\tAPItype === \"cohere_v2\" ||\n\t\ttypeof APItype === \"undefined\"\n\t) {\n\t\tif (responseData.choices) {\n\t\t\treturn responseData.choices[0] &&\n\t\t\t\tresponseData.choices[0].message &&\n\t\t\t\tresponseData.choices[0].message.content\n\t\t\t\t? responseData.choices[0].message.content\n\t\t\t\t: \"\";\n\t\t}\n\t\tif (responseData.message) {\n\t\t\treturn responseData.message.content &&\n\t\t\t\tresponseData.message.content[0] &&\n\t\t\t\tresponseData.message.content[0].text\n\t\t\t\t? responseData.message.content[0].text\n\t\t\t\t: \"\";\n\t\t}\n\t}\n\treturn \"\";\n}\n\n// Pour pouvoir lire le stream diffusé par l'API utilisée pour se connecter à une IA\nexport async function readStreamFromLLM(\n\tstreamableObject,\n\tchatMessage,\n\tAPItype,\n\toptions,\n) {\n\tlet incompleteChunkBuffer = \"\";\n\tconst LLM_MAX_PROCESSING_TIME = yaml.useLLM.maxProcessingTime;\n\tif (!streamableObject.getReader) {\n\t\tthrow new TypeError(\n\t\t\t\"streamableObject n'est pas une ReadableStream compatible.\",\n\t\t);\n\t}\n\t// Récupération du lecteur de stream\n\tconst reader = streamableObject.getReader();\n\tlet accumulatedChunks = \"\";\n\tlet done = false;\n\tconst startTime = Date.now();\n\twhile (!done) {\n\t\tconst elapsedTime = Date.now() - startTime;\n\t\tif (elapsedTime >= LLM_MAX_PROCESSING_TIME) {\n\t\t\tconsole.log(\"La réponse du LLM a pris plus de temps qu'autorisé\");\n\t\t\tLLMactive = false;\n\t\t\tbreak;\n\t\t}\n\t\tlet value;\n\t\ttry {\n\t\t\tconst result = await reader.read();\n\t\t\tvalue = result.value;\n\t\t\tdone = result.done;\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Erreur lors de la lecture du flux :\", error);\n\t\t\tbreak;\n\t\t}\n\n\t\tif (value) {\n\t\t\tconst chunkString = new TextDecoder().decode(value);\n\n\t\t\tlet isStreamMode = true;\n\t\t\tif (\n\t\t\t\t(yaml.useLLM && yaml.useLLM.stream === false) ||\n\t\t\t\t(options && options.shouldStreamLLMresponse === false)\n\t\t\t) {\n\t\t\t\tisStreamMode = false;\n\t\t\t}\n\t\t\tconst shouldSimulateStream =\n\t\t\t\tyaml.useLLM && yaml.useLLM.simulateStream === true;\n\n\t\t\tif (!isStreamMode) {\n\t\t\t\t// MOde non streamé\n\t\t\t\t// Extraction du texte complet\n\t\t\t\tconst fullResponse = JSON.parse(chunkString);\n\t\t\t\tconst fullText = extractFullResponseText(fullResponse, APItype);\n\n\t\t\t\tif (!fullText) {\n\t\t\t\t\tconsole.error(\"Impossible d'extraire le texte de la réponse\");\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Simulation du streaming si activée\n\t\t\t\tif (shouldSimulateStream) {\n\t\t\t\t\tawait simulateStreaming(fullText, chatMessage);\n\t\t\t\t} else {\n\t\t\t\t\t// Affichage direct du texte complet\n\t\t\t\t\tchatMessage.innerHTML = markdownToHTML(fullText);\n\n\t\t\t\t\tif (yaml && yaml.maths === true) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tchatMessage.innerHTML = convertLatexExpressions(\n\t\t\t\t\t\t\t\tchatMessage.innerHTML,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} catch (latexError) {\n\t\t\t\t\t\t\tconsole.warn(\"Erreur lors de la conversion LaTeX :\", latexError);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\twindow.scrollTo(0, document.body.scrollHeight);\n\t\t\t\t}\n\n\t\t\t\t// Ajout des points de suspension si nécessaire\n\t\t\t\tconst chatMessageLastChild = chatMessage.lastChild;\n\t\t\t\tif (\n\t\t\t\t\tchatMessageLastChild &&\n\t\t\t\t\t!hasSentenceEndMark(chatMessageLastChild.innerHTML)\n\t\t\t\t) {\n\t\t\t\t\tchatMessageLastChild.innerHTML =\n\t\t\t\t\t\tchatMessageLastChild.innerHTML + \" …\";\n\t\t\t\t}\n\t\t\t\tLLMactive = false;\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst chunkArray = chunkString\n\t\t\t\t.trim()\n\t\t\t\t.split(\"\\n\")\n\t\t\t\t.filter((element) => element.trim().length > 0);\n\n\t\t\tfor (const chunkElement of chunkArray) {\n\t\t\t\ttry {\n\t\t\t\t\tif (chunkElement.startsWith(\"event: \")) continue;\n\t\t\t\t\tconst cleanedChunk = chunkElement.trim().replace(/^data: /, \"\");\n\t\t\t\t\tif (!cleanedChunk.startsWith(\"{\")) continue;\n\n\t\t\t\t\t// Si le type d'API n'est pas encore détecté, on tente de l'inférer\n\t\t\t\t\tif (!APItype) {\n\t\t\t\t\t\tAPItype = detectApiType(cleanedChunk);\n\t\t\t\t\t}\n\t\t\t\t\tif (!APItype) continue;\n\t\t\t\t\tif (APItype === \"openai\" || APItype == \"cohere_v2\") {\n\t\t\t\t\t\tif (cleanedChunk.indexOf(\"[DONE]\") !== -1) {\n\t\t\t\t\t\t\tLLMactive = false;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst parsingChunk = parseChunkSafely(\n\t\t\t\t\t\tcleanedChunk,\n\t\t\t\t\t\tincompleteChunkBuffer,\n\t\t\t\t\t);\n\t\t\t\t\tconst chunkObject = parsingChunk.parsed;\n\t\t\t\t\tincompleteChunkBuffer = parsingChunk.incompleteChunkBuffer;\n\n\t\t\t\t\tif (!chunkObject) continue;\n\n\t\t\t\t\tif (APItype.includes(\"cohere\")) {\n\t\t\t\t\t\tconst cohereAPIversion = APItype.match(/v\\d+/)\n\t\t\t\t\t\t\t? APItype.match(/v\\d+/)[0]\n\t\t\t\t\t\t\t: \"\";\n\t\t\t\t\t\tlet isTextGeneration;\n\t\t\t\t\t\tif (cohereAPIversion == \"v1\") {\n\t\t\t\t\t\t\tisTextGeneration = chunkObject.event_type === \"text-generation\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cohereAPIversion == \"v2\") {\n\t\t\t\t\t\t\tisTextGeneration = chunkObject.delta;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (cohereAPIversion && isTextGeneration && LLMactive) {\n\t\t\t\t\t\t\tconst chunkMessage =\n\t\t\t\t\t\t\t\textractCohereText(chunkObject, cohereAPIversion) || \"\";\n\t\t\t\t\t\t\taccumulatedChunks += chunkMessage;\n\t\t\t\t\t\t\tchatMessage.innerHTML = markdownToHTML(accumulatedChunks);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tLLMactive = !chunkObject.is_finished;\n\t\t\t\t\t} else if (APItype === \"ollama\") {\n\t\t\t\t\t\t// Cas de l'API Ollama\n\t\t\t\t\t\tif (cleanedChunk.indexOf('\"done\":true') !== -1) {\n\t\t\t\t\t\t\tLLMactive = false;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (chunkObject.message && chunkObject.message.content) {\n\t\t\t\t\t\t\tconst chunkMessage = chunkObject.message.content;\n\t\t\t\t\t\t\taccumulatedChunks += chunkMessage;\n\t\t\t\t\t\t\tchatMessage.innerHTML = markdownToHTML(accumulatedChunks);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (APItype === \"openai\") {\n\t\t\t\t\t\t// Cas du modèle openAI\n\t\t\t\t\t\tconst choice = chunkObject.choices && chunkObject.choices[0];\n\t\t\t\t\t\tif (choice && choice.delta && choice.delta.content) {\n\t\t\t\t\t\t\tconst chunkMessage = choice.delta.content;\n\t\t\t\t\t\t\taccumulatedChunks += chunkMessage;\n\t\t\t\t\t\t\tchatMessage.innerHTML = markdownToHTML(accumulatedChunks);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Scroll automatique en bas\n\t\t\t\t\twindow.scrollTo(0, document.body.scrollHeight);\n\t\t\t\t} catch (error) {\n\t\t\t\t\tconsole.error(\"Erreur lors du traitement d'un chunk :\", error);\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Si LaTeX est activé, convertit les expressions mathématiques\n\t\t\tif (yaml && yaml.maths === true) {\n\t\t\t\ttry {\n\t\t\t\t\tchatMessage.innerHTML = convertLatexExpressions(\n\t\t\t\t\t\tchatMessage.innerHTML,\n\t\t\t\t\t\ttrue,\n\t\t\t\t\t);\n\t\t\t\t} catch (latexError) {\n\t\t\t\t\tconsole.warn(\"Erreur lors de la conversion LaTeX :\", latexError);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\tconst chatMessageLastChild = chatMessage.lastChild;\n\tif (\n\t\tchatMessageLastChild &&\n\t\t!hasSentenceEndMark(chatMessageLastChild.innerHTML)\n\t) {\n\t\tchatMessageLastChild.innerHTML = chatMessageLastChild.innerHTML + \" …\";\n\t}\n\treturn true;\n}\n","import { yaml } from \"../markdown/custom/yaml.mjs\";\nimport { chatContainer } from \"../shared/selectors.mjs\";\nimport { errorMessage } from \"./helpers/error.mjs\";\nimport { readStreamFromLLM } from \"./helpers/readStream.mjs\";\nimport { encodeString } from \"../utils/strings.mjs\";\n\nlet llmHistory = [];\n\n// Définition du nombre maximum de tokens à conserver dans l'historique des échanges\n// Par défaut, on conserve jusqu'à 2000 tokens mis si on a défini un nombre maximum de tokens pour l'historique dans le YAML, on l'utilise\nconst maxTokensInHistory = yaml.useLLM.maxTokensInHistory || 2000;\n\n// Pour tronquer l'historique des échanges à un nombre maximum de tokens\nfunction truncateHistoryToMaxTokens(history) {\n\tlet totalTokens = 0;\n\tconst truncatedHistory = [];\n\t// On parcourt l'historique à l'envers pour garder les messages les plus récents\n\tfor (let i = history.length - 1; i >= 0; i--) {\n\t\tconst message = history[i];\n\t\t// On compte le nombre de tokens (approximativement en comptant les mots)\n\t\tconst messageWords = message.content.split(\" \").length;\n\t\tconst messageTokens = Math.ceil(messageWords * 1.5);\n\t\t// Si on n'a pas dépassé la limite, on ajoute le message à l'historique tronqué\n\t\tif (totalTokens + messageTokens <= maxTokensInHistory) {\n\t\t\t// On ajoute le message au début de la liste pour conserver l'ordre chronologique\n\t\t\ttruncatedHistory.unshift(message);\n\t\t\ttotalTokens += messageTokens;\n\t\t} else {\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn truncatedHistory;\n}\n\n// Fonction pour récupérer une réponse d'un LLM à partir d'un prompt\nexport function getAnswerFromLLM(chatbot, userPrompt, options) {\n\tif (!options.useConversationHistory === true) {\n\t\t// On remet l'historique des échanges à zéro si on n'utilise pas l'historique\n\t\tllmHistory = [];\n\t}\n\t// On limite la taille de l'historique pour éviter d'envoyer trop de données au LLM\n\tconst recentHistory = truncateHistoryToMaxTokens(llmHistory);\n\n\tlet RAGinformations = options && options.RAG;\n\tconst RAGprompt = options.RAGprompt\n\t\t? options.RAGprompt\n\t\t: yaml.useLLM.RAGprompt;\n\tlet messageElement = options && options.messageElement;\n\tlet container = options && options.container;\n\tconst inline = options && options.inline;\n\tlet shouldStreamLLMresponse = true;\n\tif (\n\t\tyaml.useLLM.stream === false ||\n\t\t(options && options.shouldStreamLLMresponse === false)\n\t) {\n\t\tshouldStreamLLMresponse = false;\n\t}\n\treturn new Promise((resolve) => {\n\t\t// Configuration de l'accès au LLM\n\t\tlet bodyObject = {\n\t\t\tmodel: yaml.useLLM.model,\n\t\t\tstream: shouldStreamLLMresponse,\n\t\t\tmax_tokens: yaml.useLLM.maxTokens,\n\t\t\tfrequency_penalty: 0,\n\t\t\tpresence_penalty: 0,\n\t\t\ttemperature: 0.7,\n\t\t};\n\t\tif (RAGinformations.length > 0) {\n\t\t\tRAGinformations = RAGprompt + RAGinformations;\n\t\t}\n\t\tconst APIurl = yaml.useLLM.url;\n\t\tlet APItype;\n\t\tconst isCohere = yaml && APIurl.includes(\"cohere\");\n\t\tif (isCohere) {\n\t\t\tif (APIurl.includes(\"v1\")) {\n\t\t\t\tAPItype = \"cohere_v1\";\n\t\t\t}\n\t\t\tif (APIurl.includes(\"v2\")) {\n\t\t\t\tAPItype = \"cohere_v2\";\n\t\t\t}\n\t\t}\n\t\tconst userMessage = options.useConversationHistory\n\t\t\t? userPrompt\n\t\t\t: yaml.useLLM.preprompt +\n\t\t\t\tuserPrompt +\n\t\t\t\tyaml.useLLM.postprompt +\n\t\t\t\tRAGinformations;\n\t\tif (APItype == \"cohere_v1\") {\n\t\t\tif (options.useConversationHistory) {\n\t\t\t\tbodyObject.chat_history = recentHistory.map((item) => {\n\t\t\t\t\treturn {\n\t\t\t\t\t\trole: item.role == \"user\" ? \"user\" : \"chatbot\",\n\t\t\t\t\t\tmessage: item.content,\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t}\n\t\t\tbodyObject.message = userMessage;\n\t\t} else {\n\t\t\tbodyObject.messages = [\n\t\t\t\t{\n\t\t\t\t\tcontent: yaml.useLLM.systemPrompt,\n\t\t\t\t\trole: \"system\",\n\t\t\t\t},\n\t\t\t\t...(options.useConversationHistory ? recentHistory : []),\n\t\t\t\t{\n\t\t\t\t\tcontent: userMessage,\n\t\t\t\t\trole: \"user\",\n\t\t\t\t},\n\t\t\t];\n\t\t}\n\t\ttry {\n\t\t\tfetch(APIurl, {\n\t\t\t\tmethod: \"POST\",\n\t\t\t\theaders: {\n\t\t\t\t\tAuthorization: \"Bearer \" + yaml.useLLM.apiKey,\n\t\t\t\t\t\"Content-Type\": \"application/json\",\n\t\t\t\t},\n\t\t\t\tbody: JSON.stringify(bodyObject),\n\t\t\t})\n\t\t\t\t.then((response) => {\n\t\t\t\t\tif (!container) {\n\t\t\t\t\t\tcontainer = chatContainer;\n\t\t\t\t\t}\n\t\t\t\t\tif (response.ok) {\n\t\t\t\t\t\t// Si on n'a pas indiqué d'élément et de container, on met la réponse du LLM dans un nouveau message du chatbot, sinon on utilise l'élément et le container indiqué\n\t\t\t\t\t\tif (!messageElement) {\n\t\t\t\t\t\t\tmessageElement = document.createElement(\"div\");\n\t\t\t\t\t\t\tmessageElement.classList.add(\"message\");\n\t\t\t\t\t\t\tmessageElement.classList.add(\"bot-message\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontainer.appendChild(messageElement);\n\t\t\t\t\t\treadStreamFromLLM(\n\t\t\t\t\t\t\tresponse.body,\n\t\t\t\t\t\t\tmessageElement,\n\t\t\t\t\t\t\tAPItype,\n\t\t\t\t\t\t\toptions,\n\t\t\t\t\t\t).then(() => {\n\t\t\t\t\t\t\tconst llmAnswer = messageElement.innerHTML;\n\t\t\t\t\t\t\tllmHistory.push({ role: \"user\", content: userMessage });\n\t\t\t\t\t\t\tllmHistory.push({ role: \"assistant\", content: llmAnswer });\n\t\t\t\t\t\t\tif (!inline) {\n\t\t\t\t\t\t\t\t// On récupère le contenu de la question posée au LLM\n\t\t\t\t\t\t\t\tlet actionsLatest = chatbot.actions.pop();\n\t\t\t\t\t\t\t\tif (actionsLatest.startsWith(\"c:n\")) {\n\t\t\t\t\t\t\t\t\tactionsLatest = chatbot.actions.pop();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tactionsLatest = encodeString(actionsLatest.replace(/^e:/, \"\"));\n\t\t\t\t\t\t\t\tconst actionsHistory = chatbot.actions.join(`|`);\n\t\t\t\t\t\t\t\tconst actionLlmQuestion = `llmq:${actionsLatest}`;\n\t\t\t\t\t\t\t\t// On récupère le contenu de la réponse générée par le LLM\n\t\t\t\t\t\t\t\tconst actionLlmAnswer = `llmr:${encodeString(llmAnswer)}`;\n\t\t\t\t\t\t\t\t// On met cette question et cette réponse dans l'historique des actions\n\t\t\t\t\t\t\t\tchatbot.actions.push(actionLlmQuestion);\n\t\t\t\t\t\t\t\tchatbot.actions.push(actionLlmAnswer);\n\t\t\t\t\t\t\t\t// Et dans le bouton de menu du message\n\t\t\t\t\t\t\t\tconst actionsPrefix = actionsHistory\n\t\t\t\t\t\t\t\t\t? `${actionsHistory}|`\n\t\t\t\t\t\t\t\t\t: \"\";\n\t\t\t\t\t\t\t\tconst messageMenu = `<div class=\"messageMenu\" data-actions-history=\"${actionsPrefix}${actionLlmQuestion}|${llmAnswer}\">☰</div>`;\n\t\t\t\t\t\t\t\tconst messageMenuElement = document.createElement(\"div\");\n\t\t\t\t\t\t\t\tmessageMenuElement.innerHTML = messageMenu;\n\t\t\t\t\t\t\t\tmessageElement.appendChild(messageMenuElement);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresolve();\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\terrorMessage({ container, inline });\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch((error) => {\n\t\t\t\t\terrorMessage({ error: error, container: chatContainer });\n\t\t\t\t\tresolve();\n\t\t\t\t});\n\t\t} catch (error) {\n\t\t\terrorMessage({ error: error, container: chatContainer });\n\t\t\tresolve();\n\t\t}\n\t});\n}\n","import { cosineSimilarity } from \"../../utils/nlp.mjs\";\nimport { topElements } from \"../../utils/arrays.mjs\";\nimport { yaml } from \"../../markdown/custom/yaml.mjs\";\n\nexport function extractRelevantRAGinfo(chatbot, question, options) {\n\tconst RAGcontent =\n\t\toptions && options.RAG && options.RAG.content\n\t\t\t? options.RAG.content\n\t\t\t: chatbot.RAG.content;\n\tconst vectorRAGinformations =\n\t\toptions && options.RAG && options.RAG.vector\n\t\t\t? options.RAG.vector\n\t\t\t: chatbot.RAG.vector;\n\tconst maxResults =\n\t\toptions && options.maxResults\n\t\t\t? options.maxResults\n\t\t\t: yaml.useLLM.RAGmaxTopElements;\n\n\tconst cosSimArray = vectorRAGinformations.map((vectorRAGinformation) =>\n\t\tcosineSimilarity(question, vectorRAGinformation, {\n\t\t\tboostIfKeywordsInTitle: chatbot.nextMessage && chatbot.nextMessage.goto,\n\t\t}),\n\t);\n\n\tconst RAGbestMatchesIndexes = topElements(cosSimArray, maxResults);\n\n\treturn RAGbestMatchesIndexes.map((element) => RAGcontent[element[1]]).join(\n\t\t\"\\n\",\n\t);\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { getAnswerFromLLM } from \"../../../ai/getAnswerFromLLM.mjs\";\nimport { extractRelevantRAGinfo } from \"../../../ai/rag/extractRelevantRAGInfo.mjs\";\n\nexport function processQuestionToLLM(chatbot, inputText, options) {\n\tif (!yaml || !yaml.useLLM || !yaml.useLLM.url || !yaml.useLLM.model)\n\t\treturn null;\n\t// On autorise l'utilisation par l'utilisateur des commandes LLM seulement si la configuration le permet\n\tif (yaml.useLLM.userCanCallLLM === false) {\n\t\t// Si on a désactivé par défaut dans le YAML l'utilisation des commandes LLM, on vérifie si le chatbot les a temporairement autorisées ou pas (utile dans le cas des commandes LLM dans les boutons à cliquer)\n\t\tchatbot.allowLLMCommands = chatbot.allowLLMCommands == true ? true : false;\n\t} else {\n\t\tchatbot.allowLLMCommands = true;\n\t}\n\t// Vérifier si on doit utiliser le LLM : soit via les options (activation dans le YAML avec useLLM.always), soit via la directive !useLLM dans l'input si c'est autorisé\n\tconst shouldUseLLM =\n\t\toptions && options.useLLM == true\n\t\t\t? true\n\t\t\t: inputText.includes(\"!useLLM\") && chatbot.allowLLMCommands;\n\t// On réinitialise à false l'autorisation d'utiliser les commandes LLM après utilisation\n\tchatbot.allowLLMCommands = false;\n\tif (!shouldUseLLM) return null;\n\tlet questionToLLM = inputText\n\t\t.replace(\"!useLLM\", \"\")\n\t\t.replace('<span class=\"hidden\">/span>', \"\");\n\t// Gestion de l'historique des échanges avec le LLM\n\tlet shouldUseConversationHistory = false;\n\tif (questionToLLM.includes(\"!useHistory\")) {\n\t\tshouldUseConversationHistory = true;\n\t\tquestionToLLM = questionToLLM.replace(\"!useHistory\", \"\");\n\t}\n\tconst RAGbestMatchesInformation =\n\t\tyaml && yaml.useLLM.RAGinformations\n\t\t\t? extractRelevantRAGinfo(chatbot, questionToLLM)\n\t\t\t: \"\";\n\tconst RAGinformations =\n\t\toptions && options.RAG\n\t\t\t? options.RAG + \"\\n\" + RAGbestMatchesInformation\n\t\t\t: RAGbestMatchesInformation;\n\tgetAnswerFromLLM(chatbot, questionToLLM, {\n\t\tRAG: RAGinformations,\n\t\tuseConversationHistory: shouldUseConversationHistory,\n\t});\n\treturn true;\n}\n","import { config } from \"../../../config.mjs\";\nimport { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport {\n\tresponseToSelectedChoiceOption,\n\tprocessMessageWithChoiceOptions,\n} from \"./choiceOptions.mjs\";\n\nlet randomDefaultMessageInitialized = false;\nlet randomDefaultMessageIndex = 0;\nlet randomDefaultMessageIndexLastChoice = [];\n\nexport function getDefaultMessage(chatbot, inputText) {\n\tlet defaultResponse;\n\t// On vérifie d'abord s'il y a un fallback dans le YAML\n\t// C'est une option qui permet de rediriger vers une réponse spécifique si aucune autre n'a été trouvée\n\tif (yaml.fallback) {\n\t\tdefaultResponse = responseToSelectedChoiceOption(chatbot, yaml.fallback);\n\t}\n\tif (defaultResponse) return defaultResponse;\n\n\t// S'il n'y a pas de fallback dans le YAML, on choisit un message par défaut\n\t// On initialise l'index aléatoire pour que le choix soit aléatoire dès la première fois\n\tif (!randomDefaultMessageInitialized) {\n\t\trandomDefaultMessageIndex = Math.floor(\n\t\t\tMath.random() * config.defaultMessage.length,\n\t\t);\n\t\trandomDefaultMessageInitialized = true;\n\t}\n\t// Sinon on choisit un message par défaut aléatoire parmi la liste définie dans la configuration\n\t// On évite de répéter plusieurs fois de suite le même message par défaut\n\twhile (\n\t\trandomDefaultMessageIndexLastChoice.includes(randomDefaultMessageIndex)\n\t) {\n\t\trandomDefaultMessageIndex = Math.floor(\n\t\t\tMath.random() * config.defaultMessage.length,\n\t\t);\n\t}\n\tif (randomDefaultMessageIndexLastChoice.length > 4) {\n\t\trandomDefaultMessageIndexLastChoice.shift();\n\t}\n\trandomDefaultMessageIndexLastChoice.push(randomDefaultMessageIndex);\n\tdefaultResponse = config.defaultMessage[randomDefaultMessageIndex];\n\n\t// Si une réponse n'a pas été trouvée dans la base de réponses en Markdown du chatbot, et qu'on a activé l'option LLM dans le YAML, alors on propose un bouton qui permet, en cliquant dessus, d'avoir une réponse générée par une IA si la configuration le permet\n\tif (\n\t\tyaml &&\n\t\tyaml.useLLM.url &&\n\t\tyaml.useLLM.model &&\n\t\t!yaml.useLLM.always &&\n\t\t!yaml.useLLM.userCanCallLLM === false\n\t) {\n\t\tchatbot.allowLLMCommands = true;\n\t\tconst optionDefaultMessage = [\n\t\t\t{\n\t\t\t\ttext: \"Voir une réponse générée par une IA\",\n\t\t\t\tlink: \"!useLLM \" + inputText.replaceAll('\"', \"“\").trim(),\n\t\t\t},\n\t\t];\n\t\tdefaultResponse = processMessageWithChoiceOptions(\n\t\t\tchatbot,\n\t\t\tdefaultResponse,\n\t\t\toptionDefaultMessage,\n\t\t);\n\t}\n\treturn defaultResponse;\n}\n","import { yaml } from \"../../../../markdown/custom/yaml.mjs\";\nimport { processMessageWithChoiceOptions } from \"../choiceOptions.mjs\";\nimport { getDefaultMessage } from \"../getDefaultMessage.mjs\";\nimport { processQuestionToLLM } from \"../processQuestionToLLM.mjs\";\n\nconst BESTMATCH_THRESHOLD = 0.545; // Seuil pour que le bestMatch soit pertinent\n\nexport function processFinalResponse(\n\tchatbot,\n\tuserInput,\n\tbestMatch,\n\tbestMatchScore,\n\tindexBestMatch,\n) {\n\tlet chatbotResponses = chatbot.responses;\n\t// Soit il y a un bestMatch, soit on veut aller directement à un prochain message mais seulement si la réponse inclut les keywords correspondant (sinon on remet le message initial)\n\tif (bestMatch || chatbot.nextMessage.needsProcessing) {\n\t\tif (\n\t\t\tbestMatch &&\n\t\t\tchatbot.nextMessage.needsProcessing &&\n\t\t\tbestMatchScore > BESTMATCH_THRESHOLD\n\t\t) {\n\t\t\t// Réinitialiser si on a trouvé la bonne réponse après une directive !Next\n\t\t\tchatbot.nextMessage.lastMessageFromBot = \"\";\n\t\t\tchatbot.nextMessage.goto = \"\";\n\t\t\tchatbot.nextMessage.errorsCounter = 0;\n\t\t\tchatbot.nextMessage.needsProcessing = false;\n\t\t}\n\t\t// On envoie le meilleur choix s'il en existe un\n\t\tlet selectedResponseWithoutChoiceOptions = bestMatch\n\t\t\t? Array.isArray(bestMatch)\n\t\t\t\t? bestMatch.join(\"\\n\\n\")\n\t\t\t\t: bestMatch\n\t\t\t: \"\";\n\t\tlet selectedResponseChoiceOptions = bestMatch\n\t\t\t? chatbotResponses[indexBestMatch].choiceOptions\n\t\t\t: [];\n\t\t// Cas où on veut aller directement à un prochain message avec la directive !Next\n\t\t// S'il y avait des keywords dans le message à afficher, on vérifie si la réponse de l'utilisateur inclut les keywords correspondant (sinon on remet le message initial)\n\t\tlet selectedResponseWithChoiceOptions;\n\t\tif (\n\t\t\tchatbot.nextMessage.needsProcessing &&\n\t\t\tbestMatchScore < BESTMATCH_THRESHOLD\n\t\t) {\n\t\t\t// En cas de mauvaise réponse\n\t\t\tselectedResponseWithChoiceOptions =\n\t\t\t\tchatbot.nextMessage.lastMessageFromBot.includes(\n\t\t\t\t\tchatbot.nextMessage.messageIfKeywordsNotFound,\n\t\t\t\t)\n\t\t\t\t\t? chatbot.nextMessage.lastMessageFromBot\n\t\t\t\t\t: chatbot.nextMessage.messageIfKeywordsNotFound +\n\t\t\t\t\t\tchatbot.nextMessage.lastMessageFromBot;\n\t\t} else {\n\t\t\t// En cas de bonne réponse\n\t\t\tselectedResponseWithChoiceOptions = processMessageWithChoiceOptions(\n\t\t\t\tchatbot,\n\t\t\t\tselectedResponseWithoutChoiceOptions,\n\t\t\t\tselectedResponseChoiceOptions,\n\t\t\t);\n\t\t}\n\t\t// Si on a dans le yaml useLLM avec le paramètre `always: true`, on utilise un LLM pour répondre à la question en prenant en compte les réponses possibles comme contexte\n\t\tif (yaml.useLLM.always) {\n\t\t\tconst answerFromLLM = processQuestionToLLM(chatbot, userInput, {\n\t\t\t\tuseLLM: true,\n\t\t\t\tRAG: selectedResponseWithoutChoiceOptions,\n\t\t\t});\n\t\t\tif (answerFromLLM) return null;\n\t\t} else {\n\t\t\treturn selectedResponseWithChoiceOptions;\n\t\t}\n\t} else {\n\t\t// Si on n'a pas de bestMatch, on utilise un LLM pour répondre à la question si le yaml le permet\n\t\tif (yaml.useLLM.always) {\n\t\t\tconst answerFromLLM = processQuestionToLLM(chatbot, userInput, {\n\t\t\t\tuseLLM: true,\n\t\t\t});\n\t\t\tif (answerFromLLM) return null;\n\t\t} else {\n\t\t\t// Sinon, en cas de correspondance non trouvée, on envoie un message par défaut (sélectionné au hasard dans la liste définie par defaultMessage)\n\t\t\t// On fait en sorte que le message par défaut envoyé ne soit pas le même que les derniers messages par défaut envoyés\n\t\t\treturn getDefaultMessage(chatbot, userInput);\n\t\t}\n\t}\n}\n","import { removeAccents } from \"../../../utils/nlp.mjs\";\nimport { matchOptionFromLastResponse } from \"./findBestResponse/matchOptionFromLastResponse.mjs\";\nimport { computeSimilarityScore } from \"./findBestResponse/computeSimilarityScore.mjs\";\nimport { processFinalResponse } from \"./findBestResponse/processFinalResponse.mjs\";\n\nexport function findBestResponse(chatbot, inputText) {\n\tlet userInput = removeAccents(inputText.toLowerCase());\n\n\t// On va d'abord comparer le message de l'utilisateur aux derniers choix d'options s'il y en a, et retourner la réponse du chatbot correspondante si c'est le cas\n\tconst matchedOption = matchOptionFromLastResponse(chatbot, userInput);\n\tif (matchedOption) return matchedOption;\n\n\t/* Sinon, on cherche la meilleure réponse possible en testant l'identité ou la similarité entre les mots ou expressions clés de chaque réponse possible et le message envoyé */\n\tconst { bestMatch, bestMatchScore, indexBestMatch } = computeSimilarityScore(\n\t\tchatbot,\n\t\tuserInput,\n\t);\n\treturn processFinalResponse(\n\t\tchatbot,\n\t\tuserInput,\n\t\tbestMatch,\n\t\tbestMatchScore,\n\t\tindexBestMatch,\n\t);\n}\n","import { responseToSelectedChoiceOption } from \"../choiceOptions.mjs\";\nimport { removeAccents } from \"../../../../utils/nlp.mjs\";\n\nexport function matchOptionFromLastResponse(chatbot, userInput) {\n\tconst choiceOptions = chatbot.choiceOptionsLastResponse;\n\tif (!choiceOptions) return null;\n\tconst matchIndex = choiceOptions.findIndex(\n\t\t(choiceOption) =>\n\t\t\tremoveAccents(choiceOption.text.toLowerCase()) === userInput,\n\t);\n\tif (matchIndex > -1) {\n\t\tconst choiceOptionLink = choiceOptions[matchIndex].link;\n\t\treturn responseToSelectedChoiceOption(chatbot, choiceOptionLink);\n\t}\n\treturn null;\n}\n","import { yaml } from \"../../../../markdown/custom/yaml.mjs\";\nimport {\n\thasLevenshteinDistanceLessThan,\n\tcosineSimilarity,\n\tlongestCommonSubstringWeightedLength,\n} from \"../../../../utils/nlp.mjs\";\nimport { removeAccents } from \"../../../../utils/nlp.mjs\";\n\nconst LEVENSHTEIN_THRESHOLD = 3; // Seuil de similarité (tolérance des fautes d'orthographe et des fautes de frappe)\nconst MATCH_SCORE_IDENTITY = 30; // Pour régler le fait de privilégier l'identité d'un keyword à la simple similarité\nconst WORD_LENGTH_FACTOR = 0.1; // Prise en compte de la taille des keywords (plus les keywords sont grands, plus ils doivent avoir un poids important)\n\nexport function computeSimilarityScore(chatbot, userInput) {\n\tlet chatbotResponses = chatbot.responses;\n\tconst chatbotResponsesLength = chatbotResponses.length;\n\tlet bestMatch = null;\n\tlet bestMatchScore = 0;\n\tlet bestDistanceScore = 0;\n\n\tlet indexBestMatch;\n\n\tif (chatbotResponsesLength > 0 && chatbotResponses[0].title) {\n\t\tfor (let i = 0; i < chatbotResponsesLength; i++) {\n\t\t\tconst titleResponse = chatbotResponses[i].title;\n\t\t\tconst keywordsResponse = chatbotResponses[i].keywords;\n\t\t\t// Si on a la directive !Next ou !SelectNext, on teste seulement la similarité avec la réponse vers laquelle on doit aller et on saute toutes les autres réponses\n\t\t\tif (\n\t\t\t\t(chatbot.nextMessage.needsProcessing &&\n\t\t\t\t\ttitleResponse != chatbot.nextMessage.goto) ||\n\t\t\t\t(chatbot.nextMessage.selected &&\n\t\t\t\t\ttitleResponse != chatbot.nextMessage.selected)\n\t\t\t) {\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// Si on a la directive !Next on va directement vers cette réponse, sauf si la réponse contient des déclencheurs (qui vont servir de mots clés pour vérifier la correspondance) et qu'on ne souhaite pas les ignorer\n\t\t\tif (\n\t\t\t\tchatbot.nextMessage.needsProcessing &&\n\t\t\t\ttitleResponse == chatbot.nextMessage.goto &&\n\t\t\t\t(keywordsResponse.length == 0 || chatbot.nextMessage.ignoreKeywords)\n\t\t\t) {\n\t\t\t\tuserInput = removeAccents(chatbot.nextMessage.goto.toLowerCase());\n\t\t\t}\n\t\t\t// Si on a la directive !Next, alors on ne teste pas la correspondance avec le titre, mais seulement avec les keywords (sauf s'il n'y a pas de keyword)\n\t\t\t// Sinon on inclut le titre\n\t\t\t// On met tout en minuscule\n\t\t\tconst keywords =\n\t\t\t\tchatbot.nextMessage.needsProcessing &&\n\t\t\t\tkeywordsResponse.length > 0 &&\n\t\t\t\tchatbot.nextMessage.ignoreKeywords !== true\n\t\t\t\t\t? keywordsResponse.map((keyword) => keyword.toLowerCase())\n\t\t\t\t\t: keywordsResponse\n\t\t\t\t\t\t\t.concat(titleResponse)\n\t\t\t\t\t\t\t.map((keyword) => keyword.toLowerCase());\n\t\t\tconst responses = chatbotResponses[i];\n\t\t\tlet matchScore = 0;\n\t\t\tlet distanceScore = 0;\n\t\t\tif (yaml && yaml.searchInContent) {\n\t\t\t\tconst vectorChatBotResponses = chatbot.vectorChatBotResponses;\n\t\t\t\tconst cosSim = cosineSimilarity(userInput, vectorChatBotResponses[i], {\n\t\t\t\t\tboostIfKeywordsInTitle:\n\t\t\t\t\t\tchatbot.nextMessage && chatbot.nextMessage.goto,\n\t\t\t\t});\n\t\t\t\tmatchScore = matchScore + cosSim + 0.5;\n\t\t\t}\n\t\t\tfor (let keyword of keywords) {\n\t\t\t\t// On prend en compte les keywords négatifs (on ne doit pas les voir dans la question de l'utilisateur)\n\t\t\t\tconst isNegativeKeyword = keyword.startsWith(\"! \");\n\t\t\t\tkeyword = keyword.replace(/^!\\s/, \"\");\n\t\t\t\tkeyword = removeAccents(keyword);\n\t\t\t\tif (userInput.includes(keyword)) {\n\t\t\t\t\t// Test de l'identité stricte\n\t\t\t\t\tlet strictIdentityMatch = false;\n\t\t\t\t\tif (chatbot.nextMessage.needsProcessing) {\n\t\t\t\t\t\t// Si on utilise la directive !Next, on vérifie que le keyword n'est pas entouré de lettres ou de chiffres dans le message de l'utilisateur\n\t\t\t\t\t\tconst regexStrictIdentityMatch = new RegExp(`\\\\b${keyword}\\\\b`);\n\t\t\t\t\t\tif (regexStrictIdentityMatch.test(userInput)) {\n\t\t\t\t\t\t\tstrictIdentityMatch = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstrictIdentityMatch = true;\n\t\t\t\t\t}\n\t\t\t\t\tif (strictIdentityMatch) {\n\t\t\t\t\t\t// En cas d'identité stricte, on monte le score d'une valeur définie par MATCH_SCORE_IDENTITY, ou alors on le diminue si on avait un keyword négatif\n\t\t\t\t\t\tmatchScore = isNegativeKeyword\n\t\t\t\t\t\t\t? matchScore - MATCH_SCORE_IDENTITY * 2\n\t\t\t\t\t\t\t: matchScore + MATCH_SCORE_IDENTITY;\n\t\t\t\t\t\t// On privilégie les correspondances sur les keywords plus longs\n\t\t\t\t\t\tmatchScore = matchScore + keyword.length * WORD_LENGTH_FACTOR;\n\t\t\t\t\t}\n\t\t\t\t} else if (\n\t\t\t\t\t(userInput.length > 5) &\n\t\t\t\t\t(keyword.length > 4 && !isNegativeKeyword)\n\t\t\t\t) {\n\t\t\t\t\t// Sinon : test de la similarité (seulement si le message de l'utilisateur n'est pas très court)\n\t\t\t\t\t// On calcule la distance de Levenshtein entre le keyword et la question de l'utilisateur (en parcourant les n-grammes du message de l'utilisateur et en prenant en compte la longueur du n-gramme ; avec n = nombre de mots du keyword)\n\t\t\t\t\tconst levenshteinDistance = hasLevenshteinDistanceLessThan(\n\t\t\t\t\t\tuserInput,\n\t\t\t\t\t\tkeyword,\n\t\t\t\t\t\tLEVENSHTEIN_THRESHOLD,\n\t\t\t\t\t\tWORD_LENGTH_FACTOR,\n\t\t\t\t\t);\n\t\t\t\t\tdistanceScore =\n\t\t\t\t\t\tlevenshteinDistance > 1\n\t\t\t\t\t\t\t? distanceScore + levenshteinDistance\n\t\t\t\t\t\t\t: distanceScore;\n\t\t\t\t\tif (!chatbot.nextMessage.needsProcessing) {\n\t\t\t\t\t\t// On prend en compte la plus longue chaîne commune de caractères (sauf si on doit passer au message seulement s'il y a présence du keyword [cas d'un quiz] : dans ce cas, on doit être plus strict et tester seulement la proximité avec la distance de Levenshtein pour simplement autoriser quelques fautes d'orthographe)\n\t\t\t\t\t\tdistanceScore =\n\t\t\t\t\t\t\tdistanceScore +\n\t\t\t\t\t\t\tlongestCommonSubstringWeightedLength(\n\t\t\t\t\t\t\t\tuserInput,\n\t\t\t\t\t\t\t\tkeyword,\n\t\t\t\t\t\t\t\tWORD_LENGTH_FACTOR,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// si on a un score de distance négatif, c'est qu'il y avait des keywords négatifs : donc le matchscore doit être égal à 0\n\t\t\tif (distanceScore < 0) {\n\t\t\t\tmatchScore = 0;\n\t\t\t}\n\t\t\tif (\n\t\t\t\t(matchScore == 0 || yaml.searchInContent) &&\n\t\t\t\t!chatbot.nextMessage.needsProcessing\n\t\t\t) {\n\t\t\t\t// En cas de simple similarité : on monte quand même le score. Mais si on est dans le mode où on va directement à une réponse en testant la présence de keywords, la correspondance doit être stricte, on ne fait pas de calcul de similarité\n\t\t\t\tif (distanceScore > bestDistanceScore) {\n\t\t\t\t\tmatchScore = matchScore + distanceScore;\n\t\t\t\t\tbestDistanceScore = distanceScore;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Si on a la directive !Next : titre réponse, alors on augmente de manière importante le matchScore si on a un matchScore > 0.5 et que la réponse correspond au titre de la réponse voulue dans la directive\n\t\t\tif (\n\t\t\t\tmatchScore > 0.5 &&\n\t\t\t\tchatbot.nextMessage.needsProcessing &&\n\t\t\t\ttitleResponse == chatbot.nextMessage.goto\n\t\t\t) {\n\t\t\t\tmatchScore = matchScore + MATCH_SCORE_IDENTITY;\n\t\t\t}\n\t\t\tif (matchScore > bestMatchScore) {\n\t\t\t\tbestMatch = responses.content;\n\t\t\t\tbestMatchScore = matchScore;\n\t\t\t\tindexBestMatch = i;\n\t\t\t}\n\t\t}\n\t}\n\treturn { bestMatch, bestMatchScore, indexBestMatch };\n}\n","import { processGoToNextMessage } from \"./helpers/processGoToNextMessage.mjs\";\nimport { processBadWords } from \"./helpers/processBadWords.mjs\";\nimport { processQuestionToLLM } from \"./helpers/processQuestionToLLM.mjs\";\nimport { findBestResponse } from \"./helpers/findBestResponse.mjs\";\n\nexport function getChatbotResponse(chatbot, inputText) {\n\t// Cas où on doit aller directement vers un nouveau message si on utilise des directives comme !Next\n\tinputText = processGoToNextMessage(chatbot, inputText);\n\n\t// Gestion des insultes\n\tconst responseToBadWords = processBadWords(inputText);\n\tif (responseToBadWords) return responseToBadWords;\n\n\t// Réponse par un LLM\n\tconst answerFromLLM = processQuestionToLLM(chatbot, inputText);\n\tif (answerFromLLM) return null;\n\n\t// Choix de la réponse que le chatbot va envoyer\n\tconst response = findBestResponse(chatbot, inputText);\n\treturn response;\n}\n","export function processGoToNextMessage(chatbot, inputText) {\n\tconst shouldGoToNextMessage =\n\t\tchatbot.nextMessage.goto != \"\" && !chatbot.nextMessage.needsProcessing;\n\treturn shouldGoToNextMessage ? chatbot.nextMessage.goto : inputText;\n}\n","import { config } from \"../../../config.mjs\";\nimport { yaml, filterBadWords } from \"../../../markdown/custom/yaml.mjs\";\nimport { getRandomElement } from \"../../../utils/arrays.mjs\";\n\nexport function processBadWords(inputText) {\n\tif (\n\t\tyaml &&\n\t\tyaml.detectBadWords === true &&\n\t\tfilterBadWords &&\n\t\tfilterBadWords.check(inputText)\n\t) {\n\t\treturn getRandomElement(config.badWordsMessage);\n\t}\n}\n","//On met ici les informations pour faire du RAG\nexport const localRAGinformations = `\n\n`;\n","function splitByCharLimit(text, maxChars) {\n\tconst chunks = [];\n\tlet start = 0;\n\n\twhile (start < text.length) {\n\t\tlet end = Math.min(start + maxChars, text.length);\n\n\t\tif (end < text.length) {\n\t\t\tconst space = text.lastIndexOf(\" \", end);\n\t\t\tif (space > start) {\n\t\t\t\tend = space;\n\t\t\t}\n\t\t}\n\n\t\tconst chunk = text.slice(start, end).trim();\n\t\tif (chunk) chunks.push(chunk);\n\n\t\tstart = end;\n\t\t// saute l'espace suivant si présent\n\t\twhile (text[start] === \" \") start++;\n\t}\n\n\treturn chunks;\n}\n\nfunction splitByCustomSeparator(text, separator) {\n\treturn text.split(separator);\n}\n\nfunction splitByNewLines(text) {\n\treturn text\n\t\t.split(/\\n/)\n\t\t.map((line) => line.trim())\n\t\t.filter((line) => line !== \"\");\n}\n\nfunction splitByMarkdownHr(text) {\n\treturn text\n\t\t.split(\"---\")\n\t\t.map((section) => section.trim())\n\t\t.filter((section) => section.length > 0);\n}\n\nfunction splitByParagraphs(text) {\n\treturn text\n\t\t.split(/\\r?\\n\\s*\\r?\\n/)\n\t\t.map((paragraph) => paragraph.trim())\n\t\t.filter((paragraph) => paragraph !== \"\");\n}\n\nexport function prepareChunksForRAG(text, options) {\n\tconst separator = options && options.separator;\n\n\tif (!separator || separator == \"line\") return splitByNewLines(text);\n\tif (separator == \"maxchars\" || separator == \"auto\") {\n\t\tconst maxChars = options.maxChars || 600;\n\t\treturn splitByCharLimit(text, maxChars);\n\t}\n\tif (separator == \"break\") return splitByMarkdownHr(text);\n\tif (separator == \"paragraph\") return splitByParagraphs(text);\n\treturn splitByCustomSeparator(text, separator);\n}\n","import { yaml } from \"../../markdown/custom/yaml.mjs\";\nimport { handleURL } from \"../../utils/urls.mjs\";\nimport { createVector } from \"../../utils/nlp.mjs\";\nimport { localRAGinformations } from \"./sources.mjs\";\nimport {\n\tfetchContent,\n\tfetchContentFromMultipleSources,\n} from \"../../core/chatbot/helpers/fetch.mjs\";\nimport { prepareChunksForRAG } from \"./prepareChunks.mjs\";\n\nfunction createVectorRAGinformations(informations) {\n\tlet vectorRAGinformations = [];\n\tif (informations) {\n\t\tconst informationsLength = informations.length;\n\t\tfor (let i = 0; i < informationsLength; i++) {\n\t\t\tconst RAGinformation = informations[i];\n\t\t\tconst vectorRAGinformation = createVector(RAGinformation);\n\t\t\tvectorRAGinformations.push(vectorRAGinformation);\n\t\t}\n\t\treturn vectorRAGinformations;\n\t}\n}\n\nexport async function getRAGcontent(informations, options) {\n\tconst separator =\n\t\toptions && options.separator ? options.separator : yaml.useLLM.RAGseparator;\n\tlet RAGcontent;\n\tif (informations) {\n\t\tconst isArray = Array.isArray(informations);\n\t\tif (isArray || informations.includes(\"http\")) {\n\t\t\tlet sourceRAG;\n\t\t\tif (isArray) {\n\t\t\t\tsourceRAG = informations.map((element) =>\n\t\t\t\t\thandleURL(element, { useCorsProxy: true }),\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tsourceRAG = handleURL(informations, { useCorsProxy: true });\n\t\t\t}\n\t\t\ttry {\n\t\t\t\tconst data = isArray\n\t\t\t\t\t? await fetchContentFromMultipleSources(sourceRAG)\n\t\t\t\t\t: await fetchContent(sourceRAG);\n\t\t\t\tRAGcontent = prepareChunksForRAG(data, {\n\t\t\t\t\tseparator: separator,\n\t\t\t\t});\n\t\t\t\tconst RAGvector = createVectorRAGinformations(RAGcontent);\n\t\t\t\treturn { content: RAGcontent, vector: RAGvector };\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t\"Erreur lors du fetch ou du traitement des données RAG :\",\n\t\t\t\t\terror,\n\t\t\t\t);\n\t\t\t\treturn { content: [], vector: [] };\n\t\t\t}\n\t\t} else {\n\t\t\tlet RAGinformations;\n\t\t\tif (informations.toString().includes(\"useFile\")) {\n\t\t\t\tRAGinformations = localRAGinformations.trim();\n\t\t\t} else {\n\t\t\t\tRAGinformations = informations.trim();\n\t\t\t}\n\t\t\tRAGcontent = prepareChunksForRAG(RAGinformations, {\n\t\t\t\tseparator: separator,\n\t\t\t});\n\t\t\tconst RAGvector = createVectorRAGinformations(RAGcontent);\n\t\t\treturn { content: RAGcontent, vector: RAGvector };\n\t\t}\n\t}\n}\n","function parseValue(value) {\n\tif (value.startsWith(\"[\") && value.endsWith(\"]\")) {\n\t\t// Traitement des options qui contiennent de l'information sous forme d'un tableau\n\t\treturn value\n\t\t\t.slice(1, -1)\n\t\t\t.split(\",\")\n\t\t\t.map((v) => stripQuotes(v.trim()));\n\t}\n\treturn stripQuotes(value);\n}\n\nfunction stripQuotes(str) {\n\tif (\n\t\t(str.startsWith('\"') && str.endsWith('\"')) ||\n\t\t(str.startsWith(\"'\") && str.endsWith(\"'\"))\n\t) {\n\t\treturn str.slice(1, -1);\n\t}\n\treturn str;\n}\n\nexport function parseOptions(optionsList) {\n\tconst regex = /(\\w+):(\\[[^\\]]*\\]|\"[^\"]*\"|'[^']*'|[^\\s]+)/g;\n\t// Cette expression régulière permet d'extraire des paires clé:valeur dans une chaîne de texte.\n\t// Elle capture :\n\t//   1. Une clé constituée de caractères alphanumériques ou underscore : (\\w+)\n\t//   2. Suivie d’un deux-points : (:)\n\t//   3. Puis d’une valeur pouvant être :\n\t//      - une liste entre crochets, ex : [a, b]              → (\\[[^\\]]*\\])\n\t//      - une chaîne entre guillemets doubles, ex : \"text\"   → (\"[^\"]*\")\n\t//      - une chaîne entre guillemets simples, ex : 'text'   → ('[^']*')\n\t//      - ou une valeur simple sans espaces                  → ([^\\s]+)\n\treturn Object.fromEntries(\n\t\t[...optionsList.matchAll(regex)].map(([, key, rawValue]) => [\n\t\t\tkey.trim(),\n\t\t\tparseValue(rawValue.trim()),\n\t\t]),\n\t);\n}\n\nexport function parseRAGdirective(content) {\n\tconst RAGline = content.split(\"\\n\").find((line) => line.includes(\"!RAG:\"));\n\tif (!RAGline) return null;\n\n\tconst RAGparameters = [...RAGline.matchAll(/{([^{}]+)}/g)];\n\tif (RAGparameters.length < 2) return null;\n\n\treturn {\n\t\tquestion: RAGparameters[0][1].trim(),\n\t\toptionsList: RAGparameters[1][1],\n\t\tRAGline: RAGline,\n\t};\n}\n","import { getRAGcontent } from \"../../../../ai/rag/engine.mjs\";\nimport { extractRelevantRAGinfo } from \"../../../../ai/rag/extractRelevantRAGInfo.mjs\";\nimport { parseRAGdirective, parseOptions } from \"./helpers/RAGparser.mjs\";\n\n// Traitement des prompts avec du RAG\n// Le prompt doit contenir une ligne avec : !RAG: {contenu} {url:zerzerezr url:zerzer}\nexport async function processPromptWithRAG(chatbot, content) {\n\tconst RAGdirective = parseRAGdirective(content);\n\tif (!RAGdirective) {\n\t\treturn { content, RAGinformations: \"\" };\n\t}\n\n\tconst { question, optionsList } = RAGdirective;\n\tconst options = parseOptions(optionsList);\n\tconst RAGprompt = options.prompt ? options.prompt : \"\";\n\n\tconst RAGinformations = options.url\n\t\t? await getRAGcontent(options.url, {\n\t\t\t\tseparator: options && options.separator ? options.separator : undefined,\n\t\t\t})\n\t\t: \"\";\n\n\tconst topRAGinformations = extractRelevantRAGinfo(chatbot, question, {\n\t\tRAG: RAGinformations,\n\t\tmaxResults: options && options.maxResults ? options.maxResults : undefined,\n\t});\n\n\treturn {\n\t\tcontent: content.replace(RAGdirective.RAGline, \"\"),\n\t\tRAGinformations: topRAGinformations,\n\t\tRAGprompt: RAGprompt,\n\t};\n}\n","// Récupère le dernier élément HTML dans un élément HTML donné correspondant au sélecteur CSS\nexport function getLastElement(cssSelector, baseElement = document) {\n\tconst elements = baseElement.querySelectorAll(cssSelector);\n\tif (elements.length === 0) {\n\t\treturn null;\n\t}\n\treturn elements[elements.length - 1];\n}\n","// Permet d'extraire la structure d'un message, avec les blocs conditionnels, éventuellement imbriqués\nexport function extractStructureFromMessage(text) {\n\t// Regex pour détecter les balises if et endif\n\tconst ifRegex = /`if\\s+(.*?)`/g;\n\tconst endifRegex = /`endif`/g;\n\n\t// Tableau pour stocker toutes les balises avec leurs positions\n\tconst tokens = [];\n\tlet match;\n\n\t// Chercher tous les `if`\n\t// On enregistre la position et la condition associée à ce `if`\n\twhile ((match = ifRegex.exec(text)) !== null) {\n\t\ttokens.push({\n\t\t\ttype: \"if\",\n\t\t\tposition: match.index,\n\t\t\tlength: match[0].length,\n\t\t\tcondition: match[1],\n\t\t});\n\t}\n\n\t// Chercher tous les `endif`\n\twhile ((match = endifRegex.exec(text)) !== null) {\n\t\ttokens.push({\n\t\t\ttype: \"endif\",\n\t\t\tposition: match.index,\n\t\t\tlength: match[0].length,\n\t\t});\n\t}\n\n\t// Trier les balises par ordre d'apparition dans le texte\n\ttokens.sort((a, b) => a.position - b.position);\n\n\tlet currentIndex = 0;\n\n\t// Fonction récursive pour construire la structure imbriquée\n\tfunction parseLevel(startPos, endPos) {\n\t\tconst result = [];\n\t\tlet i = startPos;\n\n\t\twhile (i < endPos) {\n\t\t\tconst token = tokens[i];\n\n\t\t\tif (!token || token.position >= text.length) break;\n\n\t\t\t// Ajouter le texte avant la balise actuelle\n\t\t\tconst textBefore = text.substring(currentIndex, token.position);\n\n\t\t\tif (textBefore) {\n\t\t\t\tresult.push({ content: textBefore });\n\t\t\t}\n\n\t\t\tif (token.type === \"if\") {\n\t\t\t\t// Trouver le endif correspondant\n\t\t\t\tlet depth = 1;\n\t\t\t\tlet endifIndex = i + 1;\n\n\t\t\t\twhile (endifIndex < tokens.length && depth > 0) {\n\t\t\t\t\tif (tokens[endifIndex].type === \"if\") depth++;\n\t\t\t\t\tif (tokens[endifIndex].type === \"endif\") depth--;\n\t\t\t\t\tif (depth === 0) break;\n\t\t\t\t\tendifIndex++;\n\t\t\t\t}\n\n\t\t\t\t// Déplacer currentIndex après l'expression de la condition `if`\n\t\t\t\tcurrentIndex = token.position + token.length;\n\n\t\t\t\t// Parser récursivement le contenu entre if et endif\n\t\t\t\tconst nestedContent = parseLevel(i + 1, endifIndex);\n\t\t\t\tresult.push({ condition: token.condition, content: nestedContent });\n\n\t\t\t\t// Déplacer currentIndex après le `endif`\n\t\t\t\tif (endifIndex < tokens.length) {\n\t\t\t\t\tcurrentIndex =\n\t\t\t\t\t\ttokens[endifIndex].position + tokens[endifIndex].length;\n\t\t\t\t}\n\n\t\t\t\ti = endifIndex + 1;\n\t\t\t} else {\n\t\t\t\t// C'est un endif, on arrête ce niveau\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\t// Ajouter le texte restant à ce niveau\n\t\tconst remainingText = text.substring(\n\t\t\tcurrentIndex,\n\t\t\tendPos < tokens.length ? tokens[endPos].position : text.length,\n\t\t);\n\n\t\tif (remainingText) {\n\t\t\tresult.push({ content: remainingText });\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tconst structure = parseLevel(0, tokens.length);\n\treturn structure;\n}\n","import { config } from \"../../../config.mjs\";\nimport { tryConvertStringToNumber } from \"../../../utils/strings.mjs\";\n\n// Opérations autorisées pour le calcul des expressions complexes\nconst sanitizeCodeAllowedOperations = [\n\t\"+\",\n\t\"-\",\n\t\"*\",\n\t\"/\",\n\t\"%\",\n\t\"<=\",\n\t\">=\",\n\t\"<\",\n\t\">\",\n\t\"==\",\n\t\"!=\",\n\t\"&&\",\n\t\"||\",\n\t\"!\",\n\t\"(\",\n\t\")\",\n\t\"encodeURI\",\n\t\"Math.abs\",\n\t\"Math.min\",\n\t\"Math.max\",\n\t\"Math.round\",\n\t\".length\",\n\t\".includes\",\n\t\".startsWith\",\n\t\".endsWith\",\n\t\".toLowerCase\",\n\t\".toUpperCase\",\n\t\".trim\",\n\t\",\",\n\t\".\",\n\t\"[\",\n\t\"]\",\n\t\"?\",\n\t\":\",\n\t\"true\",\n\t\"false\",\n\t\"tryConvertStringToNumber\",\n\t\"dynamicVariables\",\n];\n\n// Nettoie une formule de test avant exécution dynamique (new Function).\n// Le but est de supprimer toute tentative d’injection de code non autorisé.\nfunction sanitizeCode(code) {\n\t// On va d'abord enlever dans la formule tout ce qui est autorisé\n\t// Pour pouvoir repérer à la fin ce qu'il faut supprimer\n\n\t// On supprime d'abord dans l'expression les variables dynamiques, qui sont autorisées\n\tlet codeWithoutAllowedOperations = code.replace(\n\t\t/tryConvertStringToNumber\\(.*?\\]\\)/g,\n\t\t\"\",\n\t);\n\n\t// On supprime les chaînes de caractères entre guillemets, qui sont autorisées\n\tcodeWithoutAllowedOperations = codeWithoutAllowedOperations.replace(\n\t\t/\".*?\"/g,\n\t\t\"///\",\n\t);\n\n\t// On supprime les opérations autorisées\n\tsanitizeCodeAllowedOperations.forEach((allowedOperation) => {\n\t\tcodeWithoutAllowedOperations = codeWithoutAllowedOperations.replaceAll(\n\t\t\tallowedOperation,\n\t\t\t\"///\",\n\t\t);\n\t});\n\t// On supprime aussi tous les nombres (ils sont autorisés)\n\tcodeWithoutAllowedOperations = codeWithoutAllowedOperations.replace(\n\t\t/[0-9]*/g,\n\t\t\"\",\n\t);\n\n\t// On peut alors repérer les fragments interdits\n\tconst forbiddenExpressions = codeWithoutAllowedOperations\n\t\t.split(\"///\")\n\t\t.map((exp) => exp.trim()) // On ne doit pas retirer les espaces\n\t\t.filter((exp) => exp && exp !== \"undefined\"); // On ne doit pas retirer la formule \"undefined\"\n\n\t// On retire ces fragments interdits du code initial\n\tfor (const forbidden of forbiddenExpressions) {\n\t\tcode = code.replaceAll(forbidden, \"\");\n\t}\n\treturn code;\n}\n\nexport function evaluateExpression(expression, dynamicVariables) {\n\t// Si on est déjà dans le mode sécurisé (contrôle de la source des chatbots), on n'a pas besoin de sanitizer le code ; sinon, on sanitize le code\n\texpression = config.secureMode ? expression : sanitizeCode(expression);\n\tconst result = new Function(\n\t\t\"dynamicVariables\",\n\t\t\"tryConvertStringToNumber\",\n\t\t\"return \" + expression,\n\t)(dynamicVariables, tryConvertStringToNumber);\n\treturn result;\n}\n","import { getLastElement } from \"../../../../utils/dom.mjs\";\n\n// Évalue un sélecteur CSS sur un contenu HTML donné et retourne le texte de l'élément trouvé\nexport function evaluateSelector(cssSelector, htmlContent) {\n\t// On crée un élément temporaire qui contient le contenu HTML fourni\n\tconst tempElement = document.createElement(\"div\");\n\ttempElement.innerHTML = htmlContent;\n\t// On le rend complètement invisible et hors du flux\n\ttempElement.style.cssText =\n\t\t\"position: absolute; visibility: hidden; pointer-events: none;\";\n\t// On ajoute temporairement cet élément au document\n\tdocument.body.appendChild(tempElement);\n\t// Maintenant on cherche le dernier élément qui correspond au sélecteur CSS dans tout le document en incluant l'élément temporaire\n\tconst selectorAppliedToDocument = getLastElement(cssSelector, document);\n\tlet value = selectorAppliedToDocument\n\t\t? selectorAppliedToDocument.textContent.trim()\n\t\t: \"\";\n\t// On retire l'élément temporaire du document\n\tdocument.body.removeChild(tempElement);\n\treturn value;\n}\n","import { getRandomElement } from \"../../../utils/arrays.mjs\";\nimport { evaluateExpression } from \"./evaluateExpression.mjs\";\nimport { evaluateSelector } from \"./helpers/evaluateSelector.mjs\";\n\nfunction processComplexDynamicVariables(complexExpression, dynamicVariables) {\n\t// Remplace \"@variableName\" par la variable correspondante, en la convertissant en nombre si c'est possible\n\n\t// Cas particulier : si on trouve une variable de type @SELECTOR[\"cssSelector\"], on assigne à dynamicVariables[varName] la chaîne complète pour une évaluation différée\n\tconst selectorMatch = complexExpression.match(/@SELECTOR\\[\"([^\"]+)\"\\]/);\n\tif (selectorMatch) {\n\t\treturn complexExpression;\n\t}\n\n\t// Sinon, on remplace les variables par leurs valeurs\n\tlet calc = complexExpression.replace(\n\t\t/@([\\p{L}0-9_]+)/gu,\n\t\tfunction (match, varName) {\n\t\t\treturn (\n\t\t\t\t'tryConvertStringToNumber(dynamicVariables[\"' + varName.trim() + '\"])'\n\t\t\t);\n\t\t},\n\t);\n\t// Évalue l'expression de manière sécurisée\n\tconst calcResult = evaluateExpression(calc, dynamicVariables);\n\treturn calcResult;\n}\n\nexport function processSimpleBlock(message, dynamicVariables) {\n\tlet output = \"\";\n\tlet index = 0;\n\n\t// On recherche toutes les assignations et les emplois de variables\n\t// Assignations : `@([^\\s=`]+?)\\s*=\\s*([^`]+?)`\n\t// Emplois : `@([^\\s=]+?)`\n\tconst tokenRegex = /`@([^\\s=`]+?)\\s*=\\s*([^`]+?)`|`@([^\\s=]+?)`/gs;\n\n\tlet match;\n\n\t// On traite de manière séquentielle les assignations et emplois de variables\n\twhile ((match = tokenRegex.exec(message)) !== null) {\n\t\tconst fullMatch = match[0];\n\t\tconst beforeText = message.slice(index, match.index);\n\t\tindex = match.index + fullMatch.length;\n\n\t\toutput += beforeText;\n\n\t\t// [1] ASSIGNATION d'une valeur à une variable : `@name = value`\n\t\tif (match[1] !== undefined && match[2] !== undefined) {\n\t\t\tconst varName = match[1];\n\t\t\tlet rawValue = match[2].trim();\n\n\t\t\t// cas spécial \"@INPUT : \"\" : on ne le traite pas ici\n\t\t\tif (rawValue.includes(\"@INPUT : \")) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// cas des variables complexes avec calc(...)\n\t\t\tif (rawValue.startsWith(\"calc(\") && rawValue.endsWith(\")\")) {\n\t\t\t\tconst expr = rawValue.slice(5, -1);\n\t\t\t\ttry {\n\t\t\t\t\tconst calcResult = processComplexDynamicVariables(\n\t\t\t\t\t\texpr,\n\t\t\t\t\t\tdynamicVariables,\n\t\t\t\t\t);\n\t\t\t\t\tdynamicVariables[varName] = calcResult;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"Erreur lors du calcul de\", fullMatch, e);\n\t\t\t\t\tdynamicVariables[varName] = undefined;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// choix avec /// possible\n\t\t\t\tconst parts = rawValue.split(\"///\");\n\t\t\t\tconst chosen = getRandomElement(parts);\n\n\t\t\t\t// Remplace les références intérieures (seulement celles déjà définies)\n\t\t\t\tconst resolved = chosen.replace(/`@([^\\s=]+)`/g, function (_, ref) {\n\t\t\t\t\treturn dynamicVariables[ref] !== undefined &&\n\t\t\t\t\t\tdynamicVariables[ref] !== null\n\t\t\t\t\t\t? dynamicVariables[ref]\n\t\t\t\t\t\t: \"`@\" + ref + \"`\"; // on laisse la référence à la variable si elle n'est pas définie\n\t\t\t\t});\n\n\t\t\t\tdynamicVariables[varName] = resolved;\n\t\t\t}\n\t\t\tcontinue;\n\t\t}\n\n\t\t// [2] EMPLOI d'une variable : on doit remplacer `@name` par sa valeur\n\t\tif (match[3] !== undefined) {\n\t\t\tconst varName = match[3];\n\n\t\t\t// Cas des variables dont la valeur est définie par un @SELECTOR\n\t\t\tconst isVariableWithSelector =\n\t\t\t\tdynamicVariables &&\n\t\t\t\tdynamicVariables[varName] &&\n\t\t\t\ttypeof dynamicVariables[varName] == \"string\" &&\n\t\t\t\tdynamicVariables[varName].includes(\"SELECTOR[\");\n\t\t\tif (isVariableWithSelector) {\n\t\t\t\tconst selectorMatch = dynamicVariables[varName].match(\n\t\t\t\t\t/SELECTOR\\[\"([^\"]+)\"\\]/,\n\t\t\t\t);\n\t\t\t\tif (selectorMatch) {\n\t\t\t\t\tconst cssSelector = selectorMatch[1];\n\t\t\t\t\tlet value = evaluateSelector(cssSelector, output);\n\t\t\t\t\tif (value !== \"\") {\n\t\t\t\t\t\t// Si on a trouvé une valeur, on teste si c'est un bloc spécial\n\t\t\t\t\t\tconst isSpecialBlock =\n\t\t\t\t\t\t\tvalue.includes(\"readcsv\") || value.includes(\"!useLLM\");\n\t\t\t\t\t\tif (!isSpecialBlock) {\n\t\t\t\t\t\t\tdynamicVariables[varName] = value;\n\t\t\t\t\t\t\toutput += value;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toutput += `\\`@${varName}\\``;\n\t\t\t\t\t\t\tcontinue;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\toutput += `\\`@${varName}\\``;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\toutput += `\\`@${varName}\\``;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Cas des variables SELECTOR de type `@SELECTOR[\"cssSelector\"]`\n\t\t\tif (varName.startsWith(\"SELECTOR\")) {\n\t\t\t\tconst selectorMatch = varName.match(/SELECTOR\\[\"([^\"]+)\"\\]/);\n\t\t\t\tif (selectorMatch) {\n\t\t\t\t\tconst cssSelector = selectorMatch[1];\n\t\t\t\t\tlet value = evaluateSelector(cssSelector, output);\n\t\t\t\t\tif (value !== \"\") {\n\t\t\t\t\t\t// Si on a trouvé une valeur, on teste si c'est un bloc spécial\n\t\t\t\t\t\tconst isSpecialBlock =\n\t\t\t\t\t\t\tvalue.includes(\"readcsv\") || value.includes(\"!useLLM\");\n\t\t\t\t\t\tif (isSpecialBlock) {\n\t\t\t\t\t\t\t// Si c'est un bloc spécial, on laisse la référence à la variable pour une évaluation différée\n\t\t\t\t\t\t\tvalue = `\\`@${varName}\\``;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toutput += value;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Si on n'a rien trouvé, on laisse la référence à la variable\n\t\t\t\t\t\t// Elle sera alors interprétée plus tard au moment de l'affichage\n\t\t\t\t\t\toutput += `\\`@${varName}\\``;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Si le format de la variable SELECTOR est incorrect, on remplace par une chaîne vide\n\t\t\t\t\toutput += \"\";\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Cas des variables simples `@variableName`\n\t\t\t\tconst value =\n\t\t\t\t\tdynamicVariables[varName] !== undefined\n\t\t\t\t\t\t? dynamicVariables[varName]\n\t\t\t\t\t\t: \"\";\n\t\t\t\toutput += value;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t}\n\n\t// Reste du texte après la dernière correspondance\n\tconst rest = message.slice(index);\n\toutput += rest;\n\treturn output;\n}\n","import { processSimpleBlock } from \"./processSimpleBlock.mjs\";\nimport { checkConditionalBlock } from \"./checkConditionalBlock.mjs\";\n\n// Fonction récursive qui traite un bloc de contenu, qui peut contenir des sous-blocs, éventuellement conditionnels\nexport function processBlocks(block, dynamicVariables, cumulativeOutput) {\n\tlet output = \"\";\n\n\t// On vérifie si le bloc contient des sous-blocs\n\tconst hasSubBlocks = Array.isArray(block.content);\n\tif (hasSubBlocks) {\n\t\tlet conditionCheck = null;\n\t\t// Si le bloc contient une condition, on la vérifie\n\t\tif (block.condition) {\n\t\t\tconditionCheck = checkConditionalBlock(\n\t\t\t\tblock,\n\t\t\t\tdynamicVariables,\n\t\t\t\tcumulativeOutput,\n\t\t\t);\n\t\t}\n\t\t// On détermine si le bloc doit être traité :\n\t\t// - soit il n'y a pas de condition\n\t\t// - soit la condition est présente et validée par checkConditionalBlock\n\t\tconst shouldProcessBlock =\n\t\t\t!block.condition || (block.condition && conditionCheck.result);\n\t\tif (shouldProcessBlock) {\n\t\t\tconst subBlocks = block.content;\n\t\t\tsubBlocks.forEach((subBlock) => {\n\t\t\t\t// Parcourt chaque sous-bloc et traite récursivement\n\n\t\t\t\t// Cas où la condition nécessite une évaluation différée\n\t\t\t\t// Dans ce cas on réintègre le bloc conditionnel dans le message pour un traitement ultérieur\n\t\t\t\tif (conditionCheck.differEvaluation == true) {\n\t\t\t\t\toutput += `\n\\`if ${conditionCheck.result}\\`\n${processBlocks(subBlock, dynamicVariables)}\n\\`endif\\`\n\t\t\t\t\t`;\n\t\t\t\t} else {\n\t\t\t\t\t// Traitement normal du sous-bloc\n\t\t\t\t\toutput += processBlocks(subBlock, dynamicVariables);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t} else {\n\t\t// Si le bloc n'a pas de sous-blocs, on le traite comme un bloc simple\n\t\toutput += processSimpleBlock(block.content, dynamicVariables);\n\t}\n\treturn output;\n}\n","import { evaluateExpression } from \"./evaluateExpression.mjs\";\nimport { evaluateSelector } from \"./helpers/evaluateSelector.mjs\";\n\n// Si on utilise un bloc conditionnel cette fonction permet de vérifier la condition associée à ce bloc\nexport function checkConditionalBlock(\n\tblock,\n\tdynamicVariables,\n\tcumulativeOutput,\n) {\n\tlet condition = block.condition;\n\ttry {\n\t\t// Remplace les variables personnalisées dans la condition\n\n\t\t// On parcourt d'abord toutes les variables dynamiques pour résoudre celles qui utilisent des sélecteurs\n\t\tif (dynamicVariables) {\n\t\t\tfor (const varName in dynamicVariables) {\n\t\t\t\tconst isVariableWithSelector =\n\t\t\t\t\tdynamicVariables[varName] &&\n\t\t\t\t\ttypeof dynamicVariables[varName] == \"string\" &&\n\t\t\t\t\tdynamicVariables[varName].includes(\"SELECTOR[\");\n\t\t\t\tif (isVariableWithSelector) {\n\t\t\t\t\tconst selectorMatch = dynamicVariables[varName].match(\n\t\t\t\t\t\t/SELECTOR\\[\"([^\"]+)\"\\]/,\n\t\t\t\t\t);\n\t\t\t\t\tif (selectorMatch) {\n\t\t\t\t\t\tconst cssSelector = selectorMatch[1];\n\t\t\t\t\t\tlet value = evaluateSelector(cssSelector, cumulativeOutput);\n\t\t\t\t\t\tif (value !== \"\") {\n\t\t\t\t\t\t\t// Si on a trouvé une valeur, on teste si c'est un bloc spécial\n\t\t\t\t\t\t\tconst isSpecialBlock =\n\t\t\t\t\t\t\t\tvalue.includes(\"readcsv\") || value.includes(\"!useLLM\");\n\t\t\t\t\t\t\tif (!isSpecialBlock) {\n\t\t\t\t\t\t\t\tdynamicVariables[varName] = value;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\tresult: condition,\n\t\t\t\t\t\t\t\t\tdifferEvaluation: true,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tresult: condition,\n\t\t\t\t\t\t\tdifferEvaluation: true,\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// (1) On traite d'abord le cas des variables @SELECTOR[\"cssSelector\"]\n\t\tcondition = condition.replace(\n\t\t\t/@SELECTOR\\[\"([^\"]+)\"\\]/g,\n\t\t\tfunction (match, cssSelector) {\n\t\t\t\tconst value = evaluateSelector(cssSelector, cumulativeOutput);\n\t\t\t\t// Si on a trouvé une valeur, on l'utilise directement\n\t\t\t\tif (value !== \"\") {\n\t\t\t\t\t// Si on a trouvé une valeur, on teste si c'est un bloc spécial\n\t\t\t\t\tconst isSpecialBlock =\n\t\t\t\t\t\tvalue.includes(\"readcsv\") || value.includes(\"!useLLM\");\n\t\t\t\t\tif (isSpecialBlock) {\n\t\t\t\t\t\t// Si c'est un bloc spécial, on indique qu'il faut une évaluation différée de la condition avec le sélecteur\n\t\t\t\t\t\treturn `!DIFFER_EVALUATION:SELECTOR[\"${cssSelector}\"]`;\n\t\t\t\t\t}\n\t\t\t\t\treturn '\"' + value.replaceAll('\"', '\\\\\"').replace(/\\n/g, \" \") + '\"';\n\t\t\t\t} else {\n\t\t\t\t\t// Si on n'a pas trouvé de valeur, on indique qu'il faut une évaluation différée de la condition avec le sélecteur\n\t\t\t\t\treturn `!DIFFER_EVALUATION:SELECTOR[\"${cssSelector}\"]`;\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t\t// Gestion du cas où la condition nécessite une évaluation différée\n\t\tif (condition.includes(\"!DIFFER_EVALUATION\")) {\n\t\t\treturn {\n\t\t\t\tresult: condition.replace(\"!DIFFER_EVALUATION:\", \"@\"),\n\t\t\t\tdifferEvaluation: true,\n\t\t\t};\n\t\t}\n\n\t\t// S'il n'y a pas d'évaluation différée, on continue le traitement\n\n\t\t// (2) On traite le cas des variables simples @variableName\n\t\tcondition = condition.replace(\n\t\t\t/@([\\p{L}0-9_]+)/gu,\n\t\t\tfunction (match, varName) {\n\t\t\t\treturn (\n\t\t\t\t\t'tryConvertStringToNumber(dynamicVariables[\"' + varName.trim() + '\"])'\n\t\t\t\t);\n\t\t\t},\n\t\t);\n\t\t// Gestion des valeurs si elles ne sont pas mises entre guillemets + gestion du cas undefined\n\t\tcondition = condition\n\t\t\t.replaceAll(\n\t\t\t\t/(==|!=|<=|>=|<|>) ?(.*?) ?(\\)|&|\\||$)/g,\n\t\t\t\tfunction (match, comparisonSignLeft, value, comparisonSignRight) {\n\t\t\t\t\tconst isComparisonWithDynamicVariables =\n\t\t\t\t\t\tvalue.includes(\"dynamicVariables\");\n\t\t\t\t\treturn isComparisonWithDynamicVariables\n\t\t\t\t\t\t? `${comparisonSignLeft}${value} ${comparisonSignRight}`\n\t\t\t\t\t\t: `${comparisonSignLeft}\"${value}\" ${comparisonSignRight}`;\n\t\t\t\t},\n\t\t\t)\n\t\t\t.replaceAll('\"\"', '\"')\n\t\t\t.replace('\"undefined\"', \"undefined\");\n\t\t// Évalue l'expression de manière sécurisée\n\t\treturn {\n\t\t\tresult: evaluateExpression(condition, dynamicVariables),\n\t\t\tdifferEvaluation: false,\n\t\t};\n\t} catch (e) {\n\t\tconsole.error(\"Error evaluating condition:\", condition, e);\n\t\treturn { result: false, differEvaluation: false };\n\t}\n}\n","import { extractStructureFromMessage } from \"../../../markdown/custom/variablesDynamic/extractStructureFromMessage.mjs\";\nimport { processBlocks } from \"../../../markdown/custom/variablesDynamic/processBlocks.mjs\";\n\nexport function processConditionalBlocksAtDisplayTime(\n\tmessage,\n\tdynamicVariables,\n) {\n\tconst structureMessage = extractStructureFromMessage(message);\n\tlet output = \"\";\n\tstructureMessage.forEach((block) => {\n\t\t// On fait le traitement des variables dynamiques de manière séquentielle dans chaque bloc de contenu\n\t\toutput += processBlocks(block, dynamicVariables, output);\n\t});\n\tmessage = output;\n\treturn message;\n}\n","import { processComplexDynamicVariables } from \"./complexDynamicVariables.mjs\";\n\nexport function handleUserMessage(\n\tchatbot,\n\tmessage,\n\tdynamicVariables,\n\tgetLastMessage,\n) {\n\t// Cas où le message vient de l'utilisateur\n\t// Traitement du cas où on a dans le message une assignation de variable (qui vient du fait qu'on a cliqué sur une option qui intégrait cette demande d'assignation de variable)\n\tmessage = message.replaceAll(\n\t\t/<span class=\"hidden\">@([^\\s]*?)=(.*?)<\\/span>/g,\n\t\tfunction (match, variableName, variableValue) {\n\t\t\tif (match.includes(\"calc(\")) {\n\t\t\t\ttry {\n\t\t\t\t\t// Calcule l'expression complexe\n\t\t\t\t\tconst complexExpression = variableValue\n\t\t\t\t\t\t.replace(\"calc(\", \"\")\n\t\t\t\t\t\t.trim()\n\t\t\t\t\t\t.slice(0, -1);\n\t\t\t\t\tconst calcResult = processComplexDynamicVariables(\n\t\t\t\t\t\tcomplexExpression,\n\t\t\t\t\t\tdynamicVariables,\n\t\t\t\t\t);\n\t\t\t\t\tdynamicVariables[variableName] = calcResult;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tconsole.error(\"Error evaluating :\", match, e);\n\t\t\t\t\treturn \"<!--\" + match + \"-->\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdynamicVariables[variableName] = variableValue;\n\t\t\t}\n\t\t\treturn \"\";\n\t\t},\n\t);\n\n\t// On enregistre le dernier message de l'utilisateur dans la variable dynamique INPUT.\n\tdynamicVariables[\"INPUT\"] = message;\n\n\tif (getLastMessage) {\n\t\t// Compatibilité avec l'ancienne syntaxe `@variable = @INPUT : redirection` pour récupérer l'input de l'utilisateur et l'assigner à une variable\n\t\t// Si dans le précédent message, on avait demandé à récupérer l'input : on récupère cet input et on le met dans la variable correspondante\n\t\t// puis on renvoie vers le message correspondant\n\t\tif (getLastMessage && getLastMessage.length > 0) {\n\t\t\tdynamicVariables[getLastMessage[0]] = message;\n\t\t\tchatbot.nextMessage.goto = getLastMessage[1];\n\t\t\tgetLastMessage = false;\n\t\t} else {\n\t\t\tchatbot.nextMessage.goto = \"\";\n\t\t}\n\t} else {\n\t\tchatbot.nextMessage.goto = chatbot.nextMessage.needsProcessing\n\t\t\t? chatbot.nextMessage.goto\n\t\t\t: \"\";\n\t}\n\treturn [message, getLastMessage];\n}\n","import { evaluateExpression } from \"./evaluateExpression.mjs\";\n\nexport function processComplexDynamicVariables(\n\tcomplexExpression,\n\tdynamicVariables,\n) {\n\t// Remplace \"@variableName\" par la variable correspondante, en la convertissant en nombre si c'est possible\n\tlet calc = complexExpression.replace(\n\t\t/@([\\p{L}0-9_]+)/gu,\n\t\tfunction (match, varName) {\n\t\t\treturn (\n\t\t\t\t'tryConvertStringToNumber(dynamicVariables[\"' + varName.trim() + '\"])'\n\t\t\t);\n\t\t},\n\t);\n\t// Évalue l'expression de manière sécurisée\n\tconst calcResult = evaluateExpression(calc, dynamicVariables);\n\treturn calcResult;\n}\n","import { handleBotMessage } from \"./variablesDynamic/handleBotMessage.mjs\";\nimport { handleUserMessage } from \"./variablesDynamic/handleUserMessage.mjs\";\n\nlet getLastMessage = false;\n\nexport function processDynamicVariables(\n\tchatbot,\n\tmessage,\n\tdynamicVariables,\n\tisUser,\n) {\n\tif (!isUser) {\n\t\t// Cas où le message vient du bot\n\t\tconst [processedMessage, processedGetLastMessage] = handleBotMessage(\n\t\t\tmessage,\n\t\t\tdynamicVariables,\n\t\t\tgetLastMessage,\n\t\t);\n\t\tmessage = processedMessage;\n\t\tgetLastMessage = processedGetLastMessage;\n\t} else {\n\t\tconst [processedMessage, processedGetLastMessage] = handleUserMessage(\n\t\t\tchatbot,\n\t\t\tmessage,\n\t\t\tdynamicVariables,\n\t\t\tgetLastMessage,\n\t\t);\n\t\tmessage = processedMessage;\n\t\tgetLastMessage = processedGetLastMessage;\n\t}\n\treturn message;\n}\n","import { extractStructureFromMessage } from \"./extractStructureFromMessage.mjs\";\nimport { processBlocks } from \"./processBlocks.mjs\";\n\nexport function handleBotMessage(message, dynamicVariables, getLastMessage) {\n\t// On masque dans le texte les demandes de définition d'une variable par le prochain Input\n\tmessage = message.replaceAll(\n\t\t/`@([^\\s]*?) ?= ?@INPUT : (.*)`/g,\n\t\tfunction (match, variableName, nextAnswer) {\n\t\t\tgetLastMessage = match ? [variableName, nextAnswer] : false;\n\t\t\treturn \"\";\n\t\t},\n\t);\n\n\t// On extrait la structure du message, avec éventuellement des blocs conditionnels, qui peuvent être imbriqués\n\tconst structureMessage = extractStructureFromMessage(message);\n\tlet output = \"\";\n\tstructureMessage.forEach((block) => {\n\t\t// On fait le traitement des variables dynamiques de manière séquentielle dans chaque bloc de contenu\n\t\toutput += processBlocks(block, dynamicVariables, output);\n\t});\n\tmessage = output;\n\n\t// Au lieu de récupérer l'input, on peut récupérer le contenu d'un bouton qui a été cliqué et on assigne alors ce contenu à une variable : pour cela on intègre la variable dans le bouton, et on la masque avec la classe \"hidden\"\n\n\t// On masque l'assignation de la variable dans le bouton\n\tmessage = message.replaceAll(\n\t\t/ (@[^\\s]*?=.*?)</g,\n\t\t'<span class=\"hidden\">$1</span><',\n\t);\n\t// Cas où il n'y a qu'une simple assignation sans autre texte\n\t// Exemple : 1. [@choix=Choix 1](cible)\n\t// On affiche dans le bouton \"Choix 1\", et on garde dans un élément HTML caché l'assignation de valeur qui sera à traiter.\n\tmessage = message.replaceAll(\n\t\t/>(@[^\\s]*?)=(.*?)</g,\n\t\t'><span class=\"hidden\">$1=$2</span>$2<',\n\t);\n\n\t// On masque aussi, dans le message qui s'est affiché suite au clic sur le bouton, l'assignation de la variable qui a été transmise à ce message\n\tmessage = message.replaceAll(\n\t\t/class=\"(.*)?\">(@[^\\s]*?=)/g,\n\t\t(match, beforeVariable, variable) => {\n\t\t\treturn beforeVariable.includes(\"hidden\")\n\t\t\t\t? `class=\"${beforeVariable}\">${variable}`\n\t\t\t\t: `class=\"${beforeVariable}\"><span class=\"hidden\">${variable}</span>`;\n\t\t},\n\t);\n\n\t// On nettoie le message en supprimant les lignes vides en trop\n\tmessage = message.replaceAll(/\\n\\n\\n*/g, \"\\n\\n\");\n\treturn [message, getLastMessage];\n}\n","function success(pos, chatbot) {\n\tvar crd = pos.coords;\n\tchatbot.dynamicVariables.LATITUDE = crd.latitude;\n\tchatbot.dynamicVariables.LONGITUDE = crd.longitude;\n\tchatbot.dynamicVariables.POSITION_ACCURACY = crd.accuracy;\n}\n\nfunction error(err) {\n\tconsole.warn(`ERREUR (${err.code}): ${err.message}`);\n}\n\nfunction getCurrentPosition(options) {\n\treturn new Promise((resolve, reject) => {\n\t\tnavigator.geolocation.getCurrentPosition(resolve, reject, options);\n\t});\n}\n\nconst options = {\n\tenableHighAccuracy: true,\n\ttimeout: 5000,\n\tmaximumAge: 0,\n};\nexport async function processGeolocation(chatbot) {\n\ttry {\n\t\tconst position = await getCurrentPosition(options);\n\t\tsuccess(position, chatbot);\n\t} catch (err) {\n\t\terror(err);\n\t}\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { processRandomMessage } from \"../../../markdown/custom/random.mjs\";\nimport { processFixedVariables } from \"../../../../js/markdown/custom/variablesFixed.mjs\";\nimport { processDynamicVariables } from \"../../../../js//markdown/custom/variablesDynamic.mjs\";\nimport { processGeolocation } from \"./processGeolocation.mjs\";\n\nexport async function processVariables(chatbot, message, isUser) {\n\tlet dynamicVariables = chatbot.dynamicVariables;\n\t// Gestion des variables fixes prédéfinies\n\tif (yaml && yaml.variables) {\n\t\tmessage = processFixedVariables(message, yaml);\n\t}\n\tif (!isUser) {\n\t\tmessage = processRandomMessage(message);\n\t\tif (yaml && yaml.geolocation) {\n\t\t\tconst isMessageWithGeolocationVariable =\n\t\t\t\tmessage.indexOf(\"@LATITUDE\") > -1 ||\n\t\t\t\tmessage.indexOf(\"@LONGITUDE\") > -1 ||\n\t\t\t\tmessage.indexOf(\"@POSITION_ACCURACY\") > -1;\n\t\t\tif (isMessageWithGeolocationVariable) {\n\t\t\t\tawait processGeolocation(chatbot);\n\t\t\t}\n\t\t}\n\t}\n\n\tif (yaml && yaml.dynamicContent) {\n\t\t// On traite les variables dynamiques\n\t\tmessage = processDynamicVariables(\n\t\t\tchatbot,\n\t\t\tmessage,\n\t\t\tdynamicVariables,\n\t\t\tisUser,\n\t\t);\n\t}\n\treturn message;\n}\n","import { getRandomElement } from \"../../utils/arrays.mjs\";\n\n// Gestion du cas où il y a plusieurs messages possibles de réponse, séparés par \"---\"\nexport function processRandomMessage(message) {\n\tconst SEPARATOR = \"\\n---\\n\";\n\t// Découpe en variantes et ignore les parties vides (espaces / retours à la ligne) ou seulement avec des commentaires\n\tconst messageVariants = message\n\t\t.split(SEPARATOR)\n\t\t.map((part) => part.replace(/<!--[\\s\\S]*?-->/g, \"\").trim())\n\t\t.filter((part) => part.length > 0);\n\n\tif (messageVariants.length > 1) {\n\t\tconst choiceOptionsIndex = message.indexOf('<ul class=\"messageOptions\">');\n\t\tif (choiceOptionsIndex > -1) {\n\t\t\tconst baseMessage = message.substring(0, choiceOptionsIndex);\n\t\t\tconst choiceOptionsHtml = message.substring(choiceOptionsIndex);\n\t\t\t// On découpe la partie 'baseMessage' en variantes et on ignore les parties vides\n\t\t\tconst baseMessageVariants = baseMessage\n\t\t\t\t.split(\"---\")\n\t\t\t\t.map((part) => part.replace(/<!--[\\s\\S]*?-->/g, \"\").trim())\n\t\t\t\t.filter((part) => part.length > 0);\n\t\t\tif (baseMessageVariants.length > 0) {\n\t\t\t\tmessage = getRandomElement(baseMessageVariants) + choiceOptionsHtml;\n\t\t\t}\n\t\t} else {\n\t\t\tmessage = getRandomElement(messageVariants);\n\t\t}\n\t}\n\treturn message;\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { processAudio } from \"../../../markdown/custom/directives/audio.mjs\";\nimport { processDirectiveNext } from \"../../../markdown/custom/directives/next.mjs\";\nimport { processDirectiveSelectNext } from \"../../../markdown/custom/directives/selectNext.mjs\";\nimport { processDirectiveBot } from \"../../../markdown/custom/directives/bot.mjs\";\nimport { processDirectiveKeyboard } from \"../../../markdown/custom/directives/keyboard.mjs\";\n\nexport function processDirectives(chatbot, message, container) {\n\t// Gestion de la directive !Bot: botName\n\tif (yaml && yaml.bots) {\n\t\tmessage = processDirectiveBot(message, container);\n\t}\n\n\t// Gestion de l'audio\n\tmessage = processAudio(message);\n\n\t// Gestion de la directive !Next: Titre réponse / message si mauvaise réponse\n\tmessage = processDirectiveNext(chatbot, message);\n\n\t// Gestion de la directive !SelectNext pour sélectionner aléatoirement le prochain message du chatbot\n\tmessage = processDirectiveSelectNext(chatbot, message);\n\n\t// Gestion de la directive !Keyboard : possibilité d'activer ou de désactiver le clavier au cas par cas\n\tmessage = processDirectiveKeyboard(message, yaml, chatbot.dynamicVariables);\n\n\treturn message;\n}\n","import { yaml } from \"../yaml.mjs\";\nimport { obfuscateString } from \"../../../utils/strings.mjs\";\n\n// Gestion de la directive !Next: Titre réponse / message si mauvaise réponse\nexport function processDirectiveNext(chatbot, message) {\n\tmessage = message.replaceAll(\n\t\t/!Next ?:(.*)/g,\n\t\tfunction (match, nextDirectiveContent) {\n\t\t\tconst nextDirectiveContentSplit = nextDirectiveContent.split(\"/\");\n\t\t\tlet nextDirectiveOptions;\n\t\t\tif (nextDirectiveContentSplit.length > 0) {\n\t\t\t\tnextDirectiveContent = nextDirectiveContentSplit[0];\n\t\t\t\tnextDirectiveOptions = nextDirectiveContentSplit[1];\n\t\t\t} else {\n\t\t\t\tnextDirectiveContent = nextDirectiveContentSplit[0];\n\t\t\t}\n\t\t\tconst isLoopMode = nextDirectiveContent.includes(\"!loop\");\n\n\t\t\tchatbot.nextMessage.lastMessageFromBot = message;\n\t\t\tchatbot.nextMessage.goto = nextDirectiveContent\n\t\t\t\t.replace(\"!loop\", \"\")\n\t\t\t\t.trim();\n\t\t\tchatbot.nextMessage.ignoreKeywords =\n\t\t\t\tnextDirectiveOptions && nextDirectiveOptions.includes(\"ignoreKeywords\")\n\t\t\t\t\t? true\n\t\t\t\t\t: false;\n\t\t\tchatbot.nextMessage.needsProcessing = true;\n\t\t\tchatbot.nextMessage.messageIfKeywordsNotFound = nextDirectiveOptions\n\t\t\t\t? nextDirectiveOptions.trim()\n\t\t\t\t: \"Ce n'était pas la bonne réponse, merci de réessayer !\";\n\t\t\tchatbot.nextMessage.messageIfKeywordsNotFound =\n\t\t\t\tchatbot.nextMessage.messageIfKeywordsNotFound + \"\\n\\n\";\n\t\t\tchatbot.nextMessage.errorsCounter++;\n\t\t\tif (\n\t\t\t\tmatch &&\n\t\t\t\t(chatbot.nextMessage.errorsCounter < chatbot.nextMessage.maxErrors ||\n\t\t\t\t\tisLoopMode)\n\t\t\t) {\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\tconst skipMessage = `<ul class=\"messageOptions\"><li><a href=\"#${\n\t\t\t\t\tyaml.obfuscate\n\t\t\t\t\t\t? obfuscateString(chatbot.nextMessage.goto)\n\t\t\t\t\t\t: chatbot.nextMessage.goto\n\t\t\t\t}\">Passer à la suite !</a></li></ul>`;\n\t\t\t\treturn skipMessage;\n\t\t\t}\n\t\t},\n\t);\n\treturn message;\n}\n","// Gestion de l'audio\nexport function processAudio(message) {\n\t// Gestion des éléments audio autoplay\n\tmessage = message.replaceAll(\n\t\t/<audio[\\s\\S]*?src=\"([^\"]+)\"[\\s\\S]*?<\\/audio>/gm,\n\t\tfunction (match, v1) {\n\t\t\tif (match.includes(\"autoplay\")) {\n\t\t\t\tconst audio = new Audio(v1);\n\t\t\t\taudio.play();\n\t\t\t\tif (match.includes(\"loop\")) {\n\t\t\t\t\taudio.addEventListener(\"ended\", () => {\n\t\t\t\t\t\taudio.currentTime = 0;\n\t\t\t\t\t\taudio.play();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn `<!--${match}-->`;\n\t\t\t} else {\n\t\t\t\treturn match;\n\t\t\t}\n\t\t},\n\t);\n\t// Gestion de l'audio avec la directive !Audio\n\tmessage = message.replaceAll(/!Audio:(.*)/g, function (match, v1) {\n\t\tconst audio = new Audio(v1.trim());\n\t\taudio.play();\n\t\treturn \"\";\n\t});\n\n\treturn message;\n}\n","import { getRandomElement } from \"../../../utils/arrays.mjs\";\n\n// Gestion de la directive !SelectNext pour sélectionner aléatoirement le prochain message du chatbot\nexport function processDirectiveSelectNext(chatbot, message) {\n\tmessage = message.replaceAll(/!SelectNext:(.*)/g, function (match, v1) {\n\t\tif (match) {\n\t\t\tconst v1Split = v1.split(\"/\");\n\t\t\tchatbot.nextMessage.lastMessageFromBot = \"\";\n\t\t\tchatbot.nextMessage.goto = \"\";\n\t\t\tchatbot.nextMessage.needsProcessing = false;\n\t\t\tchatbot.nextMessage.selected = getRandomElement(v1Split).trim();\n\t\t\treturn \"\";\n\t\t} else {\n\t\t\tchatbot.nextMessage.selected = \"\";\n\t\t}\n\t});\n\treturn message;\n}\n","import { sendButton, controlsElement } from \"../../../shared/selectors.mjs\";\n\nexport function processDirectiveKeyboard(message, yaml, dynamicVariables) {\n\tconst match = message.match(/!Keyboard\\s*:\\s*(true|false)/i);\n\tif (match) {\n\t\tmessage = message.replace(match[0], \"\");\n\t\tconst useKeyboard = match[1].toLowerCase() === \"true\";\n\t\tdynamicVariables[\"KEYBOARD\"] = useKeyboard ? \"true\" : \"false\";\n\t}\n\tif (yaml && yaml.userInput === false) {\n\t\t// Cas où le clavier est désactivé par défaut\n\t\tif (dynamicVariables[\"KEYBOARD\"] == \"true\") {\n\t\t\t// Cas où dans une réponse on décide d'afficher le clavier\n\t\t\tsendButton.innerHTML = \"Envoyer\";\n\t\t\tdocument.body.classList.remove(\"hideControls\");\n\t\t\tif (yaml.footer === false) {\n\t\t\t\tcontrolsElement.style.setProperty(\"height\", \"110px\", \"important\");\n\t\t\t}\n\t\t\tdynamicVariables[\"KEYBOARD\"] = \"false\";\n\t\t} else {\n\t\t\tsendButton.innerHTML = \"Afficher tout\";\n\t\t\tdocument.body.classList.add(\"hideControls\");\n\t\t\tif (yaml.footer === false) {\n\t\t\t\tcontrolsElement.style.setProperty(\"height\", \"50px\", \"important\");\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// Cas où le clavier est activé par défaut\n\t\tif (dynamicVariables[\"KEYBOARD\"] == \"false\") {\n\t\t\t// Cas où dans une réponse on décide de désactiver le clavier\n\t\t\tsendButton.innerHTML = \"Afficher tout\";\n\t\t\tdocument.body.classList.add(\"hideControls\");\n\t\t\tdynamicVariables[\"KEYBOARD\"] = \"true\";\n\t\t} else {\n\t\t\tsendButton.innerHTML = \"Envoyer\";\n\t\t\tdocument.body.classList.remove(\"hideControls\");\n\t\t}\n\t}\n\treturn message;\n}\n","// Attend que la librairie Papa.parse soit disponible\nfunction waitForPapaParse() {\n\treturn new Promise((resolve) => {\n\t\tif (window.Papa) {\n\t\t\tresolve();\n\t\t\treturn;\n\t\t}\n\n\t\tconst checkInterval = setInterval(() => {\n\t\t\tif (window.Papa) {\n\t\t\t\tclearInterval(checkInterval);\n\t\t\t\tresolve();\n\t\t\t}\n\t\t}, 500);\n\n\t\t// Timeout de sécurité (10 secondes)\n\t\tsetTimeout(() => {\n\t\t\tclearInterval(checkInterval);\n\t\t\tif (!window.Papa) {\n\t\t\t\tthrow new Error(\"Papa Parse n'a pas pu être chargé\");\n\t\t\t}\n\t\t}, 10000);\n\t});\n}\n\n// Vérifie si les données sont du JSON\nfunction isJsonData(data) {\n\tconst trimmed = data.trim();\n\treturn trimmed.startsWith(\"{\") || trimmed.startsWith(\"[\");\n}\n\n// Traite les données avec PapaParse\nfunction parseWithPapa(data, options = {}) {\n\treturn new Promise((resolve, reject) => {\n\t\twindow.Papa.parse(data, {\n\t\t\tskipEmptyLines: true,\n\t\t\t...options,\n\t\t\tcomplete: (results) => resolve(results),\n\t\t\terror: (error) => reject(error),\n\t\t});\n\t});\n}\n\n// Pour parser les données si elles sont en JSON\nfunction parseJsonData(data) {\n\tconst jsonData = JSON.parse(data);\n\tconst dataArray = jsonData.results || jsonData;\n\tconst csv = window.Papa.unparse(dataArray);\n\treturn parseWithPapa(csv);\n}\n\n// Pour parser les données si elles sont en CSV\nfunction parseCsvData(data, options) {\n\treturn parseWithPapa(data, options);\n}\n\nexport async function parseCsv(url, options = {}) {\n\t// On attend que papaparse soit disponible\n\tawait waitForPapaParse();\n\ttry {\n\t\t// On télécharge le contenu\n\t\tconst response = await fetch(url);\n\t\tif (!response.ok) {\n\t\t\tthrow new Error(`Erreur HTTP: ${response.status}`);\n\t\t}\n\n\t\tconst data = await response.text();\n\n\t\t// Si c'est du JSON\n\t\tif (isJsonData(data)) {\n\t\t\treturn await parseJsonData(data);\n\t\t}\n\n\t\t// Si c'est du CSV/TSV\n\t\tif (url.endsWith(\".tsv\")) {\n\t\t\t// Pour les TSV, on utilise la tabulation comme délimiteur, sauf si spécifié autrement dans les options\n\t\t\toptions.delimiter = options.delimiter ? options.delimiter : \"\\t\";\n\t\t}\n\n\t\treturn await parseCsvData(data, options);\n\t} catch (error) {\n\t\tconsole.error(\"Erreur lors du parsing:\", error);\n\t\tthrow error;\n\t}\n}\n","// Plugin pour lire un fichier CSV, filtrer les données en fonction d'une condition, et les afficher avec un template\n\nimport { evaluateExpression } from \"../../../../markdown/custom/variablesDynamic/evaluateExpression.mjs\";\nimport { parseCsv } from \"../../../../utils/csv.mjs\";\n\n// Transforme une expression de filtre contenant des placeholders $1, $2 …\n// et des conditions de type \"==\" ou \"<\" …\n// en une expression javascript sécurisée qui sera évaluée avec evaluateExpression\nfunction transformExpression(expr) {\n\treturn expr.replace(/\\$(\\d+)/g, (_, index) => {\n\t\t// Convertit l'index de placeholder $n en index de tableau\n\t\tconst i = parseInt(index, 10) - 1;\n\t\t// Remplace $n par un accès sécurisé à la colonne correspondante de la ligne\n\t\t// avec conversion automatique en nombre si nécessaire\n\t\treturn `tryConvertStringToNumber(dynamicVariables.row[${i}])`;\n\t});\n}\n\n// Filtre un tableau de données en fonction d'une expression conditionnelle.\n// Chaque ligne du tableau est testée avec l'expression fournie\n// qui peut utiliser des placeholders $1, $2, ...\n// correspondant aux colonnes de la ligne.\nfunction filterTable(table, expr) {\n\tconst [...rows] = table;\n\n\t// Transforme l'expression avec $1, $2... en version sécurisée\n\tconst safeExpr = transformExpression(expr);\n\n\t// Fonction de test pour chaque ligne\n\tconst rowMatchesCondition = (row) => {\n\t\treturn evaluateExpression(safeExpr, { row });\n\t};\n\n\t// On filtre le tableau avec cette fonction de test\n\tconst filteredRows = rows.filter(rowMatchesCondition);\n\treturn [...filteredRows];\n}\n\n// Fonction pour convertir les valeurs d'un tableau de données dans leur bon format (nombre, date ou chaîne de caractères), afin de permettre un tri de ces données\nfunction convertValue(val, type) {\n\tif (type === \"num\") {\n\t\treturn typeof val === \"string\"\n\t\t\t? parseFloat(val.replace(\",\", \".\")) || 0\n\t\t\t: val;\n\t}\n\tif (type === \"date\") return new Date(val);\n\treturn String(val);\n}\n\n// Tri un tableau de données en fonction d'une formule de tri\n// Syntaxe : $<colonne> [asc|desc] [num|alph|date]\n// Exemple : \"$1 asc num, $3 desc alph\"\nfunction sortTable(data, sortFormula) {\n\tconst rules = sortFormula\n\t\t.split(\",\")\n\t\t.map((crit) => {\n\t\t\tconst parts = crit.trim().split(/\\s+/);\n\t\t\tconst orderPart = parts.find((p) => /^(asc|desc)$/i.test(p));\n\t\t\tconst typePart = parts.find((p) => /^(num|alph|date)$/i.test(p));\n\t\t\treturn {\n\t\t\t\tcolIndex: parseInt(parts[0].slice(1)) - 1,\n\t\t\t\torder: orderPart ? orderPart.toLowerCase() : \"asc\",\n\t\t\t\ttype: typePart ? typePart.toLowerCase() : \"alph\",\n\t\t\t};\n\t\t})\n\t\t.filter((rule) => !isNaN(rule.colIndex));\n\n\treturn [...data].sort((a, b) => {\n\t\tfor (const { colIndex, order, type } of rules) {\n\t\t\t// On convertit les données dans le bon format (nombre, date, chaîne de caractères) pour pouvoir faire le tri\n\t\t\tconst valA = convertValue(a[colIndex], type);\n\t\t\tconst valB = convertValue(b[colIndex], type);\n\n\t\t\tlet comparison;\n\t\t\tif (type === \"alph\") {\n\t\t\t\t// Si c'est un tri alphabétique, on le fait par défaut en français, sans prendre en compte la casse, et en prenant en compte les nombres\n\t\t\t\tcomparison = valA.localeCompare(valB, \"fr\", {\n\t\t\t\t\tsensitivity: \"base\",\n\t\t\t\t\tnumeric: true,\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tif (valA < valB) comparison = -1;\n\t\t\t\telse if (valA > valB) comparison = 1;\n\t\t\t\telse comparison = 0;\n\t\t\t}\n\t\t\t// Si on doit trier en sens inverse\n\t\t\tif (comparison !== 0) {\n\t\t\t\treturn order === \"asc\" ? comparison : -comparison;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t});\n}\n\n// Remplace les marqueurs de type $1, $2, … dans un template texte par les valeurs\n// correspondantes provenant d'un tableau de lignes.\n// Chaque placeholder $n est remplacé par la valeur de la colonne correspondante\nfunction fillTemplateFromValuesFromArray(template, sourceArray) {\n\t// Fonction interne pour remplacer les placeholders dans une ligne\n\tconst replaceFn = (row) =>\n\t\ttemplate.replace(/\\$(\\d+)/g, (_, index) => {\n\t\t\t// Convertit l'index de placeholder $n en index de tableau\n\t\t\tconst i = parseInt(index, 10) - 1;\n\t\t\t// Remplace le placeholder par la valeur correspondante de la colonne ou par une chaîne vide s'il n'y a pas de valeur\n\t\t\treturn row[i] !== undefined && row[i] !== null ? row[i] : \"\";\n\t\t});\n\n\t// Applique la transformation à chaque ligne du tableau\n\tconst result = sourceArray.map((row) => replaceFn(row));\n\treturn result.join(\"\\n\").trim().replaceAll(\"\\\\n\", \"\\n\");\n}\n\n// Traite un message contenant des blocs CSV au format markdown, commençant par : ```readcsv URL, optionnellement suivi d'une condition, et d'un template de texte\n// Pour chaque bloc trouvé :\n// 1. Télécharge et parse le CSV depuis l'URL spécifiée.\n// 2. Cherche une ligne commençant par \"condition:\" pour filtrer les données.\n// 3. Supprime la ligne \"condition:\" du template si elle existe.\n// 4. Applique la condition (si présente) pour filtrer les lignes du CSV.\n// 5. Remplit le template avec les valeurs des lignes restantes.\n// 6. Remplace le bloc original dans le message par le résultat formaté.\nexport async function processCsv(message) {\n\t// Regex pour détecter tous les blocs ```readcsv URL ... ```\n\tconst regex = /```readcsv (.*)\\n((.|\\n)*?)```/gm;\n\tconst matches = [...message.matchAll(regex)];\n\n\t// Parcourt tous les blocs trouvés\n\tfor (const match of matches) {\n\t\tconst [fullMatch, url, codeBlockContent] = match;\n\n\t\t// Parse le CSV à partir de l'URL\n\t\tconst csvObject = await parseCsv(url);\n\t\tif (csvObject) {\n\t\t\tlet data = csvObject.data;\n\t\t\tdata.shift(); // supprime la ligne d'en-têtes\n\n\t\t\tconst linesCodeBlock = codeBlockContent.split(\"\\n\");\n\n\t\t\tlet condition = null;\n\t\t\tlet sortFormula = null;\n\t\t\tlet maxResults = null;\n\t\t\t// Filtrer les lignes pour récupérer la condition si elle existe\n\t\t\tconst templateLines = linesCodeBlock.filter((line) => {\n\t\t\t\tconst trimmedLine = line.trim();\n\t\t\t\tif (trimmedLine.startsWith(\"condition:\")) {\n\t\t\t\t\t// Récupère la condition (après \"condition: \")\n\t\t\t\t\tcondition = trimmedLine.replace(/^condition:\\s*/, \"\");\n\t\t\t\t\treturn false; // exclut la ligne \"condition: \"\" du template\n\t\t\t\t}\n\t\t\t\tif (trimmedLine.startsWith(\"sort:\")) {\n\t\t\t\t\t// Récupère le critère de tri (après \"sort: \")\n\t\t\t\t\tsortFormula = trimmedLine.replace(/^sort:\\s*/, \"\");\n\t\t\t\t\treturn false; // exclut la ligne \"sort: \" du template\n\t\t\t\t}\n\t\t\t\tif (trimmedLine.startsWith(\"maxResults:\")) {\n\t\t\t\t\t// Récupère le nombre maximum de résultats à afficher (après \"maxResults: \")\n\t\t\t\t\tmaxResults = parseInt(trimmedLine.replace(/^maxResults:\\s*/, \"\"), 10);\n\t\t\t\t\treturn false; // exclut la ligne \"max: \" du template\n\t\t\t\t}\n\t\t\t\treturn true; // conserve toutes les autres lignes\n\t\t\t});\n\n\t\t\tconst template = templateLines.join(\"\\n\").trim();\n\n\t\t\t// Si une condition est présente, filtre les données du CSV\n\t\t\tif (condition) {\n\t\t\t\tdata = filterTable(data, condition);\n\t\t\t}\n\n\t\t\t// S'il y a un tri particulier des résultats à respecter, on applique ce tri aux données filtrées\n\t\t\tif (sortFormula) {\n\t\t\t\tdata = sortTable(data, sortFormula);\n\t\t\t}\n\n\t\t\t// Si un nombre maximum de lignes est spécifié, on limite les données à ce nombre\n\t\t\tif (maxResults && !isNaN(maxResults)) {\n\t\t\t\tdata = data.slice(0, maxResults);\n\t\t\t}\n\n\t\t\t// Remplit le template avec les valeurs des lignes filtrées\n\t\t\tconst result = fillTemplateFromValuesFromArray(template, data);\n\n\t\t\t// Remplace le bloc original dans le message par le résultat formaté\n\t\t\tmessage = message.replace(fullMatch, result);\n\t\t}\n\t}\n\n\treturn message;\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { processKroki } from \"./plugins/processKroki.mjs\";\nimport { processCsv } from \"./plugins/readCsv.mjs\";\n\nexport async function processPlugins(message) {\n\t// Gestion de schémas et images créés avec mermaid, tikz, graphviz, plantuml …  grâce à Kroki (il faut l'inclure en plugin si on veut l'utiliser)\n\tif (yaml && yaml.plugins && yaml.plugins.includes(\"kroki\")) {\n\t\tmessage = processKroki(message);\n\t}\n\tif (yaml && yaml.plugins && yaml.plugins.includes(\"readcsv\")) {\n\t\tmessage = await new Promise((resolve) => {\n\t\t\t// Délai autorisé de traitement du csv (en millisecondes)\n\t\t\tconst TIMEOUT_MS = 5000;\n\t\t\tconst start = Date.now();\n\t\t\t// On vérifie que la librairie pour lire les CSV est bien chargée\n\t\t\tconst interval = setInterval(async () => {\n\t\t\t\t// Si le processus prend trop de temps, on arrête et on renvoie le message initial, non modifié\n\t\t\t\tif (Date.now() - start > TIMEOUT_MS) {\n\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\tresolve(message);\n\t\t\t\t}\n\t\t\t\t// Si la librairie pour lire les CSV est bien chargée, on procède au traitement des données, sinon on renvoie le message initial non modifiée\n\t\t\t\tif (window.Papa) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tclearInterval(interval);\n\t\t\t\t\t\tconst result = await processCsv(message);\n\t\t\t\t\t\tresolve(result);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\tconsole.log(error);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(message);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 500);\n\t\t});\n\t}\n\treturn message;\n}\n","// Gestion de schémas et images créés avec mermaid, tikz, graphviz, plantuml …  grâce à Kroki (il faut l'inclure en plugin si on veut l'utiliser)\n\nexport function processKroki(message) {\n\tmessage = message.replaceAll(\n\t\t/```(mermaid|tikz|graphviz|plantuml|excalidraw|vegalite|vega)((.|\\n)*?)```/gm,\n\t\tfunction (match, type, source) {\n\t\t\tsource = source.replaceAll(\"\\n\\n\\n\", \"\\n\\n\");\n\t\t\treturn window.krokiCreateImageFromSource(type, source);\n\t\t},\n\t);\n\treturn message;\n}\n","import { displayMessage } from \"./displayMessage.mjs\";\nimport { extractMarkdownAndPrompts } from \"../../markdown/custom/directives/useLLM/extractMarkdownAndPrompts.mjs\";\nimport { getChatbotResponse } from \"../interactions/getChatbotResponse.mjs\";\nimport { processMessageWithPrompt } from \"../../markdown/custom/directives/useLLM/processMessageWithPrompt.mjs\";\nimport { createMessageElement } from \"./helpers/dom.mjs\";\nimport { processVariables } from \"./helpers/processVariables.mjs\";\nimport { processDirectives } from \"./helpers/processDirectives.mjs\";\nimport { processPlugins } from \"./helpers/processPlugins.mjs\";\nimport { encodeString } from \"../../utils/strings.mjs\";\nimport { yaml } from \"../../markdown/custom/yaml.mjs\";\nimport { sendChatbotData } from \"./helpers/plugins/scorm.mjs\";\nimport { scopeStyles } from \"../../utils/css.mjs\";\nimport { processConditionalBlocksAtDisplayTime } from \"./helpers/processConditionalBlocksAtDisplayTime.mjs\";\n\nfunction handleBotResponse(chatbot) {\n\tif (chatbot.nextMessage.selected) {\n\t\treturn getChatbotResponse(chatbot, chatbot.nextMessage.selected);\n\t}\n}\n\n// Création du message par le bot ou l'utilisateur\nexport async function createMessage(chatbot, message, options) {\n\tconst originalMessage = message;\n\tconst isUser = options && options.isUser;\n\tconst changeExistingMessage = options && options.changeExistingMessage;\n\tconst disableTypewriter = options && options.disableTypewriter;\n\tconst noMessageMenu = options && options.noMessageMenu;\n\tlet messageElement =\n\t\t(options && options.messageElement) || createMessageElement(isUser);\n\tconst prefixWithIdMessage = \"#\" + messageElement.id;\n\tmessage = scopeStyles(message, prefixWithIdMessage);\n\n\tchatbot.nextMessage.selected = undefined;\n\n\tmessage = await processVariables(chatbot, message, isUser);\n\n\tif (!isUser) {\n\t\t// Si c'est un message du Bot, on traite les directives et les plugins\n\t\tmessage = processDirectives(chatbot, message, messageElement);\n\t\tmessage = await processPlugins(message);\n\t}\n\n\tconst checkPromptsinMessage = extractMarkdownAndPrompts(message);\n\tconst hasPromptInmessage = checkPromptsinMessage.useLLM;\n\n\t// On affiche un bouton de menu pour chaque message du bot, sauf si on a l'option noMessageMenu, si on est en train de traiter une partie d'un message qui contient un mélange de prompt et de Markdown, ou si le message affiché est le message initial\n\tif (\n\t\t!isUser &&\n\t\t!noMessageMenu &&\n\t\t!hasPromptInmessage &&\n\t\tmessage != chatbot.initialMessage\n\t) {\n\t\tconst actionsHistory = chatbot.actions.join(`|`);\n\t\tconst messageMenu = `<div class=\"messageMenu\" data-actions-history=\"${actionsHistory}\">☰</div>`;\n\t\tmessage = message ? message + \"\\n\\n\" + messageMenu : \"\";\n\t}\n\n\tif (hasPromptInmessage) {\n\t\t// On gère le cas où il y a une partie dans le message qui doit être gérée par un LLM\n\t\tconst markdownAndPromptSequence = checkPromptsinMessage.sequence;\n\t\tawait processMessageWithPrompt(\n\t\t\tchatbot,\n\t\t\tmarkdownAndPromptSequence,\n\t\t\tmessageElement,\n\t\t\tisUser,\n\t\t);\n\t\t// On récupère le contenu de la question posée au LLM et la réponse pour la mettre dans l'historique des actions\n\t\tchatbot.actions.pop();\n\t\tconst llmAnswer = messageElement.innerHTML;\n\t\tconst llmQuestion = messageElement.previousElementSibling\n\t\t\t? messageElement.previousElementSibling.textContent\n\t\t\t: \"\";\n\t\tconst llmQuestionEncoded = \"llmq:\" + encodeString(llmQuestion);\n\t\tconst llmAnswerEncoded = \"llmr:\" + encodeString(llmAnswer);\n\t\tchatbot.actions.push(llmQuestionEncoded);\n\t\tchatbot.actions.push(llmAnswerEncoded);\n\t\tconst actionsHistory = chatbot.actions.join(`|`);\n\t\t// On ajoute le bouton de menu avec l'historique des actions\n\t\tconst messageMenu = `<div class=\"messageMenu\" data-actions-history=\"${actionsHistory}\">☰</div>`;\n\t\tmessageElement.innerHTML = llmAnswer + messageMenu;\n\t} else {\n\t\t// Traitement des blocs conditionnels qui restent à interpréter au moment de l'affichage du message\n\t\tif (!isUser && yaml && yaml.dynamicVariables) {\n\t\t\tmessage = processConditionalBlocksAtDisplayTime(\n\t\t\t\tmessage,\n\t\t\t\tchatbot.dynamicVariables,\n\t\t\t);\n\t\t}\n\t\tif (message.trim() !== \"\") {\n\t\t\tdisplayMessage(message, {\n\t\t\t\tisUser: isUser,\n\t\t\t\thtmlElement: messageElement,\n\t\t\t\tchangeExistingMessage,\n\t\t\t\tdisableTypewriter: disableTypewriter,\n\t\t\t\tnoMessageMenu: noMessageMenu,\n\t\t\t}).then(() => {\n\t\t\t\tconst response = handleBotResponse(chatbot);\n\t\t\t\tif (response) {\n\t\t\t\t\tcreateMessage(chatbot, response, { isUser: false });\n\t\t\t\t}\n\t\t\t});\n\t\t\t// Gestion des éléments HTML de type formulaire (<select>, <input>) si on veut les utiliser pour gérer des variables dynamiques\n\t\t\tif (yaml && yaml.dynamicContent) {\n\t\t\t\tprocessFormInputs(chatbot, originalMessage, messageElement);\n\t\t\t}\n\t\t}\n\t}\n\tif (yaml && yaml.scorm) {\n\t\t// Envoi des données SCORM (score et historique des actions)\n\t\tsendChatbotData(chatbot);\n\t}\n}\n\n// Pour traiter les éléments HTML de type formulaire (<select>, <input>), afin de mettre à jour le message concerné en traitant les variables dynamiques contenues dans le message\nfunction processFormInputs(chatbot, originalMessage, htmlElement) {\n\t// Gestion des éléments <select>\n\tconst allSelectElements = htmlElement.querySelectorAll(\"select\");\n\tallSelectElements.forEach((selectElement) => {\n\t\tconst selectedValue = selectElement.getAttribute(\"data-selected\");\n\t\tif (selectedValue) {\n\t\t\tconst optionToSelect = selectElement.querySelector(\n\t\t\t\t`option[value=\"${selectedValue}\"]`,\n\t\t\t);\n\t\t\tif (optionToSelect) {\n\t\t\t\toptionToSelect.selected = true;\n\t\t\t}\n\t\t}\n\t\tselectElement.addEventListener(\"change\", (event) => {\n\t\t\thandleChange(event, chatbot, originalMessage, htmlElement);\n\t\t});\n\t});\n\n\t// Gestion des éléments <input> de type \"text\"\n\thtmlElement.addEventListener(\"keydown\", (event) => {\n\t\tif (event.key === \"Enter\" && event.target.matches(\"input[type='text']\")) {\n\t\t\tevent.preventDefault();\n\t\t\thandleChange(event, chatbot, originalMessage, htmlElement);\n\t\t}\n\t});\n}\n\nfunction handleChange(event, chatbot, originalMessage, htmlElement) {\n\tconst selectedName = event.target.name;\n\tconst selectedValue = event.target.value;\n\tconst regex = new RegExp(`^\\`@${selectedName} =.*`, \"gm\");\n\tlet message = originalMessage\n\t\t.replaceAll(regex, \"\")\n\t\t.replaceAll(/`.*= calc\\(@GET.*/g, \"\");\n\tmessage = `\\`@${selectedName} = ${selectedValue}\\`\\n` + message;\n\tcreateMessage(chatbot, message, {\n\t\tisUser: false,\n\t\tmessageElement: htmlElement,\n\t\tchangeExistingMessage: true,\n\t});\n}\n","import { getAnswerFromLLM } from \"../../../../ai/getAnswerFromLLM.mjs\";\nimport { displayMessage } from \"../../../../core/messages/displayMessage.mjs\";\nimport { processPromptWithRAG } from \"./processPromptWithRAG.mjs\";\nimport { appendMessageToContainer } from \"../../../../core/messages/helpers/dom.mjs\";\nimport { endsWithUnclosedHtmlTag } from \"../../../../utils/strings.mjs\";\nimport { getLastElement } from \"../../../../utils/dom.mjs\";\nimport { processConditionalBlocksAtDisplayTime } from \"../../../../core/messages/helpers/processConditionalBlocksAtDisplayTime.mjs\";\n\n// Traite chaque partie d’un message découpé (Markdown / LLM)\nexport async function processMessageWithPrompt(\n\tchatbot,\n\tsequence,\n\tmessageElement,\n\tisUser,\n) {\n\tfor (let i = 0; i < sequence.length; i++) {\n\t\tconst section = sequence[i];\n\t\tconst type = section.type;\n\t\tlet content = section.content;\n\t\tconst sectionElement = document.createElement(\"div\");\n\n\t\t// Gestion des variables dynamiques de type SELECTOR[\"cssSelector\"] qui n'ont pas encore été remplacées par leur valeur (notamment : si le sélecteur ciblait un bloc spécial : readcsv, !useLLM)\n\t\t// On remplace toutes les occurrences de ce type de variable par le contenu textuel de l'élément correspondant dans le document\n\t\tcontent = content.replace(\n\t\t\t/`@SELECTOR\\[\"([^\"]+)\"\\]`/g,\n\t\t\tfunction (match, cssSelector) {\n\t\t\t\tconst element = getLastElement(cssSelector, document);\n\t\t\t\tconst value = element ? element.textContent.trim() : \"\";\n\t\t\t\treturn value;\n\t\t\t},\n\t\t);\n\n\t\ttry {\n\t\t\tif (type === \"prompt\") {\n\t\t\t\t// Gestion du contenu qui fait appel à un LLM\n\t\t\t\tif (i === 0) {\n\t\t\t\t\tappendMessageToContainer(sectionElement, messageElement);\n\t\t\t\t}\n\t\t\t\tlet RAGinformations = \"\";\n\t\t\t\tlet RAGprompt = \"\";\n\t\t\t\t// Gestion de l'historique des échanges avec le LLM\n\t\t\t\tlet shouldUseConversationHistory = false;\n\t\t\t\tlet shouldStreamLLMresponse = true;\n\t\t\t\tif (content.includes(\"!useHistory\")) {\n\t\t\t\t\tshouldUseConversationHistory = true;\n\t\t\t\t\tcontent = content.replace(\"!useHistory\", \"\");\n\t\t\t\t}\n\t\t\t\t// Gestion du RAG\n\t\t\t\tif (content.includes(\"!RAG: \")) {\n\t\t\t\t\tconst promptWithRag = await processPromptWithRAG(chatbot, content);\n\t\t\t\t\tcontent = promptWithRag.content;\n\t\t\t\t\tRAGinformations = promptWithRag.RAGinformations;\n\t\t\t\t\tRAGprompt = promptWithRag.RAGprompt;\n\t\t\t\t}\n\t\t\t\tif (content.includes(\"!noStream\")) {\n\t\t\t\t\tshouldStreamLLMresponse = false;\n\t\t\t\t\tcontent = content.replace(\"!noStream\", \"\");\n\t\t\t\t}\n\n\t\t\t\t// On vérifie si l'élément précédent dans la séquence se finit par un élément html ouvert qui n'a pas été encore fermé\n\t\t\t\tconst previousSection = sequence[i - 1];\n\t\t\t\tconst previousContent = previousSection ? previousSection.content : \"\";\n\t\t\t\tconst hasUnclosedHtmlTagAtEnd =\n\t\t\t\t\tendsWithUnclosedHtmlTag(previousContent);\n\t\t\t\t// Si l'élément précédent se termine par une balise HTML ouverte non fermée, on ajoute le contenu dans cette balise\n\t\t\t\tconst container = hasUnclosedHtmlTagAtEnd\n\t\t\t\t\t? messageElement.lastChild.lastChild\n\t\t\t\t\t: messageElement;\n\n\t\t\t\tawait getAnswerFromLLM(chatbot, content, {\n\t\t\t\t\tRAG: RAGinformations,\n\t\t\t\t\tRAGprompt: RAGprompt,\n\t\t\t\t\tmessageElement: sectionElement,\n\t\t\t\t\tcontainer: container,\n\t\t\t\t\tinline: true,\n\t\t\t\t\tuseConversationHistory: shouldUseConversationHistory,\n\t\t\t\t\tshouldStreamLLMresponse: shouldStreamLLMresponse,\n\t\t\t\t});\n\t\t\t} else if (type === \"markdown\") {\n\t\t\t\t// Traitement des blocs conditionnels qui restent à interpréter au moment de l'affichage du message\n\t\t\t\tcontent = processConditionalBlocksAtDisplayTime(\n\t\t\t\t\tcontent,\n\t\t\t\t\tchatbot.dynamicVariables,\n\t\t\t\t);\n\t\t\t\t// Gestion du contenu en Markdown\n\t\t\t\tawait displayMessage(content, {\n\t\t\t\t\tisUser: isUser,\n\t\t\t\t\thtmlElement: sectionElement,\n\t\t\t\t\tappendTo: messageElement,\n\t\t\t\t\tnoMessageMenu: true,\n\t\t\t\t});\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\n\t\t\t\t\"Une erreur s'est produite lors du traitement des messages :\",\n\t\t\t\terror,\n\t\t\t);\n\t\t}\n\t}\n}\n","export function sendChatbotData(chatbot) {\n\tif (!chatbot) return;\n\n\tconst { dynamicVariables = {}, actions = [] } = chatbot;\n\n\t// Enregistrement d'un score avec 2 variables : scormScore et scoreMax, à définir dans la source du chatbot\n\tconst score = Number(dynamicVariables[\"scormScore\"]) || 0;\n\tconst scoreMax = Number(dynamicVariables[\"scormScoreMax\"]) || 0;\n\n\t// Enregistrement d'un statut de réussite (true / false / undefined) avec la variable scormSuccess, à définir dans la source du chatbot\n\tconst scormSuccess = dynamicVariables[\"scormSuccess\"];\n\tconst success = typeof scormSuccess === \"boolean\" ? scormSuccess : undefined;\n\n\t// Enregistrement d'un éventuel commentaire\n\tconst comment = dynamicVariables[\"scormComment\"] || \"\";\n\n\t// Enregistrement de l'historique des interactions avec le chatbot\n\tconst actionsHistory = Array.isArray(actions) ? actions.join(\"|\") : \"\";\n\n\t// Envoi du message\n\tconst message = {\n\t\tsource: \"chatmd\",\n\t\tscore,\n\t\tscoreMax,\n\t\tsuccess,\n\t\tcomment,\n\t\tactionsHistory,\n\t};\n\twindow.parent.postMessage(message, \"*\");\n}\n","import { footerElement, userInput } from \"../../../../shared/selectors.mjs\";\n\nfunction getHeightInEm(element) {\n\tconst heightPx = element.offsetHeight;\n\tconst fontSizePx = parseFloat(getComputedStyle(element).fontSize);\n\treturn heightPx / fontSizePx;\n}\n\n// Ajuste la visibilité du footer en fontion de la taille de l'input\n// Permet à l'utilisateur d'entrer plus qu'une seule ligne du texte\n// Permet au footer de ne pas apparaître au-dessus de la zone de texte quand celle-ci dépasse une ligne\nexport function adjustFooterToInputHeight() {\n\tif (footerElement) {\n\t\tsetTimeout(() => {\n\t\t\tconst heightInput = getHeightInEm(userInput);\n\t\t\tif (heightInput && heightInput > 3) {\n\t\t\t\tfooterElement.style.opacity = \"0\";\n\t\t\t} else {\n\t\t\t\tfooterElement.style.opacity = \"1\";\n\t\t\t}\n\t\t}, 100);\n\t}\n}\n","function getWidthInEm(element) {\n\tconst widthPx = element.offsetWidth;\n\tconst fontSizePx = parseFloat(getComputedStyle(element).fontSize);\n\treturn widthPx / fontSizePx;\n}\n\nfunction getNumberOfCharachters(element) {\n\treturn element.textContent.length;\n}\n\nexport function getNumberOfLines(element) {\n\tconst numberOfCharacters = getNumberOfCharachters(element);\n\tconst averageCharacterWidthInEm = 0.5;\n\tconst elementWidthInEm = getWidthInEm(element);\n\tconst totalWidthInEm = numberOfCharacters * averageCharacterWidthInEm;\n\tconst numberOfLines = totalWidthInEm / elementWidthInEm;\n\treturn numberOfLines;\n}\n","import { sendButton, userInput } from \"../../../shared/selectors.mjs\";\nimport { goToNewChatbot } from \"../../../utils/urls.mjs\";\nimport { adjustFooterToInputHeight } from \"./helpers/adjustFooterToInputHeight.mjs\";\nimport { insertLineBreak } from \"./helpers/insertLineBreak.mjs\";\nimport { getNumberOfLines } from \"./helpers/getNumberOfLines.mjs\";\n\nexport function setKeypressListener() {\n\tdocument.addEventListener(\"keydown\", (event) => {\n\t\tconst modal = document.querySelector(\"#systemModal\");\n\t\t// Si la fenêtre modale est ouverte\n\t\tif (modal) {\n\t\t\t// On désactive l'entrée clavier dans la zone texte\n\t\t\tevent.preventDefault();\n\t\t\t// Mais si on appuie sur “Escape”, on sort de la fenêtre modale\n\t\t\tif (event.key === \"Escape\") {\n\t\t\t\tdocument.body.removeChild(modal);\n\t\t\t}\n\t\t}\n\t\t// Si on clique sur Entrée\n\t\tif (event.key === \"Enter\") {\n\t\t\tconst isSpecialKey = event.ctrlKey || event.altKey || event.shiftKey;\n\t\t\t// Si on n'a pas utilisé de touche spéciale en combinaison avec Entrée (Clic+Enter ou Alt+Enter)\n\t\t\tif (!isSpecialKey) {\n\t\t\t\tevent.preventDefault();\n\t\t\t\t// Si on est dans le champ input qui permet de rediriger vers un chatbot à partir de l'URL de sa source : on va vers le chatbot avec la bonne adresse\n\t\t\t\tif (event.target.id == \"urlSourceChatbot\") {\n\t\t\t\t\tconst urlNewChatbot = event.target.value.trim();\n\t\t\t\t\tgoToNewChatbot(urlNewChatbot);\n\t\t\t\t} else {\n\t\t\t\t\tconst shouldClickOnSendButton =\n\t\t\t\t\t\tevent.target.id == \"user-input\" ||\n\t\t\t\t\t\t!(event.target.tagName == \"INPUT\" && event.target.type == \"text\");\n\t\t\t\t\tif (shouldClickOnSendButton) {\n\t\t\t\t\t\t// Sinon, on fait comme si on faisait un clic sur le bouton Envoyer, ce qui permet d'envoyer sa réponse (s'il y a du contenu), ou de faire tout apparaître d'un coup, et de désactiver l'effet typewriter, s'il n'y a pas de contenu.\n\t\t\t\t\t\tuserInput.focus();\n\t\t\t\t\t\tsendButton.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Si on a utilisé Clic+Enter ou Alt+Enter, alors on insère un retour à la ligne dans la zone de texte et on cache si nécessaire le footer\n\t\t\t\tif (event.target == userInput) {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tinsertLineBreak();\n\t\t\t\t\tadjustFooterToInputHeight();\n\t\t\t\t}\n\t\t\t}\n\t\t} // Si on a appuyé sur une autre touche qu'Enter\n\t\telse if (\n\t\t\tuserInput.parentElement.parentElement.classList.contains(\"hideControls\")\n\t\t) {\n\t\t\t// Si l'userInput est caché : on désactive l'entrée clavier (sauf pour Enter qui permet toujours d'afficher plus vite la suite)\n\t\t\tevent.preventDefault();\n\t\t} else {\n\t\t\t// Sinon, on vérifie ce qui peut changer la hauteur de la zone de texte afin d'adapter si nécessaire la visibilité du footer\n\t\t\t// Cela peut être : appui sur une touche de suppression de contenu ou appui sur n'importe quelle touche qui ajoute du contenu et qui fait que l'on dépasse un nombre maximum de lignes\n\t\t\tif (event.target == userInput) {\n\t\t\t\tif (\n\t\t\t\t\tevent.key === \"Delete\" ||\n\t\t\t\t\tevent.key === \"Backspace\" ||\n\t\t\t\t\tgetNumberOfLines(userInput) > 2\n\t\t\t\t) {\n\t\t\t\t\tadjustFooterToInputHeight();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n","// Pour insérer un retour à la ligne dans la zone de texte (quand on appuie sur Clic+Enter ou Alt+Enter)\nexport function insertLineBreak() {\n\tconst selection = window.getSelection();\n\tif (!selection || selection.rangeCount === 0) return;\n\n\tconst range = selection.getRangeAt(0);\n\trange.deleteContents();\n\n\t// Crée un <br> et un nœud vide après pour que le curseur ait une vraie position\n\tconst br = document.createElement(\"br\");\n\tconst space = document.createTextNode(\"\\u200B\"); // zéro-width space\n\n\trange.insertNode(space);\n\trange.insertNode(br);\n\n\t// Place le curseur après l'espace\n\trange.setStartAfter(space);\n\trange.collapse(true);\n\tselection.removeAllRanges();\n\tselection.addRange(range);\n}\n","import { yaml } from \"../../../markdown/custom/yaml.mjs\";\nimport { goToNewChatbot } from \"../../../utils/urls.mjs\";\nimport { deobfuscateString, sanitizeHtml } from \"../../../utils/strings.mjs\";\nimport { createMessage } from \"../../messages/createMessage.mjs\";\nimport {\n\tchatContainer,\n\tuserInput,\n\tsendButton,\n} from \"../../../shared/selectors.mjs\";\nimport { autoFocus } from \"../../../shared/constants.mjs\";\nimport { responseToSelectedChoiceOption } from \"../helpers/choiceOptions.mjs\";\nimport { getChatbotResponse } from \"../getChatbotResponse.mjs\";\nimport { showModal } from \"./helpers/modal.mjs\";\nimport { getElementFromEnd } from \"../../../utils/arrays.mjs\";\nimport { getParamsFromURL } from \"../../../utils/urls.mjs\";\n\nconst allowedTagsInUserInput = [\"<p>\", \"</p>\"];\n\nfunction handleClickOnSendButton(chatbot) {\n\tsendButton.addEventListener(\"click\", () => {\n\t\tlet userInputText = userInput.innerText;\n\t\tif (userInputText.trim() !== \"\") {\n\t\t\tuserInputText = sanitizeHtml(userInputText, allowedTagsInUserInput);\n\t\t\t// On enregistre l'action \"écrire un message\" dans l'historique des actions du chatbot\n\t\t\tchatbot.actions.push(\"e:\" + userInputText);\n\t\t\tcreateMessage(chatbot, userInputText, { isUser: true });\n\t\t\tsetTimeout(() => {\n\t\t\t\tconst response = getChatbotResponse(chatbot, userInputText);\n\t\t\t\tif (response) {\n\t\t\t\t\tcreateMessage(chatbot, response, { isUser: false });\n\t\t\t\t}\n\t\t\t}, 100);\n\t\t\tuserInput.innerText = \"\";\n\t\t} else {\n\t\t\tconst enterEvent = new KeyboardEvent(\"keypress\", {\n\t\t\t\tkey: \"Enter\",\n\t\t\t\tkeyCode: 13,\n\t\t\t\twhich: 13,\n\t\t\t});\n\t\t\tuserInput.dispatchEvent(enterEvent);\n\t\t}\n\t});\n}\n\nfunction handleClickOnChatContainer(chatbot) {\n\tchatContainer.addEventListener(\"click\", (event) => {\n\t\tlet target = event.target;\n\t\t// Cas où on a cliqué sur un bouton pour ouvrir un nouveau chatbot\n\t\tif (target.id == \"openNewChatbot\") {\n\t\t\tconst urlNewChatbot = target.parentElement\n\t\t\t\t.querySelector(\"#urlSourceChatbot\")\n\t\t\t\t.value.trim();\n\t\t\tgoToNewChatbot(urlNewChatbot);\n\t\t\treturn;\n\t\t}\n\t\t// Si c'est un bouton \"copyCode\", on copie le contenu du bloc code dans le presse-papier\n\t\tif (target.classList.contains(\"copyCode\")) {\n\t\t\tconst copyCodeButton = target;\n\t\t\tconst codeBlock = target.parentElement.querySelector(\"code\");\n\t\t\tnavigator.clipboard\n\t\t\t\t.writeText(\n\t\t\t\t\tcodeBlock.innerText.replaceAll(\"​\", \"\").replaceAll(\"\\n\\n\", \"\\n\"),\n\t\t\t\t)\n\t\t\t\t.then(() => {\n\t\t\t\t\tcopyCodeButton.innerText = \"Copié !\";\n\t\t\t\t\tsetTimeout(() => (copyCodeButton.innerText = \"Copier\"), 2000);\n\t\t\t\t})\n\t\t\t\t.catch((err) => {\n\t\t\t\t\tconsole.error(\"Erreur lors de la copie\", err);\n\t\t\t\t});\n\t\t}\n\t\t// gestion des clics sur le bouton de menu d'une réponse du chatbot\n\t\tif (target.classList.contains(\"messageMenu\")) {\n\t\t\tconst actionsHistory = target.getAttribute(\"data-actions-history\");\n\t\t\tconst actionsHistoryArray = actionsHistory.split(\"|\");\n\t\t\tlet actionsLatest = getElementFromEnd(actionsHistoryArray, 1);\n\t\t\t// Si la dernière action était un clic sur un bouton et qu'on veut renvoyer à la dernière réponse, on doit récupérer le contenu du dernier message envoyé pour déclenché cette réponse\n\t\t\tif (actionsLatest.startsWith(\"c:n\")) {\n\t\t\t\tlet idChoiceOption = actionsLatest.replace(\"c:n\", \"\");\n\t\t\t\tidChoiceOption = parseInt(idChoiceOption, 10);\n\t\t\t\tconst choiceOptions = document.querySelectorAll(\".messageOptions a\");\n\t\t\t\tconst selectedChoiceOption = choiceOptions[idChoiceOption - 1];\n\t\t\t\tconst actionMessage = selectedChoiceOption\n\t\t\t\t\t.getAttribute(\"href\")\n\t\t\t\t\t.replace(\"#\", \"\");\n\t\t\t\tactionsLatest = \"e:\" + actionMessage;\n\t\t\t}\n\t\t\t// Si la dernière action était une réponse d'un LLM, il faut intégrer la question dans l'historique des actions pour ce message\n\t\t\tif (actionsLatest.startsWith(\"llmr:\")) {\n\t\t\t\tconst llmQuestion = getElementFromEnd(actionsHistoryArray, 2);\n\t\t\t\tactionsLatest = llmQuestion + \"|\" + actionsLatest;\n\t\t\t}\n\t\t\tconst baseURL = window.location.origin + window.location.pathname;\n\t\t\tlet hash = window.location.hash;\n\t\t\tlet baseQuery = getParamsFromURL();\n\t\t\t// On garde dans le hash seulement l'URL de la source et on supprime les paramètres (qu'on vient de récupérer dans baseQuery)\n\t\t\t// Permet de supprimer les paramètres vides qui restent éventuellement dans l'URL par exemple des fichiers CodiMD (?both, ?edit, ?view)\n\t\t\thash = hash.replace(/\\?.*/, \"\");\n\t\t\t// On supprime le paramètre \"actions\" dans l'URL s'il existe\n\t\t\tconst params = new URLSearchParams(baseQuery);\n\t\t\tparams.delete(\"actions\");\n\t\t\tbaseQuery = params.toString();\n\t\t\tconst prefixQuery = baseQuery ? baseQuery + \"&\" : \"?\";\n\t\t\tconst queryActionsHistory = prefixQuery + `actions=${actionsHistory}`;\n\t\t\tconst queryActionsLatest = prefixQuery + `actions=${actionsLatest}`;\n\t\t\t// On crée le contenu de la boîte modale et on l'affiche\n\t\t\tconst hasDynamicVariables =\n\t\t\t\tObject.keys(chatbot.dynamicVariables).length > 0;\n\t\t\tconst linkToHistoryOfActions = `<li><a href=\"${baseURL}${hash}${queryActionsHistory}\" target=\"_blank\">Parcours complet de cette conversation</a> (jusqu'à ce message)</li>`;\n\t\t\tconst linkToSpecificResponse = hasDynamicVariables\n\t\t\t\t? \"\"\n\t\t\t\t: `<li><a href=\"${baseURL}${hash}${queryActionsLatest}\" target=\"_blank\">Lien direct vers cette réponse</a></li>`;\n\t\t\tconst modalContent = `\n\t\t\t\t<p>Voici des liens pour accéder à l’historique de vos échanges avec ce chatbot :</p>\n\t\t\t\t<ul>\n\t\t\t\t\t${linkToHistoryOfActions}\n\t\t\t\t\t${linkToSpecificResponse}\n\t\t\t\t</ul>`;\n\t\t\tshowModal(modalContent);\n\t\t}\n\t\twhile (target && target.tagName !== \"A\") {\n\t\t\ttarget = target.parentElement;\n\t\t}\n\t\tif (target) {\n\t\t\t// Gestion du cas où on clique sur un lien\n\t\t\tconst currentUrl = window.location.href;\n\t\t\tconst link = target.getAttribute(\"href\");\n\t\t\tif (link.startsWith(currentUrl)) {\n\t\t\t\t// Si le lien est vers un autre chatbot (avec la même url d'origine), alors on ouvre le chatbot dans un autre onglet\n\t\t\t\tevent.preventDefault();\n\t\t\t\twindow.open(link);\n\t\t\t}\n\t\t\tif (link.startsWith(\"#\")) {\n\t\t\t\t// Si le lien est vers une option, alors on envoie le message correspondant à cette option\n\t\t\t\tevent.preventDefault();\n\t\t\t\t// On enregistre l'action \"clic sur un bouton de réponse\" dans l'historique des actions du chatbot\n\t\t\t\tconst choiceOptions = document.querySelectorAll(\".messageOptions li a\");\n\t\t\t\t// On récupère l'index du bouton de réponse sur lequel on a cliqué, parmi l'ensemble des boutons de réponse affichés\n\t\t\t\tconst indexTarget = Array.from(choiceOptions).indexOf(target) + 1;\n\t\t\t\t// Permet de gérer les liens vides (retour au menu intial)\n\t\t\t\t// dans ce cas, il ne faut pas mettre le numéro du bouton, mais le texte du bouton\n\t\t\t\tconst isBlankTarget = link == \"#\";\n\t\t\t\tif (!isBlankTarget) {\n\t\t\t\t\tchatbot.actions.push(\"c:n\" + indexTarget);\n\t\t\t\t} else {\n\t\t\t\t\tconst actionMessage = choiceOptions[indexTarget - 1].textContent;\n\t\t\t\t\tchatbot.actions.push(\"e:\" + actionMessage);\n\t\t\t\t}\n\t\t\t\t// Si on clique sur un lien après une directive !Next, on réinitalise les variables lastMessageFromBot, nextMessage.goto et nextMessage.needsProcessing\n\t\t\t\tchatbot.nextMessage.lastMessageFromBot = \"\";\n\t\t\t\tchatbot.nextMessage.goto = \"\";\n\t\t\t\tchatbot.nextMessage.needsProcessing = false;\n\t\t\t\t// On récupère le contenu du message de l'utilisateur, en HTML si on utilise du Latex ou des éléments cachés avec la classe \"hidden\"\n\t\t\t\tlet messageFromLink =\n\t\t\t\t\tyaml.maths || target.innerHTML.includes(\"hidden\")\n\t\t\t\t\t\t? target.innerHTML\n\t\t\t\t\t\t: target.innerText;\n\t\t\t\t// Si on a utilisé la directive !useLLM dans le lien d'un bouton : on renvoie vers une réponse par un LLM\n\t\t\t\tconst linkDeobfuscated = yaml.obfuscate\n\t\t\t\t\t? deobfuscateString(link.replace(\"#\", \"\"))\n\t\t\t\t\t: link;\n\t\t\t\tif (\n\t\t\t\t\tyaml.useLLM.url &&\n\t\t\t\t\tyaml.useLLM.model &&\n\t\t\t\t\tlinkDeobfuscated.includes(\"!useLLM\")\n\t\t\t\t) {\n\t\t\t\t\t// On autorise l'utilisation par l'utilisateur de la commande LLM car elle se trouve dans un bouton déjà autorisé par le créateur du chatbot\n\t\t\t\t\tchatbot.allowLLMCommands = true;\n\t\t\t\t\tmessageFromLink = linkDeobfuscated\n\t\t\t\t\t\t.replace(\"#\", \"\")\n\t\t\t\t\t\t.replace(\"!useLLM\", '<span class=\"hidden\">!useLLM</span>')\n\t\t\t\t\t\t.trim();\n\t\t\t\t\tcreateMessage(chatbot, messageFromLink, { isUser: true });\n\t\t\t\t\tconst response = getChatbotResponse(chatbot, messageFromLink);\n\t\t\t\t\tif (response) {\n\t\t\t\t\t\tcreateMessage(chatbot, response, { isUser: false });\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tcreateMessage(chatbot, messageFromLink, { isUser: true });\n\t\t\t\t\tconst optionLink = link.substring(1);\n\t\t\t\t\tconst response = responseToSelectedChoiceOption(chatbot, optionLink);\n\t\t\t\t\tif (response) {\n\t\t\t\t\t\tcreateMessage(chatbot, response, { isUser: false });\n\t\t\t\t\t}\n\t\t\t\t\t// Supprimer le focus sur le bouton qu'on vient de cliquer\n\t\t\t\t\tdocument.activeElement.blur();\n\t\t\t\t\t// Refocaliser sur userInput\n\t\t\t\t\tif (autoFocus) {\n\t\t\t\t\t\tuserInput.focus();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Si on clique sur un lien après une directive !Next, on réinitalise le compteur d'erreurs\n\t\t\t\tchatbot.nextMessage.errorsCounter = 0;\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport function setClickListener(chatbot) {\n\thandleClickOnSendButton(chatbot);\n\thandleClickOnChatContainer(chatbot);\n}\n","export function showModal(html) {\n\t// Créer le fond de la modale\n\tconst overlay = document.createElement(\"div\");\n\toverlay.id = \"systemModal\";\n\n\t// Créer la boîte modale\n\tconst modal = document.createElement(\"div\");\n\tmodal.classList.add(\"modal-content\");\n\n\t// Ajouter la croix de fermeture\n\tconst closeBtn = document.createElement(\"span\");\n\tcloseBtn.innerHTML = \"&times;\";\n\tcloseBtn.classList.add(\"close-button\");\n\tmodal.appendChild(closeBtn);\n\n\t// Ajouter le contenu HTML\n\tconst content = document.createElement(\"div\");\n\tcontent.innerHTML = html;\n\tmodal.appendChild(content);\n\n\t// Ajouter la modale à l'overlay\n\toverlay.appendChild(modal);\n\tdocument.body.appendChild(overlay);\n\n\t// Fonction de fermeture\n\tfunction closeModal() {\n\t\tdocument.body.removeChild(overlay);\n\t}\n\n\t// Fermer en cliquant sur la croix\n\tcloseBtn.addEventListener(\"click\", closeModal);\n\n\t// Fermer en cliquant en dehors de la modale\n\toverlay.addEventListener(\"click\", (e) => {\n\t\tif (e.target === overlay) {\n\t\t\tcloseModal();\n\t\t}\n\t});\n\n\t// Fermer en cliquant sur un bouton dans la modale\n\tmodal.addEventListener(\"click\", (e) => {\n\t\tif (e.target.tagName === \"BUTTON\") {\n\t\t\tcloseModal();\n\t\t}\n\t});\n}\n","import { setKeypressListener } from \"./events/keypress.mjs\";\nimport { setClickListener } from \"./events/click.mjs\";\nimport { setFocusListener } from \"./events/focus.mjs\";\nimport { setPasteListener } from \"./events/paste.mjs\";\n\nexport async function controlEvents(chatbot) {\n\tsetKeypressListener();\n\tsetClickListener(chatbot);\n\tsetFocusListener();\n\tsetPasteListener();\n}\n","import { userInput } from \"../../../shared/selectors.mjs\";\n\nexport function setFocusListener() {\n\tuserInput.focus({ preventScroll: true });\n\n\tuserInput.addEventListener(\"focus\", function () {\n\t\tthis.classList.remove(\"placeholder\");\n\t});\n\n\tuserInput.addEventListener(\"blur\", function () {\n\t\tthis.classList.add(\"placeholder\");\n\t});\n}\n","import { userInput } from \"../../../shared/selectors.mjs\";\nimport { adjustFooterToInputHeight } from \"./helpers/adjustFooterToInputHeight.mjs\";\n\n// On doit pouvoir ajuster la taille du footer quand on copie-colle un texte de plusieurs lignes dans la zone de textes (pour que le footer ne soit plus visible au-dessus de la zone de texte)\nexport function setPasteListener() {\n\tuserInput.addEventListener(\"paste\", () => {\n\t\tadjustFooterToInputHeight();\n\t});\n}\n","import { createMessage } from \"../../messages/createMessage.mjs\";\nimport { getChatbotResponse } from \"../../interactions/getChatbotResponse.mjs\";\nimport { removeAccents } from \"../../../utils/nlp.mjs\";\nimport { decodeString, deobfuscateString } from \"../../../utils/strings.mjs\";\n\nasync function waitForChoiceOption(number, timeout = 1000) {\n\treturn new Promise((resolve, reject) => {\n\t\tconst start = Date.now();\n\t\tconst checkOptions = () => {\n\t\t\tconst choiceOptions = document.querySelectorAll(\".messageOptions li a\");\n\t\t\tif (choiceOptions.length >= number) {\n\t\t\t\tresolve(choiceOptions);\n\t\t\t} else if (Date.now() - start >= timeout) {\n\t\t\t\treject(new Error(\"Timeout: options not found within time limit.\"));\n\t\t\t} else {\n\t\t\t\tsetTimeout(checkOptions, 100);\n\t\t\t}\n\t\t};\n\t\tcheckOptions();\n\t});\n}\n\nasync function waitForSelectedChoiceOption(\n\tactionDataNormalized,\n\ttimeout = 1000,\n) {\n\tconst start = Date.now();\n\treturn new Promise((resolve, reject) => {\n\t\tconst tryFindSelectedChoiceOption = () => {\n\t\t\tconst choiceOptions = document.querySelectorAll(\".messageOptions li a\");\n\t\t\tlet choiceArray = Array.from(choiceOptions);\n\t\t\t// On met la liste dans le sens inverse pour pouvoir chercher en premier dans les dernières options affichées\n\t\t\tchoiceArray = choiceArray.reverse();\n\t\t\tconst selectedChoiceOption = choiceArray.find((option) =>\n\t\t\t\tremoveAccents(option.innerHTML.toLowerCase()).includes(\n\t\t\t\t\tactionDataNormalized,\n\t\t\t\t),\n\t\t\t);\n\n\t\t\tif (selectedChoiceOption) {\n\t\t\t\tresolve(selectedChoiceOption);\n\t\t\t} else if (Date.now() - start >= timeout) {\n\t\t\t\treject(new Error(\"Timeout: No matching choice option found.\"));\n\t\t\t} else {\n\t\t\t\tsetTimeout(tryFindSelectedChoiceOption, 100);\n\t\t\t}\n\t\t};\n\n\t\ttryFindSelectedChoiceOption();\n\t});\n}\n\nexport async function processActions(chatbot, yaml, hasActions) {\n\tconst actions = hasActions.split(\"|\");\n\t// Pour chaque action …\n\tfor (let index = 0; index < actions.length; index++) {\n\t\tconst action = actions[index];\n\t\t// On récupère les informations  de l'action (type et données)\n\t\tconst separator = action.indexOf(\":\");\n\t\tconst actionType = action.slice(0, separator);\n\t\tconst actionData = action.slice(separator + 1).trim();\n\t\tconst isLast = index === actions.length - 1;\n\n\t\t// Si l'action consiste à entrer un message dans la zone de texte\n\t\tif (actionType == \"e\") {\n\t\t\t// On affiche ce message\n\t\t\tconst userMessage =\n\t\t\t\tyaml && yaml.obfuscate ? deobfuscateString(actionData) : actionData;\n\t\t\tawait createMessage(chatbot, userMessage, { isUser: true });\n\t\t\t// Puis on affiche la réponse, sans typewriter sauf si on en est à la dernière action\n\t\t\tconst response = getChatbotResponse(chatbot, userMessage);\n\t\t\tif (response) {\n\t\t\t\tawait createMessage(chatbot, response, {\n\t\t\t\t\tisUser: false,\n\t\t\t\t\tdisableTypewriter: !isLast,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t// Si l'action consiste à cliquer sur un bouton de réponse\n\t\tif (actionType == \"c\") {\n\t\t\t// On récupère les boutons de réponse\n\t\t\tconst selectChoiceOptionByPosition = /^n\\d+$/.test(actionData);\n\t\t\tlet selectedChoiceOption;\n\t\t\tif (selectChoiceOptionByPosition) {\n\t\t\t\t// Première possibilité : on identifie un bouton de réponse par son numéro parmi l'ensemble des boutons de réponse affichées\n\t\t\t\tconst choiceOptionPosition = parseInt(actionData.replace(\"n\", \"\"));\n\t\t\t\tconst choiceOptions = await waitForChoiceOption(choiceOptionPosition);\n\t\t\t\tlet choiceArray = Array.from(choiceOptions);\n\t\t\t\tselectedChoiceOption = choiceArray[choiceOptionPosition - 1];\n\t\t\t} else {\n\t\t\t\t// Deuxième possibilité : on identifie un bouton de réponse, en cherchant le bouton de réponse, en partant des derniers, qui contient le contenu d'un texte à chercher\n\t\t\t\t// On fait la recherche sans prendre en compte les accents et les majuscules\n\t\t\t\tconst actionDataNormalized = removeAccents(actionData.toLowerCase());\n\t\t\t\tselectedChoiceOption =\n\t\t\t\t\tawait waitForSelectedChoiceOption(actionDataNormalized);\n\t\t\t}\n\n\t\t\t// Si on a trouvé un bouton de réponse qui correspond\n\t\t\tif (selectedChoiceOption) {\n\t\t\t\t// On récupère le message à afficher\n\t\t\t\t// Le message peut contenir une assignation de valeur à une variable\n\t\t\t\t// On récupère le code de cette assignation pour qu'il soit traité\n\t\t\t\t// lors de la création du message\n\t\t\t\tconst messageToDisplay = selectedChoiceOption.innerHTML.replace(\n\t\t\t\t\t/<span class=\"hidden\">(.*?)<\\/span>/,\n\t\t\t\t\t\" $1\",\n\t\t\t\t);\n\t\t\t\t// Et le message à envoyer au chatbot\n\t\t\t\tlet messageToChatbot = selectedChoiceOption\n\t\t\t\t\t.getAttribute(\"href\")\n\t\t\t\t\t.replace(\"#\", \"\");\n\t\t\t\t// Si on utilise l'obfuscation, il faut décoder le message\n\t\t\t\tmessageToChatbot = yaml.obfuscate\n\t\t\t\t\t? deobfuscateString(messageToChatbot)\n\t\t\t\t\t: messageToChatbot;\n\t\t\t\t// On affiche le message à afficher côté utilisateur\n\t\t\t\tawait createMessage(chatbot, messageToDisplay, { isUser: true });\n\t\t\t\t// On récupère puis affiche la répones du chatbot\n\t\t\t\tconst response = await getChatbotResponse(chatbot, messageToChatbot);\n\t\t\t\tif (response) {\n\t\t\t\t\tawait createMessage(chatbot, response, {\n\t\t\t\t\t\tisUser: false,\n\t\t\t\t\t\tdisableTypewriter: !isLast,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (actionType == \"llmq\") {\n\t\t\tconst userMessage = decodeString(actionData);\n\t\t\tawait createMessage(chatbot, userMessage, { isUser: true });\n\t\t}\n\n\t\tif (actionType == \"llmr\") {\n\t\t\tconst botMessage = decodeString(actionData);\n\t\t\tawait createMessage(chatbot, botMessage, {\n\t\t\t\tisUser: false,\n\t\t\t\tdisableTypewriter: !isLast,\n\t\t\t});\n\t\t}\n\t}\n}\n","import { markdownToHTML } from \"../../markdown/parser.mjs\";\nimport { createVector } from \"../../utils/nlp.mjs\";\nimport { processMessageWithChoiceOptions } from \"../interactions/helpers/choiceOptions.mjs\";\nimport { createMessage } from \"../messages/createMessage.mjs\";\nimport { controlEvents } from \"../interactions/controlEvents.mjs\";\nimport { getRAGcontent } from \"../../ai/rag/engine.mjs\";\nimport { processActions } from \"./helpers/actions.mjs\";\n\nexport async function initializeChatbot(chatbotData, yaml, params) {\n\tlet dynamicVariables = {};\n\t// On place les paramètres de l'URL dans dynamicVariables\n\t// Si on utilise du contenu dynamique : on pourra utiliser ces variables\n\tif (params) {\n\t\tfor (const [key, value] of Object.entries(params)) {\n\t\t\tif (key != \"actions\" && value) {\n\t\t\t\tdynamicVariables[\"GET\" + key] = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tconst chatbotName = chatbotData.title;\n\tlet initialMessage = chatbotData.initialMessage;\n\tconst chatbotNameHTML = markdownToHTML(chatbotName).replace(/<\\/?p>/g, \"\");\n\tdocument.getElementById(\"chatbot-name\").innerHTML = chatbotNameHTML;\n\tdocument.title = chatbotNameHTML.replace(/<[^>]*>?/gm, \"\");\n\n\tconst chatbotResponses = chatbotData.responses;\n\n\tfunction precalculateVectorChatbotResponses(chatbotResponses) {\n\t\t// On précalcule les vecteurs des réponses du chatbot\n\t\tlet vectorChatBotResponses = [];\n\t\tif ((yaml && yaml.searchInContent) || (yaml && yaml.useLLM.url)) {\n\t\t\tfor (let i = 0; i < chatbotResponses.length; i++) {\n\t\t\t\tconst responseContent = chatbotResponses[i].content;\n\t\t\t\tlet response = Array.isArray(responseContent)\n\t\t\t\t\t? responseContent.join(\" \").toLowerCase()\n\t\t\t\t\t: responseContent.toLowerCase();\n\t\t\t\tconst titleResponse = chatbotResponses[i].title;\n\t\t\t\tresponse = titleResponse + \" \" + response;\n\t\t\t\tconst vectorResponse = createVector(response, {\n\t\t\t\t\tprioritizeTokensInTitle: true,\n\t\t\t\t\ttitleResponse: titleResponse,\n\t\t\t\t});\n\t\t\t\tvectorChatBotResponses.push(vectorResponse);\n\t\t\t}\n\t\t}\n\t\treturn vectorChatBotResponses;\n\t}\n\n\tconst vectorChatBotResponses =\n\t\tprecalculateVectorChatbotResponses(chatbotResponses);\n\n\tlet RAG = {};\n\tif (yaml.useLLM.RAGinformations) {\n\t\tconst RAGinformations = await getRAGcontent(yaml.useLLM.RAGinformations);\n\t\tRAG.content = RAGinformations.content;\n\t\tRAG.vector = RAGinformations.vector;\n\t}\n\n\tlet chatbot = {\n\t\tdynamicVariables: dynamicVariables,\n\t\tresponses: chatbotResponses,\n\t\tvectorChatBotResponses: vectorChatBotResponses,\n\t\tinitialMessage: initialMessage,\n\t\tchoiceOptionsLastResponse: null,\n\t\tnextMessage: {\n\t\t\tgoto: \"\",\n\t\t\tlastMessageFromBot: \"\",\n\t\t\tselected: \"\",\n\t\t\tonlyIfKeywords: false,\n\t\t\terrorsCounter: 0,\n\t\t\tmaxErrors: 3,\n\t\t\tmessageIfKeywordsNotFound: \"\",\n\t\t},\n\t\tactions: params && params.actions ? params.actions.split(\"|\") : [],\n\t\tRAG: RAG,\n\t};\n\n\tcontrolEvents(chatbot);\n\n\t// On récupère le contenu du message initial\n\tconst initialMessageContent = initialMessage.content\n\t\t.join(\"\\n\\n\")\n\t\t.replace('<section class=\"unique\">', '<section class=\"unique\" markdown>');\n\tconst initialMessageChoiceOptions = initialMessage.choiceOptions;\n\n\tinitialMessage = processMessageWithChoiceOptions(\n\t\tchatbot,\n\t\tinitialMessageContent,\n\t\tinitialMessageChoiceOptions,\n\t);\n\t// On regarde s'il y a des actions à accomplir dans le paramètre de URL \"?actions\"\n\tconst hasActions = params && params.actions;\n\t// On affiche le message d'accueil, sans typewriter s'il y a des actions à accomplir, et sans menu de message\n\tawait createMessage(chatbot, initialMessage, {\n\t\tisUser: false,\n\t\tdisableTypewriter: hasActions,\n\t\tnoMessageMenu: true,\n\t});\n\t// S'il y a un élément dans le message initial qui ne doit apparaître que la première fois qu'il est affiché, alors on supprime cet élément pour les prochaines fois\n\tinitialMessage = initialMessage\n\t\t.replace(/<span class=\"unique\">.*?<\\/span>/g, \"\")\n\t\t.replace(/<section class=\"unique\".*?>[\\s\\S]*?<\\/section>/gm, \"\");\n\tchatbot.initialMessage = initialMessage;\n\n\t// S'il y a des actions à accomplir …\n\tif (hasActions) {\n\t\tprocessActions(chatbot, yaml, hasActions);\n\t}\n\treturn chatbot;\n}\n","import { getContent } from \"./getContent.mjs\";\nimport { parseMarkdown } from \"./parseMarkdown.mjs\";\nimport { initializeChatbot } from \"./initialize.mjs\";\nimport { getParamsFromURL } from \"../../utils/urls.mjs\";\n\n// Pour créer le chatbot à partir d'une source en Markdown\nexport async function createChatbot(defaultMd) {\n\ttry {\n\t\t// On récupère les paramètres dans l'URL\n\t\tconst params = getParamsFromURL();\n\n\t\t// On récupère le contenu en Markdown qui constitue la source du chatbot\n\t\tconst content = await getContent(defaultMd, params);\n\n\t\t// On traite le contenu en Markdown pour créer la structure du chatbot\n\t\tconst chatbotData = parseMarkdown(content.markdown, content.yaml);\n\n\t\t// On initialise le chatbot à partir de cette structure\n\t\tinitializeChatbot(chatbotData, content.yaml, params);\n\t} catch (error) {\n\t\tconsole.error(error);\n\t}\n}\n","import \"../css/styles.css\";\nimport defaultMd from \"../index.md\";\nimport { createChatbot } from \"./core/chatbot/createChatbot.mjs\";\n\ncreateChatbot(defaultMd);\n"],"names":["config","maths","js","css","pako","kroki","textFit","lightbox","readcsv","yaml","plugins","avatar","avatarCircle","bots","detectBadWords","defaultMessage","dynamicContent","favicon","footer","obfuscate","responsesTitles","searchInContent","style","theme","typeWriter","userInput","variables","useLLM","url","askAPIkey","apiKey","model","always","systemPrompt","maxTokens","preprompt","postprompt","maxProcessingTime","RAG","RAGinformations","RAGseparator","RAGmaxTopElements","RAGprompt","normalizeUrl","options","shouldAddCorsProxy","useCorsProxy","hostResult","includes","startsWith","replace","handleURLfromGithub","isCodimdURL","indexOf","handleURLfromCodimd","endsWith","isFramapadURL","handleURLfromFramapad","handleKnownHosts","corsProxy","handleURL","secureMode","authorizedChatbots","find","element","isAuthorized","foundShortcut","shortcuts","shortcutUrl","handleShorcuts","map","loadScript","src","Promise","resolve","reject","script","document","createElement","onload","onerror","head","appendChild","loadCSS","styleElement","textContent","href","rel","getParamsFromURL","queryString","window","location","search","urlHash","hash","paramsFromQuery","Object","fromEntries","URLSearchParams","hashHasParams","hashQueryPart","split","goToNewChatbot","urlNewChatbot","URLbaseChatbot","origin","pathname","fullUrl","open","alert","async","fetchContent","response","fetch","ok","Error","text","fetchContentFromMultipleSources","urls","all","join","isNothing","subject","defaultPauseTypeWriter","defaultChoiceOptionText","common","isObject","toArray","sequence","Array","isArray","repeat","string","count","cycle","result","isNegativeZero","number","Number","NEGATIVE_INFINITY","extend","target","source","index","length","key","sourceKeys","keys","formatError","exception","compact","where","message","reason","mark","name","line","column","snippet","YAMLException$1","call","this","captureStackTrace","constructor","stack","prototype","create","toString","getLine","buffer","lineStart","lineEnd","position","maxLineLength","tail","maxHalfLength","Math","floor","str","slice","pos","padStart","max","maxLength","indent","linesBefore","linesAfter","match","re","lineStarts","lineEnds","foundLineNo","exec","push","i","lineNoLength","min","TYPE_CONSTRUCTOR_OPTIONS","YAML_NODE_KINDS","type","tag","forEach","kind","construct","data","instanceOf","predicate","represent","representName","defaultStyle","multi","styleAliases","alias","String","compileStyleAliases","compileList","schema","currentType","newIndex","previousType","previousIndex","Schema$1","definition","implicit","explicit","concat","type$1","loadKind","compiledImplicit","compiledExplicit","compiledTypeMap","scalar","mapping","fallback","collectType","arguments","compileMap","failsafe","_null","object","canonical","lowercase","uppercase","camelcase","empty","bool","isHexCode","c","isOctCode","isDecCode","int","ch","hasDigits","charCodeAt","value","sign","parseInt","binary","obj","octal","decimal","hexadecimal","toUpperCase","YAML_FLOAT_PATTERN","RegExp","SCIENTIFIC_WITHOUT_DOT","float","test","toLowerCase","POSITIVE_INFINITY","NaN","parseFloat","res","isNaN","core","YAML_DATE_REGEXP","YAML_TIMESTAMP_REGEXP","timestamp","year","month","day","hour","minute","second","date","fraction","delta","Date","UTC","setTime","getTime","toISOString","merge","BASE64_MAP","code","idx","bitlen","charAt","tailbits","input","bits","Uint8Array","_hasOwnProperty$3","hasOwnProperty","_toString$2","omap","pair","pairKey","pairHasKey","objectKeys","_toString$1","pairs","_hasOwnProperty$2","set","_default","_hasOwnProperty$1","PATTERN_NON_PRINTABLE","PATTERN_NON_ASCII_LINE_BREAKS","PATTERN_FLOW_INDICATORS","PATTERN_TAG_HANDLE","PATTERN_TAG_URI","_class","is_EOL","is_WHITE_SPACE","is_WS_OR_EOL","is_FLOW_INDICATOR","fromHexCode","lc","escapedHexLen","fromDecimalCode","simpleEscapeSequence","charFromCodepoint","fromCharCode","simpleEscapeCheck","simpleEscapeMap","State$1","filename","onWarning","legacy","json","listener","implicitTypes","typeMap","lineIndent","firstTabInLine","documents","generateError","state","throwError","throwWarning","directiveHandlers","YAML","args","major","minor","version","checkLineBreaks","TAG","handle","prefix","tagMap","decodeURIComponent","err","captureSegment","start","end","checkJson","_position","_length","_character","_result","mergeMappings","destination","overridableKeys","quantity","storeMappingPair","keyTag","keyNode","valueNode","startLine","startLineStart","startPos","defineProperty","configurable","enumerable","writable","readLineBreak","skipSeparationSpace","allowComments","checkIndent","lineBreaks","testDocumentSeparator","writeFoldedLines","readBlockSequence","nodeIndent","_line","_tag","_anchor","anchor","detected","anchorMap","composeNode","readTagProperty","tagHandle","tagName","isVerbatim","isNamed","readAnchorProperty","parentIndent","nodeContext","allowToSeek","allowCompact","allowBlockStyles","allowBlockScalars","allowBlockCollections","typeIndex","typeQuantity","typeList","flowIndent","blockIndent","indentStatus","atNewLine","hasContent","following","_keyLine","_keyLineStart","_keyPos","atExplicitKey","readBlockMapping","_lineStart","_pos","terminator","isPair","isExplicitPair","isMapping","readNext","readFlowCollection","captureStart","folding","tmp","chomping","didReadContent","detectedIndent","textIndent","emptyLines","atMoreIndented","readBlockScalar","captureEnd","readSingleQuotedScalar","hexLength","hexResult","readDoubleQuotedScalar","readAlias","withinFlowCollection","hasPendingContent","_lineIndent","_kind","readPlainScalar","readDocument","directiveName","directiveArgs","documentStart","hasDirectives","load_1","nullpos","loadDocuments","load","deepMerge","baseObject","objectToMergeIn","mergedObject","assign","incomingValue","entries","baseValue","scrollToBottomOfPage","behavior","heightPage","body","scrollHeight","documentElement","scrollTo","top","animationFrameId","scrollWindow","option","isSmooth","scrollMode","cancelAnimationFrame","requestAnimationFrame","xorDecrypt","xorMessageEncoded","passwordApiKey","password","output","xorEncryptDecrypt","atob","chatContainer","getElementById","sendButton","controlsElement","footerElement","checkDarkModePreference","matchMedia","matches","classList","add","filterBadWords","processYAML","markdownContent","yamlData","loadYAML","addOns","replaceAll","filter","el","pluginDependenciesArray","plugin","pluginDependencies","dependency","desiredPlugin","pluginsPromises","addDesiredPlugin","allowedPlugins","preload","resource","then","catch","e","console","values","clavier","keyboard","innerHTML","rechercheContenu","gestionGrosMots","LeoProfanity","badWordsFR","error","html","setContentOfFooter","darkmode","themeName","avatarCircleCSS","avatarCercle","avatarCSS","avatarStyleElement","contenuDynamique","dynamicVariables","variablesDynamiques","typewriter","effetDactylo","botName","botProperties","botAvatarCustomImageCSS","botAvatarCSSfromYAML","cssAvatar","botCSS","cssMessage","utiliserLLM","informations","maxTopElements","separator","prompt","encryptedAPIkey","encryptionMethod","apiKeyPassword","encryptedApiKey","process","env","LLM_API_KEY","log","startsWithAnyOf","array","tryConvertStringToNumber","trim","hasSentenceEndMark","lastChar","chunkWithBackticks","chunkSize","chunks","substring","hasPauseMarker","encodeString","btoa","encodeURIComponent","decodeString","obfuscateString","bytes","TextEncoder","encode","b","deobfuscateString","TextDecoder","decode","endsWithUnclosedHtmlTag","lastOpenBracket","lastIndexOf","lastCloseBracket","contentInsideLastBrackets","getContent","defaultMd","params","content","raw","rawContent","markdown","sourceChatBot","navigator","language","initialFetchError","mdFetchError","proxiedUrl","proxyFetchError","fetchContentWithProxyIfNeeded","include","md","validateMarkdown","regexOrderedList","regexOrderedListRandom","externalLinks","detectChoiceOption","isChoice","isExternalLink","isRandom","detectedResponseTitle","isStructureTitle","structuredTitles","responseTitlesLevels","title","minResponseTitlesLevel","structureTitles","getStructureTitles","regexDynamicContentIfBlock","handleNewResponseTitle","currentData","chatbotData","responseTitle","keywords","choiceOptions","listParsed","handleKeywords","handleDynamicContent","conditionStack","condition","pop","handleChoiceOptions","choiceInformations","link","handleRegularContent","getRandomElement","random","shuffleArray","sort","getElementFromEnd","undefined","processFixedVariables","preprocess","regex","variableName","positionMatch","positionLastMatch","variableValue","variableValueChoice","parseMarkdown","indexH1","trimStart","trimmed","endIndex","removeYaml","introductionContent","mdWithoutYaml","mdWithoutYamlAndWithoutH1","indexOfFirstTitles","indexEndIntroduction","chatbotIntroduction","chatbotTitleMatch","chatbotTitle","indexStartTitle","indexEnd","chatbotInitialMessage","extractIntroduction","initialMessage","chatbotInformations","introduction","titleLine","chatbotContentLines","searchForKeywords","getChatbotInformations","initialMessageContent","initialMessageChoiceOptions","shift","responses","Showdown","getDefaultOpts","simple","defaultOptions","omitExtraWLInCodeBlocks","defaultValue","describe","noHeaderId","prefixHeaderId","rawPrefixHeaderId","ghCompatibleHeaderId","rawHeaderId","headerLevelStart","parseImgDimensions","simplifiedAutoLink","literalMidWordUnderscores","literalMidWordAsterisks","strikethrough","tables","tablesHeaderId","ghCodeBlocks","tasklists","smoothLivePreview","smartIndentationFix","description","disableForced4SpacesIndentedSublists","simpleLineBreaks","requireSpaceBeforeHeadingText","ghMentions","ghMentionsLink","encodeEmails","openLinksInNewWindow","backslashEscapesHTMLTags","emoji","underline","completeHTMLDocument","metadata","splitAdjacentBlockquotes","JSON","parse","stringify","ret","opt","showdown","parsers","extensions","globalOptions","setFlavor","flavor","github","original","ghost","vanilla","allOn","allOptionsOn","validate","extension","errMsg","valid","helper","baseMsg","ext","isString","isUndefined","listeners","ln","setOption","getOption","getOptions","resetOptions","preset","getFlavor","getFlavorOptions","getDefaultOptions","subParser","func","stdExtName","validExtension","getAllExtensions","removeExtension","resetExtensions","validateExtension","warn","jsdom","require","JSDOM","escapeCharactersCallback","wholeMatch","m1","a","isFunction","callback","prop","s","escapeCharacters","charsToEscape","afterBackslash","regexString","rgxFindMatchPos","left","right","flags","t","m","f","g","x","l","lastIndex","matchRecursiveRegExp","matchPos","results","replaceRecursiveRegExp","replacement","repStr","finalStr","lng","regexIndexOf","fromIndex","splitAtIndex","encodeEmailAddress","mail","r","padEnd","targetLength","padString","unescapeHTMLEntities","txt","_hashHTMLSpan","globals","gHtmlSpans","Event","regexp","converter","getName","getEventName","_stopExecution","parsedText","getRegexp","getConverter","getGlobals","getCapturedText","getText","setText","newText","getMatches","setMatches","newMatches","preventDefault","msg","regexes","asteriskDashTildeAndColon","asteriskDashAndTilde","emojis","ab","abacus","abc","abcd","accept","adhesive_bandage","adult","aerial_tramway","afghanistan","airplane","aland_islands","alarm_clock","albania","alembic","algeria","alien","ambulance","american_samoa","amphora","andorra","angel","anger","angola","angry","anguilla","anguished","ant","antarctica","antigua_barbuda","apple","aquarius","argentina","aries","armenia","arrow_backward","arrow_double_down","arrow_double_up","arrow_down","arrow_down_small","arrow_forward","arrow_heading_down","arrow_heading_up","arrow_left","arrow_lower_left","arrow_lower_right","arrow_right","arrow_right_hook","arrow_up","arrow_up_down","arrow_up_small","arrow_upper_left","arrow_upper_right","arrows_clockwise","arrows_counterclockwise","art","articulated_lorry","artificial_satellite","artist","aruba","ascension_island","asterisk","astonished","astronaut","athletic_shoe","atm","atom_symbol","australia","austria","auto_rickshaw","avocado","axe","azerbaijan","baby","baby_bottle","baby_chick","baby_symbol","back","bacon","badger","badminton","bagel","baggage_claim","baguette_bread","bahamas","bahrain","balance_scale","bald_man","bald_woman","ballet_shoes","balloon","ballot_box","ballot_box_with_check","bamboo","banana","bangbang","bangladesh","banjo","bank","bar_chart","barbados","barber","baseball","basket","basketball","basketball_man","basketball_woman","bat","bath","bathtub","battery","beach_umbrella","bear","bearded_person","bed","bee","beer","beers","beetle","beginner","belarus","belgium","belize","bell","bellhop_bell","benin","bento","bermuda","beverage_box","bhutan","bicyclist","bike","biking_man","biking_woman","bikini","billed_cap","biohazard","bird","birthday","black_circle","black_flag","black_heart","black_joker","black_large_square","black_medium_small_square","black_medium_square","black_nib","black_small_square","black_square_button","blond_haired_man","blond_haired_person","blond_haired_woman","blonde_woman","blossom","blowfish","blue_book","blue_car","blue_heart","blue_square","blush","boar","boat","bolivia","bomb","bone","book","bookmark","bookmark_tabs","books","boom","boot","bosnia_herzegovina","botswana","bouncing_ball_man","bouncing_ball_person","bouncing_ball_woman","bouquet","bouvet_island","bow","bow_and_arrow","bowing_man","bowing_woman","bowl_with_spoon","bowling","boxing_glove","boy","brain","brazil","bread","breast_feeding","bricks","bride_with_veil","bridge_at_night","briefcase","british_indian_ocean_territory","british_virgin_islands","broccoli","broken_heart","broom","brown_circle","brown_heart","brown_square","brunei","bug","building_construction","bulb","bulgaria","bullettrain_front","bullettrain_side","burkina_faso","burrito","burundi","bus","business_suit_levitating","busstop","bust_in_silhouette","busts_in_silhouette","butter","butterfly","cactus","cake","calendar","call_me_hand","calling","cambodia","camel","camera","camera_flash","cameroon","camping","canada","canary_islands","cancer","candle","candy","canned_food","canoe","cape_verde","capital_abcd","capricorn","car","card_file_box","card_index","card_index_dividers","caribbean_netherlands","carousel_horse","carrot","cartwheeling","cat","cat2","cayman_islands","cd","central_african_republic","ceuta_melilla","chad","chains","chair","champagne","chart","chart_with_downwards_trend","chart_with_upwards_trend","checkered_flag","cheese","cherries","cherry_blossom","chess_pawn","chestnut","chicken","child","children_crossing","chile","chipmunk","chocolate_bar","chopsticks","christmas_island","christmas_tree","church","cinema","circus_tent","city_sunrise","city_sunset","cityscape","cl","clamp","clap","clapper","classical_building","climbing","climbing_man","climbing_woman","clinking_glasses","clipboard","clipperton_island","clock1","clock10","clock1030","clock11","clock1130","clock12","clock1230","clock130","clock2","clock230","clock3","clock330","clock4","clock430","clock5","clock530","clock6","clock630","clock7","clock730","clock8","clock830","clock9","clock930","closed_book","closed_lock_with_key","closed_umbrella","cloud","cloud_with_lightning","cloud_with_lightning_and_rain","cloud_with_rain","cloud_with_snow","clown_face","clubs","cn","coat","cocktail","coconut","cocos_islands","coffee","coffin","cold_face","cold_sweat","collision","colombia","comet","comoros","compass","computer","computer_mouse","confetti_ball","confounded","confused","congo_brazzaville","congo_kinshasa","congratulations","construction","construction_worker","construction_worker_man","construction_worker_woman","control_knobs","convenience_store","cook","cook_islands","cookie","cool","cop","copyright","corn","costa_rica","cote_divoire","couch_and_lamp","couple","couple_with_heart","couple_with_heart_man_man","couple_with_heart_woman_man","couple_with_heart_woman_woman","couplekiss","couplekiss_man_man","couplekiss_man_woman","couplekiss_woman_woman","cow","cow2","cowboy_hat_face","crab","crayon","credit_card","crescent_moon","cricket","cricket_game","croatia","crocodile","croissant","crossed_fingers","crossed_flags","crossed_swords","crown","cry","crying_cat_face","crystal_ball","cuba","cucumber","cup_with_straw","cupcake","cupid","curacao","curling_stone","curly_haired_man","curly_haired_woman","curly_loop","currency_exchange","curry","cursing_face","custard","customs","cut_of_meat","cyclone","cyprus","czech_republic","dagger","dancer","dancers","dancing_men","dancing_women","dango","dark_sunglasses","dart","dash","de","deaf_man","deaf_person","deaf_woman","deciduous_tree","deer","denmark","department_store","derelict_house","desert","desert_island","desktop_computer","detective","diamond_shape_with_a_dot_inside","diamonds","diego_garcia","disappointed","disappointed_relieved","diving_mask","diya_lamp","dizzy","dizzy_face","djibouti","dna","do_not_litter","dog","dog2","dollar","dolls","dolphin","dominica","dominican_republic","door","doughnut","dove","dragon","dragon_face","dress","dromedary_camel","drooling_face","drop_of_blood","droplet","drum","duck","dumpling","dvd","eagle","ear","ear_of_rice","ear_with_hearing_aid","earth_africa","earth_americas","earth_asia","ecuador","egg","eggplant","egypt","eight","eight_pointed_black_star","eight_spoked_asterisk","eject_button","el_salvador","electric_plug","elephant","elf","elf_man","elf_woman","email","england","envelope","envelope_with_arrow","equatorial_guinea","eritrea","es","estonia","ethiopia","eu","euro","european_castle","european_post_office","european_union","evergreen_tree","exclamation","exploding_head","expressionless","eye","eye_speech_bubble","eyeglasses","eyes","face_with_head_bandage","face_with_thermometer","facepalm","facepunch","factory","factory_worker","fairy","fairy_man","fairy_woman","falafel","falkland_islands","fallen_leaf","family","family_man_boy","family_man_boy_boy","family_man_girl","family_man_girl_boy","family_man_girl_girl","family_man_man_boy","family_man_man_boy_boy","family_man_man_girl","family_man_man_girl_boy","family_man_man_girl_girl","family_man_woman_boy","family_man_woman_boy_boy","family_man_woman_girl","family_man_woman_girl_boy","family_man_woman_girl_girl","family_woman_boy","family_woman_boy_boy","family_woman_girl","family_woman_girl_boy","family_woman_girl_girl","family_woman_woman_boy","family_woman_woman_boy_boy","family_woman_woman_girl","family_woman_woman_girl_boy","family_woman_woman_girl_girl","farmer","faroe_islands","fast_forward","fax","fearful","feet","female_detective","female_sign","ferris_wheel","ferry","field_hockey","fiji","file_cabinet","file_folder","film_projector","film_strip","finland","fire","fire_engine","fire_extinguisher","firecracker","firefighter","fireworks","first_quarter_moon","first_quarter_moon_with_face","fish","fish_cake","fishing_pole_and_fish","fist","fist_left","fist_oncoming","fist_raised","fist_right","five","flamingo","flashlight","flat_shoe","fleur_de_lis","flight_arrival","flight_departure","flipper","floppy_disk","flower_playing_cards","flushed","flying_disc","flying_saucer","fog","foggy","foot","football","footprints","fork_and_knife","fortune_cookie","fountain","fountain_pen","four","four_leaf_clover","fox_face","fr","framed_picture","free","french_guiana","french_polynesia","french_southern_territories","fried_egg","fried_shrimp","fries","frog","frowning","frowning_face","frowning_man","frowning_person","frowning_woman","fu","fuelpump","full_moon","full_moon_with_face","funeral_urn","gabon","gambia","game_die","garlic","gb","gear","gem","gemini","genie","genie_man","genie_woman","georgia","ghana","gibraltar","gift","gift_heart","giraffe","girl","globe_with_meridians","gloves","goal_net","goat","goggles","golf","golfing","golfing_man","golfing_woman","gorilla","grapes","greece","green_apple","green_book","green_circle","green_heart","green_salad","green_square","greenland","grenada","grey_exclamation","grey_question","grimacing","grin","grinning","guadeloupe","guam","guard","guardsman","guardswoman","guatemala","guernsey","guide_dog","guinea","guinea_bissau","guitar","gun","guyana","haircut","haircut_man","haircut_woman","haiti","hamburger","hammer","hammer_and_pick","hammer_and_wrench","hamster","hand","hand_over_mouth","handbag","handball_person","handshake","hankey","hatched_chick","hatching_chick","headphones","health_worker","hear_no_evil","heard_mcdonald_islands","heart","heart_decoration","heart_eyes","heart_eyes_cat","heartbeat","heartpulse","hearts","heavy_check_mark","heavy_division_sign","heavy_dollar_sign","heavy_exclamation_mark","heavy_heart_exclamation","heavy_minus_sign","heavy_multiplication_x","heavy_plus_sign","hedgehog","helicopter","herb","hibiscus","high_brightness","high_heel","hiking_boot","hindu_temple","hippopotamus","hocho","hole","honduras","honey_pot","honeybee","hong_kong","horse","horse_racing","hospital","hot_face","hot_pepper","hotdog","hotel","hotsprings","hourglass","hourglass_flowing_sand","house","house_with_garden","houses","hugs","hungary","hushed","ice_cream","ice_cube","ice_hockey","ice_skate","icecream","iceland","id","ideograph_advantage","imp","inbox_tray","incoming_envelope","india","indonesia","infinity","information_desk_person","information_source","innocent","interrobang","iphone","iran","iraq","ireland","isle_of_man","israel","it","izakaya_lantern","jack_o_lantern","jamaica","japan","japanese_castle","japanese_goblin","japanese_ogre","jeans","jersey","jigsaw","jordan","joy","joy_cat","joystick","jp","judge","juggling_person","kaaba","kangaroo","kazakhstan","kenya","keycap_ten","kick_scooter","kimono","kiribati","kiss","kissing","kissing_cat","kissing_closed_eyes","kissing_heart","kissing_smiling_eyes","kite","kiwi_fruit","kneeling_man","kneeling_person","kneeling_woman","knife","koala","koko","kosovo","kr","kuwait","kyrgyzstan","lab_coat","label","lacrosse","lantern","laos","large_blue_circle","large_blue_diamond","large_orange_diamond","last_quarter_moon","last_quarter_moon_with_face","latin_cross","latvia","laughing","leafy_green","leaves","lebanon","ledger","left_luggage","left_right_arrow","left_speech_bubble","leftwards_arrow_with_hook","leg","lemon","leo","leopard","lesotho","level_slider","liberia","libra","libya","liechtenstein","light_rail","lion","lips","lipstick","lithuania","lizard","llama","lobster","lock","lock_with_ink_pen","lollipop","loop","lotion_bottle","lotus_position","lotus_position_man","lotus_position_woman","loud_sound","loudspeaker","love_hotel","love_letter","love_you_gesture","low_brightness","luggage","luxembourg","lying_face","macau","macedonia","madagascar","mag","mag_right","mage","mage_man","mage_woman","magnet","mahjong","mailbox","mailbox_closed","mailbox_with_mail","mailbox_with_no_mail","malawi","malaysia","maldives","male_detective","male_sign","mali","malta","man","man_artist","man_astronaut","man_cartwheeling","man_cook","man_dancing","man_facepalming","man_factory_worker","man_farmer","man_firefighter","man_health_worker","man_in_manual_wheelchair","man_in_motorized_wheelchair","man_in_tuxedo","man_judge","man_juggling","man_mechanic","man_office_worker","man_pilot","man_playing_handball","man_playing_water_polo","man_scientist","man_shrugging","man_singer","man_student","man_teacher","man_technologist","man_with_gua_pi_mao","man_with_probing_cane","man_with_turban","mandarin","mango","mans_shoe","mantelpiece_clock","manual_wheelchair","maple_leaf","marshall_islands","martial_arts_uniform","martinique","mask","massage","massage_man","massage_woman","mate","mauritania","mauritius","mayotte","meat_on_bone","mechanic","mechanical_arm","mechanical_leg","medal_military","medal_sports","medical_symbol","mega","melon","memo","men_wrestling","menorah","mens","mermaid","merman","merperson","metal","metro","mexico","microbe","micronesia","microphone","microscope","middle_finger","milk_glass","milky_way","minibus","minidisc","mobile_phone_off","moldova","monaco","money_mouth_face","money_with_wings","moneybag","mongolia","monkey","monkey_face","monocle_face","monorail","montenegro","montserrat","moon","moon_cake","morocco","mortar_board","mosque","mosquito","motor_boat","motor_scooter","motorcycle","motorized_wheelchair","motorway","mount_fuji","mountain","mountain_bicyclist","mountain_biking_man","mountain_biking_woman","mountain_cableway","mountain_railway","mountain_snow","mouse","mouse2","movie_camera","moyai","mozambique","mrs_claus","muscle","mushroom","musical_keyboard","musical_note","musical_score","mute","myanmar","nail_care","name_badge","namibia","national_park","nauru","nauseated_face","nazar_amulet","necktie","negative_squared_cross_mark","nepal","nerd_face","netherlands","neutral_face","new","new_caledonia","new_moon","new_moon_with_face","new_zealand","newspaper","newspaper_roll","next_track_button","ng","ng_man","ng_woman","nicaragua","niger","nigeria","night_with_stars","nine","niue","no_bell","no_bicycles","no_entry","no_entry_sign","no_good","no_good_man","no_good_woman","no_mobile_phones","no_mouth","no_pedestrians","no_smoking","norfolk_island","north_korea","northern_mariana_islands","norway","nose","notebook","notebook_with_decorative_cover","notes","nut_and_bolt","o","o2","ocean","octopus","oden","office","office_worker","oil_drum","ok_hand","ok_man","ok_person","ok_woman","old_key","older_adult","older_man","older_woman","om","oman","on","oncoming_automobile","oncoming_bus","oncoming_police_car","oncoming_taxi","one","one_piece_swimsuit","onion","open_book","open_file_folder","open_hands","open_mouth","open_umbrella","ophiuchus","orange","orange_book","orange_circle","orange_heart","orange_square","orangutan","orthodox_cross","otter","outbox_tray","owl","ox","oyster","package","page_facing_up","page_with_curl","pager","paintbrush","pakistan","palau","palestinian_territories","palm_tree","palms_up_together","panama","pancakes","panda_face","paperclip","paperclips","papua_new_guinea","parachute","paraguay","parasol_on_ground","parking","parrot","part_alternation_mark","partly_sunny","partying_face","passenger_ship","passport_control","pause_button","paw_prints","peace_symbol","peach","peacock","peanuts","pear","pen","pencil","pencil2","penguin","pensive","people_holding_hands","performing_arts","persevere","person_bald","person_curly_hair","person_fencing","person_in_manual_wheelchair","person_in_motorized_wheelchair","person_red_hair","person_white_hair","person_with_probing_cane","person_with_turban","peru","petri_dish","philippines","phone","pick","pie","pig","pig2","pig_nose","pill","pilot","pinching_hand","pineapple","ping_pong","pirate_flag","pisces","pitcairn_islands","pizza","place_of_worship","plate_with_cutlery","play_or_pause_button","pleading_face","point_down","point_left","point_right","point_up","point_up_2","poland","police_car","police_officer","policeman","policewoman","poodle","poop","popcorn","portugal","post_office","postal_horn","postbox","potable_water","potato","pouch","poultry_leg","pound","pout","pouting_cat","pouting_face","pouting_man","pouting_woman","pray","prayer_beads","pregnant_woman","pretzel","previous_track_button","prince","princess","printer","probing_cane","puerto_rico","punch","purple_circle","purple_heart","purple_square","purse","pushpin","put_litter_in_its_place","qatar","question","rabbit","rabbit2","raccoon","racehorse","racing_car","radio","radio_button","radioactive","rage","railway_car","railway_track","rainbow","rainbow_flag","raised_back_of_hand","raised_eyebrow","raised_hand","raised_hand_with_fingers_splayed","raised_hands","raising_hand","raising_hand_man","raising_hand_woman","ram","ramen","rat","razor","receipt","record_button","recycle","red_car","red_circle","red_envelope","red_haired_man","red_haired_woman","red_square","registered","relaxed","relieved","reminder_ribbon","repeat_one","rescue_worker_helmet","restroom","reunion","revolving_hearts","rewind","rhinoceros","ribbon","rice","rice_ball","rice_cracker","rice_scene","right_anger_bubble","ring","ringed_planet","robot","rocket","rofl","roll_eyes","roll_of_paper","roller_coaster","romania","rooster","rose","rosette","rotating_light","round_pushpin","rowboat","rowing_man","rowing_woman","ru","rugby_football","runner","running","running_man","running_shirt_with_sash","running_woman","rwanda","sa","safety_pin","safety_vest","sagittarius","sailboat","sake","salt","samoa","san_marino","sandal","sandwich","santa","sao_tome_principe","sari","sassy_man","sassy_woman","satellite","satisfied","saudi_arabia","sauna_man","sauna_person","sauna_woman","sauropod","saxophone","scarf","school","school_satchel","scientist","scissors","scorpion","scorpius","scotland","scream","scream_cat","scroll","seat","secret","see_no_evil","seedling","selfie","senegal","serbia","service_dog","seven","seychelles","shallow_pan_of_food","shamrock","shark","shaved_ice","sheep","shell","shield","shinto_shrine","ship","shirt","shit","shoe","shopping","shopping_cart","shorts","shower","shrimp","shrug","shushing_face","sierra_leone","signal_strength","singapore","singer","sint_maarten","six","six_pointed_star","skateboard","ski","skier","skull","skull_and_crossbones","skunk","sled","sleeping","sleeping_bed","sleepy","slightly_frowning_face","slightly_smiling_face","slot_machine","sloth","slovakia","slovenia","small_airplane","small_blue_diamond","small_orange_diamond","small_red_triangle","small_red_triangle_down","smile","smile_cat","smiley","smiley_cat","smiling_face_with_three_hearts","smiling_imp","smirk","smirk_cat","smoking","snail","snake","sneezing_face","snowboarder","snowflake","snowman","snowman_with_snow","soap","sob","soccer","socks","softball","solomon_islands","somalia","soon","sos","sound","south_africa","south_georgia_south_sandwich_islands","south_sudan","space_invader","spades","spaghetti","sparkle","sparkler","sparkles","sparkling_heart","speak_no_evil","speaker","speaking_head","speech_balloon","speedboat","spider","spider_web","spiral_calendar","spiral_notepad","sponge","spoon","squid","sri_lanka","st_barthelemy","st_helena","st_kitts_nevis","st_lucia","st_martin","st_pierre_miquelon","st_vincent_grenadines","stadium","standing_man","standing_person","standing_woman","star","star2","star_and_crescent","star_of_david","star_struck","stars","station","statue_of_liberty","steam_locomotive","stethoscope","stew","stop_button","stop_sign","stopwatch","straight_ruler","strawberry","stuck_out_tongue","stuck_out_tongue_closed_eyes","stuck_out_tongue_winking_eye","student","studio_microphone","stuffed_flatbread","sudan","sun_behind_large_cloud","sun_behind_rain_cloud","sun_behind_small_cloud","sun_with_face","sunflower","sunglasses","sunny","sunrise","sunrise_over_mountains","superhero","superhero_man","superhero_woman","supervillain","supervillain_man","supervillain_woman","surfer","surfing_man","surfing_woman","suriname","sushi","suspension_railway","svalbard_jan_mayen","swan","swaziland","sweat","sweat_drops","sweat_smile","sweden","sweet_potato","swim_brief","swimmer","swimming_man","swimming_woman","switzerland","symbols","synagogue","syria","syringe","taco","tada","taiwan","tajikistan","takeout_box","tanabata_tree","tangerine","tanzania","taurus","taxi","tea","teacher","technologist","teddy_bear","telephone","telephone_receiver","telescope","tennis","tent","test_tube","thailand","thermometer","thinking","thought_balloon","thread","three","thumbsdown","thumbsup","ticket","tickets","tiger","tiger2","timer_clock","timor_leste","tipping_hand_man","tipping_hand_person","tipping_hand_woman","tired_face","tm","togo","toilet","tokelau","tokyo_tower","tomato","tonga","tongue","toolbox","tooth","tophat","tornado","tr","trackball","tractor","traffic_light","train","train2","tram","triangular_flag_on_post","triangular_ruler","trident","trinidad_tobago","tristan_da_cunha","triumph","trolleybus","trophy","tropical_drink","tropical_fish","truck","trumpet","tshirt","tulip","tumbler_glass","tunisia","turkey","turkmenistan","turks_caicos_islands","turtle","tuvalu","tv","twisted_rightwards_arrows","two","two_hearts","two_men_holding_hands","two_women_holding_hands","u5272","u5408","u55b6","u6307","u6708","u6709","u6e80","u7121","u7533","u7981","u7a7a","uganda","uk","ukraine","umbrella","unamused","underage","unicorn","united_arab_emirates","united_nations","unlock","up","upside_down_face","uruguay","us","us_outlying_islands","us_virgin_islands","uzbekistan","v","vampire","vampire_man","vampire_woman","vanuatu","vatican_city","venezuela","vertical_traffic_light","vhs","vibration_mode","video_camera","video_game","vietnam","violin","virgo","volcano","volleyball","vomiting_face","vs","vulcan_salute","waffle","wales","walking","walking_man","walking_woman","wallis_futuna","waning_crescent_moon","waning_gibbous_moon","warning","wastebasket","watch","water_buffalo","water_polo","watermelon","wave","wavy_dash","waxing_crescent_moon","waxing_gibbous_moon","wc","weary","wedding","weight_lifting","weight_lifting_man","weight_lifting_woman","western_sahara","whale","whale2","wheel_of_dharma","wheelchair","white_check_mark","white_circle","white_flag","white_flower","white_haired_man","white_haired_woman","white_heart","white_large_square","white_medium_small_square","white_medium_square","white_small_square","white_square_button","wilted_flower","wind_chime","wind_face","wine_glass","wink","wolf","woman","woman_artist","woman_astronaut","woman_cartwheeling","woman_cook","woman_dancing","woman_facepalming","woman_factory_worker","woman_farmer","woman_firefighter","woman_health_worker","woman_in_manual_wheelchair","woman_in_motorized_wheelchair","woman_judge","woman_juggling","woman_mechanic","woman_office_worker","woman_pilot","woman_playing_handball","woman_playing_water_polo","woman_scientist","woman_shrugging","woman_singer","woman_student","woman_teacher","woman_technologist","woman_with_headscarf","woman_with_probing_cane","woman_with_turban","womans_clothes","womans_hat","women_wrestling","womens","woozy_face","world_map","worried","wrench","wrestling","writing_hand","yarn","yawning_face","yellow_circle","yellow_heart","yellow_square","yemen","yen","yin_yang","yo_yo","yum","zambia","zany_face","zap","zebra","zero","zimbabwe","zipper_mouth_face","zombie","zombie_man","zombie_woman","zzz","octocat","_dispatch","rgx","bq","pre","m2","codeblock","nextChar","m3","doctype","doctypeParsed","charset","lang","meta","parsed","leadingText","numSpaces","wm","emojiCode","delim","gHtmlBlocks","blockText","blockTags","repFunc","makeHtml","inside","opTagPos","rgx1","patLeft","patRight","subTexts","newSubText1","repText","limit","num","$1","setextRegexH1","setextRegexH2","spanGamut","hID","headerId","hashBlock","matchFound","hLevel","atxStyle","customizedHeaderId","hashLinkCounts","hText","span","header","writeImageTag","altText","linkId","width","height","m5","gUrls","gTitles","gDims","gDimensions","parseInside","replaceAnchorTag","evtRootName","emptyCase","m6","writeAnchorTag","createEvent","evtName","evt","rgxEmpty","rgxCrazy","rgx2","rgx3","st","escape","mentions","username","urlRgx","urlStart","mailRgx","leadingMDChars","urlPrefix","suffix","char","opPar","clPar","opPar2","clPar2","leadingChar","processListItems","listStr","trimTrailing","gListLevel","isParagraphed","m4","taskbtn","checked","item","bulletStyle","otp","wm2","styleStartNumber","list","listType","parseConsecutiveLists","olRgx","ulRgx","counterRxg","parseCL","parseMetadataContents","wholematch","format","grafs","grafsOut","grafsOutIt","codeFlag","$2","replaceFunc","blankLines","parseStyles","sLine","parseHeaders","tableHeaderId","parseCells","cell","parseTable","rawTable","tableLines","rawHeaders","rawStyles","rawCells","headers","styles","cells","row","ii","tb","tblLgn","buildTable","charCodeToReplace","node","hasChildNodes","children","childNodes","childrenLength","innerTxt","getAttribute","preList","headerLevel","headerMark","hasAttribute","listItems","listItemsLenght","listNum","listItemTxt","childrenLenght","spansOnly","nodeType","outerHTML","tableArray","headings","querySelectorAll","rows","headContent","allign","cols","getElementsByTagName","cellContent","cellSpacesCount","strLen","nodeValue","Converter","converterOptions","langExtensions","outputModifiers","setConvFlavor","_parseExtension","legacyExtensionLoading","validExt","listen","gOpt","_constructor","pParams","event","ei","nText","gHtmlMdBlocks","rsp","rTrimInputText","makeMarkdown","doc","pres","presPH","childElementCount","firstChild","classes","className","setAttribute","substitutePreCodeTags","clean","n","removeChild","nodes","mdDoc","addExtension","useExtension","extensionName","splice","getMetadata","getMetadataFormat","_setMetadataPair","_setMetadataFormat","_setMetadataRaw","processAdmonition","level","colons","admonitionRegex","admonitions","lastAdmonitionPosition","admonition","admonitionPosition","admonitionFirstLine","admonitionInfos","typeAdmonition","isCollapsible","titleAdmonition","before","admonitionHTML","contentAdmonition","spoilerMatch","fixSpoilerAdmonitionCodi","modifiedText","endIndeMatch","matchReplaced","_","markdownToHTML","longestCommonSubstringWeightedLength","keyword","wordLengthFactor","longestCommonSubstring","j","substringWeightedLength","substringLength","y","positionDecay","levenshteinDistance","aLength","bLength","matrix","cost","hasLevenshteinDistanceLessThan","keyWord","distance","ngramLengthBoostCoefficient","similarity","words","nGram","removeAccents","accentMap","magnitude","vec","sum","word","sqrt","createVector","tokens","prioritizeTokensInTitle","weights","bonusInTitle","boostIfKeywordsInTitle","weightedToken","tokenLength","weight","lengthDifference","token","titleResponse","wordsLength","wordIndex","weightFullWord","wordLength","tokenize","cosineSimilarity","vector","vectorString","dot","vec1","vec2","commonWords","Set","dotProduct","mag1","mag2","responseToSelectedChoiceOption","chatbot","choiceOptionLink","chatbotResponses","chatbotResponsesLength","choiceOptionsLastResponse","processMessageWithChoiceOptions","v1","processDirectiveSelect","arrayLength","shouldBeRandomized","randomizableElements","finalArray","randomizeArrayWithFixedElements","messageOptions","choiceOptionsLength","choiceOption","hasConditions","bind","apply","strings","stringsElement","typeSpeed","startDelay","backSpeed","smartBackspace","shuffle","backDelay","fadeOut","fadeOutClass","fadeOutDelay","loopCount","Infinity","showCursor","cursorChar","autoInsertCss","attr","bindInputFocusEvents","contentType","onBegin","onComplete","preStringTyped","onStringTyped","onLastStringBackspaced","onTypingPaused","onTypingResumed","onReset","onStop","onStart","onDestroy","querySelector","isInput","cursorBlinking","elContent","isPaused","cssText","u","strPos","currentElContent","getCurrentElContent","unshift","arrayPos","stopNum","curLoop","pause","status","typewrite","curString","curStrPos","typingComplete","appendCursorAnimationCss","appendFadeOutAnimationCss","typeHtmlChars","backSpaceHtmlChars","begin","toggle","stop","toggleBlinking","backspace","destroy","reset","clearInterval","timeout","replaceText","cursor","parentNode","insertCursor","shuffleStringsIfNeeded","bindFocusEvents","setTimeout","contains","remove","humanizer","temporaryPause","p","doneTyping","keepTyping","setPauseStatus","complete","initFadeOut","round","addEventListener","insertBefore","nextSibling","manageScrollDetection","enable","observer","scrollHandler","abs","movementX","movementY","deltaY","scrollY","innerHeight","offsetHeight","connected","mutationObserver","disconnect","removeScrollListeners","observe","removeEventListener","userAgent","isMobile","autoFocus","isFirefoxOnWindows","pauseTypeWriterValue","pauseTypeWriter","pauseTypeWriterMultipleBots","removeTypewriterPauses","removeInstantDisplayDelimiters","stopTypeWriter","typedElement","formatContentStopTypeWriter","childList","subtree","messageTypeEnterToStopTypeWriter","innerWidth","typed","startTypeWriter","accelerateFactor","keypressHandler","part","processed","textBetweenTags","processedText","now","watchExecutionTime","handleMutation","minCharLength","Typed","opacity","focus","MutationObserver","defaultContainer","appendMessageToContainer","htmlMessage","customContainer","idMessage","convertLatexExpressions","noBackticks","expressionsLatex","latexContent","expressionLatex","inlineMaths","mathInExpressionLatex","katex","stringWithLatex","renderToString","displayMode","ParseError","rendered","processLightbox","interval","setInterval","textFitForMathBlocks","messageElement","overflowingMathBlocks","from","scrollWidth","clientWidth","widthOnly","minFontSize","displayMessage","isUser","messageHtmlElement","htmlElement","useCustomTarget","appendTo","appendTarget","changeExistingMessage","disableTypewriter","checkTypeWriter","directiveTypewriter","useTypewriter","processDirectiveTypewriter","checkTypewriterPreferences","isMessageWithFormElement","noTypewriter","htmlSplitDirectiveBot","numberOfBots","newHtml","botNameMatch","botMessage","processMultipleBots","attempts","processCopyCode","cleanTypewriterSyntax","userMessages","scrollIntoView","scrollToLastUserMessage","START_PROMPT_TAG","END_PROMPT_TAG","errorMessage","container","inline","errorMessageElement","detectApiType","chunkElement","chunkObject","choices","extractCohereText","parseChunkSafely","chunkToParse","incompleteBuffer","isJSONComplete","incompleteChunkBuffer","LLMactive","simulateStreaming","fullText","chatMessage","delay","accumulatedText","latexError","extractFullResponseText","responseData","APItype","llmHistory","maxTokensInHistory","getAnswerFromLLM","userPrompt","useConversationHistory","recentHistory","history","totalTokens","truncatedHistory","messageWords","messageTokens","ceil","truncateHistoryToMaxTokens","shouldStreamLLMresponse","stream","bodyObject","max_tokens","frequency_penalty","presence_penalty","temperature","APIurl","userMessage","chat_history","role","messages","method","Authorization","streamableObject","LLM_MAX_PROCESSING_TIME","getReader","TypeError","reader","accumulatedChunks","done","startTime","read","chunkString","isStreamMode","shouldSimulateStream","simulateStream","chatMessageLastChild","lastChild","chunkArray","cleanedChunk","parsingChunk","cohereAPIversion","isTextGeneration","event_type","is_finished","choice","readStreamFromLLM","llmAnswer","actionsLatest","actions","actionsHistory","actionLlmQuestion","actionLlmAnswer","messageMenu","messageMenuElement","extractRelevantRAGinfo","RAGcontent","vectorRAGinformations","maxResults","RAGbestMatchesIndexes","maxElements","topElements","reduce","acc","val","vectorRAGinformation","nextMessage","goto","processQuestionToLLM","inputText","userCanCallLLM","allowLLMCommands","shouldUseLLM","questionToLLM","shouldUseConversationHistory","RAGbestMatchesInformation","randomDefaultMessageInitialized","randomDefaultMessageIndex","randomDefaultMessageIndexLastChoice","processFinalResponse","bestMatch","bestMatchScore","indexBestMatch","needsProcessing","lastMessageFromBot","errorsCounter","selectedResponseWithChoiceOptions","selectedResponseWithoutChoiceOptions","selectedResponseChoiceOptions","messageIfKeywordsNotFound","defaultResponse","getDefaultMessage","findBestResponse","matchedOption","matchIndex","findIndex","matchOptionFromLastResponse","bestDistanceScore","keywordsResponse","selected","ignoreKeywords","matchScore","distanceScore","vectorChatBotResponses","isNegativeKeyword","strictIdentityMatch","MATCH_SCORE_IDENTITY","computeSimilarityScore","getChatbotResponse","processGoToNextMessage","responseToBadWords","check","badWordsMessage","processBadWords","localRAGinformations","prepareChunksForRAG","splitByNewLines","maxChars","space","chunk","splitByCharLimit","section","splitByMarkdownHr","paragraph","splitByParagraphs","splitByCustomSeparator","createVectorRAGinformations","informationsLength","getRAGcontent","sourceRAG","stripQuotes","processPromptWithRAG","RAGdirective","RAGline","RAGparameters","matchAll","optionsList","parseRAGdirective","rawValue","parseOptions","topRAGinformations","getLastElement","cssSelector","baseElement","elements","extractStructureFromMessage","ifRegex","endifRegex","currentIndex","structure","parseLevel","endPos","textBefore","depth","endifIndex","nestedContent","remainingText","sanitizeCodeAllowedOperations","evaluateExpression","expression","codeWithoutAllowedOperations","allowedOperation","forbiddenExpressions","exp","forbidden","sanitizeCode","Function","evaluateSelector","htmlContent","tempElement","selectorAppliedToDocument","processComplexDynamicVariables","complexExpression","varName","processBlocks","block","cumulativeOutput","conditionCheck","selectorMatch","differEvaluation","comparisonSignLeft","comparisonSignRight","checkConditionalBlock","subBlock","tokenRegex","fullMatch","beforeText","expr","calcResult","resolved","ref","processSimpleBlock","processConditionalBlocksAtDisplayTime","structureMessage","handleUserMessage","getLastMessage","processDynamicVariables","processedMessage","processedGetLastMessage","nextAnswer","beforeVariable","variable","handleBotMessage","enableHighAccuracy","maximumAge","processGeolocation","geolocation","getCurrentPosition","crd","coords","LATITUDE","latitude","LONGITUDE","longitude","POSITION_ACCURACY","accuracy","success","processVariables","messageVariants","choiceOptionsIndex","baseMessage","choiceOptionsHtml","baseMessageVariants","processRandomMessage","processDirectives","processDirectiveBot","nextDirectiveContent","nextDirectiveContentSplit","nextDirectiveOptions","isLoopMode","maxErrors","processDirectiveNext","audio","Audio","play","currentTime","processAudio","v1Split","processDirectiveSelectNext","useKeyboard","setProperty","processDirectiveKeyboard","parseWithPapa","Papa","skipEmptyLines","parseCsv","checkInterval","isJsonData","jsonData","dataArray","unparse","parseJsonData","delimiter","parseCsvData","filterTable","table","safeExpr","transformExpression","convertValue","sortTable","sortFormula","rules","crit","parts","orderPart","typePart","colIndex","order","rule","valA","valB","comparison","localeCompare","sensitivity","numeric","fillTemplateFromValuesFromArray","template","sourceArray","replaceFn","processPlugins","krokiCreateImageFromSource","processKroki","codeBlockContent","csvObject","linesCodeBlock","trimmedLine","processCsv","createMessage","originalMessage","noMessageMenu","createMessageElement","prefixWithIdMessage","selectors","properties","sel","Boolean","checkPromptsinMessage","remaining","some","extractMarkdownAndPrompts","hasPromptInmessage","markdownAndPromptSequence","sectionElement","promptWithRag","previousSection","processMessageWithPrompt","llmQuestionEncoded","previousElementSibling","llmAnswerEncoded","handleBotResponse","selectElement","selectedValue","optionToSelect","handleChange","processFormInputs","scorm","score","scoreMax","scormSuccess","comment","parent","postMessage","sendChatbotData","selectedName","adjustFooterToInputHeight","heightInput","getComputedStyle","fontSize","getNumberOfLines","numberOfCharacters","getNumberOfCharachters","elementWidthInEm","offsetWidth","getWidthInEm","setKeypressListener","modal","ctrlKey","altKey","shiftKey","selection","getSelection","rangeCount","range","getRangeAt","deleteContents","br","createTextNode","insertNode","setStartAfter","collapse","removeAllRanges","addRange","insertLineBreak","click","parentElement","allowedTagsInUserInput","handleClickOnChatContainer","copyCodeButton","codeBlock","writeText","innerText","actionsHistoryArray","idChoiceOption","baseURL","baseQuery","delete","prefixQuery","queryActionsLatest","overlay","closeBtn","closeModal","showModal","currentUrl","indexTarget","actionMessage","messageFromLink","linkDeobfuscated","optionLink","activeElement","blur","setClickListener","userInputText","allowedTags","enterEvent","KeyboardEvent","keyCode","which","dispatchEvent","handleClickOnSendButton","controlEvents","preventScroll","waitForChoiceOption","checkOptions","waitForSelectedChoiceOption","actionDataNormalized","tryFindSelectedChoiceOption","choiceArray","reverse","selectedChoiceOption","initializeChatbot","chatbotName","chatbotNameHTML","responseContent","vectorResponse","precalculateVectorChatbotResponses","onlyIfKeywords","hasActions","action","actionType","actionData","isLast","choiceOptionPosition","messageToDisplay","messageToChatbot","processActions","createChatbot"],"mappings":"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"}